theory OPC_UA_Secure_Communication begin

// Function signature and definition of the equational theory E

builtins: multiset
functions: check_rep/2, fst/1, get_rep/1, h/1, mac/2, pair/2,
           rep/2 [private], sdec/2, senc/2, snd/1, true/0, verifyMac/3
equations:
    check_rep(rep(m, loc), loc) = m,
    fst(<x.1, x.2>) = x.1,
    get_rep(rep(m, loc)) = m,
    sdec(senc(x.1, x.2), x.2) = x.1,
    snd(<x.1, x.2>) = x.2,
    verifyMac(mac(m, sk), m, sk) = true

heuristic: l

section{* The OPC UA Secure Conversation protocol *}

rule (modulo E) Init_:
   [ ] --[ Init( ) ]-> [ State_( ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) MessageID_rule_:
   [ Fr( ~x ) ] --> [ MID_Sender( ~x ), MID_Receiver( ~x ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Rep_0_:
   [ State_( ) ] --> [ !Semistate_1( ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Rep_1_:
   [ Fr( ~prog_1 ), !Semistate_1( ) ]
  --[ ProgressFrom_1( ~prog_1 ) ]->
   [ State_1( ~prog_1 ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) new_a_1:
   [ State_1( ~prog_1 ), Fr( a ) ] --> [ State_11( ~prog_1, a ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) new_b_11:
   [ State_11( ~prog_1, a ), Fr( b ) ] --> [ State_111( ~prog_1, a, b ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) new_kSign_111:
   [ State_111( ~prog_1, a, b ), Fr( kSign ) ]
  -->
   [ State_1111( ~prog_1, a, b, kSign ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) new_kEnc_1111:
   [ State_1111( ~prog_1, a, b, kSign ), Fr( kEnc ) ]
  -->
   [ State_11111( ~prog_1, a, b, kEnc, kSign ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Par_11111:
   [ State_11111( ~prog_1, a, b, kEnc, kSign ) ]
  -->
   [
   State_111111( ~prog_1, a, b, kEnc, kSign ),
   State_111112( ~prog_1, a, b, kEnc, kSign )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Rep_0_111111[color=#569dc0]:
   [ State_111111( ~prog_1, a, b, kEnc, kSign ) ]
  --[ ProgressTo_1111111( ~prog_1 ) ]->
   [ !Semistate_1111111( ~prog_1, a, b, kEnc, kSign ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Rep_1_111111[color=#569dc0]:
   [ !Semistate_1111111( ~prog_1, a, b, kEnc, kSign ) ]
  -->
   [ State_1111111( ~prog_1, a, b, kEnc, kSign ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) lock_a_b__1111111[color=#569dc0]:
   [
   Fr( ~prog_11111111 ), State_1111111( ~prog_1, a, b, kEnc, kSign ),
   Fr( ~lock8 )
   ]
  --[
  ProgressFrom_11111111( ~prog_11111111 ), Lock( $8, ~lock8, <a, b> ),
  Lock_8( $8, ~lock8, <a, b> )
  ]->
   [ State_11111111( ~lock8, ~prog_1, ~prog_11111111, a, b, kEnc, kSign ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) in_c_seq_11111111[color=#569dc0]:
   [
   State_11111111( ~lock8, ~prog_1, ~prog_11111111, a, b, kEnc, kSign ),
   In( <'c', seq> )
   ]
  --[ ProgressTo_111111111( ~prog_11111111 ), ChannelInEvent( <'c', seq> )
  ]->
   [
   State_111111111( ~lock8, ~prog_1, ~prog_11111111, a, b, kEnc, kSign, seq
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) event_Seq_Senta_b_seq_111111111[color=#569dc0]:
   [
   Fr( ~prog_1111111111 ),
   State_111111111( ~lock8, ~prog_1, ~prog_11111111, a, b, kEnc, kSign, seq
   )
   ]
  --[
  ProgressFrom_1111111111( ~prog_1111111111 ), Event( ),
  Seq_Sent( a, b, seq )
  ]->
   [
   State_1111111111( ~lock8, ~prog_1, ~prog_11111111, ~prog_1111111111, a,
                     b, kEnc, kSign, seq
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) new_m_1111111111[color=#569dc0]:
   [
   State_1111111111( ~lock8, ~prog_1, ~prog_11111111, ~prog_1111111111, a,
                     b, kEnc, kSign, seq
   ),
   Fr( m )
   ]
  -->
   [
   State_11111111111( ~lock8, ~prog_1, ~prog_11111111, ~prog_1111111111, a,
                      b, kEnc, kSign, m, seq
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) event_Senta_b_m_11111111111[color=#569dc0]:
   [
   State_11111111111( ~lock8, ~prog_1, ~prog_11111111, ~prog_1111111111, a,
                      b, kEnc, kSign, m, seq
   )
   ]
  --[ Event( ), Sent( a, b, m ) ]->
   [
   State_111111111111( ~lock8, ~prog_1, ~prog_11111111, ~prog_1111111111, a,
                       b, kEnc, kSign, m, seq
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) out_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__111111111111[color=#569dc0]:
   [
   MID_Sender( mid_111111111111 ),
   State_111111111111( ~lock8, ~prog_1, ~prog_11111111, ~prog_1111111111, a,
                       b, kEnc, kSign, m, seq
   )
   ]
  --[
  Send( mid_111111111111,
        <$MH, $SH, 
         senc(<seq, m, $pad, mac(<$MH, $SH, seq, m, $pad>, kSign)>, kEnc)>
  )
  ]->
   [
   Out( <$MH, $SH, 
         senc(<seq, m, $pad, mac(<$MH, $SH, seq, m, $pad>, kSign)>, kEnc)>
   ),
   State_1111111111111( ~lock8, ~prog_1, ~prog_11111111, ~prog_1111111111,
                        a, b, kEnc, kSign, m, seq
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) unlock_a_b__1111111111111[color=#569dc0]:
   [
   State_1111111111111( ~lock8, ~prog_1, ~prog_11111111, ~prog_1111111111,
                        a, b, kEnc, kSign, m, seq
   )
   ]
  --[ Unlock( $8, ~lock8, <a, b> ), Unlock_8( $8, ~lock8, <a, b> ) ]->
   [
   State_11111111111111( ~lock8, ~prog_1, ~prog_11111111, ~prog_1111111111,
                         a, b, kEnc, kSign, m, seq
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Zero_11111111111111[color=#569dc0]:
   [
   State_11111111111111( ~lock8, ~prog_1, ~prog_11111111, ~prog_1111111111,
                         a, b, kEnc, kSign, m, seq
   )
   ]
  --[ ProgressTo_111111111111111( ~prog_1111111111 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) Rep_0_111112[color=#2cd719]:
   [ State_111112( ~prog_1, a, b, kEnc, kSign ) ]
  --[ ProgressTo_1111121( ~prog_1 ) ]->
   [ !Semistate_1111121( ~prog_1, a, b, kEnc, kSign ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Rep_1_111112[color=#2cd719]:
   [ !Semistate_1111121( ~prog_1, a, b, kEnc, kSign ) ]
  -->
   [ State_1111121( ~prog_1, a, b, kEnc, kSign ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) lock_b_a__1111121[color=#2cd719]:
   [
   Fr( ~prog_11111211 ), State_1111121( ~prog_1, a, b, kEnc, kSign ),
   Fr( ~lock6 )
   ]
  --[
  ProgressFrom_11111211( ~prog_11111211 ), Lock( $6, ~lock6, <b, a> ),
  Lock_6( $6, ~lock6, <b, a> )
  ]->
   [ State_11111211( ~lock6, ~prog_1, ~prog_11111211, a, b, kEnc, kSign ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) in_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__11111211[color=#2cd719]:
   [
   State_11111211( ~lock6, ~prog_1, ~prog_11111211, a, b, kEnc, kSign ),
   In( <MH, SH, senc(<seq, m, pad, mac(<MH, SH, seq, m, pad>, kSign)>, kEnc)
       >
   ),
   MID_Receiver( mid_11111211 )
   ]
  --[
  ProgressTo_111112111( ~prog_11111211 ),
  Receive( mid_11111211,
           <MH, SH, senc(<seq, m, pad, mac(<MH, SH, seq, m, pad>, kSign)>, kEnc)>
  )
  ]->
   [
   State_111112111( ~lock6, ~prog_1, ~prog_11111211, MH, SH, a, b, kEnc,
                    kSign, m, pad, seq
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) event_Seq_Recva_b_seq_111112111[color=#2cd719]:
   [
   Fr( ~prog_1111121111 ),
   State_111112111( ~lock6, ~prog_1, ~prog_11111211, MH, SH, a, b, kEnc,
                    kSign, m, pad, seq
   )
   ]
  --[
  ProgressFrom_1111121111( ~prog_1111121111 ), Event( ),
  Seq_Recv( a, b, seq )
  ]->
   [
   State_1111121111( ~lock6, ~prog_1, ~prog_11111211, ~prog_1111121111, MH,
                     SH, a, b, kEnc, kSign, m, pad, seq
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) event_Recva_b_m_1111121111[color=#2cd719]:
   [
   State_1111121111( ~lock6, ~prog_1, ~prog_11111211, ~prog_1111121111, MH,
                     SH, a, b, kEnc, kSign, m, pad, seq
   )
   ]
  --[ Event( ), Recv( a, b, m ) ]->
   [
   State_11111211111( ~lock6, ~prog_1, ~prog_11111211, ~prog_1111121111, MH,
                      SH, a, b, kEnc, kSign, m, pad, seq
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) unlock_b_a__11111211111[color=#2cd719]:
   [
   State_11111211111( ~lock6, ~prog_1, ~prog_11111211, ~prog_1111121111, MH,
                      SH, a, b, kEnc, kSign, m, pad, seq
   )
   ]
  --[ Unlock( $6, ~lock6, <b, a> ), Unlock_6( $6, ~lock6, <b, a> ) ]->
   [
   State_111112111111( ~lock6, ~prog_1, ~prog_11111211, ~prog_1111121111,
                       MH, SH, a, b, kEnc, kSign, m, pad, seq
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Zero_111112111111[color=#2cd719]:
   [
   State_111112111111( ~lock6, ~prog_1, ~prog_11111211, ~prog_1111121111,
                       MH, SH, a, b, kEnc, kSign, m, pad, seq
   )
   ]
  --[ ProgressTo_1111121111111( ~prog_1111121111 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

restriction A_Counter_Increases:
  "∀ A B seq1 seq2 #i #j.
    (((Seq_Sent( A, B, seq1 ) @ #i) ∧ (Seq_Sent( A, B, seq2 ) @ #j)) ∧
     (#i < #j)) ⇒
    (∃ dif. seq2 = (dif+seq1))"

restriction A_Counter_No_Reuse:
  "∀ A B seq #i #j.
    ((Seq_Sent( A, B, seq ) @ #i) ∧ (Seq_Sent( A, B, seq ) @ #j)) ⇒
    (#i = #j)"
  // safety formula

restriction B_Counter_Counter_Increases:
  "∀ A B seq1 seq2 #i #j.
    (((Seq_Recv( A, B, seq1 ) @ #i) ∧ (Seq_Recv( A, B, seq2 ) @ #j)) ∧
     (#i < #j)) ⇒
    (∃ dif. seq2 = (dif+seq1))"

restriction B_Counter_No_Reuse:
  "∀ A B seq #i #j.
    ((Seq_Recv( A, B, seq ) @ #i) ∧ (Seq_Recv( A, B, seq ) @ #j)) ⇒
    (#i = #j)"
  // safety formula

restriction single_session:
  "∀ #i #j. ((Init( ) @ #i) ∧ (Init( ) @ #j)) ⇒ (#i = #j)"
  // safety formula

restriction progress_11111211_to_111112111:
  "∀ p #t1.
    (ProgressFrom_11111211( p ) @ #t1) ⇒
    (∃ #t2. ProgressTo_111112111( p ) @ #t2)"

restriction progress_1111121111_to_1111121111111:
  "∀ p #t1.
    (ProgressFrom_1111121111( p ) @ #t1) ⇒
    (∃ #t2. ProgressTo_1111121111111( p ) @ #t2)"

restriction progress_1111111111_to_111111111111111:
  "∀ p #t1.
    (ProgressFrom_1111111111( p ) @ #t1) ⇒
    (∃ #t2. ProgressTo_111111111111111( p ) @ #t2)"

restriction progress_11111111_to_111111111:
  "∀ p #t1.
    (ProgressFrom_11111111( p ) @ #t1) ⇒
    (∃ #t2. ProgressTo_111111111( p ) @ #t2)"

restriction progress_1_to_1111121:
  "∀ p #t1.
    (ProgressFrom_1( p ) @ #t1) ⇒ (∃ #t2. ProgressTo_1111121( p ) @ #t2)"

restriction progress_1_to_1111111:
  "∀ p #t1.
    (ProgressFrom_1( p ) @ #t1) ⇒ (∃ #t2. ProgressTo_1111111( p ) @ #t2)"

restriction progress_init:
  "∃ #t. Init( ) @ #t"

restriction resilient:
  "∀ #i x y.
    (Send( x, y ) @ #i) ⇒ (∃ #j. (Receive( x, y ) @ #j) ∧ (#i < #j))"

restriction locking_8:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_8( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_8( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

restriction locking_6:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_6( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_6( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

lemma Executable:
  exists-trace "∃ A B m #i. Recv( A, B, m ) @ #i"
/*
guarded formula characterizing all satisfying traces:
"∃ A B m #i. (Recv( A, B, m ) @ #i)"
*/
simplify
solve( State_1111121111( ~lock6, ~prog_1, ~prog_11111211,
                         ~prog_1111121111, MH, SH, A, B, kEnc, kSign, m, pad, seq
       ) ▶₀ #i )
  case event_Seq_Recva_b_seq_111112111
  solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.2 )
    case MessageID_rule_
    solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2 )
      case Par_11111
      solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.1 )
        case Par_11111
        solve( State_11111211( ~lock6.1, ~prog_1.1, ~prog_11111211, a, b, kEnc,
                               kSign
               ) ▶₀ #t2.2 )
          case lock_b_a__1111121
          solve( State_111112111111( ~lock6.1, ~prog_1.1, ~prog_11111211.1,
                                     ~prog_1111121111, MH.1, SH.1, a, b, kEnc, kSign, m.1, pad.1, seq.1
                 ) ▶₀ #t2.2 )
            case unlock_b_a__11111211111
            solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.7 )
              case MessageID_rule_
              solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                case Par_11111
                solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                  case Par_11111
                  solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                    case Par_11111
                    solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                      case Par_11111
                      solve( State_11111211( ~lock6.1, ~prog_1.1, ~prog_11111211, a, b, kEnc,
                                             kSign
                             ) ▶₀ #t2.3 )
                        case lock_b_a__1111121
                        solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                          case Par_11111
                          solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                            case Par_11111
                            solve( !KU( senc(<seq, m, pad, mac(<MH, SH, seq, m, pad>, ~n.3)>, ~n.2)
                                   ) @ #vk.4 )
                              case out_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__111111111111
                              solve( MID_Receiver( ~x.1 ) ▶₂ #j )
                                case MessageID_rule_
                                solve( State_11111211( ~lock6.1, ~prog_1.1, ~prog_11111211.1, a, b, ~n.2,
                                                       ~n.3
                                       ) ▶₀ #j )
                                  case lock_b_a__1111121
                                  solve( ((#vr.2 < #vr.23) ∧
                                          (∃ #t2.
                                            (Unlock_6( $6, ~lock6, <~n.1, ~n> ) @ #t2)
                                           ∧
                                            (#vr.2 < #t2) ∧
                                            (#t2 < #vr.23) ∧
                                            (∀ #t0 pp. (Unlock( pp, ~lock6, <~n.1, ~n> ) @ #t0) ⇒ #t0 = #t2) ∧
                                            (∀ pp lpp #t0.
                                              (Lock( pp, lpp, <~n.1, ~n> ) @ #t0)
                                             ⇒
                                              ((#t0 < #vr.2) ∨ (#t0 = #vr.2) ∨ (#t2 < #t0))) ∧
                                            (∀ pp lpp #t0.
                                              (Unlock( pp, lpp, <~n.1, ~n> ) @ #t0)
                                             ⇒
                                              ((#t0 < #vr.2) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                         (#vr.23 < #vr.2)  ∥ (#vr.2 = #vr.23) )
                                    case case_1
                                    solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.9 )
                                      case MessageID_rule_
                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                                        case Par_11111
                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                                          case Par_11111
                                          solve( State_11111111( ~lock8, ~prog_1.1, ~prog_11111111, a, b,
                                                                 kEnc, kSign
                                                 ) ▶₀ #t2.3 )
                                            case lock_a_b__1111111
                                            solve( State_11111111111111( ~lock8.1, ~prog_1.1,
                                                                         ~prog_11111111.1, ~prog_1111111111,
                                                                         a, b, kEnc, kSign, m, seq.1
                                                   ) ▶₀ #t2.4 )
                                              case unlock_a_b__1111111111111
                                              solve( MID_Receiver( ~x ) ▶₂ #j.1 )
                                                case MessageID_rule_
                                                solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.5 )
                                                  case Par_11111
                                                  solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.5 )
                                                    case Par_11111
                                                    solve( State_11111211( ~lock6.2, ~prog_1.1,
                                                                           ~prog_11111211.1, a, b, kEnc, kSign
                                                           ) ▶₀ #t2.5 )
                                                      case lock_b_a__1111121
                                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t2.5 )
                                                        case Par_11111
                                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                               ) ▶₀ #t2.5 )
                                                          case Par_11111
                                                          solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                 ) ▶₀ #t2.5 )
                                                            case Par_11111
                                                            solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t2.5 )
                                                              case Par_11111
                                                              solve( State_11111111( ~lock8.1, ~prog_1.1,
                                                                                     ~prog_11111111, a, b,
                                                                                     kEnc, kSign
                                                                     ) ▶₀ #t2.5 )
                                                                case lock_a_b__1111111
                                                                solve( State_111111( ~prog_1, a, b, kEnc,
                                                                                     kSign
                                                                       ) ▶₀ #t2.5 )
                                                                  case Par_11111
                                                                  solve( State_111112( ~prog_1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t2.5 )
                                                                    case Par_11111
                                                                    solve( State_111111( ~prog_1, a, b, kEnc,
                                                                                         kSign
                                                                           ) ▶₀ #t2.5 )
                                                                      case Par_11111
                                                                      solve( State_111112( ~prog_1, a, b,
                                                                                           kEnc, kSign
                                                                             ) ▶₀ #t2.5 )
                                                                        case Par_11111
                                                                        SOLVED // trace found
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma all_received_were_sent:
  all-traces
  "∀ A B m #i.
    (Recv( A, B, m ) @ #i) ⇒ (∃ #k. (Sent( A, B, m ) @ #k) ∧ (#k < #i))"
/*
guarded formula characterizing all counter-examples:
"∃ A B m #i.
  (Recv( A, B, m ) @ #i) ∧ ∀ #k. (Sent( A, B, m ) @ #k) ⇒ ¬(#k < #i)"
*/
simplify
solve( State_1111121111( ~lock6, ~prog_1, ~prog_11111211,
                         ~prog_1111121111, MH, SH, A, B, kEnc, kSign, m, pad, seq
       ) ▶₀ #i )
  case event_Seq_Recva_b_seq_111112111
  solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.2 )
    case MessageID_rule_
    solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2 )
      case Par_11111
      solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.1 )
        case Par_11111
        solve( State_11111211( ~lock6.1, ~prog_1.1, ~prog_11111211, a, b, kEnc,
                               kSign
               ) ▶₀ #t2.2 )
          case lock_b_a__1111121
          solve( State_111112111111( ~lock6.1, ~prog_1.1, ~prog_11111211.1,
                                     ~prog_1111121111, MH.1, SH.1, a, b, kEnc, kSign, m.1, pad.1, seq.1
                 ) ▶₀ #t2.2 )
            case unlock_b_a__11111211111
            solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.7 )
              case MessageID_rule_
              solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                case Par_11111
                solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                  case Par_11111
                  solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                    case Par_11111
                    solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                      case Par_11111
                      solve( State_11111211( ~lock6.1, ~prog_1.1, ~prog_11111211, a, b, kEnc,
                                             kSign
                             ) ▶₀ #t2.3 )
                        case lock_b_a__1111121
                        solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                          case Par_11111
                          solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                            case Par_11111
                            solve( !KU( senc(<seq, m, pad, mac(<MH, SH, seq, m, pad>, ~n.3)>, ~n.2)
                                   ) @ #vk.4 )
                              case c_senc
                              by solve( !KU( ~n.2 ) @ #vk.6 )
                            next
                              case out_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__111111111111
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma all_received_were_sent_injective:
  all-traces
  "∀ A B t #i.
    (Recv( A, B, t ) @ #i) ⇒
    (∃ #j.
      ((Sent( A, B, t ) @ #j) ∧ (#j < #i)) ∧
      (¬(∃ A2 B2 #i2. (Recv( A2, B2, t ) @ #i2) ∧ (¬(#i2 = #i)))))"
/*
guarded formula characterizing all counter-examples:
"∃ A B t #i.
  (Recv( A, B, t ) @ #i)
 ∧
  ∀ #j.
   (Sent( A, B, t ) @ #j)
  ⇒
   ((¬(#j < #i)) ∨ (∃ A2 B2 #i2. (Recv( A2, B2, t ) @ #i2) ∧ ¬(#i2 = #i)))"
*/
simplify
solve( State_1111121111( ~lock6, ~prog_1, ~prog_11111211,
                         ~prog_1111121111, MH, SH, A, B, kEnc, kSign, t, pad, seq
       ) ▶₀ #i )
  case event_Seq_Recva_b_seq_111112111
  solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.2 )
    case MessageID_rule_
    solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2 )
      case Par_11111
      solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.1 )
        case Par_11111
        solve( State_11111211( ~lock6.1, ~prog_1.1, ~prog_11111211, a, b, kEnc,
                               kSign
               ) ▶₀ #t2.2 )
          case lock_b_a__1111121
          solve( State_111112111111( ~lock6.1, ~prog_1.1, ~prog_11111211.1,
                                     ~prog_1111121111, MH.1, SH.1, a, b, kEnc, kSign, m.1, pad.1, seq.1
                 ) ▶₀ #t2.2 )
            case unlock_b_a__11111211111
            solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.7 )
              case MessageID_rule_
              solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                case Par_11111
                solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                  case Par_11111
                  solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                    case Par_11111
                    solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                      case Par_11111
                      solve( State_11111211( ~lock6.1, ~prog_1.1, ~prog_11111211, a, b, kEnc,
                                             kSign
                             ) ▶₀ #t2.3 )
                        case lock_b_a__1111121
                        solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                          case Par_11111
                          solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                            case Par_11111
                            solve( !KU( senc(<seq, m, pad, mac(<MH, SH, seq, m, pad>, ~n.3)>, ~n.2)
                                   ) @ #vk.4 )
                              case c_senc
                              by solve( !KU( ~n.2 ) @ #vk.6 )
                            next
                              case out_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__111111111111
                              solve( (#i2 < #i)  ∥ (#i < #i2) )
                                case case_1
                                solve( MID_Receiver( ~x ) ▶₂ #j )
                                  case MessageID_rule_
                                  solve( State_11111211( ~lock6.2, ~prog_1.2, ~prog_11111211.2, a, b, ~n.2,
                                                         ~n.3
                                         ) ▶₀ #j )
                                    case lock_b_a__1111121
                                    solve( ((#vr.2 < #vr.23) ∧
                                            (∃ #t2.
                                              (Unlock_6( $6, ~lock6, <~n.1, ~n> ) @ #t2)
                                             ∧
                                              (#vr.2 < #t2) ∧
                                              (#t2 < #vr.23) ∧
                                              (∀ #t0 pp.
                                                (Unlock( pp, ~lock6, <~n.1, ~n> ) @ #t0) ⇒ #t0 = #t2) ∧
                                              (∀ pp lpp #t0.
                                                (Lock( pp, lpp, <~n.1, ~n> ) @ #t0)
                                               ⇒
                                                ((#t0 < #vr.2) ∨ (#t0 = #vr.2) ∨ (#t2 < #t0))) ∧
                                              (∀ pp lpp #t0.
                                                (Unlock( pp, lpp, <~n.1, ~n> ) @ #t0)
                                               ⇒
                                                ((#t0 < #vr.2) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                           (#vr.23 < #vr.2)  ∥ (#vr.2 = #vr.23) )
                                      case case_1
                                      solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.9 )
                                        case MessageID_rule_
                                        solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t2.3 )
                                          case Par_11111
                                          solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t2.3 )
                                            case Par_11111
                                            solve( State_11111111( ~lock8, ~prog_1.2, ~prog_11111111, a, b,
                                                                   kEnc.1, kSign.1
                                                   ) ▶₀ #t2.3 )
                                              case lock_a_b__1111111
                                              solve( State_11111111111111( ~lock8.1, ~prog_1.2,
                                                                           ~prog_11111111.1, ~prog_1111111111,
                                                                           a, b, kEnc.1, kSign.1, m, seq.2
                                                     ) ▶₀ #t2.4 )
                                                case unlock_a_b__1111111111111
                                                solve( MID_Receiver( ~x ) ▶₂ #j.1 )
                                                  case MessageID_rule_
                                                  solve( State_1111121111( ~lock6.1, ~prog_1.1,
                                                                           ~prog_11111211.1,
                                                                           ~prog_1111121111.1, MH.1, SH.1, A2,
                                                                           B2, kEnc, kSign, ~n.4, pad.1, seq.1
                                                         ) ▶₀ #i2 )
                                                    case event_Seq_Recva_b_seq_111112111
                                                    solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.15 )
                                                      case MessageID_rule_
                                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t2.5 )
                                                        case Par_11111
                                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                               ) ▶₀ #t2.5 )
                                                          case Par_11111
                                                          solve( State_11111211( ~lock6.3, ~prog_1.2,
                                                                                 ~prog_11111211.2, a, b, kEnc,
                                                                                 kSign
                                                                 ) ▶₀ #t2.5 )
                                                            case lock_b_a__1111121
                                                            solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t2.5 )
                                                              case Par_11111
                                                              solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                     ) ▶₀ #t2.5 )
                                                                case Par_11111
                                                                solve( State_111111( ~prog_1, a, b, kEnc,
                                                                                     kSign
                                                                       ) ▶₀ #t2.5 )
                                                                  case Par_11111
                                                                  solve( State_111112( ~prog_1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t2.5 )
                                                                    case Par_11111
                                                                    solve( State_11111111( ~lock8.1,
                                                                                           ~prog_1.2,
                                                                                           ~prog_11111111, a,
                                                                                           b, kEnc, kSign
                                                                           ) ▶₀ #t2.5 )
                                                                      case lock_a_b__1111111
                                                                      solve( State_111111( ~prog_1.1, a, b,
                                                                                           kEnc, kSign
                                                                             ) ▶₀ #t2.5 )
                                                                        case Par_11111
                                                                        solve( State_111112( ~prog_1.1, a, b,
                                                                                             kEnc, kSign
                                                                               ) ▶₀ #t2.6 )
                                                                          case Par_11111
                                                                          solve( State_11111211( ~lock6.3,
                                                                                                 ~prog_1.2,
                                                                                                 ~prog_11111211.1,
                                                                                                 a, b, kEnc,
                                                                                                 kSign
                                                                                 ) ▶₀ #t2.7 )
                                                                            case lock_b_a__1111121
                                                                            solve( State_111112111111( ~lock6.3,
                                                                                                       ~prog_1.2,
                                                                                                       ~prog_11111211.3,
                                                                                                       ~prog_1111121111.1,
                                                                                                       MH.2,
                                                                                                       SH.2,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign,
                                                                                                       m,
                                                                                                       pad.2,
                                                                                                       seq.2
                                                                                   ) ▶₀ #t2.8 )
                                                                              case unlock_b_a__11111211111
                                                                              solve( MID_Receiver( mid_11111211
                                                                                     ) ▶₂ #t2.17 )
                                                                                case MessageID_rule_
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t2.9 )
                                                                                  case Par_11111
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t2.9 )
                                                                                    case Par_11111
                                                                                    solve( State_111111( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t2.9 )
                                                                                      case Par_11111
                                                                                      solve( State_111112( ~prog_1,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case Par_11111
                                                                                        solve( State_111111( ~prog_1.1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case Par_11111
                                                                                          solve( State_111112( ~prog_1.1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t2.9 )
                                                                                            case Par_11111
                                                                                            solve( State_111111( ~prog_1.1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t2.9 )
                                                                                              case Par_11111
                                                                                              solve( State_111112( ~prog_1.1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t2.9 )
                                                                                                case Par_11111
                                                                                                solve( State_11111211( ~lock6.3,
                                                                                                                       ~prog_1.2,
                                                                                                                       ~prog_11111211.1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t2.9 )
                                                                                                  case lock_b_a__1111121
                                                                                                  solve( State_111111( ~prog_1.1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t2.9 )
                                                                                                    case Par_11111
                                                                                                    solve( State_111112( ~prog_1.1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t2.9 )
                                                                                                      case Par_11111
                                                                                                      solve( !KU( senc(<
                                                                                                                        seq.1, 
                                                                                                                        ~n.4, 
                                                                                                                        pad.1, 
                                                                                                                        mac(<
                                                                                                                             MH.1, 
                                                                                                                             SH.1, 
                                                                                                                             seq.1, 
                                                                                                                             ~n.4, 
                                                                                                                             pad.1
                                                                                                                            >,
                                                                                                                            ~n.8)
                                                                                                                       >,
                                                                                                                       ~n.7)
                                                                                                             ) @ #vk.12 )
                                                                                                        case c_senc
                                                                                                        by solve( !KU( ~n.7
                                                                                                                  ) @ #vk.14 )
                                                                                                      next
                                                                                                        case out_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__111111111111
                                                                                                        by contradiction
                                                                                                           /*
                                                                                                           cyclic
                                                                                                           */
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    next
                                      case case_2
                                      solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.9 )
                                        case MessageID_rule_
                                        solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t2.3 )
                                          case Par_11111
                                          solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t2.3 )
                                            case Par_11111
                                            solve( State_11111111( ~lock8, ~prog_1.2, ~prog_11111111, a, b,
                                                                   kEnc.1, kSign.1
                                                   ) ▶₀ #t2.3 )
                                              case lock_a_b__1111111
                                              solve( State_11111111111111( ~lock8.1, ~prog_1.2,
                                                                           ~prog_11111111.1, ~prog_1111111111,
                                                                           a, b, kEnc.1, kSign.1, m, seq.2
                                                     ) ▶₀ #t2.4 )
                                                case unlock_a_b__1111111111111
                                                solve( MID_Receiver( ~x ) ▶₂ #j.1 )
                                                  case MessageID_rule_
                                                  solve( State_1111121111( ~lock6.1, ~prog_1.1,
                                                                           ~prog_11111211.1,
                                                                           ~prog_1111121111.1, MH.1, SH.1, A2,
                                                                           B2, kEnc, kSign, ~n.4, pad.1, seq.1
                                                         ) ▶₀ #i2 )
                                                    case event_Seq_Recva_b_seq_111112111
                                                    solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.16 )
                                                      case MessageID_rule_
                                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t2.5 )
                                                        case Par_11111
                                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                               ) ▶₀ #t2.5 )
                                                          case Par_11111
                                                          solve( State_11111211( ~lock6.3, ~prog_1.2,
                                                                                 ~prog_11111211.2, a, b, kEnc,
                                                                                 kSign
                                                                 ) ▶₀ #t2.5 )
                                                            case lock_b_a__1111121
                                                            by solve( State_11111211111( ~lock6.2, ~prog_1.2,
                                                                                         ~prog_11111211.3,
                                                                                         ~prog_1111121111.2,
                                                                                         MH.2, SH.2, ~n, ~n.1,
                                                                                         kEnc, kSign, m,
                                                                                         pad.2, seq.2
                                                                      ) ▶₀ #t2.5 )
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    next
                                      case case_3
                                      solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.9 )
                                        case MessageID_rule_
                                        solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t2.3 )
                                          case Par_11111
                                          solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t2.3 )
                                            case Par_11111
                                            solve( State_11111111( ~lock8, ~prog_1.2, ~prog_11111111, a, b,
                                                                   kEnc.1, kSign.1
                                                   ) ▶₀ #t2.3 )
                                              case lock_a_b__1111111
                                              solve( State_11111111111111( ~lock8.1, ~prog_1.2,
                                                                           ~prog_11111111.1, ~prog_1111111111,
                                                                           a, b, kEnc.1, kSign.1, m, seq.2
                                                     ) ▶₀ #t2.4 )
                                                case unlock_a_b__1111111111111
                                                solve( MID_Receiver( ~x ) ▶₂ #j.1 )
                                                  case MessageID_rule_
                                                  solve( State_1111121111( ~lock6.1, ~prog_1.1,
                                                                           ~prog_11111211.1,
                                                                           ~prog_1111121111.1, MH.1, SH.1, A2,
                                                                           B2, kEnc, kSign, ~n.4, pad.1, seq.1
                                                         ) ▶₀ #i2 )
                                                    case event_Seq_Recva_b_seq_111112111
                                                    solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.15 )
                                                      case MessageID_rule_
                                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t2.5 )
                                                        case Par_11111
                                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                               ) ▶₀ #t2.5 )
                                                          case Par_11111
                                                          solve( State_11111211( ~lock6.2, ~prog_1.2,
                                                                                 ~prog_11111211, a, b, kEnc,
                                                                                 kSign
                                                                 ) ▶₀ #t2.5 )
                                                            case lock_b_a__1111121
                                                            solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t2.5 )
                                                              case Par_11111
                                                              solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                     ) ▶₀ #t2.5 )
                                                                case Par_11111
                                                                solve( State_111111( ~prog_1, a, b, kEnc,
                                                                                     kSign
                                                                       ) ▶₀ #t2.5 )
                                                                  case Par_11111
                                                                  solve( State_111112( ~prog_1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t2.5 )
                                                                    case Par_11111
                                                                    solve( State_11111111( ~lock8.1,
                                                                                           ~prog_1.2,
                                                                                           ~prog_11111111, a,
                                                                                           b, kEnc, kSign
                                                                           ) ▶₀ #t2.5 )
                                                                      case lock_a_b__1111111
                                                                      solve( State_111111( ~prog_1.1, a, b,
                                                                                           kEnc, kSign
                                                                             ) ▶₀ #t2.5 )
                                                                        case Par_11111
                                                                        solve( State_111112( ~prog_1.1, a, b,
                                                                                             kEnc, kSign
                                                                               ) ▶₀ #t2.6 )
                                                                          case Par_11111
                                                                          solve( State_11111211( ~lock6.2,
                                                                                                 ~prog_1.2,
                                                                                                 ~prog_11111211.1,
                                                                                                 a, b, kEnc,
                                                                                                 kSign
                                                                                 ) ▶₀ #t2.7 )
                                                                            case lock_b_a__1111121
                                                                            solve( State_111112111111( ~lock6.2,
                                                                                                       ~prog_1.2,
                                                                                                       ~prog_11111211.2,
                                                                                                       ~prog_1111121111.1,
                                                                                                       MH.2,
                                                                                                       SH.2,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign,
                                                                                                       m,
                                                                                                       pad.2,
                                                                                                       seq.2
                                                                                   ) ▶₀ #t2.8 )
                                                                              case unlock_b_a__11111211111
                                                                              solve( MID_Receiver( mid_11111211
                                                                                     ) ▶₂ #t2.17 )
                                                                                case MessageID_rule_
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t2.9 )
                                                                                  case Par_11111
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t2.9 )
                                                                                    case Par_11111
                                                                                    solve( State_111111( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t2.9 )
                                                                                      case Par_11111
                                                                                      solve( State_111112( ~prog_1,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case Par_11111
                                                                                        solve( State_111111( ~prog_1.1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case Par_11111
                                                                                          solve( State_111112( ~prog_1.1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t2.9 )
                                                                                            case Par_11111
                                                                                            solve( State_111111( ~prog_1.1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t2.9 )
                                                                                              case Par_11111
                                                                                              solve( State_111112( ~prog_1.1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t2.9 )
                                                                                                case Par_11111
                                                                                                solve( State_11111211( ~lock6.2,
                                                                                                                       ~prog_1.2,
                                                                                                                       ~prog_11111211.1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t2.9 )
                                                                                                  case lock_b_a__1111121
                                                                                                  solve( State_111111( ~prog_1.1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t2.9 )
                                                                                                    case Par_11111
                                                                                                    solve( State_111112( ~prog_1.1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t2.9 )
                                                                                                      case Par_11111
                                                                                                      solve( !KU( senc(<
                                                                                                                        seq.1, 
                                                                                                                        ~n.4, 
                                                                                                                        pad.1, 
                                                                                                                        mac(<
                                                                                                                             MH.1, 
                                                                                                                             SH.1, 
                                                                                                                             seq.1, 
                                                                                                                             ~n.4, 
                                                                                                                             pad.1
                                                                                                                            >,
                                                                                                                            ~n.8)
                                                                                                                       >,
                                                                                                                       ~n.7)
                                                                                                             ) @ #vk.12 )
                                                                                                        case c_senc
                                                                                                        by solve( !KU( ~n.7
                                                                                                                  ) @ #vk.14 )
                                                                                                      next
                                                                                                        case out_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__111111111111
                                                                                                        by contradiction
                                                                                                           /*
                                                                                                           cyclic
                                                                                                           */
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              next
                                case case_2
                                solve( MID_Receiver( ~x ) ▶₂ #j )
                                  case MessageID_rule_
                                  solve( State_11111211( ~lock6.2, ~prog_1.2, ~prog_11111211.2, a, b, ~n.2,
                                                         ~n.3
                                         ) ▶₀ #j )
                                    case lock_b_a__1111121
                                    solve( ((#vr.2 < #vr.23) ∧
                                            (∃ #t2.
                                              (Unlock_6( $6, ~lock6, <~n.1, ~n> ) @ #t2)
                                             ∧
                                              (#vr.2 < #t2) ∧
                                              (#t2 < #vr.23) ∧
                                              (∀ #t0 pp.
                                                (Unlock( pp, ~lock6, <~n.1, ~n> ) @ #t0) ⇒ #t0 = #t2) ∧
                                              (∀ pp lpp #t0.
                                                (Lock( pp, lpp, <~n.1, ~n> ) @ #t0)
                                               ⇒
                                                ((#t0 < #vr.2) ∨ (#t0 = #vr.2) ∨ (#t2 < #t0))) ∧
                                              (∀ pp lpp #t0.
                                                (Unlock( pp, lpp, <~n.1, ~n> ) @ #t0)
                                               ⇒
                                                ((#t0 < #vr.2) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                           (#vr.23 < #vr.2)  ∥ (#vr.2 = #vr.23) )
                                      case case_1
                                      solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.9 )
                                        case MessageID_rule_
                                        solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t2.3 )
                                          case Par_11111
                                          solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t2.3 )
                                            case Par_11111
                                            solve( State_11111111( ~lock8, ~prog_1.2, ~prog_11111111, a, b,
                                                                   kEnc.1, kSign.1
                                                   ) ▶₀ #t2.3 )
                                              case lock_a_b__1111111
                                              solve( State_11111111111111( ~lock8.1, ~prog_1.2,
                                                                           ~prog_11111111.1, ~prog_1111111111,
                                                                           a, b, kEnc.1, kSign.1, m, seq.2
                                                     ) ▶₀ #t2.4 )
                                                case unlock_a_b__1111111111111
                                                solve( MID_Receiver( ~x ) ▶₂ #j.1 )
                                                  case MessageID_rule_
                                                  solve( State_1111121111( ~lock6.1, ~prog_1.1,
                                                                           ~prog_11111211.1,
                                                                           ~prog_1111121111.1, MH.1, SH.1, A2,
                                                                           B2, kEnc, kSign, ~n.4, pad.1, seq.1
                                                         ) ▶₀ #i2 )
                                                    case event_Seq_Recva_b_seq_111112111
                                                    solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.15 )
                                                      case MessageID_rule_
                                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t2.5 )
                                                        case Par_11111
                                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                               ) ▶₀ #t2.5 )
                                                          case Par_11111
                                                          solve( State_11111211( ~lock6.3, ~prog_1.2,
                                                                                 ~prog_11111211.2, a, b, kEnc,
                                                                                 kSign
                                                                 ) ▶₀ #t2.5 )
                                                            case lock_b_a__1111121
                                                            solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t2.5 )
                                                              case Par_11111
                                                              solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                     ) ▶₀ #t2.5 )
                                                                case Par_11111
                                                                solve( State_111111( ~prog_1, a, b, kEnc,
                                                                                     kSign
                                                                       ) ▶₀ #t2.5 )
                                                                  case Par_11111
                                                                  solve( State_111112( ~prog_1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t2.5 )
                                                                    case Par_11111
                                                                    solve( State_11111111( ~lock8.1,
                                                                                           ~prog_1.2,
                                                                                           ~prog_11111111, a,
                                                                                           b, kEnc, kSign
                                                                           ) ▶₀ #t2.5 )
                                                                      case lock_a_b__1111111
                                                                      solve( State_111111( ~prog_1.1, a, b,
                                                                                           kEnc, kSign
                                                                             ) ▶₀ #t2.5 )
                                                                        case Par_11111
                                                                        solve( State_111112( ~prog_1.1, a, b,
                                                                                             kEnc, kSign
                                                                               ) ▶₀ #t2.6 )
                                                                          case Par_11111
                                                                          solve( State_11111211( ~lock6.3,
                                                                                                 ~prog_1.2,
                                                                                                 ~prog_11111211.1,
                                                                                                 a, b, kEnc,
                                                                                                 kSign
                                                                                 ) ▶₀ #t2.7 )
                                                                            case lock_b_a__1111121
                                                                            solve( State_111112111111( ~lock6.3,
                                                                                                       ~prog_1.2,
                                                                                                       ~prog_11111211.3,
                                                                                                       ~prog_1111121111.1,
                                                                                                       MH.2,
                                                                                                       SH.2,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign,
                                                                                                       m,
                                                                                                       pad.2,
                                                                                                       seq.2
                                                                                   ) ▶₀ #t2.8 )
                                                                              case unlock_b_a__11111211111
                                                                              solve( MID_Receiver( mid_11111211
                                                                                     ) ▶₂ #t2.17 )
                                                                                case MessageID_rule_
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t2.9 )
                                                                                  case Par_11111
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t2.9 )
                                                                                    case Par_11111
                                                                                    solve( State_111111( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t2.9 )
                                                                                      case Par_11111
                                                                                      solve( State_111112( ~prog_1,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case Par_11111
                                                                                        solve( State_111111( ~prog_1.1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case Par_11111
                                                                                          solve( State_111112( ~prog_1.1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t2.9 )
                                                                                            case Par_11111
                                                                                            solve( State_111111( ~prog_1.1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t2.9 )
                                                                                              case Par_11111
                                                                                              solve( State_111112( ~prog_1.1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t2.9 )
                                                                                                case Par_11111
                                                                                                solve( State_11111211( ~lock6.3,
                                                                                                                       ~prog_1.2,
                                                                                                                       ~prog_11111211.1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t2.9 )
                                                                                                  case lock_b_a__1111121
                                                                                                  solve( State_111111( ~prog_1.1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t2.9 )
                                                                                                    case Par_11111
                                                                                                    solve( State_111112( ~prog_1.1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t2.9 )
                                                                                                      case Par_11111
                                                                                                      solve( !KU( senc(<
                                                                                                                        seq.1, 
                                                                                                                        ~n.4, 
                                                                                                                        pad.1, 
                                                                                                                        mac(<
                                                                                                                             MH.1, 
                                                                                                                             SH.1, 
                                                                                                                             seq.1, 
                                                                                                                             ~n.4, 
                                                                                                                             pad.1
                                                                                                                            >,
                                                                                                                            ~n.8)
                                                                                                                       >,
                                                                                                                       ~n.7)
                                                                                                             ) @ #vk.12 )
                                                                                                        case c_senc
                                                                                                        by solve( !KU( ~n.7
                                                                                                                  ) @ #vk.14 )
                                                                                                      next
                                                                                                        case out_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__111111111111
                                                                                                        by contradiction
                                                                                                           /*
                                                                                                           cyclic
                                                                                                           */
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    next
                                      case case_2
                                      solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.9 )
                                        case MessageID_rule_
                                        solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t2.3 )
                                          case Par_11111
                                          solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t2.3 )
                                            case Par_11111
                                            solve( State_11111111( ~lock8, ~prog_1.2, ~prog_11111111, a, b,
                                                                   kEnc.1, kSign.1
                                                   ) ▶₀ #t2.3 )
                                              case lock_a_b__1111111
                                              solve( State_11111111111111( ~lock8.1, ~prog_1.2,
                                                                           ~prog_11111111.1, ~prog_1111111111,
                                                                           a, b, kEnc.1, kSign.1, m, seq.2
                                                     ) ▶₀ #t2.4 )
                                                case unlock_a_b__1111111111111
                                                solve( MID_Receiver( ~x ) ▶₂ #j.1 )
                                                  case MessageID_rule_
                                                  solve( State_1111121111( ~lock6.1, ~prog_1.1,
                                                                           ~prog_11111211.1,
                                                                           ~prog_1111121111.1, MH.1, SH.1, A2,
                                                                           B2, kEnc, kSign, ~n.4, pad.1, seq.1
                                                         ) ▶₀ #i2 )
                                                    case event_Seq_Recva_b_seq_111112111
                                                    solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.16 )
                                                      case MessageID_rule_
                                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t2.5 )
                                                        case Par_11111
                                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                               ) ▶₀ #t2.5 )
                                                          case Par_11111
                                                          solve( State_11111211( ~lock6.3, ~prog_1.2,
                                                                                 ~prog_11111211.2, a, b, kEnc,
                                                                                 kSign
                                                                 ) ▶₀ #t2.5 )
                                                            case lock_b_a__1111121
                                                            by solve( State_11111211111( ~lock6.2, ~prog_1.2,
                                                                                         ~prog_11111211.3,
                                                                                         ~prog_1111121111.2,
                                                                                         MH.2, SH.2, ~n, ~n.1,
                                                                                         kEnc, kSign, m,
                                                                                         pad.2, seq.2
                                                                      ) ▶₀ #t2.5 )
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    next
                                      case case_3
                                      solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.9 )
                                        case MessageID_rule_
                                        solve( State_111111( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t2.3 )
                                          case Par_11111
                                          solve( State_111112( ~prog_1, a, b, kEnc.1, kSign.1 ) ▶₀ #t2.3 )
                                            case Par_11111
                                            solve( State_11111111( ~lock8, ~prog_1.2, ~prog_11111111, a, b,
                                                                   kEnc.1, kSign.1
                                                   ) ▶₀ #t2.3 )
                                              case lock_a_b__1111111
                                              solve( State_11111111111111( ~lock8.1, ~prog_1.2,
                                                                           ~prog_11111111.1, ~prog_1111111111,
                                                                           a, b, kEnc.1, kSign.1, m, seq.2
                                                     ) ▶₀ #t2.4 )
                                                case unlock_a_b__1111111111111
                                                solve( MID_Receiver( ~x ) ▶₂ #j.1 )
                                                  case MessageID_rule_
                                                  solve( State_1111121111( ~lock6.1, ~prog_1.1,
                                                                           ~prog_11111211.1,
                                                                           ~prog_1111121111.1, MH.1, SH.1, A2,
                                                                           B2, kEnc, kSign, ~n.4, pad.1, seq.1
                                                         ) ▶₀ #i2 )
                                                    case event_Seq_Recva_b_seq_111112111
                                                    solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.15 )
                                                      case MessageID_rule_
                                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t2.5 )
                                                        case Par_11111
                                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                               ) ▶₀ #t2.5 )
                                                          case Par_11111
                                                          solve( State_11111211( ~lock6.2, ~prog_1.2,
                                                                                 ~prog_11111211, a, b, kEnc,
                                                                                 kSign
                                                                 ) ▶₀ #t2.5 )
                                                            case lock_b_a__1111121
                                                            solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t2.5 )
                                                              case Par_11111
                                                              solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                     ) ▶₀ #t2.5 )
                                                                case Par_11111
                                                                solve( State_111111( ~prog_1, a, b, kEnc,
                                                                                     kSign
                                                                       ) ▶₀ #t2.5 )
                                                                  case Par_11111
                                                                  solve( State_111112( ~prog_1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t2.5 )
                                                                    case Par_11111
                                                                    solve( State_11111111( ~lock8.1,
                                                                                           ~prog_1.2,
                                                                                           ~prog_11111111, a,
                                                                                           b, kEnc, kSign
                                                                           ) ▶₀ #t2.5 )
                                                                      case lock_a_b__1111111
                                                                      solve( State_111111( ~prog_1.1, a, b,
                                                                                           kEnc, kSign
                                                                             ) ▶₀ #t2.5 )
                                                                        case Par_11111
                                                                        solve( State_111112( ~prog_1.1, a, b,
                                                                                             kEnc, kSign
                                                                               ) ▶₀ #t2.6 )
                                                                          case Par_11111
                                                                          solve( State_11111211( ~lock6.2,
                                                                                                 ~prog_1.2,
                                                                                                 ~prog_11111211.1,
                                                                                                 a, b, kEnc,
                                                                                                 kSign
                                                                                 ) ▶₀ #t2.7 )
                                                                            case lock_b_a__1111121
                                                                            solve( State_111112111111( ~lock6.2,
                                                                                                       ~prog_1.2,
                                                                                                       ~prog_11111211.2,
                                                                                                       ~prog_1111121111.1,
                                                                                                       MH.2,
                                                                                                       SH.2,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign,
                                                                                                       m,
                                                                                                       pad.2,
                                                                                                       seq.2
                                                                                   ) ▶₀ #t2.8 )
                                                                              case unlock_b_a__11111211111
                                                                              solve( MID_Receiver( mid_11111211
                                                                                     ) ▶₂ #t2.17 )
                                                                                case MessageID_rule_
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t2.9 )
                                                                                  case Par_11111
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t2.9 )
                                                                                    case Par_11111
                                                                                    solve( State_111111( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t2.9 )
                                                                                      case Par_11111
                                                                                      solve( State_111112( ~prog_1,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                             ) ▶₀ #t2.9 )
                                                                                        case Par_11111
                                                                                        solve( State_111111( ~prog_1.1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t2.9 )
                                                                                          case Par_11111
                                                                                          solve( State_111112( ~prog_1.1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t2.9 )
                                                                                            case Par_11111
                                                                                            solve( State_111111( ~prog_1.1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t2.9 )
                                                                                              case Par_11111
                                                                                              solve( State_111112( ~prog_1.1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t2.9 )
                                                                                                case Par_11111
                                                                                                solve( State_11111211( ~lock6.2,
                                                                                                                       ~prog_1.2,
                                                                                                                       ~prog_11111211.1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t2.9 )
                                                                                                  case lock_b_a__1111121
                                                                                                  solve( State_111111( ~prog_1.1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t2.9 )
                                                                                                    case Par_11111
                                                                                                    solve( State_111112( ~prog_1.1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t2.9 )
                                                                                                      case Par_11111
                                                                                                      solve( !KU( senc(<
                                                                                                                        seq.1, 
                                                                                                                        ~n.4, 
                                                                                                                        pad.1, 
                                                                                                                        mac(<
                                                                                                                             MH.1, 
                                                                                                                             SH.1, 
                                                                                                                             seq.1, 
                                                                                                                             ~n.4, 
                                                                                                                             pad.1
                                                                                                                            >,
                                                                                                                            ~n.8)
                                                                                                                       >,
                                                                                                                       ~n.7)
                                                                                                             ) @ #vk.12 )
                                                                                                        case c_senc
                                                                                                        by solve( !KU( ~n.7
                                                                                                                  ) @ #vk.14 )
                                                                                                      next
                                                                                                        case out_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__111111111111
                                                                                                        by contradiction
                                                                                                           /*
                                                                                                           cyclic
                                                                                                           */
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma order:
  all-traces
  "∀ A B m m2 #i #j.
    (((Recv( A, B, m ) @ #i) ∧ (Recv( A, B, m2 ) @ #j)) ∧ (#i < #j)) ⇒
    (∃ #k #l.
      ((Sent( A, B, m ) @ #k) ∧ (Sent( A, B, m2 ) @ #l)) ∧ (#k < #l))"
/*
guarded formula characterizing all counter-examples:
"∃ A B m m2 #i #j.
  (Recv( A, B, m ) @ #i) ∧ (Recv( A, B, m2 ) @ #j)
 ∧
  (#i < #j) ∧
  (∀ #k #l. (Sent( A, B, m ) @ #k) ∧ (Sent( A, B, m2 ) @ #l) ⇒ ¬(#k < #l))"
*/
simplify
solve( State_1111121111( ~lock6, ~prog_1, ~prog_11111211,
                         ~prog_1111121111, MH, SH, A, B, kEnc, kSign, m, pad, seq
       ) ▶₀ #i )
  case event_Seq_Recva_b_seq_111112111
  solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.2 )
    case MessageID_rule_
    solve( State_1111121111( ~lock6.1, ~prog_1.1, ~prog_11111211.1,
                             ~prog_1111121111.1, MH.1, SH.1, ~n, ~n.1, kEnc, kSign, m2, pad.1, seq.1
           ) ▶₀ #j )
      case event_Seq_Recva_b_seq_111112111
      solve( (¬(#vr < #vr.14))  ∥ (∃ dif. (seq.1 = (dif+seq))) )
        case case_1
        solve( (¬(#vr.14 < #vr))  ∥ (∃ dif. (seq = (dif+seq.1))) )
          case case_1
          solve( ((#vr.2 < #vr.16) ∧
                  (∃ #t2.
                    (Unlock_6( $6, ~lock6, <~n.1, ~n> ) @ #t2)
                   ∧
                    (#vr.2 < #t2) ∧
                    (#t2 < #vr.16) ∧
                    (∀ #t0 pp. (Unlock( pp, ~lock6, <~n.1, ~n> ) @ #t0) ⇒ #t0 = #t2) ∧
                    (∀ pp lpp #t0.
                      (Lock( pp, lpp, <~n.1, ~n> ) @ #t0)
                     ⇒
                      ((#t0 < #vr.2) ∨ (#t0 = #vr.2) ∨ (#t2 < #t0))) ∧
                    (∀ pp lpp #t0.
                      (Unlock( pp, lpp, <~n.1, ~n> ) @ #t0)
                     ⇒
                      ((#t0 < #vr.2) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                 (#vr.16 < #vr.2)  ∥ (#vr.2 = #vr.16) )
            case case_1
            solve( (#vr = #vr.14)  ∥ (#vr.14 < #vr) )
              case case_1
              by contradiction /* cyclic */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_2
            solve( (#vr = #vr.14)  ∥ (#vr.14 < #vr) )
              case case_1
              by contradiction /* cyclic */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            by contradiction /* cyclic */
          qed
        next
          case case_2
          solve( ((#vr.2 < #vr.16) ∧
                  (∃ #t2.
                    (Unlock_6( $6, ~lock6, <~n.1, ~n> ) @ #t2)
                   ∧
                    (#vr.2 < #t2) ∧
                    (#t2 < #vr.16) ∧
                    (∀ #t0 pp. (Unlock( pp, ~lock6, <~n.1, ~n> ) @ #t0) ⇒ #t0 = #t2) ∧
                    (∀ pp lpp #t0.
                      (Lock( pp, lpp, <~n.1, ~n> ) @ #t0)
                     ⇒
                      ((#t0 < #vr.2) ∨ (#t0 = #vr.2) ∨ (#t2 < #t0))) ∧
                    (∀ pp lpp #t0.
                      (Unlock( pp, lpp, <~n.1, ~n> ) @ #t0)
                     ⇒
                      ((#t0 < #vr.2) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                 (#vr.16 < #vr.2)  ∥ (#vr.2 = #vr.16) )
            case case_1
            solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.6 )
              case MessageID_rule_
              solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2 )
                case Par_11111
                solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.1 )
                  case Par_11111
                  solve( State_11111211( ~lock6.2, ~prog_1.1, ~prog_11111211, a, b, kEnc,
                                         kSign
                         ) ▶₀ #t2.2 )
                    case lock_b_a__1111121
                    solve( State_111112111111( ~lock6.2, ~prog_1.1, ~prog_11111211.2,
                                               ~prog_1111121111, MH.2, SH.2, a, b, kEnc, kSign, m.1, pad.2,
                                               seq.1
                           ) ▶₀ #t2.2 )
                      case unlock_b_a__11111211111
                      by contradiction /* cyclic */
                    qed
                  qed
                qed
              qed
            qed
          next
            case case_2
            solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.6 )
              case MessageID_rule_
              solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2 )
                case Par_11111
                solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.1 )
                  case Par_11111
                  solve( State_11111211( ~lock6.2, ~prog_1.1, ~prog_11111211, a, b, kEnc,
                                         kSign
                         ) ▶₀ #t2.2 )
                    case lock_b_a__1111121
                    solve( State_111112111111( ~lock6.2, ~prog_1.1, ~prog_11111211.2,
                                               ~prog_1111121111, MH.2, SH.2, a, b, kEnc, kSign, m.1, pad.2,
                                               seq.1
                           ) ▶₀ #t2.2 )
                      case unlock_b_a__11111211111
                      solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.12 )
                        case MessageID_rule_
                        solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                          case Par_11111
                          solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                            case Par_11111
                            solve( State_11111211( ~lock6.2, ~prog_1.1, ~prog_11111211.1, a, b, kEnc,
                                                   kSign
                                   ) ▶₀ #t2.3 )
                              case lock_b_a__1111121
                              solve( State_111112111111( ~lock6.2, ~prog_1.1, ~prog_11111211.2,
                                                         ~prog_1111121111.1, MH.2, SH.2, a, b, kEnc, kSign,
                                                         m.1, pad.2, seq.1
                                     ) ▶₀ #t2.4 )
                                case unlock_b_a__11111211111
                                by contradiction /* cyclic */
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case case_2
        solve( (¬(#vr.14 < #vr))  ∥ (∃ dif.1. (seq = (dif+seq+dif.1))) )
          case case_1
          solve( ((#vr.2 < #vr.16) ∧
                  (∃ #t2.
                    (Unlock_6( $6, ~lock6, <~n.1, ~n> ) @ #t2)
                   ∧
                    (#vr.2 < #t2) ∧
                    (#t2 < #vr.16) ∧
                    (∀ #t0 pp. (Unlock( pp, ~lock6, <~n.1, ~n> ) @ #t0) ⇒ #t0 = #t2) ∧
                    (∀ pp lpp #t0.
                      (Lock( pp, lpp, <~n.1, ~n> ) @ #t0)
                     ⇒
                      ((#t0 < #vr.2) ∨ (#t0 = #vr.2) ∨ (#t2 < #t0))) ∧
                    (∀ pp lpp #t0.
                      (Unlock( pp, lpp, <~n.1, ~n> ) @ #t0)
                     ⇒
                      ((#t0 < #vr.2) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                 (#vr.16 < #vr.2)  ∥ (#vr.2 = #vr.16) )
            case case_1
            solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.6 )
              case MessageID_rule_
              solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2 )
                case Par_11111
                solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.1 )
                  case Par_11111
                  solve( State_11111211( ~lock6.2, ~prog_1.1, ~prog_11111211, a, b, kEnc,
                                         kSign
                         ) ▶₀ #t2.2 )
                    case lock_b_a__1111121
                    solve( State_111112111111( ~lock6.2, ~prog_1.1, ~prog_11111211.2,
                                               ~prog_1111121111, MH.2, SH.2, a, b, kEnc, kSign, m.1, pad.2,
                                               seq.1
                           ) ▶₀ #t2.2 )
                      case unlock_b_a__11111211111
                      solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.12 )
                        case MessageID_rule_
                        solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                          case Par_11111
                          solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                            case Par_11111
                            solve( State_11111211( ~lock6.2, ~prog_1.1, ~prog_11111211.1, a, b, kEnc,
                                                   kSign
                                   ) ▶₀ #t2.3 )
                              case lock_b_a__1111121
                              solve( State_111112111111( ~lock6.2, ~prog_1.1, ~prog_11111211.2,
                                                         ~prog_1111121111.1, MH.2, SH.2, a, b, kEnc, kSign,
                                                         m.1, pad.2, seq.1
                                     ) ▶₀ #t2.4 )
                                case unlock_b_a__11111211111
                                solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.15 )
                                  case MessageID_rule_
                                  solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.6 )
                                    case Par_11111
                                    solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.6 )
                                      case Par_11111
                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.6 )
                                        case Par_11111
                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.6 )
                                          case Par_11111
                                          solve( State_11111211( ~lock6.2, ~prog_1.1, ~prog_11111211, a, b,
                                                                 kEnc, kSign
                                                 ) ▶₀ #t2.6 )
                                            case lock_b_a__1111121
                                            solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.6 )
                                              case Par_11111
                                              solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.6 )
                                                case Par_11111
                                                solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.6 )
                                                  case Par_11111
                                                  solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.6 )
                                                    case Par_11111
                                                    solve( State_11111211( ~lock6.2, ~prog_1.1,
                                                                           ~prog_11111211.1, a, b, kEnc, kSign
                                                           ) ▶₀ #t2.6 )
                                                      case lock_b_a__1111121
                                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t2.6 )
                                                        case Par_11111
                                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                               ) ▶₀ #t2.6 )
                                                          case Par_11111
                                                          solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                 ) ▶₀ #t2.6 )
                                                            case Par_11111
                                                            solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t2.6 )
                                                              case Par_11111
                                                              solve( !KU( senc(<seq, m, pad, 
                                                                                mac(<MH, SH, seq, m, pad>,
                                                                                    ~n.3)
                                                                               >,
                                                                               ~n.2)
                                                                     ) @ #vk.4 )
                                                                case c_senc
                                                                solve( !KU( senc(<(dif+seq), m2, pad.1, 
                                                                                  mac(<MH.1, SH.1, (dif+seq), 
                                                                                       m2, pad.1>,
                                                                                      ~n.3)
                                                                                 >,
                                                                                 ~n.2)
                                                                       ) @ #vk.9 )
                                                                  case c_senc
                                                                  by solve( !KU( ~n.2 ) @ #vk.11 )
                                                                next
                                                                  case out_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__111111111111
                                                                  solve( MID_Receiver( ~x.2 ) ▶₂ #j.1 )
                                                                    case MessageID_rule_
                                                                    solve( State_11111211( ~lock6.2,
                                                                                           ~prog_1.1,
                                                                                           ~prog_11111211.2,
                                                                                           a, b, ~n.2, ~n.3
                                                                           ) ▶₀ #j.1 )
                                                                      case lock_b_a__1111121
                                                                      solve( ((#vr.2 < #vr.27) ∧
                                                                              (∃ #t2.
                                                                                (Unlock_6( $6, ~lock6,
                                                                                           <~n.1, ~n>
                                                                                 ) @ #t2)
                                                                               ∧
                                                                                (#vr.2 < #t2) ∧
                                                                                (#t2 < #vr.27) ∧
                                                                                (∀ #t0 pp.
                                                                                  (Unlock( pp, ~lock6,
                                                                                           <~n.1, ~n>
                                                                                   ) @ #t0)
                                                                                 ⇒
                                                                                  #t0 = #t2) ∧
                                                                                (∀ pp lpp #t0.
                                                                                  (Lock( pp, lpp, <~n.1, ~n>
                                                                                   ) @ #t0)
                                                                                 ⇒
                                                                                  ((#t0 < #vr.2) ∨
                                                                                   (#t0 = #vr.2) ∨
                                                                                   (#t2 < #t0))) ∧
                                                                                (∀ pp lpp #t0.
                                                                                  (Unlock( pp, lpp, <~n.1, ~n>
                                                                                   ) @ #t0)
                                                                                 ⇒
                                                                                  ((#t0 < #vr.2) ∨
                                                                                   (#t2 < #t0) ∨
                                                                                   (#t2 = #t0)))))  ∥
                                                                             (#vr.27 < #vr.2)  ∥
                                                                             (#vr.2 = #vr.27) )
                                                                        case case_1
                                                                        solve( ((#vr.13 < #vr.27) ∧
                                                                                (∃ #t2.
                                                                                  (Unlock_6( $6.1, ~lock6.1,
                                                                                             <~n.1, ~n>
                                                                                   ) @ #t2)
                                                                                 ∧
                                                                                  (#vr.13 < #t2) ∧
                                                                                  (#t2 < #vr.27) ∧
                                                                                  (∀ #t0 pp.
                                                                                    (Unlock( pp, ~lock6.1,
                                                                                             <~n.1, ~n>
                                                                                     ) @ #t0)
                                                                                   ⇒
                                                                                    #t0 = #t2) ∧
                                                                                  (∀ pp lpp #t0.
                                                                                    (Lock( pp, lpp, <~n.1, ~n>
                                                                                     ) @ #t0)
                                                                                   ⇒
                                                                                    ((#t0 < #vr.13) ∨
                                                                                     (#t0 = #vr.13) ∨
                                                                                     (#t2 < #t0))) ∧
                                                                                  (∀ pp lpp #t0.
                                                                                    (Unlock( pp, lpp,
                                                                                             <~n.1, ~n>
                                                                                     ) @ #t0)
                                                                                   ⇒
                                                                                    ((#t0 < #vr.13) ∨
                                                                                     (#t2 < #t0) ∨
                                                                                     (#t2 = #t0)))))  ∥
                                                                               (#vr.27 < #vr.13)  ∥
                                                                               (#vr.13 = #vr.27) )
                                                                          case case_1
                                                                          solve( MID_Receiver( mid_11111211
                                                                                 ) ▶₂ #t2.12 )
                                                                            case MessageID_rule_
                                                                            solve( State_111111( ~prog_1, a,
                                                                                                 b, kEnc,
                                                                                                 kSign
                                                                                   ) ▶₀ #t2.6 )
                                                                              case Par_11111
                                                                              solve( State_111112( ~prog_1, a,
                                                                                                   b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t2.6 )
                                                                                case Par_11111
                                                                                solve( State_11111111( ~lock8,
                                                                                                       ~prog_1.1,
                                                                                                       ~prog_11111111,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                       ) ▶₀ #t2.6 )
                                                                                  case lock_a_b__1111111
                                                                                  solve( State_11111111111111( ~lock8.1,
                                                                                                               ~prog_1.1,
                                                                                                               ~prog_11111111.1,
                                                                                                               ~prog_1111111111,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign,
                                                                                                               m.1,
                                                                                                               seq.1
                                                                                         ) ▶₀ #t2.7 )
                                                                                    case unlock_a_b__1111111111111
                                                                                    solve( MID_Receiver( ~x
                                                                                           ) ▶₂ #j.2 )
                                                                                      case MessageID_rule_
                                                                                      solve( State_111111( ~prog_1,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                             ) ▶₀ #t2.8 )
                                                                                        case Par_11111
                                                                                        solve( State_111112( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t2.8 )
                                                                                          case Par_11111
                                                                                          solve( State_11111211( ~lock6.3,
                                                                                                                 ~prog_1.1,
                                                                                                                 ~prog_11111211.2,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                 ) ▶₀ #t2.8 )
                                                                                            case lock_b_a__1111121
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t2.8 )
                                                                                              case Par_11111
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t2.8 )
                                                                                                case Par_11111
                                                                                                solve( State_111111( ~prog_1,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                       ) ▶₀ #t2.8 )
                                                                                                  case Par_11111
                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t2.8 )
                                                                                                    case Par_11111
                                                                                                    solve( State_11111111( ~lock8.1,
                                                                                                                           ~prog_1.1,
                                                                                                                           ~prog_11111111,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                           ) ▶₀ #t2.8 )
                                                                                                      case lock_a_b__1111111
                                                                                                      solve( State_111111( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t2.8 )
                                                                                                        case Par_11111
                                                                                                        solve( State_111112( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t2.8 )
                                                                                                          case Par_11111
                                                                                                          solve( State_111111( ~prog_1,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                                 ) ▶₀ #t2.8 )
                                                                                                            case Par_11111
                                                                                                            solve( State_111112( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t2.8 )
                                                                                                              case Par_11111
                                                                                                              by solve( !KU( ~n.2
                                                                                                                        ) @ #vk.11 )
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        next
                                                                          case case_2
                                                                          solve( MID_Receiver( mid_11111211
                                                                                 ) ▶₂ #t2.12 )
                                                                            case MessageID_rule_
                                                                            solve( State_111111( ~prog_1, a,
                                                                                                 b, kEnc,
                                                                                                 kSign
                                                                                   ) ▶₀ #t2.6 )
                                                                              case Par_11111
                                                                              solve( State_111112( ~prog_1, a,
                                                                                                   b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t2.6 )
                                                                                case Par_11111
                                                                                solve( State_11111111( ~lock8,
                                                                                                       ~prog_1.1,
                                                                                                       ~prog_11111111,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                       ) ▶₀ #t2.6 )
                                                                                  case lock_a_b__1111111
                                                                                  solve( State_11111111111111( ~lock8.1,
                                                                                                               ~prog_1.1,
                                                                                                               ~prog_11111111.1,
                                                                                                               ~prog_1111111111,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign,
                                                                                                               m.1,
                                                                                                               seq.1
                                                                                         ) ▶₀ #t2.7 )
                                                                                    case unlock_a_b__1111111111111
                                                                                    solve( MID_Receiver( ~x
                                                                                           ) ▶₂ #j.2 )
                                                                                      case MessageID_rule_
                                                                                      solve( State_111111( ~prog_1,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                             ) ▶₀ #t2.8 )
                                                                                        case Par_11111
                                                                                        solve( State_111112( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t2.8 )
                                                                                          case Par_11111
                                                                                          solve( State_11111211( ~lock6.3,
                                                                                                                 ~prog_1.1,
                                                                                                                 ~prog_11111211.2,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                 ) ▶₀ #t2.8 )
                                                                                            case lock_b_a__1111121
                                                                                            by solve( State_11111211111( ~lock6.2,
                                                                                                                         ~prog_1.1,
                                                                                                                         ~prog_11111211.3,
                                                                                                                         ~prog_1111121111.2,
                                                                                                                         MH.2,
                                                                                                                         SH.2,
                                                                                                                         ~n,
                                                                                                                         ~n.1,
                                                                                                                         kEnc,
                                                                                                                         kSign,
                                                                                                                         m.1,
                                                                                                                         pad.2,
                                                                                                                         seq.1
                                                                                                      ) ▶₀ #t2.8 )
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        next
                                                                          case case_3
                                                                          solve( MID_Receiver( mid_11111211
                                                                                 ) ▶₂ #t2.11 )
                                                                            case MessageID_rule_
                                                                            solve( State_111111( ~prog_1, a,
                                                                                                 b, kEnc,
                                                                                                 kSign
                                                                                   ) ▶₀ #t2.5 )
                                                                              case Par_11111
                                                                              solve( State_111112( ~prog_1, a,
                                                                                                   b, kEnc,
                                                                                                   kSign
                                                                                     ) ▶₀ #t2.5 )
                                                                                case Par_11111
                                                                                solve( State_11111111( ~lock8,
                                                                                                       ~prog_1.1,
                                                                                                       ~prog_11111111,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                       ) ▶₀ #t2.5 )
                                                                                  case lock_a_b__1111111
                                                                                  solve( State_11111111111111( ~lock8.1,
                                                                                                               ~prog_1.1,
                                                                                                               ~prog_11111111.1,
                                                                                                               ~prog_1111111111,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign,
                                                                                                               m.1,
                                                                                                               seq.1
                                                                                         ) ▶₀ #t2.6 )
                                                                                    case unlock_a_b__1111111111111
                                                                                    solve( MID_Receiver( ~x
                                                                                           ) ▶₂ #j.2 )
                                                                                      case MessageID_rule_
                                                                                      solve( State_111111( ~prog_1,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                             ) ▶₀ #t2.7 )
                                                                                        case Par_11111
                                                                                        solve( State_111112( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t2.7 )
                                                                                          case Par_11111
                                                                                          solve( State_11111211( ~lock6.2,
                                                                                                                 ~prog_1.1,
                                                                                                                 ~prog_11111211.1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                 ) ▶₀ #t2.7 )
                                                                                            case lock_b_a__1111121
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t2.7 )
                                                                                              case Par_11111
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t2.7 )
                                                                                                case Par_11111
                                                                                                solve( State_111111( ~prog_1,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                       ) ▶₀ #t2.7 )
                                                                                                  case Par_11111
                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t2.7 )
                                                                                                    case Par_11111
                                                                                                    solve( State_11111111( ~lock8.1,
                                                                                                                           ~prog_1.1,
                                                                                                                           ~prog_11111111,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                           ) ▶₀ #t2.7 )
                                                                                                      case lock_a_b__1111111
                                                                                                      solve( State_111111( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t2.7 )
                                                                                                        case Par_11111
                                                                                                        solve( State_111112( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t2.7 )
                                                                                                          case Par_11111
                                                                                                          solve( State_111111( ~prog_1,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                                 ) ▶₀ #t2.7 )
                                                                                                            case Par_11111
                                                                                                            solve( State_111112( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t2.7 )
                                                                                                              case Par_11111
                                                                                                              by solve( !KU( ~n.2
                                                                                                                        ) @ #vk.11 )
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      next
                                                                        case case_2
                                                                        solve( MID_Receiver( mid_11111211
                                                                               ) ▶₂ #t2.12 )
                                                                          case MessageID_rule_
                                                                          solve( State_111111( ~prog_1, a, b,
                                                                                               kEnc, kSign
                                                                                 ) ▶₀ #t2.6 )
                                                                            case Par_11111
                                                                            solve( State_111112( ~prog_1, a,
                                                                                                 b, kEnc,
                                                                                                 kSign
                                                                                   ) ▶₀ #t2.6 )
                                                                              case Par_11111
                                                                              solve( State_11111111( ~lock8,
                                                                                                     ~prog_1.1,
                                                                                                     ~prog_11111111,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                     ) ▶₀ #t2.6 )
                                                                                case lock_a_b__1111111
                                                                                solve( State_11111111111111( ~lock8.1,
                                                                                                             ~prog_1.1,
                                                                                                             ~prog_11111111.1,
                                                                                                             ~prog_1111111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign,
                                                                                                             m.1,
                                                                                                             seq.1
                                                                                       ) ▶₀ #t2.7 )
                                                                                  case unlock_a_b__1111111111111
                                                                                  solve( MID_Receiver( ~x
                                                                                         ) ▶₂ #j.2 )
                                                                                    case MessageID_rule_
                                                                                    solve( State_111111( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t2.8 )
                                                                                      case Par_11111
                                                                                      solve( State_111112( ~prog_1,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                             ) ▶₀ #t2.8 )
                                                                                        case Par_11111
                                                                                        solve( State_11111211( ~lock6.3,
                                                                                                               ~prog_1.1,
                                                                                                               ~prog_11111211.2,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                               ) ▶₀ #t2.8 )
                                                                                          case lock_b_a__1111121
                                                                                          by solve( State_11111211111( ~lock6.2,
                                                                                                                       ~prog_1.1,
                                                                                                                       ~prog_11111211.3,
                                                                                                                       ~prog_1111121111.2,
                                                                                                                       MH.2,
                                                                                                                       SH.2,
                                                                                                                       ~n,
                                                                                                                       ~n.1,
                                                                                                                       kEnc,
                                                                                                                       kSign,
                                                                                                                       m.1,
                                                                                                                       pad.2,
                                                                                                                       seq.1
                                                                                                    ) ▶₀ #t2.8 )
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              next
                                                                case out_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__111111111111
                                                                solve( MID_Receiver( ~x.2 ) ▶₂ #j.1 )
                                                                  case MessageID_rule_
                                                                  solve( State_11111211( ~lock6.2, ~prog_1.1,
                                                                                         ~prog_11111211.2, a,
                                                                                         b, ~n.2, ~n.3
                                                                         ) ▶₀ #j.1 )
                                                                    case lock_b_a__1111121
                                                                    solve( ((#vr.2 < #vr.27) ∧
                                                                            (∃ #t2.
                                                                              (Unlock_6( $6, ~lock6,
                                                                                         <~n.1, ~n>
                                                                               ) @ #t2)
                                                                             ∧
                                                                              (#vr.2 < #t2) ∧
                                                                              (#t2 < #vr.27) ∧
                                                                              (∀ #t0 pp.
                                                                                (Unlock( pp, ~lock6,
                                                                                         <~n.1, ~n>
                                                                                 ) @ #t0)
                                                                               ⇒
                                                                                #t0 = #t2) ∧
                                                                              (∀ pp lpp #t0.
                                                                                (Lock( pp, lpp, <~n.1, ~n>
                                                                                 ) @ #t0)
                                                                               ⇒
                                                                                ((#t0 < #vr.2) ∨
                                                                                 (#t0 = #vr.2) ∨
                                                                                 (#t2 < #t0))) ∧
                                                                              (∀ pp lpp #t0.
                                                                                (Unlock( pp, lpp, <~n.1, ~n>
                                                                                 ) @ #t0)
                                                                               ⇒
                                                                                ((#t0 < #vr.2) ∨
                                                                                 (#t2 < #t0) ∨
                                                                                 (#t2 = #t0)))))  ∥
                                                                           (#vr.27 < #vr.2)  ∥
                                                                           (#vr.2 = #vr.27) )
                                                                      case case_1
                                                                      solve( ((#vr.13 < #vr.27) ∧
                                                                              (∃ #t2.
                                                                                (Unlock_6( $6.1, ~lock6.1,
                                                                                           <~n.1, ~n>
                                                                                 ) @ #t2)
                                                                               ∧
                                                                                (#vr.13 < #t2) ∧
                                                                                (#t2 < #vr.27) ∧
                                                                                (∀ #t0 pp.
                                                                                  (Unlock( pp, ~lock6.1,
                                                                                           <~n.1, ~n>
                                                                                   ) @ #t0)
                                                                                 ⇒
                                                                                  #t0 = #t2) ∧
                                                                                (∀ pp lpp #t0.
                                                                                  (Lock( pp, lpp, <~n.1, ~n>
                                                                                   ) @ #t0)
                                                                                 ⇒
                                                                                  ((#t0 < #vr.13) ∨
                                                                                   (#t0 = #vr.13) ∨
                                                                                   (#t2 < #t0))) ∧
                                                                                (∀ pp lpp #t0.
                                                                                  (Unlock( pp, lpp, <~n.1, ~n>
                                                                                   ) @ #t0)
                                                                                 ⇒
                                                                                  ((#t0 < #vr.13) ∨
                                                                                   (#t2 < #t0) ∨
                                                                                   (#t2 = #t0)))))  ∥
                                                                             (#vr.27 < #vr.13)  ∥
                                                                             (#vr.13 = #vr.27) )
                                                                        case case_1
                                                                        solve( MID_Receiver( mid_11111211
                                                                               ) ▶₂ #t2.12 )
                                                                          case MessageID_rule_
                                                                          solve( State_111111( ~prog_1, a, b,
                                                                                               kEnc, kSign
                                                                                 ) ▶₀ #t2.6 )
                                                                            case Par_11111
                                                                            solve( State_111112( ~prog_1, a,
                                                                                                 b, kEnc,
                                                                                                 kSign
                                                                                   ) ▶₀ #t2.6 )
                                                                              case Par_11111
                                                                              solve( State_11111111( ~lock8,
                                                                                                     ~prog_1.1,
                                                                                                     ~prog_11111111,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                     ) ▶₀ #t2.6 )
                                                                                case lock_a_b__1111111
                                                                                solve( State_11111111111111( ~lock8.1,
                                                                                                             ~prog_1.1,
                                                                                                             ~prog_11111111.1,
                                                                                                             ~prog_1111111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign,
                                                                                                             m,
                                                                                                             seq.1
                                                                                       ) ▶₀ #t2.7 )
                                                                                  case unlock_a_b__1111111111111
                                                                                  solve( MID_Receiver( ~x
                                                                                         ) ▶₂ #j.2 )
                                                                                    case MessageID_rule_
                                                                                    solve( State_111111( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t2.8 )
                                                                                      case Par_11111
                                                                                      solve( State_111112( ~prog_1,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                             ) ▶₀ #t2.8 )
                                                                                        case Par_11111
                                                                                        solve( State_11111211( ~lock6.3,
                                                                                                               ~prog_1.1,
                                                                                                               ~prog_11111211.2,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                               ) ▶₀ #t2.8 )
                                                                                          case lock_b_a__1111121
                                                                                          solve( State_111111( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t2.8 )
                                                                                            case Par_11111
                                                                                            solve( State_111112( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t2.8 )
                                                                                              case Par_11111
                                                                                              solve( State_111111( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t2.8 )
                                                                                                case Par_11111
                                                                                                solve( State_111112( ~prog_1,
                                                                                                                     a,
                                                                                                                     b,
                                                                                                                     kEnc,
                                                                                                                     kSign
                                                                                                       ) ▶₀ #t2.8 )
                                                                                                  case Par_11111
                                                                                                  solve( State_11111111( ~lock8.1,
                                                                                                                         ~prog_1.1,
                                                                                                                         ~prog_11111111,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                         ) ▶₀ #t2.8 )
                                                                                                    case lock_a_b__1111111
                                                                                                    solve( State_111111( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t2.8 )
                                                                                                      case Par_11111
                                                                                                      solve( State_111112( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t2.8 )
                                                                                                        case Par_11111
                                                                                                        solve( State_111111( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t2.8 )
                                                                                                          case Par_11111
                                                                                                          solve( State_111112( ~prog_1,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                                 ) ▶₀ #t2.8 )
                                                                                                            case Par_11111
                                                                                                            solve( !KU( senc(<
                                                                                                                              (
                                                                                                                               dif+
                                                                                                                               seq
                                                                                                                              ), 
                                                                                                                              m2, 
                                                                                                                              pad.1, 
                                                                                                                              mac(<
                                                                                                                                   MH.1, 
                                                                                                                                   SH.1, 
                                                                                                                                   (
                                                                                                                                    dif+
                                                                                                                                    seq
                                                                                                                                   ), 
                                                                                                                                   m2, 
                                                                                                                                   pad.1
                                                                                                                                  >,
                                                                                                                                  ~n.3)
                                                                                                                             >,
                                                                                                                             ~n.2)
                                                                                                                   ) @ #vk.9 )
                                                                                                              case c_senc
                                                                                                              by solve( !KU( ~n.2
                                                                                                                        ) @ #vk.15 )
                                                                                                            next
                                                                                                              case out_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__111111111111
                                                                                                              solve( (¬(#vr.23 < #vr.35))  ∥
                                                                                                                     (∃ dif.1.
                                                                                                                       ((
                                                                                                                         dif+
                                                                                                                         seq
                                                                                                                        ) =
                                                                                                                        (
                                                                                                                         seq+
                                                                                                                         dif.1
                                                                                                                        ))) )
                                                                                                                case case_2
                                                                                                                solve( (¬(#vr.35 < #vr.23))  ∥
                                                                                                                       (∃ dif.1.
                                                                                                                         (seq =
                                                                                                                          (
                                                                                                                           dif+
                                                                                                                           seq+
                                                                                                                           dif.1
                                                                                                                          ))) )
                                                                                                                  case case_1
                                                                                                                  solve( ((#vr.24 < #vr.37) ∧
                                                                                                                          (∃ #t2.
                                                                                                                            (Unlock_8( $8,
                                                                                                                                       ~lock8,
                                                                                                                                       <
                                                                                                                                        ~n, 
                                                                                                                                        ~n.1
                                                                                                                                       >
                                                                                                                             ) @ #t2)
                                                                                                                           ∧
                                                                                                                            (#vr.24 < #t2) ∧
                                                                                                                            (#t2 < #vr.37) ∧
                                                                                                                            (∀ #t0
                                                                                                                               pp.
                                                                                                                              (Unlock( pp,
                                                                                                                                       ~lock8,
                                                                                                                                       <
                                                                                                                                        ~n, 
                                                                                                                                        ~n.1
                                                                                                                                       >
                                                                                                                               ) @ #t0)
                                                                                                                             ⇒
                                                                                                                              #t0 =
                                                                                                                              #t2) ∧
                                                                                                                            (∀ pp
                                                                                                                               lpp
                                                                                                                               #t0.
                                                                                                                              (Lock( pp,
                                                                                                                                     lpp,
                                                                                                                                     <
                                                                                                                                      ~n, 
                                                                                                                                      ~n.1
                                                                                                                                     >
                                                                                                                               ) @ #t0)
                                                                                                                             ⇒
                                                                                                                              ((#t0 < #vr.24) ∨
                                                                                                                               (#t0 =
                                                                                                                                #vr.24) ∨
                                                                                                                               (#t2 < #t0))) ∧
                                                                                                                            (∀ pp
                                                                                                                               lpp
                                                                                                                               #t0.
                                                                                                                              (Unlock( pp,
                                                                                                                                       lpp,
                                                                                                                                       <
                                                                                                                                        ~n, 
                                                                                                                                        ~n.1
                                                                                                                                       >
                                                                                                                               ) @ #t0)
                                                                                                                             ⇒
                                                                                                                              ((#t0 < #vr.24) ∨
                                                                                                                               (#t2 < #t0) ∨
                                                                                                                               (#t2 =
                                                                                                                                #t0)))))  ∥
                                                                                                                         (#vr.37 < #vr.24)  ∥
                                                                                                                         (#vr.24 =
                                                                                                                          #vr.37) )
                                                                                                                    case case_1
                                                                                                                    by contradiction
                                                                                                                       /*
                                                                                                                       cyclic
                                                                                                                       */
                                                                                                                  next
                                                                                                                    case case_2
                                                                                                                    solve( MID_Receiver( ~x.2
                                                                                                                           ) ▶₂ #j.2 )
                                                                                                                      case MessageID_rule_
                                                                                                                      solve( State_11111211( ~lock6.3,
                                                                                                                                             ~prog_1.1,
                                                                                                                                             ~prog_11111211.3,
                                                                                                                                             a,
                                                                                                                                             b,
                                                                                                                                             ~n.2,
                                                                                                                                             ~n.3
                                                                                                                             ) ▶₀ #j.2 )
                                                                                                                        case lock_b_a__1111121
                                                                                                                        solve( ((#vr.2 < #vr.39) ∧
                                                                                                                                (∃ #t2.
                                                                                                                                  (Unlock_6( $6,
                                                                                                                                             ~lock6,
                                                                                                                                             <
                                                                                                                                              ~n.1, 
                                                                                                                                              ~n
                                                                                                                                             >
                                                                                                                                   ) @ #t2)
                                                                                                                                 ∧
                                                                                                                                  (#vr.2 < #t2) ∧
                                                                                                                                  (#t2 < #vr.39) ∧
                                                                                                                                  (∀ #t0
                                                                                                                                     pp.
                                                                                                                                    (Unlock( pp,
                                                                                                                                             ~lock6,
                                                                                                                                             <
                                                                                                                                              ~n.1, 
                                                                                                                                              ~n
                                                                                                                                             >
                                                                                                                                     ) @ #t0)
                                                                                                                                   ⇒
                                                                                                                                    #t0 =
                                                                                                                                    #t2) ∧
                                                                                                                                  (∀ pp
                                                                                                                                     lpp
                                                                                                                                     #t0.
                                                                                                                                    (Lock( pp,
                                                                                                                                           lpp,
                                                                                                                                           <
                                                                                                                                            ~n.1, 
                                                                                                                                            ~n
                                                                                                                                           >
                                                                                                                                     ) @ #t0)
                                                                                                                                   ⇒
                                                                                                                                    ((#t0 < #vr.2) ∨
                                                                                                                                     (#t0 =
                                                                                                                                      #vr.2) ∨
                                                                                                                                     (#t2 < #t0))) ∧
                                                                                                                                  (∀ pp
                                                                                                                                     lpp
                                                                                                                                     #t0.
                                                                                                                                    (Unlock( pp,
                                                                                                                                             lpp,
                                                                                                                                             <
                                                                                                                                              ~n.1, 
                                                                                                                                              ~n
                                                                                                                                             >
                                                                                                                                     ) @ #t0)
                                                                                                                                   ⇒
                                                                                                                                    ((#t0 < #vr.2) ∨
                                                                                                                                     (#t2 < #t0) ∨
                                                                                                                                     (#t2 =
                                                                                                                                      #t0)))))  ∥
                                                                                                                               (#vr.39 < #vr.2)  ∥
                                                                                                                               (#vr.2 =
                                                                                                                                #vr.39) )
                                                                                                                          case case_1
                                                                                                                          solve( ((#vr.13 < #vr.39) ∧
                                                                                                                                  (∃ #t2.
                                                                                                                                    (Unlock_6( $6.1,
                                                                                                                                               ~lock6.1,
                                                                                                                                               <
                                                                                                                                                ~n.1, 
                                                                                                                                                ~n
                                                                                                                                               >
                                                                                                                                     ) @ #t2)
                                                                                                                                   ∧
                                                                                                                                    (#vr.13 < #t2) ∧
                                                                                                                                    (#t2 < #vr.39) ∧
                                                                                                                                    (∀ #t0
                                                                                                                                       pp.
                                                                                                                                      (Unlock( pp,
                                                                                                                                               ~lock6.1,
                                                                                                                                               <
                                                                                                                                                ~n.1, 
                                                                                                                                                ~n
                                                                                                                                               >
                                                                                                                                       ) @ #t0)
                                                                                                                                     ⇒
                                                                                                                                      #t0 =
                                                                                                                                      #t2) ∧
                                                                                                                                    (∀ pp
                                                                                                                                       lpp
                                                                                                                                       #t0.
                                                                                                                                      (Lock( pp,
                                                                                                                                             lpp,
                                                                                                                                             <
                                                                                                                                              ~n.1, 
                                                                                                                                              ~n
                                                                                                                                             >
                                                                                                                                       ) @ #t0)
                                                                                                                                     ⇒
                                                                                                                                      ((#t0 < #vr.13) ∨
                                                                                                                                       (#t0 =
                                                                                                                                        #vr.13) ∨
                                                                                                                                       (#t2 < #t0))) ∧
                                                                                                                                    (∀ pp
                                                                                                                                       lpp
                                                                                                                                       #t0.
                                                                                                                                      (Unlock( pp,
                                                                                                                                               lpp,
                                                                                                                                               <
                                                                                                                                                ~n.1, 
                                                                                                                                                ~n
                                                                                                                                               >
                                                                                                                                       ) @ #t0)
                                                                                                                                     ⇒
                                                                                                                                      ((#t0 < #vr.13) ∨
                                                                                                                                       (#t2 < #t0) ∨
                                                                                                                                       (#t2 =
                                                                                                                                        #t0)))))  ∥
                                                                                                                                 (#vr.39 < #vr.13)  ∥
                                                                                                                                 (#vr.13 =
                                                                                                                                  #vr.39) )
                                                                                                                            case case_1
                                                                                                                            solve( ((#vr.26 < #vr.39) ∧
                                                                                                                                    (∃ #t2.
                                                                                                                                      (Unlock_6( $6.2,
                                                                                                                                                 ~lock6.2,
                                                                                                                                                 <
                                                                                                                                                  ~n.1, 
                                                                                                                                                  ~n
                                                                                                                                                 >
                                                                                                                                       ) @ #t2)
                                                                                                                                     ∧
                                                                                                                                      (#vr.26 < #t2) ∧
                                                                                                                                      (#t2 < #vr.39) ∧
                                                                                                                                      (∀ #t0
                                                                                                                                         pp.
                                                                                                                                        (Unlock( pp,
                                                                                                                                                 ~lock6.2,
                                                                                                                                                 <
                                                                                                                                                  ~n.1, 
                                                                                                                                                  ~n
                                                                                                                                                 >
                                                                                                                                         ) @ #t0)
                                                                                                                                       ⇒
                                                                                                                                        #t0 =
                                                                                                                                        #t2) ∧
                                                                                                                                      (∀ pp
                                                                                                                                         lpp
                                                                                                                                         #t0.
                                                                                                                                        (Lock( pp,
                                                                                                                                               lpp,
                                                                                                                                               <
                                                                                                                                                ~n.1, 
                                                                                                                                                ~n
                                                                                                                                               >
                                                                                                                                         ) @ #t0)
                                                                                                                                       ⇒
                                                                                                                                        ((#t0 < #vr.26) ∨
                                                                                                                                         (#t0 =
                                                                                                                                          #vr.26) ∨
                                                                                                                                         (#t2 < #t0))) ∧
                                                                                                                                      (∀ pp
                                                                                                                                         lpp
                                                                                                                                         #t0.
                                                                                                                                        (Unlock( pp,
                                                                                                                                                 lpp,
                                                                                                                                                 <
                                                                                                                                                  ~n.1, 
                                                                                                                                                  ~n
                                                                                                                                                 >
                                                                                                                                         ) @ #t0)
                                                                                                                                       ⇒
                                                                                                                                        ((#t0 < #vr.26) ∨
                                                                                                                                         (#t2 < #t0) ∨
                                                                                                                                         (#t2 =
                                                                                                                                          #t0)))))  ∥
                                                                                                                                   (#vr.39 < #vr.26)  ∥
                                                                                                                                   (#vr.26 =
                                                                                                                                    #vr.39) )
                                                                                                                              case case_1
                                                                                                                              solve( MID_Receiver( mid_11111211
                                                                                                                                     ) ▶₂ #t2.15 )
                                                                                                                                case MessageID_rule_
                                                                                                                                solve( State_111111( ~prog_1,
                                                                                                                                                     a,
                                                                                                                                                     b,
                                                                                                                                                     kEnc,
                                                                                                                                                     kSign
                                                                                                                                       ) ▶₀ #t2.8 )
                                                                                                                                  case Par_11111
                                                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                                                       a,
                                                                                                                                                       b,
                                                                                                                                                       kEnc,
                                                                                                                                                       kSign
                                                                                                                                         ) ▶₀ #t2.8 )
                                                                                                                                    case Par_11111
                                                                                                                                    solve( State_11111111( ~lock8.1,
                                                                                                                                                           ~prog_1.1,
                                                                                                                                                           ~prog_11111111.1,
                                                                                                                                                           a,
                                                                                                                                                           b,
                                                                                                                                                           kEnc,
                                                                                                                                                           kSign
                                                                                                                                           ) ▶₀ #t2.8 )
                                                                                                                                      case lock_a_b__1111111
                                                                                                                                      solve( State_11111111111111( ~lock8.2,
                                                                                                                                                                   ~prog_1.1,
                                                                                                                                                                   ~prog_11111111.2,
                                                                                                                                                                   ~prog_1111111111.1,
                                                                                                                                                                   a,
                                                                                                                                                                   b,
                                                                                                                                                                   kEnc,
                                                                                                                                                                   kSign,
                                                                                                                                                                   m,
                                                                                                                                                                   seq.1
                                                                                                                                             ) ▶₀ #t2.9 )
                                                                                                                                        case unlock_a_b__1111111111111
                                                                                                                                        by contradiction
                                                                                                                                           /*
                                                                                                                                           cyclic
                                                                                                                                           */
                                                                                                                                      qed
                                                                                                                                    qed
                                                                                                                                  qed
                                                                                                                                qed
                                                                                                                              qed
                                                                                                                            next
                                                                                                                              case case_2
                                                                                                                              solve( MID_Receiver( mid_11111211
                                                                                                                                     ) ▶₂ #t2.15 )
                                                                                                                                case MessageID_rule_
                                                                                                                                solve( State_111111( ~prog_1,
                                                                                                                                                     a,
                                                                                                                                                     b,
                                                                                                                                                     kEnc,
                                                                                                                                                     kSign
                                                                                                                                       ) ▶₀ #t2.8 )
                                                                                                                                  case Par_11111
                                                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                                                       a,
                                                                                                                                                       b,
                                                                                                                                                       kEnc,
                                                                                                                                                       kSign
                                                                                                                                         ) ▶₀ #t2.8 )
                                                                                                                                    case Par_11111
                                                                                                                                    solve( State_11111111( ~lock8.1,
                                                                                                                                                           ~prog_1.1,
                                                                                                                                                           ~prog_11111111.1,
                                                                                                                                                           a,
                                                                                                                                                           b,
                                                                                                                                                           kEnc,
                                                                                                                                                           kSign
                                                                                                                                           ) ▶₀ #t2.8 )
                                                                                                                                      case lock_a_b__1111111
                                                                                                                                      solve( State_11111111111111( ~lock8.2,
                                                                                                                                                                   ~prog_1.1,
                                                                                                                                                                   ~prog_11111111.2,
                                                                                                                                                                   ~prog_1111111111.1,
                                                                                                                                                                   a,
                                                                                                                                                                   b,
                                                                                                                                                                   kEnc,
                                                                                                                                                                   kSign,
                                                                                                                                                                   m,
                                                                                                                                                                   seq.1
                                                                                                                                             ) ▶₀ #t2.9 )
                                                                                                                                        case unlock_a_b__1111111111111
                                                                                                                                        by contradiction
                                                                                                                                           /*
                                                                                                                                           cyclic
                                                                                                                                           */
                                                                                                                                      qed
                                                                                                                                    qed
                                                                                                                                  qed
                                                                                                                                qed
                                                                                                                              qed
                                                                                                                            qed
                                                                                                                          next
                                                                                                                            case case_2
                                                                                                                            solve( MID_Receiver( mid_11111211
                                                                                                                                   ) ▶₂ #t2.15 )
                                                                                                                              case MessageID_rule_
                                                                                                                              solve( State_111111( ~prog_1,
                                                                                                                                                   a,
                                                                                                                                                   b,
                                                                                                                                                   kEnc,
                                                                                                                                                   kSign
                                                                                                                                     ) ▶₀ #t2.8 )
                                                                                                                                case Par_11111
                                                                                                                                solve( State_111112( ~prog_1,
                                                                                                                                                     a,
                                                                                                                                                     b,
                                                                                                                                                     kEnc,
                                                                                                                                                     kSign
                                                                                                                                       ) ▶₀ #t2.8 )
                                                                                                                                  case Par_11111
                                                                                                                                  solve( State_11111111( ~lock8.1,
                                                                                                                                                         ~prog_1.1,
                                                                                                                                                         ~prog_11111111.1,
                                                                                                                                                         a,
                                                                                                                                                         b,
                                                                                                                                                         kEnc,
                                                                                                                                                         kSign
                                                                                                                                         ) ▶₀ #t2.8 )
                                                                                                                                    case lock_a_b__1111111
                                                                                                                                    solve( State_11111111111111( ~lock8.2,
                                                                                                                                                                 ~prog_1.1,
                                                                                                                                                                 ~prog_11111111.2,
                                                                                                                                                                 ~prog_1111111111.1,
                                                                                                                                                                 a,
                                                                                                                                                                 b,
                                                                                                                                                                 kEnc,
                                                                                                                                                                 kSign,
                                                                                                                                                                 m,
                                                                                                                                                                 seq.1
                                                                                                                                           ) ▶₀ #t2.9 )
                                                                                                                                      case unlock_a_b__1111111111111
                                                                                                                                      by contradiction
                                                                                                                                         /*
                                                                                                                                         cyclic
                                                                                                                                         */
                                                                                                                                    qed
                                                                                                                                  qed
                                                                                                                                qed
                                                                                                                              qed
                                                                                                                            qed
                                                                                                                          next
                                                                                                                            case case_3
                                                                                                                            solve( MID_Receiver( mid_11111211
                                                                                                                                   ) ▶₂ #t2.14 )
                                                                                                                              case MessageID_rule_
                                                                                                                              solve( State_111111( ~prog_1,
                                                                                                                                                   a,
                                                                                                                                                   b,
                                                                                                                                                   kEnc,
                                                                                                                                                   kSign
                                                                                                                                     ) ▶₀ #t2.7 )
                                                                                                                                case Par_11111
                                                                                                                                solve( State_111112( ~prog_1,
                                                                                                                                                     a,
                                                                                                                                                     b,
                                                                                                                                                     kEnc,
                                                                                                                                                     kSign
                                                                                                                                       ) ▶₀ #t2.7 )
                                                                                                                                  case Par_11111
                                                                                                                                  solve( State_11111111( ~lock8.1,
                                                                                                                                                         ~prog_1.1,
                                                                                                                                                         ~prog_11111111.1,
                                                                                                                                                         a,
                                                                                                                                                         b,
                                                                                                                                                         kEnc,
                                                                                                                                                         kSign
                                                                                                                                         ) ▶₀ #t2.7 )
                                                                                                                                    case lock_a_b__1111111
                                                                                                                                    solve( State_11111111111111( ~lock8.2,
                                                                                                                                                                 ~prog_1.1,
                                                                                                                                                                 ~prog_11111111.2,
                                                                                                                                                                 ~prog_1111111111.1,
                                                                                                                                                                 a,
                                                                                                                                                                 b,
                                                                                                                                                                 kEnc,
                                                                                                                                                                 kSign,
                                                                                                                                                                 m,
                                                                                                                                                                 seq.1
                                                                                                                                           ) ▶₀ #t2.8 )
                                                                                                                                      case unlock_a_b__1111111111111
                                                                                                                                      by contradiction
                                                                                                                                         /*
                                                                                                                                         cyclic
                                                                                                                                         */
                                                                                                                                    qed
                                                                                                                                  qed
                                                                                                                                qed
                                                                                                                              qed
                                                                                                                            qed
                                                                                                                          qed
                                                                                                                        next
                                                                                                                          case case_2
                                                                                                                          solve( MID_Receiver( mid_11111211
                                                                                                                                 ) ▶₂ #t2.15 )
                                                                                                                            case MessageID_rule_
                                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                                 a,
                                                                                                                                                 b,
                                                                                                                                                 kEnc,
                                                                                                                                                 kSign
                                                                                                                                   ) ▶₀ #t2.8 )
                                                                                                                              case Par_11111
                                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                                   a,
                                                                                                                                                   b,
                                                                                                                                                   kEnc,
                                                                                                                                                   kSign
                                                                                                                                     ) ▶₀ #t2.8 )
                                                                                                                                case Par_11111
                                                                                                                                solve( State_11111111( ~lock8.1,
                                                                                                                                                       ~prog_1.1,
                                                                                                                                                       ~prog_11111111.1,
                                                                                                                                                       a,
                                                                                                                                                       b,
                                                                                                                                                       kEnc,
                                                                                                                                                       kSign
                                                                                                                                       ) ▶₀ #t2.8 )
                                                                                                                                  case lock_a_b__1111111
                                                                                                                                  solve( State_11111111111111( ~lock8.2,
                                                                                                                                                               ~prog_1.1,
                                                                                                                                                               ~prog_11111111.2,
                                                                                                                                                               ~prog_1111111111.1,
                                                                                                                                                               a,
                                                                                                                                                               b,
                                                                                                                                                               kEnc,
                                                                                                                                                               kSign,
                                                                                                                                                               m,
                                                                                                                                                               seq.1
                                                                                                                                         ) ▶₀ #t2.9 )
                                                                                                                                    case unlock_a_b__1111111111111
                                                                                                                                    by contradiction
                                                                                                                                       /*
                                                                                                                                       cyclic
                                                                                                                                       */
                                                                                                                                  qed
                                                                                                                                qed
                                                                                                                              qed
                                                                                                                            qed
                                                                                                                          qed
                                                                                                                        qed
                                                                                                                      qed
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      next
                                                                        case case_2
                                                                        solve( MID_Receiver( mid_11111211
                                                                               ) ▶₂ #t2.12 )
                                                                          case MessageID_rule_
                                                                          solve( State_111111( ~prog_1, a, b,
                                                                                               kEnc, kSign
                                                                                 ) ▶₀ #t2.6 )
                                                                            case Par_11111
                                                                            solve( State_111112( ~prog_1, a,
                                                                                                 b, kEnc,
                                                                                                 kSign
                                                                                   ) ▶₀ #t2.6 )
                                                                              case Par_11111
                                                                              solve( State_11111111( ~lock8,
                                                                                                     ~prog_1.1,
                                                                                                     ~prog_11111111,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                     ) ▶₀ #t2.6 )
                                                                                case lock_a_b__1111111
                                                                                solve( State_11111111111111( ~lock8.1,
                                                                                                             ~prog_1.1,
                                                                                                             ~prog_11111111.1,
                                                                                                             ~prog_1111111111,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign,
                                                                                                             m,
                                                                                                             seq.1
                                                                                       ) ▶₀ #t2.7 )
                                                                                  case unlock_a_b__1111111111111
                                                                                  solve( MID_Receiver( ~x
                                                                                         ) ▶₂ #j.2 )
                                                                                    case MessageID_rule_
                                                                                    solve( State_111111( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t2.8 )
                                                                                      case Par_11111
                                                                                      solve( State_111112( ~prog_1,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                             ) ▶₀ #t2.8 )
                                                                                        case Par_11111
                                                                                        solve( State_11111211( ~lock6.3,
                                                                                                               ~prog_1.1,
                                                                                                               ~prog_11111211.2,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                               ) ▶₀ #t2.8 )
                                                                                          case lock_b_a__1111121
                                                                                          by solve( State_11111211111( ~lock6.2,
                                                                                                                       ~prog_1.1,
                                                                                                                       ~prog_11111211.3,
                                                                                                                       ~prog_1111121111.2,
                                                                                                                       MH.2,
                                                                                                                       SH.2,
                                                                                                                       ~n,
                                                                                                                       ~n.1,
                                                                                                                       kEnc,
                                                                                                                       kSign,
                                                                                                                       m,
                                                                                                                       pad.2,
                                                                                                                       seq.1
                                                                                                    ) ▶₀ #t2.8 )
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    next
                                                                      case case_2
                                                                      solve( MID_Receiver( mid_11111211
                                                                             ) ▶₂ #t2.12 )
                                                                        case MessageID_rule_
                                                                        solve( State_111111( ~prog_1, a, b,
                                                                                             kEnc, kSign
                                                                               ) ▶₀ #t2.6 )
                                                                          case Par_11111
                                                                          solve( State_111112( ~prog_1, a, b,
                                                                                               kEnc, kSign
                                                                                 ) ▶₀ #t2.6 )
                                                                            case Par_11111
                                                                            solve( State_11111111( ~lock8,
                                                                                                   ~prog_1.1,
                                                                                                   ~prog_11111111,
                                                                                                   a, b, kEnc,
                                                                                                   kSign
                                                                                   ) ▶₀ #t2.6 )
                                                                              case lock_a_b__1111111
                                                                              solve( State_11111111111111( ~lock8.1,
                                                                                                           ~prog_1.1,
                                                                                                           ~prog_11111111.1,
                                                                                                           ~prog_1111111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign,
                                                                                                           m,
                                                                                                           seq.1
                                                                                     ) ▶₀ #t2.7 )
                                                                                case unlock_a_b__1111111111111
                                                                                solve( MID_Receiver( ~x
                                                                                       ) ▶₂ #j.2 )
                                                                                  case MessageID_rule_
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t2.8 )
                                                                                    case Par_11111
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t2.8 )
                                                                                      case Par_11111
                                                                                      solve( State_11111211( ~lock6.3,
                                                                                                             ~prog_1.1,
                                                                                                             ~prog_11111211.2,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                             ) ▶₀ #t2.8 )
                                                                                        case lock_b_a__1111121
                                                                                        by solve( State_11111211111( ~lock6.2,
                                                                                                                     ~prog_1.1,
                                                                                                                     ~prog_11111211.3,
                                                                                                                     ~prog_1111121111.2,
                                                                                                                     MH.2,
                                                                                                                     SH.2,
                                                                                                                     ~n,
                                                                                                                     ~n.1,
                                                                                                                     kEnc,
                                                                                                                     kSign,
                                                                                                                     m,
                                                                                                                     pad.2,
                                                                                                                     seq.1
                                                                                                  ) ▶₀ #t2.8 )
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    next
                                                                      case case_3
                                                                      solve( MID_Receiver( mid_11111211
                                                                             ) ▶₂ #t2.12 )
                                                                        case MessageID_rule_
                                                                        solve( State_111111( ~prog_1, a, b,
                                                                                             kEnc, kSign
                                                                               ) ▶₀ #t2.6 )
                                                                          case Par_11111
                                                                          solve( State_111112( ~prog_1, a, b,
                                                                                               kEnc, kSign
                                                                                 ) ▶₀ #t2.6 )
                                                                            case Par_11111
                                                                            solve( State_11111111( ~lock8,
                                                                                                   ~prog_1.1,
                                                                                                   ~prog_11111111,
                                                                                                   a, b, kEnc,
                                                                                                   kSign
                                                                                   ) ▶₀ #t2.6 )
                                                                              case lock_a_b__1111111
                                                                              solve( State_11111111111111( ~lock8.1,
                                                                                                           ~prog_1.1,
                                                                                                           ~prog_11111111.1,
                                                                                                           ~prog_1111111111,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign,
                                                                                                           m,
                                                                                                           seq.1
                                                                                     ) ▶₀ #t2.7 )
                                                                                case unlock_a_b__1111111111111
                                                                                solve( MID_Receiver( ~x
                                                                                       ) ▶₂ #j.2 )
                                                                                  case MessageID_rule_
                                                                                  solve( State_111111( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t2.8 )
                                                                                    case Par_11111
                                                                                    solve( State_111112( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t2.8 )
                                                                                      case Par_11111
                                                                                      solve( State_11111211( ~lock6.2,
                                                                                                             ~prog_1.1,
                                                                                                             ~prog_11111211,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                             ) ▶₀ #t2.8 )
                                                                                        case lock_b_a__1111121
                                                                                        solve( State_111111( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t2.8 )
                                                                                          case Par_11111
                                                                                          solve( State_111112( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t2.8 )
                                                                                            case Par_11111
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t2.8 )
                                                                                              case Par_11111
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t2.8 )
                                                                                                case Par_11111
                                                                                                solve( State_11111111( ~lock8.1,
                                                                                                                       ~prog_1.1,
                                                                                                                       ~prog_11111111,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t2.8 )
                                                                                                  case lock_a_b__1111111
                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                         ) ▶₀ #t2.8 )
                                                                                                    case Par_11111
                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                         a,
                                                                                                                         b,
                                                                                                                         kEnc,
                                                                                                                         kSign
                                                                                                           ) ▶₀ #t2.8 )
                                                                                                      case Par_11111
                                                                                                      solve( State_111111( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t2.8 )
                                                                                                        case Par_11111
                                                                                                        solve( State_111112( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t2.8 )
                                                                                                          case Par_11111
                                                                                                          solve( !KU( senc(<
                                                                                                                            (
                                                                                                                             dif+
                                                                                                                             seq
                                                                                                                            ), 
                                                                                                                            m2, 
                                                                                                                            pad.1, 
                                                                                                                            mac(<
                                                                                                                                 MH.1, 
                                                                                                                                 SH.1, 
                                                                                                                                 (
                                                                                                                                  dif+
                                                                                                                                  seq
                                                                                                                                 ), 
                                                                                                                                 m2, 
                                                                                                                                 pad.1
                                                                                                                                >,
                                                                                                                                ~n.3)
                                                                                                                           >,
                                                                                                                           ~n.2)
                                                                                                                 ) @ #vk.9 )
                                                                                                            case c_senc
                                                                                                            by solve( !KU( ~n.2
                                                                                                                      ) @ #vk.15 )
                                                                                                          next
                                                                                                            case out_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__111111111111
                                                                                                            solve( (¬(#vr.21 < #vr.31))  ∥
                                                                                                                   (∃ dif.1.
                                                                                                                     ((
                                                                                                                       dif+
                                                                                                                       seq
                                                                                                                      ) =
                                                                                                                      (
                                                                                                                       seq+
                                                                                                                       dif.1
                                                                                                                      ))) )
                                                                                                              case case_2
                                                                                                              solve( (¬(#vr.31 < #vr.21))  ∥
                                                                                                                     (∃ dif.1.
                                                                                                                       (seq =
                                                                                                                        (
                                                                                                                         dif+
                                                                                                                         seq+
                                                                                                                         dif.1
                                                                                                                        ))) )
                                                                                                                case case_1
                                                                                                                solve( ((#vr.22 < #vr.33) ∧
                                                                                                                        (∃ #t2.
                                                                                                                          (Unlock_8( $8,
                                                                                                                                     ~lock8,
                                                                                                                                     <
                                                                                                                                      ~n, 
                                                                                                                                      ~n.1
                                                                                                                                     >
                                                                                                                           ) @ #t2)
                                                                                                                         ∧
                                                                                                                          (#vr.22 < #t2) ∧
                                                                                                                          (#t2 < #vr.33) ∧
                                                                                                                          (∀ #t0
                                                                                                                             pp.
                                                                                                                            (Unlock( pp,
                                                                                                                                     ~lock8,
                                                                                                                                     <
                                                                                                                                      ~n, 
                                                                                                                                      ~n.1
                                                                                                                                     >
                                                                                                                             ) @ #t0)
                                                                                                                           ⇒
                                                                                                                            #t0 =
                                                                                                                            #t2) ∧
                                                                                                                          (∀ pp
                                                                                                                             lpp
                                                                                                                             #t0.
                                                                                                                            (Lock( pp,
                                                                                                                                   lpp,
                                                                                                                                   <
                                                                                                                                    ~n, 
                                                                                                                                    ~n.1
                                                                                                                                   >
                                                                                                                             ) @ #t0)
                                                                                                                           ⇒
                                                                                                                            ((#t0 < #vr.22) ∨
                                                                                                                             (#t0 =
                                                                                                                              #vr.22) ∨
                                                                                                                             (#t2 < #t0))) ∧
                                                                                                                          (∀ pp
                                                                                                                             lpp
                                                                                                                             #t0.
                                                                                                                            (Unlock( pp,
                                                                                                                                     lpp,
                                                                                                                                     <
                                                                                                                                      ~n, 
                                                                                                                                      ~n.1
                                                                                                                                     >
                                                                                                                             ) @ #t0)
                                                                                                                           ⇒
                                                                                                                            ((#t0 < #vr.22) ∨
                                                                                                                             (#t2 < #t0) ∨
                                                                                                                             (#t2 =
                                                                                                                              #t0)))))  ∥
                                                                                                                       (#vr.33 < #vr.22)  ∥
                                                                                                                       (#vr.22 =
                                                                                                                        #vr.33) )
                                                                                                                  case case_1
                                                                                                                  by contradiction
                                                                                                                     /*
                                                                                                                     cyclic
                                                                                                                     */
                                                                                                                next
                                                                                                                  case case_2
                                                                                                                  solve( MID_Receiver( ~x.1
                                                                                                                         ) ▶₂ #j.2 )
                                                                                                                    case MessageID_rule_
                                                                                                                    solve( State_11111211( ~lock6.2,
                                                                                                                                           ~prog_1.1,
                                                                                                                                           ~prog_11111211.2,
                                                                                                                                           a,
                                                                                                                                           b,
                                                                                                                                           ~n.2,
                                                                                                                                           ~n.3
                                                                                                                           ) ▶₀ #j.2 )
                                                                                                                      case lock_b_a__1111121
                                                                                                                      solve( ((#vr.1 < #vr.35) ∧
                                                                                                                              (∃ #t2.
                                                                                                                                (Unlock_6( $6,
                                                                                                                                           ~lock6,
                                                                                                                                           <
                                                                                                                                            ~n.1, 
                                                                                                                                            ~n
                                                                                                                                           >
                                                                                                                                 ) @ #t2)
                                                                                                                               ∧
                                                                                                                                (#vr.1 < #t2) ∧
                                                                                                                                (#t2 < #vr.35) ∧
                                                                                                                                (∀ #t0
                                                                                                                                   pp.
                                                                                                                                  (Unlock( pp,
                                                                                                                                           ~lock6,
                                                                                                                                           <
                                                                                                                                            ~n.1, 
                                                                                                                                            ~n
                                                                                                                                           >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  #t0 =
                                                                                                                                  #t2) ∧
                                                                                                                                (∀ pp
                                                                                                                                   lpp
                                                                                                                                   #t0.
                                                                                                                                  (Lock( pp,
                                                                                                                                         lpp,
                                                                                                                                         <
                                                                                                                                          ~n.1, 
                                                                                                                                          ~n
                                                                                                                                         >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  ((#t0 < #vr.1) ∨
                                                                                                                                   (#t0 =
                                                                                                                                    #vr.1) ∨
                                                                                                                                   (#t2 < #t0))) ∧
                                                                                                                                (∀ pp
                                                                                                                                   lpp
                                                                                                                                   #t0.
                                                                                                                                  (Unlock( pp,
                                                                                                                                           lpp,
                                                                                                                                           <
                                                                                                                                            ~n.1, 
                                                                                                                                            ~n
                                                                                                                                           >
                                                                                                                                   ) @ #t0)
                                                                                                                                 ⇒
                                                                                                                                  ((#t0 < #vr.1) ∨
                                                                                                                                   (#t2 < #t0) ∨
                                                                                                                                   (#t2 =
                                                                                                                                    #t0)))))  ∥
                                                                                                                             (#vr.35 < #vr.1)  ∥
                                                                                                                             (#vr.1 =
                                                                                                                              #vr.35) )
                                                                                                                        case case_1
                                                                                                                        solve( ((#vr.12 < #vr.35) ∧
                                                                                                                                (∃ #t2.
                                                                                                                                  (Unlock_6( $6.1,
                                                                                                                                             ~lock6.1,
                                                                                                                                             <
                                                                                                                                              ~n.1, 
                                                                                                                                              ~n
                                                                                                                                             >
                                                                                                                                   ) @ #t2)
                                                                                                                                 ∧
                                                                                                                                  (#vr.12 < #t2) ∧
                                                                                                                                  (#t2 < #vr.35) ∧
                                                                                                                                  (∀ #t0
                                                                                                                                     pp.
                                                                                                                                    (Unlock( pp,
                                                                                                                                             ~lock6.1,
                                                                                                                                             <
                                                                                                                                              ~n.1, 
                                                                                                                                              ~n
                                                                                                                                             >
                                                                                                                                     ) @ #t0)
                                                                                                                                   ⇒
                                                                                                                                    #t0 =
                                                                                                                                    #t2) ∧
                                                                                                                                  (∀ pp
                                                                                                                                     lpp
                                                                                                                                     #t0.
                                                                                                                                    (Lock( pp,
                                                                                                                                           lpp,
                                                                                                                                           <
                                                                                                                                            ~n.1, 
                                                                                                                                            ~n
                                                                                                                                           >
                                                                                                                                     ) @ #t0)
                                                                                                                                   ⇒
                                                                                                                                    ((#t0 < #vr.12) ∨
                                                                                                                                     (#t0 =
                                                                                                                                      #vr.12) ∨
                                                                                                                                     (#t2 < #t0))) ∧
                                                                                                                                  (∀ pp
                                                                                                                                     lpp
                                                                                                                                     #t0.
                                                                                                                                    (Unlock( pp,
                                                                                                                                             lpp,
                                                                                                                                             <
                                                                                                                                              ~n.1, 
                                                                                                                                              ~n
                                                                                                                                             >
                                                                                                                                     ) @ #t0)
                                                                                                                                   ⇒
                                                                                                                                    ((#t0 < #vr.12) ∨
                                                                                                                                     (#t2 < #t0) ∨
                                                                                                                                     (#t2 =
                                                                                                                                      #t0)))))  ∥
                                                                                                                               (#vr.35 < #vr.12)  ∥
                                                                                                                               (#vr.12 =
                                                                                                                                #vr.35) )
                                                                                                                          case case_1
                                                                                                                          solve( MID_Receiver( mid_11111211
                                                                                                                                 ) ▶₂ #t2.15 )
                                                                                                                            case MessageID_rule_
                                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                                 a,
                                                                                                                                                 b,
                                                                                                                                                 kEnc,
                                                                                                                                                 kSign
                                                                                                                                   ) ▶₀ #t2.8 )
                                                                                                                              case Par_11111
                                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                                   a,
                                                                                                                                                   b,
                                                                                                                                                   kEnc,
                                                                                                                                                   kSign
                                                                                                                                     ) ▶₀ #t2.8 )
                                                                                                                                case Par_11111
                                                                                                                                solve( State_11111111( ~lock8.1,
                                                                                                                                                       ~prog_1.1,
                                                                                                                                                       ~prog_11111111.1,
                                                                                                                                                       a,
                                                                                                                                                       b,
                                                                                                                                                       kEnc,
                                                                                                                                                       kSign
                                                                                                                                       ) ▶₀ #t2.8 )
                                                                                                                                  case lock_a_b__1111111
                                                                                                                                  solve( State_11111111111111( ~lock8.2,
                                                                                                                                                               ~prog_1.1,
                                                                                                                                                               ~prog_11111111.2,
                                                                                                                                                               ~prog_1111111111.1,
                                                                                                                                                               a,
                                                                                                                                                               b,
                                                                                                                                                               kEnc,
                                                                                                                                                               kSign,
                                                                                                                                                               m,
                                                                                                                                                               seq.1
                                                                                                                                         ) ▶₀ #t2.9 )
                                                                                                                                    case unlock_a_b__1111111111111
                                                                                                                                    by contradiction
                                                                                                                                       /*
                                                                                                                                       cyclic
                                                                                                                                       */
                                                                                                                                  qed
                                                                                                                                qed
                                                                                                                              qed
                                                                                                                            qed
                                                                                                                          qed
                                                                                                                        next
                                                                                                                          case case_2
                                                                                                                          solve( MID_Receiver( mid_11111211
                                                                                                                                 ) ▶₂ #t2.15 )
                                                                                                                            case MessageID_rule_
                                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                                 a,
                                                                                                                                                 b,
                                                                                                                                                 kEnc,
                                                                                                                                                 kSign
                                                                                                                                   ) ▶₀ #t2.8 )
                                                                                                                              case Par_11111
                                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                                   a,
                                                                                                                                                   b,
                                                                                                                                                   kEnc,
                                                                                                                                                   kSign
                                                                                                                                     ) ▶₀ #t2.8 )
                                                                                                                                case Par_11111
                                                                                                                                solve( State_11111111( ~lock8.1,
                                                                                                                                                       ~prog_1.1,
                                                                                                                                                       ~prog_11111111.1,
                                                                                                                                                       a,
                                                                                                                                                       b,
                                                                                                                                                       kEnc,
                                                                                                                                                       kSign
                                                                                                                                       ) ▶₀ #t2.8 )
                                                                                                                                  case lock_a_b__1111111
                                                                                                                                  solve( State_11111111111111( ~lock8.2,
                                                                                                                                                               ~prog_1.1,
                                                                                                                                                               ~prog_11111111.2,
                                                                                                                                                               ~prog_1111111111.1,
                                                                                                                                                               a,
                                                                                                                                                               b,
                                                                                                                                                               kEnc,
                                                                                                                                                               kSign,
                                                                                                                                                               m,
                                                                                                                                                               seq.1
                                                                                                                                         ) ▶₀ #t2.9 )
                                                                                                                                    case unlock_a_b__1111111111111
                                                                                                                                    by contradiction
                                                                                                                                       /*
                                                                                                                                       cyclic
                                                                                                                                       */
                                                                                                                                  qed
                                                                                                                                qed
                                                                                                                              qed
                                                                                                                            qed
                                                                                                                          qed
                                                                                                                        next
                                                                                                                          case case_3
                                                                                                                          solve( MID_Receiver( mid_11111211
                                                                                                                                 ) ▶₂ #t2.14 )
                                                                                                                            case MessageID_rule_
                                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                                 a,
                                                                                                                                                 b,
                                                                                                                                                 kEnc,
                                                                                                                                                 kSign
                                                                                                                                   ) ▶₀ #t2.7 )
                                                                                                                              case Par_11111
                                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                                   a,
                                                                                                                                                   b,
                                                                                                                                                   kEnc,
                                                                                                                                                   kSign
                                                                                                                                     ) ▶₀ #t2.7 )
                                                                                                                                case Par_11111
                                                                                                                                solve( State_11111111( ~lock8.1,
                                                                                                                                                       ~prog_1.1,
                                                                                                                                                       ~prog_11111111.1,
                                                                                                                                                       a,
                                                                                                                                                       b,
                                                                                                                                                       kEnc,
                                                                                                                                                       kSign
                                                                                                                                       ) ▶₀ #t2.7 )
                                                                                                                                  case lock_a_b__1111111
                                                                                                                                  solve( State_11111111111111( ~lock8.2,
                                                                                                                                                               ~prog_1.1,
                                                                                                                                                               ~prog_11111111.2,
                                                                                                                                                               ~prog_1111111111.1,
                                                                                                                                                               a,
                                                                                                                                                               b,
                                                                                                                                                               kEnc,
                                                                                                                                                               kSign,
                                                                                                                                                               m,
                                                                                                                                                               seq.1
                                                                                                                                         ) ▶₀ #t2.8 )
                                                                                                                                    case unlock_a_b__1111111111111
                                                                                                                                    by contradiction
                                                                                                                                       /*
                                                                                                                                       cyclic
                                                                                                                                       */
                                                                                                                                  qed
                                                                                                                                qed
                                                                                                                              qed
                                                                                                                            qed
                                                                                                                          qed
                                                                                                                        qed
                                                                                                                      next
                                                                                                                        case case_2
                                                                                                                        solve( MID_Receiver( mid_11111211
                                                                                                                               ) ▶₂ #t2.15 )
                                                                                                                          case MessageID_rule_
                                                                                                                          solve( State_111111( ~prog_1,
                                                                                                                                               a,
                                                                                                                                               b,
                                                                                                                                               kEnc,
                                                                                                                                               kSign
                                                                                                                                 ) ▶₀ #t2.8 )
                                                                                                                            case Par_11111
                                                                                                                            solve( State_111112( ~prog_1,
                                                                                                                                                 a,
                                                                                                                                                 b,
                                                                                                                                                 kEnc,
                                                                                                                                                 kSign
                                                                                                                                   ) ▶₀ #t2.8 )
                                                                                                                              case Par_11111
                                                                                                                              solve( State_11111111( ~lock8.1,
                                                                                                                                                     ~prog_1.1,
                                                                                                                                                     ~prog_11111111.1,
                                                                                                                                                     a,
                                                                                                                                                     b,
                                                                                                                                                     kEnc,
                                                                                                                                                     kSign
                                                                                                                                     ) ▶₀ #t2.8 )
                                                                                                                                case lock_a_b__1111111
                                                                                                                                solve( State_11111111111111( ~lock8.2,
                                                                                                                                                             ~prog_1.1,
                                                                                                                                                             ~prog_11111111.2,
                                                                                                                                                             ~prog_1111111111.1,
                                                                                                                                                             a,
                                                                                                                                                             b,
                                                                                                                                                             kEnc,
                                                                                                                                                             kSign,
                                                                                                                                                             m,
                                                                                                                                                             seq.1
                                                                                                                                       ) ▶₀ #t2.9 )
                                                                                                                                  case unlock_a_b__1111111111111
                                                                                                                                  by contradiction
                                                                                                                                     /*
                                                                                                                                     cyclic
                                                                                                                                     */
                                                                                                                                qed
                                                                                                                              qed
                                                                                                                            qed
                                                                                                                          qed
                                                                                                                        qed
                                                                                                                      qed
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          next
            case case_2
            solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.6 )
              case MessageID_rule_
              solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2 )
                case Par_11111
                solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.1 )
                  case Par_11111
                  solve( State_11111211( ~lock6.2, ~prog_1.1, ~prog_11111211, a, b, kEnc,
                                         kSign
                         ) ▶₀ #t2.2 )
                    case lock_b_a__1111121
                    solve( State_111112111111( ~lock6.2, ~prog_1.1, ~prog_11111211.2,
                                               ~prog_1111121111, MH.2, SH.2, a, b, kEnc, kSign, m.1, pad.2,
                                               seq.1
                           ) ▶₀ #t2.2 )
                      case unlock_b_a__11111211111
                      solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.12 )
                        case MessageID_rule_
                        solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                          case Par_11111
                          solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.3 )
                            case Par_11111
                            solve( State_11111211( ~lock6.2, ~prog_1.1, ~prog_11111211.1, a, b, kEnc,
                                                   kSign
                                   ) ▶₀ #t2.3 )
                              case lock_b_a__1111121
                              solve( State_111112111111( ~lock6.2, ~prog_1.1, ~prog_11111211.2,
                                                         ~prog_1111121111.1, MH.2, SH.2, a, b, kEnc, kSign,
                                                         m.1, pad.2, seq.1
                                     ) ▶₀ #t2.4 )
                                case unlock_b_a__11111211111
                                by contradiction /* cyclic */
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma delivery:
  all-traces
  "∀ A B m #i.
    (Sent( A, B, m ) @ #i) ⇒ (∃ #k. (Recv( A, B, m ) @ #k) ∧ (#i < #k))"
/*
guarded formula characterizing all counter-examples:
"∃ A B m #i.
  (Sent( A, B, m ) @ #i) ∧ ∀ #k. (Recv( A, B, m ) @ #k) ⇒ ¬(#i < #k)"
*/
simplify
solve( State_11111111111( ~lock8, ~prog_1, ~prog_11111111,
                          ~prog_1111111111, A, B, kEnc, kSign, m, seq
       ) ▶₀ #i )
  case new_m_1111111111
  solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2 )
    case Par_11111
    solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.1 )
      case Par_11111
      solve( State_11111111( ~lock8.1, ~prog_1.1, ~prog_11111111, a, b, kEnc,
                             kSign
             ) ▶₀ #t2.2 )
        case lock_a_b__1111111
        solve( State_11111111111111( ~lock8.1, ~prog_1.1, ~prog_11111111.1,
                                     ~prog_1111111111, a, b, kEnc, kSign, m, seq.1
               ) ▶₀ #t2.3 )
          case unlock_a_b__1111111111111
          solve( MID_Receiver( ~x ) ▶₂ #j )
            case MessageID_rule_
            solve( State_111111( ~prog_1, a.1, b.1, kEnc, kSign ) ▶₀ #t2.4 )
              case Par_11111
              solve( State_111112( ~prog_1, a.1, b.1, kEnc, kSign ) ▶₀ #t2.4 )
                case Par_11111
                solve( State_11111211( ~lock6, ~prog_1.1, ~prog_11111211, a, b, ~n.2,
                                       ~n.3
                       ) ▶₀ #j )
                  case lock_b_a__1111121
                  solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.9 )
                    case MessageID_rule_
                    solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.4 )
                      case Par_11111
                      solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.4 )
                        case Par_11111
                        solve( State_11111111( ~lock8.1, ~prog_1.1, ~prog_11111111, a, b, kEnc,
                                               kSign
                               ) ▶₀ #t2.4 )
                          case lock_a_b__1111111
                          solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.4 )
                            case Par_11111
                            solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.4 )
                              case Par_11111
                              solve( State_11111211( ~lock6.1, ~prog_1.1, ~prog_11111211, a, b, kEnc,
                                                     kSign
                                     ) ▶₀ #t2.4 )
                                case lock_b_a__1111121
                                solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.4 )
                                  case Par_11111
                                  solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.4 )
                                    case Par_11111
                                    solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.4 )
                                      case Par_11111
                                      solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.4 )
                                        case Par_11111
                                        solve( !KU( senc(<seq, ~n.4, $pad, 
                                                          mac(<$MH, $SH, seq, ~n.4, $pad>, ~n.3)>,
                                                         ~n.2)
                                               ) @ #vk.7 )
                                          case out_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__111111111111
                                          solve( MID_Receiver( ~x ) ▶₂ #j.1 )
                                            case MessageID_rule_
                                            solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.4 )
                                              case Par_11111
                                              solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.4 )
                                                case Par_11111
                                                solve( State_11111111( ~lock8.1, ~prog_1.1, ~prog_11111111, a,
                                                                       b, kEnc, kSign
                                                       ) ▶₀ #t2.4 )
                                                  case lock_a_b__1111111
                                                  solve( State_11111111111111( ~lock8.1, ~prog_1.1,
                                                                               ~prog_11111111.1,
                                                                               ~prog_1111111111, a, b, kEnc,
                                                                               kSign, m, seq.1
                                                         ) ▶₀ #t2.4 )
                                                    case unlock_a_b__1111111111111
                                                    solve( MID_Receiver( ~x ) ▶₂ #j.1 )
                                                      case MessageID_rule_
                                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t2.4 )
                                                        case Par_11111
                                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                               ) ▶₀ #t2.4 )
                                                          case Par_11111
                                                          solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                 ) ▶₀ #t2.4 )
                                                            case Par_11111
                                                            solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t2.4 )
                                                              case Par_11111
                                                              solve( State_11111111( ~lock8.1, ~prog_1.1,
                                                                                     ~prog_11111111, a, b,
                                                                                     kEnc, kSign
                                                                     ) ▶₀ #t2.4 )
                                                                case lock_a_b__1111111
                                                                solve( State_111111( ~prog_1, a, b, kEnc,
                                                                                     kSign
                                                                       ) ▶₀ #t2.4 )
                                                                  case Par_11111
                                                                  solve( State_111112( ~prog_1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t2.4 )
                                                                    case Par_11111
                                                                    SOLVED // trace found
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma delivery_order:
  all-traces
  "∀ A B m m2 #i #j.
    (((Sent( A, B, m ) @ #i) ∧ (Sent( A, B, m2 ) @ #j)) ∧ (#i < #j)) ⇒
    (∃ #k #l.
      ((Recv( A, B, m ) @ #k) ∧ (Recv( A, B, m2 ) @ #l)) ∧ (#k < #l))"
/*
guarded formula characterizing all counter-examples:
"∃ A B m m2 #i #j.
  (Sent( A, B, m ) @ #i) ∧ (Sent( A, B, m2 ) @ #j)
 ∧
  (#i < #j) ∧
  (∀ #k #l. (Recv( A, B, m ) @ #k) ∧ (Recv( A, B, m2 ) @ #l) ⇒ ¬(#k < #l))"
*/
simplify
solve( State_11111111111( ~lock8, ~prog_1, ~prog_11111111,
                          ~prog_1111111111, A, B, kEnc, kSign, m, seq
       ) ▶₀ #i )
  case new_m_1111111111
  solve( State_11111111111( ~lock8.1, ~prog_1.1, ~prog_11111111.1,
                            ~prog_1111111111.1, ~n, ~n.1, kEnc, kSign, m2, seq.1
         ) ▶₀ #j )
    case new_m_1111111111
    solve( (¬(#vr.1 < #vr.14))  ∥ (∃ dif. (seq.1 = (dif+seq))) )
      case case_2
      solve( (¬(#vr.14 < #vr.1))  ∥ (∃ dif.1. (seq = (dif+seq+dif.1))) )
        case case_1
        solve( ((#vr.3 < #vr.16) ∧
                (∃ #t2.
                  (Unlock_8( $8, ~lock8, <~n, ~n.1> ) @ #t2)
                 ∧
                  (#vr.3 < #t2) ∧
                  (#t2 < #vr.16) ∧
                  (∀ #t0 pp. (Unlock( pp, ~lock8, <~n, ~n.1> ) @ #t0) ⇒ #t0 = #t2) ∧
                  (∀ pp lpp #t0.
                    (Lock( pp, lpp, <~n, ~n.1> ) @ #t0)
                   ⇒
                    ((#t0 < #vr.3) ∨ (#t0 = #vr.3) ∨ (#t2 < #t0))) ∧
                  (∀ pp lpp #t0.
                    (Unlock( pp, lpp, <~n, ~n.1> ) @ #t0)
                   ⇒
                    ((#t0 < #vr.3) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
               (#vr.16 < #vr.3)  ∥ (#vr.3 = #vr.16) )
          case case_1
          solve( State_111111( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2 )
            case Par_11111
            solve( State_111112( ~prog_1, a, b, kEnc, kSign ) ▶₀ #t2.1 )
              case Par_11111
              solve( State_11111111( ~lock8.2, ~prog_1.1, ~prog_11111111, a, b, kEnc,
                                     kSign
                     ) ▶₀ #t2.2 )
                case lock_a_b__1111111
                solve( State_11111111111111( ~lock8.2, ~prog_1.1, ~prog_11111111.2,
                                             ~prog_1111111111, a, b, kEnc, kSign, m, seq.1
                       ) ▶₀ #t2.3 )
                  case unlock_a_b__1111111111111
                  solve( MID_Receiver( ~x ) ▶₂ #j.1 )
                    case MessageID_rule_
                    solve( State_111111( ~prog_1, a.1, b.1, kEnc, kSign ) ▶₀ #t2.4 )
                      case Par_11111
                      solve( State_111112( ~prog_1, a.1, b.1, kEnc, kSign ) ▶₀ #t2.4 )
                        case Par_11111
                        solve( State_11111111( ~lock8.2, ~prog_1.2, ~prog_11111111.1, a.1, b.1,
                                               kEnc, kSign
                               ) ▶₀ #t2.4 )
                          case lock_a_b__1111111
                          solve( State_11111111111111( ~lock8.2, ~prog_1.2, ~prog_11111111.2,
                                                       ~prog_1111111111.1, a.1, b.1, kEnc, kSign, m, seq.1
                                 ) ▶₀ #t2.5 )
                            case unlock_a_b__1111111111111
                            solve( MID_Receiver( ~x.1 ) ▶₂ #j.2 )
                              case MessageID_rule_
                              solve( State_111111( ~prog_1, a.2, b.2, kEnc, kSign ) ▶₀ #t2.7 )
                                case Par_11111
                                solve( State_111112( ~prog_1, a.2, b.2, kEnc, kSign ) ▶₀ #t2.7 )
                                  case Par_11111
                                  solve( State_11111211( ~lock6, ~prog_1.1, ~prog_11111211, a, b, ~n.2,
                                                         ~n.3
                                         ) ▶₀ #j.1 )
                                    case lock_b_a__1111121
                                    solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.17 )
                                      case MessageID_rule_
                                      solve( State_111111( ~prog_1, a.1, b.1, kEnc, kSign ) ▶₀ #t2.7 )
                                        case Par_11111
                                        solve( State_111112( ~prog_1, a.1, b.1, kEnc, kSign ) ▶₀ #t2.7 )
                                          case Par_11111
                                          solve( State_11111111( ~lock8.2, ~prog_1.2, ~prog_11111111, a.1,
                                                                 b.1, kEnc, kSign
                                                 ) ▶₀ #t2.7 )
                                            case lock_a_b__1111111
                                            solve( State_111111( ~prog_1, a.1, b.1, kEnc, kSign ) ▶₀ #t2.7 )
                                              case Par_11111
                                              solve( State_111112( ~prog_1, a.1, b.1, kEnc, kSign ) ▶₀ #t2.7 )
                                                case Par_11111
                                                solve( State_11111211( ~lock6.1, ~prog_1.1, ~prog_11111211.1,
                                                                       a, b, ~n.2, ~n.3
                                                       ) ▶₀ #j.2 )
                                                  case lock_b_a__1111121
                                                  solve( ((#vr.20 < #vr.23) ∧
                                                          (∃ #t2.
                                                            (Unlock_6( $6, ~lock6, <~n.1, ~n> ) @ #t2)
                                                           ∧
                                                            (#vr.20 < #t2) ∧
                                                            (#t2 < #vr.23) ∧
                                                            (∀ #t0 pp.
                                                              (Unlock( pp, ~lock6, <~n.1, ~n> ) @ #t0)
                                                             ⇒
                                                              #t0 = #t2) ∧
                                                            (∀ pp lpp #t0.
                                                              (Lock( pp, lpp, <~n.1, ~n> ) @ #t0)
                                                             ⇒
                                                              ((#t0 < #vr.20) ∨
                                                               (#t0 = #vr.20) ∨
                                                               (#t2 < #t0))) ∧
                                                            (∀ pp lpp #t0.
                                                              (Unlock( pp, lpp, <~n.1, ~n> ) @ #t0)
                                                             ⇒
                                                              ((#t0 < #vr.20) ∨
                                                               (#t2 < #t0) ∨
                                                               (#t2 = #t0)))))  ∥
                                                         (#vr.23 < #vr.20)  ∥ (#vr.20 = #vr.23) )
                                                    case case_1
                                                    solve( MID_Receiver( mid_11111211 ) ▶₂ #t2.17 )
                                                      case MessageID_rule_
                                                      solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                             ) ▶₀ #t2.7 )
                                                        case Par_11111
                                                        solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                               ) ▶₀ #t2.7 )
                                                          case Par_11111
                                                          solve( State_11111111( ~lock8.2, ~prog_1.1,
                                                                                 ~prog_11111111.1, a, b, kEnc,
                                                                                 kSign
                                                                 ) ▶₀ #t2.7 )
                                                            case lock_a_b__1111111
                                                            solve( State_111111( ~prog_1, a, b, kEnc, kSign
                                                                   ) ▶₀ #t2.7 )
                                                              case Par_11111
                                                              solve( State_111112( ~prog_1, a, b, kEnc, kSign
                                                                     ) ▶₀ #t2.7 )
                                                                case Par_11111
                                                                solve( State_11111211( ~lock6.2, ~prog_1.1,
                                                                                       ~prog_11111211, a, b,
                                                                                       kEnc, kSign
                                                                       ) ▶₀ #t2.7 )
                                                                  case lock_b_a__1111121
                                                                  solve( State_111111( ~prog_1, a, b, kEnc,
                                                                                       kSign
                                                                         ) ▶₀ #t2.7 )
                                                                    case Par_11111
                                                                    solve( State_111112( ~prog_1, a, b, kEnc,
                                                                                         kSign
                                                                           ) ▶₀ #t2.7 )
                                                                      case Par_11111
                                                                      solve( State_111111( ~prog_1, a, b,
                                                                                           kEnc, kSign
                                                                             ) ▶₀ #t2.7 )
                                                                        case Par_11111
                                                                        solve( State_111112( ~prog_1, a, b,
                                                                                             kEnc, kSign
                                                                               ) ▶₀ #t2.7 )
                                                                          case Par_11111
                                                                          solve( State_11111211( ~lock6.2,
                                                                                                 ~prog_1.1,
                                                                                                 ~prog_11111211.1,
                                                                                                 a, b, kEnc,
                                                                                                 kSign
                                                                                 ) ▶₀ #t2.7 )
                                                                            case lock_b_a__1111121
                                                                            solve( State_11111211111( ~lock6,
                                                                                                      ~prog_1.1,
                                                                                                      ~prog_11111211.2,
                                                                                                      ~prog_1111121111,
                                                                                                      MH.2,
                                                                                                      SH.2,
                                                                                                      ~n,
                                                                                                      ~n.1,
                                                                                                      kEnc,
                                                                                                      kSign,
                                                                                                      m,
                                                                                                      pad.2,
                                                                                                      seq.1
                                                                                   ) ▶₀ #t2.7 )
                                                                              case event_Recva_b_m_1111121111
                                                                              solve( MID_Receiver( mid_11111211
                                                                                     ) ▶₂ #t2.16 )
                                                                                case MessageID_rule_
                                                                                solve( State_111111( ~prog_1,
                                                                                                     a, b,
                                                                                                     kEnc,
                                                                                                     kSign
                                                                                       ) ▶₀ #t2.8 )
                                                                                  case Par_11111
                                                                                  solve( State_111112( ~prog_1,
                                                                                                       a, b,
                                                                                                       kEnc,
                                                                                                       kSign
                                                                                         ) ▶₀ #t2.8 )
                                                                                    case Par_11111
                                                                                    solve( State_111111( ~prog_1,
                                                                                                         a, b,
                                                                                                         kEnc,
                                                                                                         kSign
                                                                                           ) ▶₀ #t2.8 )
                                                                                      case Par_11111
                                                                                      solve( State_111112( ~prog_1,
                                                                                                           a,
                                                                                                           b,
                                                                                                           kEnc,
                                                                                                           kSign
                                                                                             ) ▶₀ #t2.8 )
                                                                                        case Par_11111
                                                                                        solve( State_111111( ~prog_1,
                                                                                                             a,
                                                                                                             b,
                                                                                                             kEnc,
                                                                                                             kSign
                                                                                               ) ▶₀ #t2.8 )
                                                                                          case Par_11111
                                                                                          solve( State_111112( ~prog_1,
                                                                                                               a,
                                                                                                               b,
                                                                                                               kEnc,
                                                                                                               kSign
                                                                                                 ) ▶₀ #t2.8 )
                                                                                            case Par_11111
                                                                                            solve( State_111111( ~prog_1,
                                                                                                                 a,
                                                                                                                 b,
                                                                                                                 kEnc,
                                                                                                                 kSign
                                                                                                   ) ▶₀ #t2.8 )
                                                                                              case Par_11111
                                                                                              solve( State_111112( ~prog_1,
                                                                                                                   a,
                                                                                                                   b,
                                                                                                                   kEnc,
                                                                                                                   kSign
                                                                                                     ) ▶₀ #t2.8 )
                                                                                                case Par_11111
                                                                                                solve( State_11111211( ~lock6.2,
                                                                                                                       ~prog_1.1,
                                                                                                                       ~prog_11111211,
                                                                                                                       a,
                                                                                                                       b,
                                                                                                                       kEnc,
                                                                                                                       kSign
                                                                                                       ) ▶₀ #t2.8 )
                                                                                                  case lock_b_a__1111121
                                                                                                  solve( State_111112111111( ~lock6.2,
                                                                                                                             ~prog_1.1,
                                                                                                                             ~prog_11111211.2,
                                                                                                                             ~prog_1111121111,
                                                                                                                             MH.2,
                                                                                                                             SH.2,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign,
                                                                                                                             m,
                                                                                                                             pad.2,
                                                                                                                             seq.1
                                                                                                         ) ▶₀ #t2.8 )
                                                                                                    case unlock_b_a__11111211111
                                                                                                    solve( MID_Receiver( mid_11111211
                                                                                                           ) ▶₂ #t2.13 )
                                                                                                      case MessageID_rule_
                                                                                                      solve( State_111111( ~prog_1,
                                                                                                                           a,
                                                                                                                           b,
                                                                                                                           kEnc,
                                                                                                                           kSign
                                                                                                             ) ▶₀ #t2.9 )
                                                                                                        case Par_11111
                                                                                                        solve( State_111112( ~prog_1,
                                                                                                                             a,
                                                                                                                             b,
                                                                                                                             kEnc,
                                                                                                                             kSign
                                                                                                               ) ▶₀ #t2.9 )
                                                                                                          case Par_11111
                                                                                                          solve( State_111111( ~prog_1,
                                                                                                                               a,
                                                                                                                               b,
                                                                                                                               kEnc,
                                                                                                                               kSign
                                                                                                                 ) ▶₀ #t2.9 )
                                                                                                            case Par_11111
                                                                                                            solve( State_111112( ~prog_1,
                                                                                                                                 a,
                                                                                                                                 b,
                                                                                                                                 kEnc,
                                                                                                                                 kSign
                                                                                                                   ) ▶₀ #t2.9 )
                                                                                                              case Par_11111
                                                                                                              solve( State_11111211( ~lock6.2,
                                                                                                                                     ~prog_1.1,
                                                                                                                                     ~prog_11111211,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                     ) ▶₀ #t2.9 )
                                                                                                                case lock_b_a__1111121
                                                                                                                solve( State_111111( ~prog_1,
                                                                                                                                     a,
                                                                                                                                     b,
                                                                                                                                     kEnc,
                                                                                                                                     kSign
                                                                                                                       ) ▶₀ #t2.9 )
                                                                                                                  case Par_11111
                                                                                                                  solve( State_111112( ~prog_1,
                                                                                                                                       a,
                                                                                                                                       b,
                                                                                                                                       kEnc,
                                                                                                                                       kSign
                                                                                                                         ) ▶₀ #t2.9 )
                                                                                                                    case Par_11111
                                                                                                                    solve( !KU( senc(<
                                                                                                                                      seq, 
                                                                                                                                      ~n.4, 
                                                                                                                                      $pad, 
                                                                                                                                      mac(<
                                                                                                                                           $MH, 
                                                                                                                                           $SH, 
                                                                                                                                           seq, 
                                                                                                                                           ~n.4, 
                                                                                                                                           $pad
                                                                                                                                          >,
                                                                                                                                          ~n.3)
                                                                                                                                     >,
                                                                                                                                     ~n.2)
                                                                                                                           ) @ #vk.10 )
                                                                                                                      case out_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__111111111111
                                                                                                                      solve( MID_Receiver( ~x
                                                                                                                             ) ▶₂ #j.3 )
                                                                                                                        case MessageID_rule_
                                                                                                                        solve( State_111111( ~prog_1,
                                                                                                                                             a,
                                                                                                                                             b,
                                                                                                                                             kEnc,
                                                                                                                                             kSign
                                                                                                                               ) ▶₀ #t2.9 )
                                                                                                                          case Par_11111
                                                                                                                          solve( State_111112( ~prog_1,
                                                                                                                                               a,
                                                                                                                                               b,
                                                                                                                                               kEnc,
                                                                                                                                               kSign
                                                                                                                                 ) ▶₀ #t2.9 )
                                                                                                                            case Par_11111
                                                                                                                            solve( State_11111111( ~lock8.2,
                                                                                                                                                   ~prog_1.1,
                                                                                                                                                   ~prog_11111111,
                                                                                                                                                   a,
                                                                                                                                                   b,
                                                                                                                                                   kEnc,
                                                                                                                                                   kSign
                                                                                                                                   ) ▶₀ #t2.9 )
                                                                                                                              case lock_a_b__1111111
                                                                                                                              solve( State_11111111111111( ~lock8.2,
                                                                                                                                                           ~prog_1.1,
                                                                                                                                                           ~prog_11111111.2,
                                                                                                                                                           ~prog_1111111111,
                                                                                                                                                           a,
                                                                                                                                                           b,
                                                                                                                                                           kEnc,
                                                                                                                                                           kSign,
                                                                                                                                                           m,
                                                                                                                                                           seq.1
                                                                                                                                     ) ▶₀ #t2.9 )
                                                                                                                                case unlock_a_b__1111111111111
                                                                                                                                solve( MID_Receiver( ~x
                                                                                                                                       ) ▶₂ #j.3 )
                                                                                                                                  case MessageID_rule_
                                                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                                                       a,
                                                                                                                                                       b,
                                                                                                                                                       kEnc,
                                                                                                                                                       kSign
                                                                                                                                         ) ▶₀ #t2.9 )
                                                                                                                                    case Par_11111
                                                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                                                         a,
                                                                                                                                                         b,
                                                                                                                                                         kEnc,
                                                                                                                                                         kSign
                                                                                                                                           ) ▶₀ #t2.9 )
                                                                                                                                      case Par_11111
                                                                                                                                      solve( State_111111( ~prog_1,
                                                                                                                                                           a,
                                                                                                                                                           b,
                                                                                                                                                           kEnc,
                                                                                                                                                           kSign
                                                                                                                                             ) ▶₀ #t2.9 )
                                                                                                                                        case Par_11111
                                                                                                                                        solve( State_111112( ~prog_1,
                                                                                                                                                             a,
                                                                                                                                                             b,
                                                                                                                                                             kEnc,
                                                                                                                                                             kSign
                                                                                                                                               ) ▶₀ #t2.9 )
                                                                                                                                          case Par_11111
                                                                                                                                          solve( State_11111111( ~lock8.2,
                                                                                                                                                                 ~prog_1.1,
                                                                                                                                                                 ~prog_11111111,
                                                                                                                                                                 a,
                                                                                                                                                                 b,
                                                                                                                                                                 kEnc,
                                                                                                                                                                 kSign
                                                                                                                                                 ) ▶₀ #t2.9 )
                                                                                                                                            case lock_a_b__1111111
                                                                                                                                            solve( State_111111( ~prog_1,
                                                                                                                                                                 a,
                                                                                                                                                                 b,
                                                                                                                                                                 kEnc,
                                                                                                                                                                 kSign
                                                                                                                                                   ) ▶₀ #t2.9 )
                                                                                                                                              case Par_11111
                                                                                                                                              solve( State_111112( ~prog_1,
                                                                                                                                                                   a,
                                                                                                                                                                   b,
                                                                                                                                                                   kEnc,
                                                                                                                                                                   kSign
                                                                                                                                                     ) ▶₀ #t2.9 )
                                                                                                                                                case Par_11111
                                                                                                                                                solve( !KU( senc(<
                                                                                                                                                                  (
                                                                                                                                                                   dif+
                                                                                                                                                                   seq
                                                                                                                                                                  ), 
                                                                                                                                                                  ~n.5, 
                                                                                                                                                                  $pad.1, 
                                                                                                                                                                  mac(<
                                                                                                                                                                       $MH.1, 
                                                                                                                                                                       $SH.1, 
                                                                                                                                                                       (
                                                                                                                                                                        dif+
                                                                                                                                                                        seq
                                                                                                                                                                       ), 
                                                                                                                                                                       ~n.5, 
                                                                                                                                                                       $pad.1
                                                                                                                                                                      >,
                                                                                                                                                                      ~n.3)
                                                                                                                                                                 >,
                                                                                                                                                                 ~n.2)
                                                                                                                                                       ) @ #vk.15 )
                                                                                                                                                  case out_r_MH_SH_senc_seq_m_pad_mac_MH_SH_seq_m_pad_kSign_kEnc__111111111111
                                                                                                                                                  solve( MID_Receiver( ~x.1
                                                                                                                                                         ) ▶₂ #j.3 )
                                                                                                                                                    case MessageID_rule_
                                                                                                                                                    solve( State_111111( ~prog_1,
                                                                                                                                                                         a,
                                                                                                                                                                         b,
                                                                                                                                                                         kEnc,
                                                                                                                                                                         kSign
                                                                                                                                                           ) ▶₀ #t2.9 )
                                                                                                                                                      case Par_11111
                                                                                                                                                      solve( State_111112( ~prog_1,
                                                                                                                                                                           a,
                                                                                                                                                                           b,
                                                                                                                                                                           kEnc,
                                                                                                                                                                           kSign
                                                                                                                                                             ) ▶₀ #t2.9 )
                                                                                                                                                        case Par_11111
                                                                                                                                                        solve( State_11111111( ~lock8.2,
                                                                                                                                                                               ~prog_1.1,
                                                                                                                                                                               ~prog_11111111.1,
                                                                                                                                                                               a,
                                                                                                                                                                               b,
                                                                                                                                                                               kEnc,
                                                                                                                                                                               kSign
                                                                                                                                                               ) ▶₀ #t2.9 )
                                                                                                                                                          case lock_a_b__1111111
                                                                                                                                                          solve( State_11111111111111( ~lock8.2,
                                                                                                                                                                                       ~prog_1.1,
                                                                                                                                                                                       ~prog_11111111.2,
                                                                                                                                                                                       ~prog_1111111111.1,
                                                                                                                                                                                       a,
                                                                                                                                                                                       b,
                                                                                                                                                                                       kEnc,
                                                                                                                                                                                       kSign,
                                                                                                                                                                                       m,
                                                                                                                                                                                       seq.1
                                                                                                                                                                 ) ▶₀ #t2.9 )
                                                                                                                                                            case unlock_a_b__1111111111111
                                                                                                                                                            solve( MID_Receiver( ~x.1
                                                                                                                                                                   ) ▶₂ #j.3 )
                                                                                                                                                              case MessageID_rule_
                                                                                                                                                              solve( State_111111( ~prog_1,
                                                                                                                                                                                   a,
                                                                                                                                                                                   b,
                                                                                                                                                                                   kEnc,
                                                                                                                                                                                   kSign
                                                                                                                                                                     ) ▶₀ #t2.9 )
                                                                                                                                                                case Par_11111
                                                                                                                                                                solve( State_111112( ~prog_1,
                                                                                                                                                                                     a,
                                                                                                                                                                                     b,
                                                                                                                                                                                     kEnc,
                                                                                                                                                                                     kSign
                                                                                                                                                                       ) ▶₀ #t2.9 )
                                                                                                                                                                  case Par_11111
                                                                                                                                                                  solve( State_111111( ~prog_1,
                                                                                                                                                                                       a,
                                                                                                                                                                                       b,
                                                                                                                                                                                       kEnc,
                                                                                                                                                                                       kSign
                                                                                                                                                                         ) ▶₀ #t2.9 )
                                                                                                                                                                    case Par_11111
                                                                                                                                                                    solve( State_111112( ~prog_1,
                                                                                                                                                                                         a,
                                                                                                                                                                                         b,
                                                                                                                                                                                         kEnc,
                                                                                                                                                                                         kSign
                                                                                                                                                                           ) ▶₀ #t2.9 )
                                                                                                                                                                      case Par_11111
                                                                                                                                                                      solve( State_11111111( ~lock8.2,
                                                                                                                                                                                             ~prog_1.1,
                                                                                                                                                                                             ~prog_11111111.1,
                                                                                                                                                                                             a,
                                                                                                                                                                                             b,
                                                                                                                                                                                             kEnc,
                                                                                                                                                                                             kSign
                                                                                                                                                                             ) ▶₀ #t2.9 )
                                                                                                                                                                        case lock_a_b__1111111
                                                                                                                                                                        solve( State_111111( ~prog_1,
                                                                                                                                                                                             a,
                                                                                                                                                                                             b,
                                                                                                                                                                                             kEnc,
                                                                                                                                                                                             kSign
                                                                                                                                                                               ) ▶₀ #t2.9 )
                                                                                                                                                                          case Par_11111
                                                                                                                                                                          solve( State_111112( ~prog_1,
                                                                                                                                                                                               a,
                                                                                                                                                                                               b,
                                                                                                                                                                                               kEnc,
                                                                                                                                                                                               kSign
                                                                                                                                                                                 ) ▶₀ #t2.9 )
                                                                                                                                                                            case Par_11111
                                                                                                                                                                            SOLVED // trace found
                                                                                                                                                                          qed
                                                                                                                                                                        qed
                                                                                                                                                                      qed
                                                                                                                                                                    qed
                                                                                                                                                                  qed
                                                                                                                                                                qed
                                                                                                                                                              qed
                                                                                                                                                            qed
                                                                                                                                                          qed
                                                                                                                                                        qed
                                                                                                                                                      qed
                                                                                                                                                    qed
                                                                                                                                                  qed
                                                                                                                                                qed
                                                                                                                                              qed
                                                                                                                                            qed
                                                                                                                                          qed
                                                                                                                                        qed
                                                                                                                                      qed
                                                                                                                                    qed
                                                                                                                                  qed
                                                                                                                                qed
                                                                                                                              qed
                                                                                                                            qed
                                                                                                                          qed
                                                                                                                        qed
                                                                                                                      qed
                                                                                                                    qed
                                                                                                                  qed
                                                                                                                qed
                                                                                                              qed
                                                                                                            qed
                                                                                                          qed
                                                                                                        qed
                                                                                                      qed
                                                                                                    qed
                                                                                                  qed
                                                                                                qed
                                                                                              qed
                                                                                            qed
                                                                                          qed
                                                                                        qed
                                                                                      qed
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

/* All well-formedness checks were successful. */

end
/* Output
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.
SAPIC tool: 'sapic'
Checking availablity ... OK.


analyzing: case-studies-sapic-regression/SCADA/opc_ua_secure_conversation.spthy

------------------------------------------------------------------------------
analyzed: case-studies-sapic-regression/SCADA/opc_ua_secure_conversation.spthy

  output:          case-studies-sapic-regression/SCADA/opc_ua_secure_conversation.spthy.tmp
  processing time: 45.625396s
  Executable (exists-trace): verified (38 steps)
  all_received_were_sent (all-traces): verified (18 steps)
  all_received_were_sent_injective (all-traces): verified (188 steps)
  order (all-traces): verified (270 steps)
  delivery (all-traces): falsified - found trace (36 steps)
  delivery_order (all-traces): falsified - found trace (88 steps)

------------------------------------------------------------------------------

==============================================================================
summary of summaries:

analyzed: case-studies-sapic-regression/SCADA/opc_ua_secure_conversation.spthy

  output:          case-studies-sapic-regression/SCADA/opc_ua_secure_conversation.spthy.tmp
  processing time: 45.625396s
  Executable (exists-trace): verified (38 steps)
  all_received_were_sent (all-traces): verified (18 steps)
  all_received_were_sent_injective (all-traces): verified (188 steps)
  order (all-traces): verified (270 steps)
  delivery (all-traces): falsified - found trace (36 steps)
  delivery_order (all-traces): falsified - found trace (88 steps)

==============================================================================
*/
