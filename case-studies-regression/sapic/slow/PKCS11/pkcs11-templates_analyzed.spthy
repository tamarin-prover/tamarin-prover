theory PKCS11TemplatePolicy begin

// Function signature and definition of the equational theory E

functions: attdec/1, attenc/1, attextr/1, attsens/1, atttrus/1,
           attunwrap/1, attut/1, attwrap/1, attwt/1, attwwt/1, fst/1, key/1, pair/2,
           sdec/2, senc/2, snd/1, tem/1
equations:
    attdec(<wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, ut>) = dec,
    attenc(<wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, ut>) = enc,
    attextr(<wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, ut>) = extr,
    attsens(<wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, ut>) = sens,
    atttrus(<wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, ut>) = trus,
    attunwrap(<wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, ut>)
  = unwrap,
    attut(<wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, ut>) = ut,
    attwrap(<wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, ut>) = wrap,
    attwt(<wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, ut>) = wt,
    attwwt(<wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, ut>) = wwt,
    fst(<x.1, x.2>) = x.1,
    key(<k, templ>) = k,
    sdec(senc(x.1, x.2), x.2) = x.1,
    snd(<x.1, x.2>) = x.2,
    tem(<k, templ>) = templ



heuristic: p



predicate: Can_encrypt( wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, ut
)<=>enc = 'on'

predicate: Can_decrypt( wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, ut
)<=>dec = 'on'

predicate: Can_wrap( wrap1, unwrap1, enc1, dec1, sens1, extr1, trus1, wwt1,
          wt1, ut1, wrap2, unwrap2, enc2, dec2, sens2, extr2, trus2, wwt2,
          wt2, ut2
)<=>((wrap1 = 'on') ∧ (extr2 = 'on')) ∧
((wwt2 = 'off') ∨ ((wwt2 = 'on') ∧ (trus1 = 'on')))

predicate: Can_unwrap( wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, ut )<=>unwrap = 'on'

predicate: Can_get_keyvalue( wrap, unwrap, enc, dec, sens, extr, trus, wwt,
                  wt, ut
)<=>sens = 'off'

predicate: Permits( t_wrap, t_unwrap, t_enc, t_dec, t_sens, t_extr, t_trus,
         t_wwt, t_wt, t_ut, wrap, unwrap, enc, dec, sens, extr, trus, wwt,
         wt, ut
)<=>(((((((((t_wrap = wrap) ∧ (t_unwrap = unwrap)) ∧ (t_enc = enc)) ∧
      (t_dec = dec)) ∧
     (t_sens = sens)) ∧
    (t_extr = extr)) ∧
   (t_trus = trus)) ∧
  (t_wwt = wwt)) ∧
 (t_wt = wt)) ∧
(t_ut = ut)















lemma dec_limits [use_induction, reuse]:
  all-traces
  "(((((∀ k m #t1.
         (DecUsing( k, m ) @ #t1) ⇒
         (((((∃ h2 k2 #t2 #t3.
               (((NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)) ∧ (#t2 < #t1)) ∧
               (#t3 < #t1)) ∨
             (∃ h2 #t2 #t3 #t4.
               (((((NewKey( h2, k, 'off' ) @ #t2) ∧ (!KU( k ) @ #t3)) ∧
                  (!KU( m ) @ #t4)) ∧
                 (#t2 < #t1)) ∧
                (#t3 < #t1)) ∧
               (#t4 < #t1))) ∨
            (∃ #t2. (EncUsing( k, m ) @ #t2) ∧ (#t2 < #t1))) ∨
           (∃ h2 k2 #t2 #t3 a.
             (((Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)) ∧ (#t2 < #t1)) ∧
             (#t3 < #t1))) ∨
          (∃ #t2 #t3 h1 h2 k2.
            (((WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)) ∧
             (#t2 < #t1)) ∧
            (#t3 < #t1)))) ∧
       (∀ k #t2.
         (GetKeyValue( k ) @ #t2) ⇒ (∃ L_h #t1. NewKey( L_h, k, 'off' ) @ #t1))) ∧
      (¬(∃ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
          Insert( <'obj', L_h>,
                  <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'trusted'>
          ) @ #t))) ∧
     (¬(∃ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
         Insert( <'obj', L_h>,
                 <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'untrusted'>
         ) @ #t))) ∧
    (¬(∃ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
        Insert( <'obj', L_h>,
                <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'trusted', ut>
        ) @ #t))) ∧
   (¬(∃ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
       Insert( <'obj', L_h>,
               <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'untrusted', ut>
       ) @ #t))"
/*
guarded formula characterizing all counter-examples:
"((∃ k m #t1.
    (DecUsing( k, m ) @ #t1)
   ∧
    (∀ h2 k2 #t2 #t3.
      (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
     ⇒
      ((¬(#t2 < #t1)) ∨ (¬(#t3 < #t1)))) ∧
    (∀ h2 #t2 #t3 #t4.
      (NewKey( h2, k, 'off' ) @ #t2) ∧ (!KU( k ) @ #t3) ∧ (!KU( m ) @ #t4)
     ⇒
      ((¬(#t2 < #t1)) ∨ (¬(#t3 < #t1)) ∨ (¬(#t4 < #t1)))) ∧
    (∀ #t2. (EncUsing( k, m ) @ #t2) ⇒ ¬(#t2 < #t1)) ∧
    (∀ h2 k2 #t2 #t3 a.
      (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
     ⇒
      ((¬(#t2 < #t1)) ∨ (¬(#t3 < #t1)))) ∧
    (∀ #t2 #t3 h1 h2 k2.
      (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
     ⇒
      ((¬(#t2 < #t1)) ∨ (¬(#t3 < #t1))))) ∨
  (∃ k #t2.
    (GetKeyValue( k ) @ #t2)
   ∧
    ∀ L_h #t1. (NewKey( L_h, k, 'off' ) @ #t1) ⇒ ⊥) ∨
  (∃ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
    (Insert( <'obj', L_h>,
             <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'trusted'>
     ) @ #t)) ∨
  (∃ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
    (Insert( <'obj', L_h>,
             <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'untrusted'>
     ) @ #t)) ∨
  (∃ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
    (Insert( <'obj', L_h>,
             <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'trusted', ut>
     ) @ #t)) ∨
  (∃ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
    (Insert( <'obj', L_h>,
             <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'untrusted', ut>
     ) @ #t)))"
*/
induction
  case empty_trace
  by contradiction /* from formulas */
next
  case non_empty_trace
  simplify
  solve( (∃ k m #t1.
           (DecUsing( k, m ) @ #t1)
          ∧
           (∀ h2 k2 #t2 #t3.
             (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
            ⇒
             ((¬(#t2 < #t1)) ∨ (¬(#t3 < #t1)))) ∧
           (∀ h2 #t2 #t3 #t4.
             (NewKey( h2, k, 'off' ) @ #t2) ∧ (!KU( k ) @ #t3) ∧ (!KU( m ) @ #t4)
            ⇒
             ((¬(#t2 < #t1)) ∨ (¬(#t3 < #t1)) ∨ (¬(#t4 < #t1)))) ∧
           (∀ #t2. (EncUsing( k, m ) @ #t2) ⇒ ¬(#t2 < #t1)) ∧
           (∀ h2 k2 #t2 #t3 a.
             (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
            ⇒
             ((¬(#t2 < #t1)) ∨ (¬(#t3 < #t1)))) ∧
           (∀ #t2 #t3 h1 h2 k2.
             (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
            ⇒
             ((¬(#t2 < #t1)) ∨ (¬(#t3 < #t1)))))  ∥
         (∃ k #t2.
           (GetKeyValue( k ) @ #t2)
          ∧
           ∀ L_h #t1. (NewKey( L_h, k, 'off' ) @ #t1) ⇒ ⊥)  ∥
         (∃ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
           (Insert( <'obj', L_h>,
                    <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'trusted'>
            ) @ #t))  ∥
         (∃ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
           (Insert( <'obj', L_h>,
                    <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'untrusted'>
            ) @ #t))  ∥
         (∃ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
           (Insert( <'obj', L_h>,
                    <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'trusted', ut>
            ) @ #t))  ∥
         (∃ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
           (Insert( <'obj', L_h>,
                    <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'untrusted', ut>
            ) @ #t)) )
    case case_1
    solve( ((∀ k m #t1.
              (DecUsing( k, m ) @ #t1)
             ⇒
              ((last(#t1)) ∨
               (∃ h2 k2 #t2 #t3.
                 (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)) ∨
               (∃ h2 #t2 #t3 #t4.
                 (NewKey( h2, k, 'off' ) @ #t2) ∧ (!KU( k ) @ #t3) ∧ (!KU( m ) @ #t4)
                ∧
                 (¬(last(#t4))) ∧
                 (¬(last(#t3))) ∧
                 (¬(last(#t2))) ∧
                 (#t2 < #t1) ∧
                 (#t3 < #t1) ∧
                 (#t4 < #t1)) ∨
               (∃ #t2. (EncUsing( k, m ) @ #t2) ∧ (¬(last(#t2))) ∧ (#t2 < #t1)) ∨
               (∃ h2 k2 #t2 #t3 a.
                 (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)) ∨
               (∃ #t2 #t3 h1 h2 k2.
                 (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)))) ∧
            (∀ k #t2.
              (GetKeyValue( k ) @ #t2)
             ⇒
              ((last(#t2)) ∨
               (∃ L_h #t1. (NewKey( L_h, k, 'off' ) @ #t1) ∧ ¬(last(#t1))))) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'trusted'>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'untrusted'>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'trusted', ut>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'untrusted', ut>
               ) @ #t)
             ⇒
              last(#t)))  ∥
           (∃ x y #t3.
             (IsIn( x, y ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (∀ #t2.
               (Insert( x, y ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t1 yp.
                  (Insert( x, yp ) @ #t1)
                 ∧
                  (¬(last(#t1))) ∧
                  (((#t1 = #t2) ∨ (#t2 < #t1))) ∧
                  (¬(#t1 = #t2)) ∧
                  (((#t3 = #t1) ∨ (#t1 < #t3)))))))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_0( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_0( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_1( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_1( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_2( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_2( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_3( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_3( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_4( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_4( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_5( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_5( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3))) )
      case case_1
      solve( (last(#t1))  ∥
             (∃ h2 k2 #t2 #t3.
               (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
              ∧
               (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1))  ∥
             (∃ h2 #t2 #t3 #t4.
               (NewKey( h2, k, 'off' ) @ #t2) ∧ (!KU( k ) @ #t3) ∧ (!KU( m ) @ #t4)
              ∧
               (¬(last(#t4))) ∧
               (¬(last(#t3))) ∧
               (¬(last(#t2))) ∧
               (#t2 < #t1) ∧
               (#t3 < #t1) ∧
               (#t4 < #t1))  ∥
             (∃ #t2. (EncUsing( k, m ) @ #t2) ∧ (¬(last(#t2))) ∧ (#t2 < #t1))  ∥
             (∃ h2 k2 #t2 #t3 a.
               (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
              ∧
               (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1))  ∥
             (∃ #t2 #t3 h1 h2 k2.
               (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
              ∧
               (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)) )
        case case_1
        solve( State_111111112111111( lock, m, v, L_h, k ) ▶₀ #t1 )
          case ifkeyvk_0_11111111211111
          solve( !KU( senc(m, k) ) @ #vk.2 )
            case c_senc
            solve( Insert( <'obj', L_h>,
                           <k, x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                   ) @ #t2 )
              case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
              solve( State_1111121111111( <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, 
                                           x.8>,
                                          <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>, k.1, k, v, L_h,
                                          lock
                     ) ▶₀ #t2 )
                case lookupFtemplateattuttemvasut_0_111112111111
                solve( Insert( <'F_template', z>,
                               <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                       ) @ #t2.2 )
                  case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                  by contradiction /* cyclic */
                next
                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                  solve( (#vr.6 < #t2.2)  ∥ (#vr.6 = #t2.2) )
                    case case_1
                    solve( State_1111121111111111111111( ut, atts, h2, k.2, m.1, v, L_h.1,
                                                         ~n.2
                           ) ▶₀ #t2.1 )
                      case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_2
                    solve( State_1111121111111111111111( ut, atts, h2, k.2, m.1, v, L_h.1,
                                                         ~n.2
                           ) ▶₀ #t2.1 )
                      case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            next
              case insertobjLhkatts_0_11111111111111111
              solve( State_11111111111111111( lock, L_h,
                                              <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>, k, ptr, templ
                     ) ▶₀ #t2 )
                case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                solve( Insert( <'F_template', ptr>,
                               <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                       ) @ #t2.2 )
                  case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                  by contradiction /* from formulas */
                next
                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                  by contradiction /* from formulas */
                qed
              qed
            qed
          next
            case eventDecUsingkm_0_111111112111111
            solve( (∃ h2 k2 #t2 #t3.
                     (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                    ∧
                     (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #vr.9) ∧ (#t3 < #vr.9))  ∥
                   (∃ h2 #t2 #t3 #t4.
                     (NewKey( h2, k.1, 'off' ) @ #t2) ∧ (!KU( k.1 ) @ #t3) ∧ (!KU( t ) @ #t4)
                    ∧
                     (¬(last(#t4))) ∧
                     (¬(last(#t3))) ∧
                     (¬(last(#t2))) ∧
                     (#t2 < #vr.9) ∧
                     (#t3 < #vr.9) ∧
                     (#t4 < #vr.9))  ∥
                   (∃ #t2. (EncUsing( k.1, t ) @ #t2) ∧ (¬(last(#t2))) ∧ (#t2 < #vr.9))  ∥
                   (∃ h2 k2 #t2 #t3 a.
                     (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                    ∧
                     (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #vr.9) ∧ (#t3 < #vr.9))  ∥
                   (∃ #t2 #t3 h1 h2 k2.
                     (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
                    ∧
                     (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #vr.9) ∧ (#t3 < #vr.9)) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* cyclic */
            next
              case case_3
              solve( State_11111111211111111( ~n.1, m.1, v, L_h.1, k.1 ) ▶₀ #t2 )
                case eventDecUsingkm_0_111111112111111
                solve( (#t2.3 < #t2.4)  ∥ (#t2.3 = #t2.4) )
                  case case_1
                  by contradiction /* from formulas */
                next
                  case case_2
                  solve( State_111111121111( lock, t,
                                             <k.1, x.18, x.19, 'on', x.20, x.21, x.22, x.23, x.24, x.25, x.26
                                             >,
                                             L_h.2
                         ) ▶₀ #t2.1 )
                    case lookupobjLhasv_0_11111112111
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            next
              case case_4
              by contradiction /* from formulas */
            next
              case case_5
              by contradiction /* from formulas */
            qed
          next
            case ifCanencryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111121111
            by contradiction /* from formulas */
          next
            case ifCangetkeyvalueattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111121111
            solve( State_111111111111111( lock, L_h.2,
                                          <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>, t, ptr,
                                          <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>
                   ) ▶₀ #t1.1 )
              case lookupFtemplateptrastempl_0_11111111111111
              by contradiction /* impossible chain */
            qed
          next
            case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_1
            solve( (z.8 = 'off')  ∥ ((z.8 = 'on') ∧ (z = 'on')) )
              case case_1
              solve( Insert( <'F_template', z.1>,
                             <z.2, z.3, z.4, z.5, z.6, 'on', z.7, 'off', z.8, z.9>
                     ) @ #t2.2 )
                case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                by contradiction /* cyclic */
              qed
            next
              case case_2
              solve( Insert( <'F_template', z>,
                             <z.1, z.2, z.3, z.4, z.5, 'on', z.6, 'on', z.7, z.8>
                     ) @ #t2.2 )
                case insertFtemplatetrustedononoffoffononononusageusage_0_
                by contradiction /* cyclic */
              next
                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                solve( (#vr.6 < #t2.1)  ∥ (#vr.6 = #t2.1) )
                  case case_1
                  solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.1 ) ▶₀ #t2 )
                    case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                    solve( (#t2.4 < #t2.7)  ∥ (#t2.4 = #t2.7) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      solve( (#t2.3 < #t2.6)  ∥ (#t2.3 = #t2.6) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        solve( (#vr.6 < #t2.5)  ∥ (#vr.6 = #t2.5) )
                          case case_1
                          solve( (#t2.1 < #t2.5)  ∥ (#t2.1 = #t2.5) )
                            case case_1
                            by contradiction /* from formulas */
                          next
                            case case_2
                            solve( State_1( ) ▶₀ #t2.1 )
                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                              by contradiction /* cyclic */
                            qed
                          qed
                        next
                          case case_2
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  qed
                next
                  case case_2
                  solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.1 ) ▶₀ #t2 )
                    case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                    solve( (#t2.4 < #t2.7)  ∥ (#t2.4 = #t2.7) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      solve( (#t2.1 < #t2.5)  ∥ (#t2.1 = #t2.5) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        solve( (#t2.3 < #t2.5)  ∥ (#t2.3 = #t2.5) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( Insert( <'obj', L_h>,
                                         <k, x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                                 ) @ #t2.2 )
                            case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                            solve( State_1111121111111( <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, 
                                                         x.8>,
                                                        <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>,
                                                        k.1, k, v, L_h, lock
                                   ) ▶₀ #t2.2 )
                              case lookupFtemplateattuttemvasut_0_111112111111
                              solve( (#vr.19 < #vr.13)  ∥ (#t2 < #vr.19) )
                                case case_1
                                solve( Insert( <'F_template', z>,
                                               <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                                       ) @ #t2.6 )
                                  case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                                  by contradiction /* cyclic */
                                next
                                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                  solve( (#t2.4 < #t2.1)  ∥ (#t2.4 = #t2.1)  ∥ (#vr.9 < #t2.4) )
                                    case case_1
                                    by contradiction /* from formulas */
                                  next
                                    case case_2
                                    solve( State_1111121111111111111111( ut, atts, h2.1, k.2, m.1, v, L_h.1,
                                                                         ~n.3
                                           ) ▶₀ #t2.3 )
                                      case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                      solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( (#t2.1 < #t2.7)  ∥ (#t2.1 = #t2.7) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( Insert( <'obj', h2>,
                                                         <m, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                          'on', 'undef', 'undef'>
                                                 ) @ #t2.4 )
                                            case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                            solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 
                                                                         'on', 'off', 'on', 'undef', 'undef'>,
                                                                        <'off', 'off', 'on', 'on', 'on', 
                                                                         'on', 'off', 'on', 'undef', 'undef'>,
                                                                        k.2, m, v, L_h.1, lock
                                                   ) ▶₀ #t2.4 )
                                              case lookupFtemplateattuttemvasut_0_111112111111
                                              solve( ((#vr.19 < #vr.30) ∧
                                                      (∃ #t2.
                                                        (Unlock_4( '4', ~n.4, 'device' ) @ #t2)
                                                       ∧
                                                        (#vr.19 < #t2) ∧
                                                        (#t2 < #vr.30) ∧
                                                        (∀ #t0 pp.
                                                          (Unlock( pp, ~n.4, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                        (∀ pp lpp #t0.
                                                          (Lock( pp, lpp, 'device' ) @ #t0)
                                                         ⇒
                                                          ((#t0 < #vr.19) ∨ (#t0 = #vr.19) ∨ (#t2 < #t0))) ∧
                                                        (∀ pp lpp #t0.
                                                          (Unlock( pp, lpp, 'device' ) @ #t0)
                                                         ⇒
                                                          ((#t0 < #vr.19) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                                     (#vr.30 < #vr.19)  ∥ (#vr.19 = #vr.30) )
                                                case case_1
                                                solve( Insert( <'F_template', z>,
                                                               <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                                'on', 'undef', 'undef'>
                                                       ) @ #t2.8 )
                                                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                  solve( (#t2.6 < #t2.1)  ∥ (#t2.6 = #t2.1)  ∥
                                                         (#vr.15 < #t2.6) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( State_1111121111111111111111( ut, atts, h2, k.3,
                                                                                         m.1, v, L_h.2, ~n.5
                                                           ) ▶₀ #t2.5 )
                                                      case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                      solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.9 < #t2.1)  ∥ (#t2.9 = #t2.1)  ∥
                                                               (#vr.15 < #t2.9) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( Insert( <'obj', h1>,
                                                                         <k, 'on', x, x.1, x.2, x.3, x.4, 
                                                                          'on', x.5, 'usage', x.6>
                                                                 ) @ #t2.6 )
                                                            case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                            solve( State_1111121111111( <'on', x, x.1, x.2, 
                                                                                         x.3, x.4, 'on', x.5, 
                                                                                         'usage', x.6>,
                                                                                        <'on', x, x.1, x.2, 
                                                                                         x.3, x.4, 'on', x.5, 
                                                                                         'usage', x.6>,
                                                                                        k.3, k, v, L_h.2, lock
                                                                   ) ▶₀ #t2.6 )
                                                              case lookupFtemplateattuttemvasut_0_111112111111
                                                              solve( (#vr.41 < #vr.19)  ∥ (#t2.3 < #vr.41) )
                                                                case case_1
                                                                solve( Insert( <'F_template', z>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.10 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  by contradiction /* cyclic */
                                                                qed
                                                              next
                                                                case case_2
                                                                solve( (#vr.41 < #vr.30)  ∥ (#t2.5 < #vr.41) )
                                                                  case case_1
                                                                  solve( Insert( <'F_template', z>,
                                                                                 <'on', x, x.1, x.2, x.3, 
                                                                                  x.4, 'on', x.5, 'usage', x.6
                                                                                 >
                                                                         ) @ #t2.10 )
                                                                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                    by contradiction /* cyclic */
                                                                  qed
                                                                next
                                                                  case case_2
                                                                  solve( Insert( <'F_template', z>,
                                                                                 <'on', x, x.1, x.2, x.3, 
                                                                                  x.4, 'on', x.5, 'usage', x.6
                                                                                 >
                                                                         ) @ #t2.10 )
                                                                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                    by contradiction /* cyclic */
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case insertobjLhkatts_0_11111111111111111
                                                            solve( State_11111111111111111( lock, h1,
                                                                                            <'on', x, x.1, 
                                                                                             x.2, x.3, x.4, 
                                                                                             'on', x.5, 
                                                                                             'usage', x.6>,
                                                                                            k, ptr, templ
                                                                   ) ▶₀ #t2.6 )
                                                              case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                              solve( Insert( <'F_template', ptr>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                solve( (#vr.6 < #t2.8)  ∥ (#vr.6 = #t2.8) )
                                                                  case case_1
                                                                  solve( State_11111111111111111111111( ~n.8,
                                                                                                        L_h.2,
                                                                                                        atts,
                                                                                                        k.2,
                                                                                                        ptr,
                                                                                                        templ
                                                                         ) ▶₀ #t2.7 )
                                                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                    by contradiction /* from formulas */
                                                                  qed
                                                                next
                                                                  case case_2
                                                                  solve( State_11111111111111111111111( ~n.8,
                                                                                                        L_h.2,
                                                                                                        atts,
                                                                                                        k.2,
                                                                                                        ptr,
                                                                                                        templ
                                                                         ) ▶₀ #t2.7 )
                                                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                    by contradiction /* from formulas */
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_3
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  next
                                                    case case_3
                                                    by contradiction /* from formulas */
                                                  qed
                                                qed
                                              next
                                                case case_2
                                                solve( Insert( <'F_template', z>,
                                                               <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                                'on', 'undef', 'undef'>
                                                       ) @ #t2.8 )
                                                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                  solve( (#t2.6 < #t2.1)  ∥ (#t2.6 = #t2.1)  ∥
                                                         (#vr.15 < #t2.6) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( State_1111121111111111111111( ut, atts, h2, k.3,
                                                                                         m.1, v, L_h.2, ~n.5
                                                           ) ▶₀ #t2.5 )
                                                      case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                      solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.1 < #t2.9)  ∥ (#t2.1 = #t2.9) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( Insert( <'obj', h1>,
                                                                         <k, 'on', x, x.1, x.2, x.3, x.4, 
                                                                          'on', x.5, 'usage', x.6>
                                                                 ) @ #t2.6 )
                                                            case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                            solve( State_1111121111111( <'on', x, x.1, x.2, 
                                                                                         x.3, x.4, 'on', x.5, 
                                                                                         'usage', x.6>,
                                                                                        <'on', x, x.1, x.2, 
                                                                                         x.3, x.4, 'on', x.5, 
                                                                                         'usage', x.6>,
                                                                                        k.3, k, v, L_h.2, lock
                                                                   ) ▶₀ #t2.6 )
                                                              case lookupFtemplateattuttemvasut_0_111112111111
                                                              solve( (#vr.41 < #vr.19)  ∥ (#t2.3 < #vr.41) )
                                                                case case_1
                                                                solve( (#vr.41 < #vr.30)  ∥ (#t2.5 < #vr.41) )
                                                                  case case_1
                                                                  solve( Insert( <'F_template', z>,
                                                                                 <'on', x, x.1, x.2, x.3, 
                                                                                  x.4, 'on', x.5, 'usage', x.6
                                                                                 >
                                                                         ) @ #t2.10 )
                                                                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                    by contradiction /* cyclic */
                                                                  qed
                                                                next
                                                                  case case_2
                                                                  solve( Insert( <'F_template', z>,
                                                                                 <'on', x, x.1, x.2, x.3, 
                                                                                  x.4, 'on', x.5, 'usage', x.6
                                                                                 >
                                                                         ) @ #t2.10 )
                                                                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                    by contradiction /* cyclic */
                                                                  qed
                                                                qed
                                                              next
                                                                case case_2
                                                                solve( Insert( <'F_template', z>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.10 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  by contradiction /* cyclic */
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case insertobjLhkatts_0_11111111111111111
                                                            solve( State_11111111111111111( lock, h1,
                                                                                            <'on', x, x.1, 
                                                                                             x.2, x.3, x.4, 
                                                                                             'on', x.5, 
                                                                                             'usage', x.6>,
                                                                                            k, ptr, templ
                                                                   ) ▶₀ #t2.6 )
                                                              case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                              solve( (#vr.39 < #vr.30)  ∥ (#t2.5 < #vr.39) )
                                                                case case_1
                                                                solve( Insert( <'F_template', ptr>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.10 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  solve( (#vr.6 < #t2.8)  ∥ (#vr.6 = #t2.8) )
                                                                    case case_1
                                                                    solve( State_11111111111111111111111( ~n.8,
                                                                                                          L_h.2,
                                                                                                          atts,
                                                                                                          k.2,
                                                                                                          ptr,
                                                                                                          templ
                                                                           ) ▶₀ #t2.7 )
                                                                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                      by contradiction /* from formulas */
                                                                    qed
                                                                  next
                                                                    case case_2
                                                                    solve( State_11111111111111111111111( ~n.8,
                                                                                                          L_h.2,
                                                                                                          atts,
                                                                                                          k.2,
                                                                                                          ptr,
                                                                                                          templ
                                                                           ) ▶₀ #t2.7 )
                                                                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                      by contradiction /* from formulas */
                                                                    qed
                                                                  qed
                                                                qed
                                                              next
                                                                case case_2
                                                                solve( Insert( <'F_template', ptr>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.10 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  solve( (#vr.6 < #t2.8)  ∥ (#vr.6 = #t2.8) )
                                                                    case case_1
                                                                    solve( State_11111111111111111111111( ~n.8,
                                                                                                          L_h.2,
                                                                                                          atts,
                                                                                                          k.2,
                                                                                                          ptr,
                                                                                                          templ
                                                                           ) ▶₀ #t2.7 )
                                                                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                      by contradiction /* from formulas */
                                                                    qed
                                                                  next
                                                                    case case_2
                                                                    solve( State_11111111111111111111111( ~n.8,
                                                                                                          L_h.2,
                                                                                                          atts,
                                                                                                          k.2,
                                                                                                          ptr,
                                                                                                          templ
                                                                           ) ▶₀ #t2.7 )
                                                                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                      by contradiction /* from formulas */
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  next
                                                    case case_3
                                                    by contradiction /* from formulas */
                                                  qed
                                                qed
                                              next
                                                case case_3
                                                solve( (#t2.5 < #t2.7)  ∥ (#t2.5 = #t2.7) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( (#t2.1 < #t2.6)  ∥ (#t2.1 = #t2.6) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( Insert( <'obj', h1>,
                                                                   <k, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                    x.5, 'usage', x.6>
                                                           ) @ #t2.4 )
                                                      case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                      solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                   x.4, 'on', x.5, 'usage', 
                                                                                   x.6>,
                                                                                  <'on', x, x.1, x.2, x.3, 
                                                                                   x.4, 'on', x.5, 'usage', 
                                                                                   x.6>,
                                                                                  k.2, k, v, L_h.1, lock
                                                             ) ▶₀ #t2.4 )
                                                        case lookupFtemplateattuttemvasut_0_111112111111
                                                        solve( (#vr.30 < #vr.19)  ∥ (#t2.3 < #vr.30) )
                                                          case case_1
                                                          solve( Insert( <'F_template', z>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.7 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* cyclic */
                                                          qed
                                                        next
                                                          case case_2
                                                          solve( Insert( <'F_template', z>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.7 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* cyclic */
                                                          qed
                                                        qed
                                                      qed
                                                    next
                                                      case insertobjLhkatts_0_11111111111111111
                                                      solve( State_11111111111111111( lock, h1,
                                                                                      <'on', x, x.1, x.2, 
                                                                                       x.3, x.4, 'on', x.5, 
                                                                                       'usage', x.6>,
                                                                                      k, ptr, templ
                                                             ) ▶₀ #t2.4 )
                                                        case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                        solve( Insert( <'F_template', ptr>,
                                                                       <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                        x.5, 'usage', x.6>
                                                               ) @ #t2.7 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          solve( (#vr.6 < #t2.6)  ∥ (#vr.6 = #t2.6) )
                                                            case case_1
                                                            solve( State_11111111111111111111111( ~n.6, L_h.1,
                                                                                                  atts, k.1,
                                                                                                  ptr, templ
                                                                   ) ▶₀ #t2.5 )
                                                              case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                              by contradiction /* from formulas */
                                                            qed
                                                          next
                                                            case case_2
                                                            solve( State_11111111111111111111111( ~n.6, L_h.1,
                                                                                                  atts, k.1,
                                                                                                  ptr, templ
                                                                   ) ▶₀ #t2.5 )
                                                              case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                              by contradiction /* from formulas */
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          next
                                            case insertobjLhkatts_0_11111111111111111
                                            solve( State_11111111111111111( lock, h2,
                                                                            <'off', 'off', 'on', 'on', 'on', 
                                                                             'on', 'off', 'on', 'undef', 
                                                                             'undef'>,
                                                                            m, ptr, templ
                                                   ) ▶₀ #t2.4 )
                                              case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                              solve( (#vr.28 < #vr.19)  ∥ (#t2.3 < #vr.28) )
                                                case case_1
                                                solve( Insert( <'F_template', ptr>,
                                                               <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                                'on', 'undef', 'undef'>
                                                       ) @ #t2.8 )
                                                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                  solve( (#t2.6 < #t2.1)  ∥ (#t2.6 = #t2.1)  ∥
                                                         (#vr.15 < #t2.6) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( State_11111111111111111111111( ~n.6, L_h.1, atts,
                                                                                          k.2, ptr, templ
                                                           ) ▶₀ #t2.5 )
                                                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                      solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( Insert( <'obj', h1>,
                                                                       <k, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                        x.5, 'usage', x.6>
                                                               ) @ #t2.6 )
                                                          case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                          solve( State_1111121111111( <'on', x, x.1, x.2, 
                                                                                       x.3, x.4, 'on', x.5, 
                                                                                       'usage', x.6>,
                                                                                      <'on', x, x.1, x.2, 
                                                                                       x.3, x.4, 'on', x.5, 
                                                                                       'usage', x.6>,
                                                                                      k.2, k, v, L_h.1, lock
                                                                 ) ▶₀ #t2.6 )
                                                            case lookupFtemplateattuttemvasut_0_111112111111
                                                            solve( (#vr.38 < #vr.19)  ∥ (#t2.3 < #vr.38) )
                                                              case case_1
                                                              solve( (#vr.38 < #vr.28)  ∥ (#t2.5 < #vr.38) )
                                                                case case_1
                                                                solve( Insert( <'F_template', z>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.9 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  by contradiction /* cyclic */
                                                                qed
                                                              next
                                                                case case_2
                                                                solve( Insert( <'F_template', z>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.9 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  by contradiction /* cyclic */
                                                                qed
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( Insert( <'F_template', z>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.9 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* cyclic */
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case insertobjLhkatts_0_11111111111111111
                                                          solve( State_11111111111111111( lock, h1,
                                                                                          <'on', x, x.1, x.2, 
                                                                                           x.3, x.4, 'on', 
                                                                                           x.5, 'usage', x.6>,
                                                                                          k, ptr, templ
                                                                 ) ▶₀ #t2.6 )
                                                            case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                            solve( (#vr.36 < #vr.28)  ∥ (#t2.5 < #vr.36) )
                                                              case case_1
                                                              solve( Insert( <'F_template', ptr>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.9 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                solve( (#vr.6 < #t2.8)  ∥ (#vr.6 = #t2.8) )
                                                                  case case_1
                                                                  solve( State_11111111111111111111111( ~n.9,
                                                                                                        L_h.1,
                                                                                                        atts,
                                                                                                        k.1,
                                                                                                        ptr,
                                                                                                        templ
                                                                         ) ▶₀ #t2.7 )
                                                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                    by contradiction /* from formulas */
                                                                  qed
                                                                next
                                                                  case case_2
                                                                  solve( State_11111111111111111111111( ~n.9,
                                                                                                        L_h.1,
                                                                                                        atts,
                                                                                                        k.1,
                                                                                                        ptr,
                                                                                                        templ
                                                                         ) ▶₀ #t2.7 )
                                                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                    by contradiction /* from formulas */
                                                                  qed
                                                                qed
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( Insert( <'F_template', ptr>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.9 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                solve( (#vr.6 < #t2.8)  ∥ (#vr.6 = #t2.8) )
                                                                  case case_1
                                                                  solve( State_11111111111111111111111( ~n.9,
                                                                                                        L_h.1,
                                                                                                        atts,
                                                                                                        k.1,
                                                                                                        ptr,
                                                                                                        templ
                                                                         ) ▶₀ #t2.7 )
                                                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                    by contradiction /* from formulas */
                                                                  qed
                                                                next
                                                                  case case_2
                                                                  solve( State_11111111111111111111111( ~n.9,
                                                                                                        L_h.1,
                                                                                                        atts,
                                                                                                        k.1,
                                                                                                        ptr,
                                                                                                        templ
                                                                         ) ▶₀ #t2.7 )
                                                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                    by contradiction /* from formulas */
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  next
                                                    case case_3
                                                    by contradiction /* from formulas */
                                                  qed
                                                qed
                                              next
                                                case case_2
                                                solve( Insert( <'F_template', ptr>,
                                                               <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                                'on', 'undef', 'undef'>
                                                       ) @ #t2.8 )
                                                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                  solve( (#t2.6 < #t2.1)  ∥ (#t2.6 = #t2.1)  ∥
                                                         (#vr.15 < #t2.6) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( State_11111111111111111111111( ~n.6, L_h.1, atts,
                                                                                          k.2, ptr, templ
                                                           ) ▶₀ #t2.5 )
                                                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                      solve( (#t2.8 < #t2.1)  ∥ (#t2.8 = #t2.1)  ∥
                                                             (#vr.15 < #t2.8) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( Insert( <'obj', h1>,
                                                                       <k, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                        x.5, 'usage', x.6>
                                                               ) @ #t2.6 )
                                                          case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                          solve( State_1111121111111( <'on', x, x.1, x.2, 
                                                                                       x.3, x.4, 'on', x.5, 
                                                                                       'usage', x.6>,
                                                                                      <'on', x, x.1, x.2, 
                                                                                       x.3, x.4, 'on', x.5, 
                                                                                       'usage', x.6>,
                                                                                      k.2, k, v, L_h.1, lock
                                                                 ) ▶₀ #t2.6 )
                                                            case lookupFtemplateattuttemvasut_0_111112111111
                                                            solve( (#vr.38 < #vr.19)  ∥ (#t2.3 < #vr.38) )
                                                              case case_1
                                                              solve( Insert( <'F_template', z>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.9 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* cyclic */
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( (#vr.38 < #vr.28)  ∥ (#t2.5 < #vr.38) )
                                                                case case_1
                                                                solve( Insert( <'F_template', z>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.9 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  by contradiction /* cyclic */
                                                                qed
                                                              next
                                                                case case_2
                                                                solve( Insert( <'F_template', z>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.9 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  by contradiction /* cyclic */
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case insertobjLhkatts_0_11111111111111111
                                                          solve( State_11111111111111111( lock, h1,
                                                                                          <'on', x, x.1, x.2, 
                                                                                           x.3, x.4, 'on', 
                                                                                           x.5, 'usage', x.6>,
                                                                                          k, ptr, templ
                                                                 ) ▶₀ #t2.6 )
                                                            case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                            solve( Insert( <'F_template', ptr>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.9 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              solve( (#vr.6 < #t2.8)  ∥ (#vr.6 = #t2.8) )
                                                                case case_1
                                                                solve( State_11111111111111111111111( ~n.9,
                                                                                                      L_h.1,
                                                                                                      atts,
                                                                                                      k.1,
                                                                                                      ptr,
                                                                                                      templ
                                                                       ) ▶₀ #t2.7 )
                                                                  case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                  by contradiction /* from formulas */
                                                                qed
                                                              next
                                                                case case_2
                                                                solve( State_11111111111111111111111( ~n.9,
                                                                                                      L_h.1,
                                                                                                      atts,
                                                                                                      k.1,
                                                                                                      ptr,
                                                                                                      templ
                                                                       ) ▶₀ #t2.7 )
                                                                  case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                  by contradiction /* from formulas */
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      next
                                                        case case_3
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  next
                                                    case case_3
                                                    by contradiction /* from formulas */
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  next
                                    case case_3
                                    solve( State_1111121111111111111111( ut, atts, h2.1, k.2, m.1, v, L_h.1,
                                                                         ~n.3
                                           ) ▶₀ #t2.3 )
                                      case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                      by contradiction /* cyclic */
                                    qed
                                  qed
                                qed
                              next
                                case case_2
                                solve( Insert( <'F_template', z>,
                                               <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                                       ) @ #t2.6 )
                                  case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                                  by contradiction /* cyclic */
                                next
                                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                  solve( (#t2.4 < #t2.1)  ∥ (#t2.4 = #t2.1)  ∥ (#vr.9 < #t2.4) )
                                    case case_1
                                    by contradiction /* from formulas */
                                  next
                                    case case_2
                                    solve( State_1111121111111111111111( ut, atts, h2.1, k.2, m.1, v, L_h.1,
                                                                         ~n.3
                                           ) ▶₀ #t2.3 )
                                      case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                      solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( (#t2.7 < #t2.1)  ∥ (#t2.7 = #t2.1)  ∥ (#vr.9 < #t2.7) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( Insert( <'obj', h2>,
                                                         <m, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                          'on', 'undef', 'undef'>
                                                 ) @ #t2.4 )
                                            case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                            solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 
                                                                         'on', 'off', 'on', 'undef', 'undef'>,
                                                                        <'off', 'off', 'on', 'on', 'on', 
                                                                         'on', 'off', 'on', 'undef', 'undef'>,
                                                                        k.2, m, v, L_h.1, lock
                                                   ) ▶₀ #t2.4 )
                                              case lookupFtemplateattuttemvasut_0_111112111111
                                              solve( Insert( <'F_template', z>,
                                                             <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                              'on', 'undef', 'undef'>
                                                     ) @ #t2.8 )
                                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                solve( (#t2.1 < #t2.6)  ∥ (#t2.1 = #t2.6) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( State_1111121111111111111111( ut, atts, h2, k.3, m.1,
                                                                                       v, L_h.2, ~n.5
                                                         ) ▶₀ #t2.5 )
                                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                    solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.1 < #t2.9)  ∥ (#t2.1 = #t2.9) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( Insert( <'obj', h1>,
                                                                       <k, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                        x.5, 'usage', x.6>
                                                               ) @ #t2.6 )
                                                          case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                          solve( State_1111121111111( <'on', x, x.1, x.2, 
                                                                                       x.3, x.4, 'on', x.5, 
                                                                                       'usage', x.6>,
                                                                                      <'on', x, x.1, x.2, 
                                                                                       x.3, x.4, 'on', x.5, 
                                                                                       'usage', x.6>,
                                                                                      k.3, k, v, L_h.2, lock
                                                                 ) ▶₀ #t2.6 )
                                                            case lookupFtemplateattuttemvasut_0_111112111111
                                                            solve( (#vr.41 < #vr.30)  ∥ (#t2.5 < #vr.41) )
                                                              case case_1
                                                              solve( Insert( <'F_template', z>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* cyclic */
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( Insert( <'F_template', z>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* cyclic */
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case insertobjLhkatts_0_11111111111111111
                                                          solve( State_11111111111111111( lock, h1,
                                                                                          <'on', x, x.1, x.2, 
                                                                                           x.3, x.4, 'on', 
                                                                                           x.5, 'usage', x.6>,
                                                                                          k, ptr, templ
                                                                 ) ▶₀ #t2.6 )
                                                            case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                            solve( (#vr.39 < #vr.30)  ∥ (#t2.5 < #vr.39) )
                                                              case case_1
                                                              solve( Insert( <'F_template', ptr>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                solve( (#vr.6 < #t2.8)  ∥ (#vr.6 = #t2.8) )
                                                                  case case_1
                                                                  solve( State_11111111111111111111111( ~n.8,
                                                                                                        L_h.2,
                                                                                                        atts,
                                                                                                        k.2,
                                                                                                        ptr,
                                                                                                        templ
                                                                         ) ▶₀ #t2.7 )
                                                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                    by contradiction /* from formulas */
                                                                  qed
                                                                next
                                                                  case case_2
                                                                  solve( State_11111111111111111111111( ~n.8,
                                                                                                        L_h.2,
                                                                                                        atts,
                                                                                                        k.2,
                                                                                                        ptr,
                                                                                                        templ
                                                                         ) ▶₀ #t2.7 )
                                                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                    by contradiction /* from formulas */
                                                                  qed
                                                                qed
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( Insert( <'F_template', ptr>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                solve( (#vr.6 < #t2.8)  ∥ (#vr.6 = #t2.8) )
                                                                  case case_1
                                                                  solve( State_11111111111111111111111( ~n.8,
                                                                                                        L_h.2,
                                                                                                        atts,
                                                                                                        k.2,
                                                                                                        ptr,
                                                                                                        templ
                                                                         ) ▶₀ #t2.7 )
                                                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                    by contradiction /* from formulas */
                                                                  qed
                                                                next
                                                                  case case_2
                                                                  solve( State_11111111111111111111111( ~n.8,
                                                                                                        L_h.2,
                                                                                                        atts,
                                                                                                        k.2,
                                                                                                        ptr,
                                                                                                        templ
                                                                         ) ▶₀ #t2.7 )
                                                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                    by contradiction /* from formulas */
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          next
                                            case insertobjLhkatts_0_11111111111111111
                                            solve( State_11111111111111111( lock, h2,
                                                                            <'off', 'off', 'on', 'on', 'on', 
                                                                             'on', 'off', 'on', 'undef', 
                                                                             'undef'>,
                                                                            m, ptr, templ
                                                   ) ▶₀ #t2.4 )
                                              case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                              solve( Insert( <'F_template', ptr>,
                                                             <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                              'on', 'undef', 'undef'>
                                                     ) @ #t2.8 )
                                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                solve( (#t2.1 < #t2.6)  ∥ (#t2.1 = #t2.6) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( State_11111111111111111111111( ~n.6, L_h.1, atts,
                                                                                        k.2, ptr, templ
                                                         ) ▶₀ #t2.5 )
                                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                    solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( Insert( <'obj', h1>,
                                                                     <k, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                      x.5, 'usage', x.6>
                                                             ) @ #t2.6 )
                                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                        solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    k.2, k, v, L_h.1, lock
                                                               ) ▶₀ #t2.6 )
                                                          case lookupFtemplateattuttemvasut_0_111112111111
                                                          solve( (#vr.38 < #vr.28)  ∥ (#t2.5 < #vr.38) )
                                                            case case_1
                                                            solve( Insert( <'F_template', z>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.9 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* cyclic */
                                                            qed
                                                          next
                                                            case case_2
                                                            solve( Insert( <'F_template', z>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.9 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* cyclic */
                                                            qed
                                                          qed
                                                        qed
                                                      next
                                                        case insertobjLhkatts_0_11111111111111111
                                                        solve( State_11111111111111111( lock, h1,
                                                                                        <'on', x, x.1, x.2, 
                                                                                         x.3, x.4, 'on', x.5, 
                                                                                         'usage', x.6>,
                                                                                        k, ptr, templ
                                                               ) ▶₀ #t2.6 )
                                                          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                          solve( (#vr.36 < #vr.28)  ∥ (#t2.5 < #vr.36) )
                                                            case case_1
                                                            solve( Insert( <'F_template', ptr>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.9 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              solve( (#vr.6 < #t2.8)  ∥ (#vr.6 = #t2.8) )
                                                                case case_1
                                                                solve( State_11111111111111111111111( ~n.9,
                                                                                                      L_h.1,
                                                                                                      atts,
                                                                                                      k.1,
                                                                                                      ptr,
                                                                                                      templ
                                                                       ) ▶₀ #t2.7 )
                                                                  case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                  by contradiction /* from formulas */
                                                                qed
                                                              next
                                                                case case_2
                                                                solve( State_11111111111111111111111( ~n.9,
                                                                                                      L_h.1,
                                                                                                      atts,
                                                                                                      k.1,
                                                                                                      ptr,
                                                                                                      templ
                                                                       ) ▶₀ #t2.7 )
                                                                  case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                  by contradiction /* from formulas */
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            solve( Insert( <'F_template', ptr>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.9 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              solve( (#vr.6 < #t2.8)  ∥ (#vr.6 = #t2.8) )
                                                                case case_1
                                                                solve( State_11111111111111111111111( ~n.9,
                                                                                                      L_h.1,
                                                                                                      atts,
                                                                                                      k.1,
                                                                                                      ptr,
                                                                                                      templ
                                                                       ) ▶₀ #t2.7 )
                                                                  case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                  by contradiction /* from formulas */
                                                                qed
                                                              next
                                                                case case_2
                                                                solve( State_11111111111111111111111( ~n.9,
                                                                                                      L_h.1,
                                                                                                      atts,
                                                                                                      k.1,
                                                                                                      ptr,
                                                                                                      templ
                                                                       ) ▶₀ #t2.7 )
                                                                  case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                                  by contradiction /* from formulas */
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        next
                                          case case_3
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  next
                                    case case_3
                                    solve( State_1111121111111111111111( ut, atts, h2.1, k.2, m.1, v, L_h.1,
                                                                         ~n.3
                                           ) ▶₀ #t2.3 )
                                      case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                      solve( (#t2.7 < #t2.9)  ∥ (#t2.7 = #t2.9) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( (#t2.8 < #t2.1)  ∥ (#t2.8 = #t2.1)  ∥ (#vr.9 < #t2.8) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          by contradiction /* from formulas */
                                        next
                                          case case_3
                                          solve( (#t2.4 < #t2.8)  ∥ (#t2.4 = #t2.8) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            solve( State_1( ) ▶₀ #t2.4 )
                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                              by contradiction /* cyclic */
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case insertobjLhkatts_0_11111111111111111
                            solve( State_11111111111111111( lock, L_h,
                                                            <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>,
                                                            k, ptr, templ
                                   ) ▶₀ #t2.2 )
                              case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                              solve( Insert( <'F_template', ptr>,
                                             <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                                     ) @ #t2.6 )
                                case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                                solve( (#vr.5 < #t2.4)  ∥ (#vr.5 = #t2.4) )
                                  case case_1
                                  solve( State_11111111111111111111111( ~n.4, L_h, atts, k, ptr, templ
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                    solve( (#t2.4 < #t2.7)  ∥ (#t2.4 = #t2.7) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      solve( State_11( ) ▶₀ #t2.4 )
                                        case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  qed
                                next
                                  case case_2
                                  solve( State_11111111111111111111111( ~n.4, L_h, atts, k, ptr, templ
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                    solve( (#t2.4 < #t2.7)  ∥ (#t2.4 = #t2.7) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      solve( Insert( <'obj', h2>,
                                                     <m, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                      'undef', 'undef'>
                                             ) @ #t2.5 )
                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                        solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                     'off', 'on', 'undef', 'undef'>,
                                                                    <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                     'off', 'on', 'undef', 'undef'>,
                                                                    k, m, v, L_h, lock
                                               ) ▶₀ #t2.5 )
                                          case lookupFtemplateattuttemvasut_0_111112111111
                                          solve( (#vr.26 < #vr.16)  ∥ (#t2.3 < #vr.26) )
                                            case case_1
                                            solve( Insert( <'F_template', z>,
                                                           <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                            'on', 'undef', 'undef'>
                                                   ) @ #t2.8 )
                                              case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                              solve( (#t2.1 < #t2.7)  ∥ (#t2.1 = #t2.7) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( State_1111121111111111111111( ut, atts, h2, k.1, m.1,
                                                                                     v, L_h.1, ~n.6
                                                       ) ▶₀ #t2.6 )
                                                  case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                  solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.1 < #t2.9)  ∥ (#t2.1 = #t2.9) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( Insert( <'obj', h1>,
                                                                     <~n.1, 'on', x, x.1, x.2, x.3, x.4, 
                                                                      'on', x.5, 'usage', x.6>
                                                             ) @ #t2.7 )
                                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                        solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    k.1, ~n.1, v, L_h.1, lock
                                                               ) ▶₀ #t2.7 )
                                                          case lookupFtemplateattuttemvasut_0_111112111111
                                                          solve( Insert( <'F_template', z>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.10 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* cyclic */
                                                          qed
                                                        qed
                                                      next
                                                        case insertobjLhkatts_0_11111111111111111
                                                        by solve( State_11111111111111111( lock, h1,
                                                                                           <'on', x, x.1, 
                                                                                            x.2, x.3, x.4, 
                                                                                            'on', x.5, 
                                                                                            'usage', x.6>,
                                                                                           ~n.1, ptr, templ
                                                                  ) ▶₀ #t2.7 )
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( Insert( <'F_template', z>,
                                                           <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                            'on', 'undef', 'undef'>
                                                   ) @ #t2.8 )
                                              case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                              solve( (#t2.1 < #t2.7)  ∥ (#t2.1 = #t2.7) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( State_1111121111111111111111( ut, atts, h2, k.1, m.1,
                                                                                     v, L_h.1, ~n.6
                                                       ) ▶₀ #t2.6 )
                                                  case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                  solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.1 < #t2.9)  ∥ (#t2.1 = #t2.9) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( Insert( <'obj', h1>,
                                                                     <~n.1, 'on', x, x.1, x.2, x.3, x.4, 
                                                                      'on', x.5, 'usage', x.6>
                                                             ) @ #t2.7 )
                                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                        solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    k.1, ~n.1, v, L_h.1, lock
                                                               ) ▶₀ #t2.7 )
                                                          case lookupFtemplateattuttemvasut_0_111112111111
                                                          solve( (#vr.37 < #vr.26)  ∥ (#t2.6 < #vr.37) )
                                                            case case_1
                                                            solve( Insert( <'F_template', z>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.10 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* cyclic */
                                                            qed
                                                          next
                                                            case case_2
                                                            solve( Insert( <'F_template', z>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.10 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* cyclic */
                                                            qed
                                                          qed
                                                        qed
                                                      next
                                                        case insertobjLhkatts_0_11111111111111111
                                                        by solve( State_11111111111111111( lock, h1,
                                                                                           <'on', x, x.1, 
                                                                                            x.2, x.3, x.4, 
                                                                                            'on', x.5, 
                                                                                            'usage', x.6>,
                                                                                           ~n.1, ptr, templ
                                                                  ) ▶₀ #t2.7 )
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case insertobjLhkatts_0_11111111111111111
                                        solve( State_11111111111111111( lock, h2,
                                                                        <'off', 'off', 'on', 'on', 'on', 
                                                                         'on', 'off', 'on', 'undef', 'undef'>,
                                                                        m, ptr, templ
                                               ) ▶₀ #t2.5 )
                                          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                          solve( (#vr.24 < #vr.16)  ∥ (#t2.3 < #vr.24) )
                                            case case_1
                                            solve( Insert( <'F_template', ptr>,
                                                           <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                            'on', 'undef', 'undef'>
                                                   ) @ #t2.8 )
                                              case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                              solve( (#t2.1 < #t2.7)  ∥ (#t2.1 = #t2.7) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( State_11111111111111111111111( ~n.7, L_h, atts, k, ptr,
                                                                                      templ
                                                       ) ▶₀ #t2.6 )
                                                  case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                  solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( Insert( <'obj', h1>,
                                                                   <~n.2, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                    x.5, 'usage', x.6>
                                                           ) @ #t2.7 )
                                                      case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                      solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                   x.4, 'on', x.5, 'usage', 
                                                                                   x.6>,
                                                                                  <'on', x, x.1, x.2, x.3, 
                                                                                   x.4, 'on', x.5, 'usage', 
                                                                                   x.6>,
                                                                                  k, ~n.2, v, L_h, lock
                                                             ) ▶₀ #t2.7 )
                                                        case lookupFtemplateattuttemvasut_0_111112111111
                                                        solve( Insert( <'F_template', z>,
                                                                       <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                        x.5, 'usage', x.6>
                                                               ) @ #t2.9 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          by contradiction /* cyclic */
                                                        qed
                                                      qed
                                                    next
                                                      case insertobjLhkatts_0_11111111111111111
                                                      by solve( State_11111111111111111( lock, h1,
                                                                                         <'on', x, x.1, x.2, 
                                                                                          x.3, x.4, 'on', 
                                                                                          x.5, 'usage', x.6>,
                                                                                         ~n.2, ptr, templ
                                                                ) ▶₀ #t2.7 )
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( Insert( <'F_template', ptr>,
                                                           <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                            'on', 'undef', 'undef'>
                                                   ) @ #t2.8 )
                                              case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                              solve( (#t2.1 < #t2.7)  ∥ (#t2.1 = #t2.7) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( State_11111111111111111111111( ~n.7, L_h, atts, k, ptr,
                                                                                      templ
                                                       ) ▶₀ #t2.6 )
                                                  case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                  solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( Insert( <'obj', h1>,
                                                                   <~n.2, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                    x.5, 'usage', x.6>
                                                           ) @ #t2.7 )
                                                      case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                      solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                   x.4, 'on', x.5, 'usage', 
                                                                                   x.6>,
                                                                                  <'on', x, x.1, x.2, x.3, 
                                                                                   x.4, 'on', x.5, 'usage', 
                                                                                   x.6>,
                                                                                  k, ~n.2, v, L_h, lock
                                                             ) ▶₀ #t2.7 )
                                                        case lookupFtemplateattuttemvasut_0_111112111111
                                                        solve( (#vr.34 < #vr.24)  ∥ (#t2.6 < #vr.34) )
                                                          case case_1
                                                          solve( Insert( <'F_template', z>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.9 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* cyclic */
                                                          qed
                                                        next
                                                          case case_2
                                                          solve( Insert( <'F_template', z>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.9 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* cyclic */
                                                          qed
                                                        qed
                                                      qed
                                                    next
                                                      case insertobjLhkatts_0_11111111111111111
                                                      by solve( State_11111111111111111( lock, h1,
                                                                                         <'on', x, x.1, x.2, 
                                                                                          x.3, x.4, 'on', 
                                                                                          x.5, 'usage', x.6>,
                                                                                         ~n.2, ptr, templ
                                                                ) ▶₀ #t2.7 )
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              next
                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                solve( (#t2.4 < #t2.1)  ∥ (#t2.4 = #t2.1)  ∥ (#vr.9 < #t2.4) )
                                  case case_1
                                  by contradiction /* from formulas */
                                next
                                  case case_2
                                  solve( State_11111111111111111111111( ~n.4, L_h, atts, k, ptr, templ
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                    solve( (#t2.1 < #t2.6)  ∥ (#t2.1 = #t2.6) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      solve( Insert( <'obj', h2>,
                                                     <m, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                      'undef', 'undef'>
                                             ) @ #t2.4 )
                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                        solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                     'off', 'on', 'undef', 'undef'>,
                                                                    <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                     'off', 'on', 'undef', 'undef'>,
                                                                    k, m, v, L_h, lock
                                               ) ▶₀ #t2.4 )
                                          case lookupFtemplateattuttemvasut_0_111112111111
                                          solve( (#vr.27 < #vr.17)  ∥ (#t2.3 < #vr.27) )
                                            case case_1
                                            solve( Insert( <'F_template', z>,
                                                           <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                            'on', 'undef', 'undef'>
                                                   ) @ #t2.7 )
                                              case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                              solve( (#t2.6 < #t2.1)  ∥ (#t2.6 = #t2.1)  ∥ (#vr.16 < #t2.6) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( State_1111121111111111111111( ut, atts, h2, k.1, m.1,
                                                                                     v, L_h.1, ~n.6
                                                       ) ▶₀ #t2.5 )
                                                  case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                  solve( (#t2.7 < #t2.9)  ∥ (#t2.7 = #t2.9) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( Insert( <'obj', h1>,
                                                                     <~n.1, 'on', x, x.1, x.2, x.3, x.4, 
                                                                      'on', x.5, 'usage', x.6>
                                                             ) @ #t2.6 )
                                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                        solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    k.1, ~n.1, v, L_h.1, lock
                                                               ) ▶₀ #t2.6 )
                                                          case lookupFtemplateattuttemvasut_0_111112111111
                                                          solve( Insert( <'F_template', z>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.9 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* cyclic */
                                                          qed
                                                        qed
                                                      next
                                                        case insertobjLhkatts_0_11111111111111111
                                                        by solve( State_11111111111111111( lock, h1,
                                                                                           <'on', x, x.1, 
                                                                                            x.2, x.3, x.4, 
                                                                                            'on', x.5, 
                                                                                            'usage', x.6>,
                                                                                           ~n.1, ptr, templ
                                                                  ) ▶₀ #t2.6 )
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case case_3
                                                by contradiction /* from formulas */
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( Insert( <'F_template', z>,
                                                           <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                            'on', 'undef', 'undef'>
                                                   ) @ #t2.7 )
                                              case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                              solve( (#t2.6 < #t2.1)  ∥ (#t2.6 = #t2.1)  ∥ (#vr.16 < #t2.6) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( State_1111121111111111111111( ut, atts, h2, k.1, m.1,
                                                                                     v, L_h.1, ~n.6
                                                       ) ▶₀ #t2.5 )
                                                  case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                  solve( (#t2.7 < #t2.9)  ∥ (#t2.7 = #t2.9) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.8 < #t2.1)  ∥ (#t2.8 = #t2.1)  ∥
                                                           (#vr.16 < #t2.8) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( Insert( <'obj', h1>,
                                                                     <~n.1, 'on', x, x.1, x.2, x.3, x.4, 
                                                                      'on', x.5, 'usage', x.6>
                                                             ) @ #t2.6 )
                                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                        solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    k.1, ~n.1, v, L_h.1, lock
                                                               ) ▶₀ #t2.6 )
                                                          case lookupFtemplateattuttemvasut_0_111112111111
                                                          solve( (#vr.38 < #vr.27)  ∥ (#t2.5 < #vr.38) )
                                                            case case_1
                                                            solve( Insert( <'F_template', z>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.9 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* cyclic */
                                                            qed
                                                          next
                                                            case case_2
                                                            solve( Insert( <'F_template', z>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.9 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* cyclic */
                                                            qed
                                                          qed
                                                        qed
                                                      next
                                                        case insertobjLhkatts_0_11111111111111111
                                                        by solve( State_11111111111111111( lock, h1,
                                                                                           <'on', x, x.1, 
                                                                                            x.2, x.3, x.4, 
                                                                                            'on', x.5, 
                                                                                            'usage', x.6>,
                                                                                           ~n.1, ptr, templ
                                                                  ) ▶₀ #t2.6 )
                                                      qed
                                                    next
                                                      case case_3
                                                      by contradiction /* from formulas */
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case case_3
                                                by contradiction /* from formulas */
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case insertobjLhkatts_0_11111111111111111
                                        solve( State_11111111111111111( lock, h2,
                                                                        <'off', 'off', 'on', 'on', 'on', 
                                                                         'on', 'off', 'on', 'undef', 'undef'>,
                                                                        m, ptr, templ
                                               ) ▶₀ #t2.4 )
                                          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                          solve( ((#vr.17 < #vr.25) ∧
                                                  (∃ #t2.
                                                    (Unlock_0( '0', ~n.6, 'device' ) @ #t2)
                                                   ∧
                                                    (#vr.17 < #t2) ∧
                                                    (#t2 < #vr.25) ∧
                                                    (∀ #t0 pp.
                                                      (Unlock( pp, ~n.6, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                    (∀ pp lpp #t0.
                                                      (Lock( pp, lpp, 'device' ) @ #t0)
                                                     ⇒
                                                      ((#t0 < #vr.17) ∨ (#t0 = #vr.17) ∨ (#t2 < #t0))) ∧
                                                    (∀ pp lpp #t0.
                                                      (Unlock( pp, lpp, 'device' ) @ #t0)
                                                     ⇒
                                                      ((#t0 < #vr.17) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                                 (#vr.25 < #vr.17)  ∥ (#vr.17 = #vr.25) )
                                            case case_1
                                            solve( Insert( <'F_template', ptr>,
                                                           <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                            'on', 'undef', 'undef'>
                                                   ) @ #t2.7 )
                                              case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                              solve( (#t2.6 < #t2.1)  ∥ (#t2.6 = #t2.1)  ∥ (#vr.16 < #t2.6) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( State_11111111111111111111111( ~n.7, L_h, atts, k, ptr,
                                                                                      templ
                                                       ) ▶₀ #t2.5 )
                                                  case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                  solve( (#t2.7 < #t2.1)  ∥ (#t2.7 = #t2.1)  ∥
                                                         (#vr.16 < #t2.7) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( Insert( <'obj', h1>,
                                                                   <~n.2, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                    x.5, 'usage', x.6>
                                                           ) @ #t2.6 )
                                                      case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                      solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                   x.4, 'on', x.5, 'usage', 
                                                                                   x.6>,
                                                                                  <'on', x, x.1, x.2, x.3, 
                                                                                   x.4, 'on', x.5, 'usage', 
                                                                                   x.6>,
                                                                                  k, ~n.2, v, L_h, lock
                                                             ) ▶₀ #t2.6 )
                                                        case lookupFtemplateattuttemvasut_0_111112111111
                                                        solve( (#vr.35 < #vr.25)  ∥ (#t2.5 < #vr.35) )
                                                          case case_1
                                                          solve( Insert( <'F_template', z>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.8 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* cyclic */
                                                          qed
                                                        next
                                                          case case_2
                                                          solve( Insert( <'F_template', z>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.8 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* cyclic */
                                                          qed
                                                        qed
                                                      qed
                                                    next
                                                      case insertobjLhkatts_0_11111111111111111
                                                      by solve( State_11111111111111111( lock, h1,
                                                                                         <'on', x, x.1, x.2, 
                                                                                          x.3, x.4, 'on', 
                                                                                          x.5, 'usage', x.6>,
                                                                                         ~n.2, ptr, templ
                                                                ) ▶₀ #t2.6 )
                                                    qed
                                                  next
                                                    case case_3
                                                    by contradiction /* from formulas */
                                                  qed
                                                qed
                                              next
                                                case case_3
                                                by contradiction /* from formulas */
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( Insert( <'F_template', ptr>,
                                                           <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                            'on', 'undef', 'undef'>
                                                   ) @ #t2.7 )
                                              case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                              solve( (#t2.6 < #t2.1)  ∥ (#t2.6 = #t2.1)  ∥ (#vr.16 < #t2.6) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( State_11111111111111111111111( ~n.7, L_h, atts, k, ptr,
                                                                                      templ
                                                       ) ▶₀ #t2.5 )
                                                  case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                  solve( (#t2.1 < #t2.7)  ∥ (#t2.1 = #t2.7) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( Insert( <'obj', h1>,
                                                                   <~n.2, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                    x.5, 'usage', x.6>
                                                           ) @ #t2.6 )
                                                      case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                      solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                   x.4, 'on', x.5, 'usage', 
                                                                                   x.6>,
                                                                                  <'on', x, x.1, x.2, x.3, 
                                                                                   x.4, 'on', x.5, 'usage', 
                                                                                   x.6>,
                                                                                  k, ~n.2, v, L_h, lock
                                                             ) ▶₀ #t2.6 )
                                                        case lookupFtemplateattuttemvasut_0_111112111111
                                                        solve( Insert( <'F_template', z>,
                                                                       <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                        x.5, 'usage', x.6>
                                                               ) @ #t2.8 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          by contradiction /* cyclic */
                                                        qed
                                                      qed
                                                    next
                                                      case insertobjLhkatts_0_11111111111111111
                                                      by solve( State_11111111111111111( lock, h1,
                                                                                         <'on', x, x.1, x.2, 
                                                                                          x.3, x.4, 'on', 
                                                                                          x.5, 'usage', x.6>,
                                                                                         ~n.2, ptr, templ
                                                                ) ▶₀ #t2.6 )
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case case_3
                                                by contradiction /* from formulas */
                                              qed
                                            qed
                                          next
                                            case case_3
                                            solve( (#t2.1 < #t2.5)  ∥ (#t2.1 = #t2.5) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( Insert( <'obj', h1>,
                                                             <~n.1, 'on', x, x.1, x.2, x.3, x.4, 'on', x.5, 
                                                              'usage', x.6>
                                                     ) @ #t2.4 )
                                                case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                solve( State_1111121111111( <'on', x, x.1, x.2, x.3, x.4, 
                                                                             'on', x.5, 'usage', x.6>,
                                                                            <'on', x, x.1, x.2, x.3, x.4, 
                                                                             'on', x.5, 'usage', x.6>,
                                                                            k, ~n.1, v, L_h, lock
                                                       ) ▶₀ #t2.4 )
                                                  case lookupFtemplateattuttemvasut_0_111112111111
                                                  solve( Insert( <'F_template', z>,
                                                                 <'on', x, x.1, x.2, x.3, x.4, 'on', x.5, 
                                                                  'usage', x.6>
                                                         ) @ #t2.6 )
                                                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                    by contradiction /* cyclic */
                                                  qed
                                                qed
                                              next
                                                case insertobjLhkatts_0_11111111111111111
                                                by solve( State_11111111111111111( lock, h1,
                                                                                   <'on', x, x.1, x.2, x.3, 
                                                                                    x.4, 'on', x.5, 'usage', 
                                                                                    x.6>,
                                                                                   ~n.1, ptr, templ
                                                          ) ▶₀ #t2.4 )
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                next
                                  case case_3
                                  solve( State_11111111111111111111111( ~n.4, L_h, atts, k, ptr, templ
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          next
            case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_2
            solve( Insert( <'F_template', z.3>,
                           <z.4, z.5, z.6, z.7, z.8, 'on', z.9, 'off', z.10, z.11>
                   ) @ #t2.2 )
              case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
              by contradiction /* cyclic */
            qed
          next
            case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_3
            solve( Insert( <'F_template', z.2>,
                           <z.3, z.4, z.5, z.6, z.7, 'on', z.8, 'on', z.9, z.10>
                   ) @ #t2.2 )
              case insertFtemplatetrustedononoffoffononononusageusage_0_
              by contradiction /* cyclic */
            next
              case insertFtemplateusageoffoffononononoffonundefundef_0_1
              solve( (#vr.6 < #t2.1)  ∥ (#vr.6 = #t2.1) )
                case case_1
                solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.1 ) ▶₀ #t2 )
                  case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                  solve( (#t2.4 < #t2.7)  ∥ (#t2.4 = #t2.7) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    solve( (#t2.3 < #t2.6)  ∥ (#t2.3 = #t2.6) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      solve( (#vr.6 < #t2.5)  ∥ (#vr.6 = #t2.5) )
                        case case_1
                        solve( (#t2.1 < #t2.5)  ∥ (#t2.1 = #t2.5) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( State_1( ) ▶₀ #t2.1 )
                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                            by contradiction /* cyclic */
                          qed
                        qed
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.1 ) ▶₀ #t2 )
                  case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                  solve( (#t2.4 < #t2.7)  ∥ (#t2.4 = #t2.7) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    solve( (#t2.1 < #t2.5)  ∥ (#t2.1 = #t2.5) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      solve( (#t2.3 < #t2.5)  ∥ (#t2.3 = #t2.5) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        solve( Insert( <'obj', L_h>,
                                       <k, x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                               ) @ #t2.2 )
                          case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                          solve( State_1111121111111( <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, 
                                                       x.8>,
                                                      <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>, k.1,
                                                      k, v, L_h, lock
                                 ) ▶₀ #t2.2 )
                            case lookupFtemplateattuttemvasut_0_111112111111
                            solve( (#vr.20 < #vr.14)  ∥ (#t2 < #vr.20) )
                              case case_1
                              solve( Insert( <'F_template', z.2>,
                                             <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                                     ) @ #t2.6 )
                                case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                                by contradiction /* cyclic */
                              next
                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                solve( (#t2.4 < #t2.1)  ∥ (#t2.4 = #t2.1)  ∥ (#vr.10 < #t2.4) )
                                  case case_1
                                  by contradiction /* from formulas */
                                next
                                  case case_2
                                  solve( State_1111121111111111111111( ut, atts, h2.1, k.2, m.1, v, L_h.1,
                                                                       ~n.3
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                    solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      solve( (#t2.1 < #t2.7)  ∥ (#t2.1 = #t2.7) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( Insert( <'obj', h2>,
                                                       <z.1, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                        'on', 'undef', 'undef'>
                                               ) @ #t2.4 )
                                          case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                          solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                       'off', 'on', 'undef', 'undef'>,
                                                                      <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                       'off', 'on', 'undef', 'undef'>,
                                                                      k.2, z.1, v, L_h.1, lock
                                                 ) ▶₀ #t2.4 )
                                            case lookupFtemplateattuttemvasut_0_111112111111
                                            solve( ((#vr.20 < #vr.31) ∧
                                                    (∃ #t2.
                                                      (Unlock_4( '4', ~n.4, 'device' ) @ #t2)
                                                     ∧
                                                      (#vr.20 < #t2) ∧
                                                      (#t2 < #vr.31) ∧
                                                      (∀ #t0 pp.
                                                        (Unlock( pp, ~n.4, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                                      (∀ pp lpp #t0.
                                                        (Lock( pp, lpp, 'device' ) @ #t0)
                                                       ⇒
                                                        ((#t0 < #vr.20) ∨ (#t0 = #vr.20) ∨ (#t2 < #t0))) ∧
                                                      (∀ pp lpp #t0.
                                                        (Unlock( pp, lpp, 'device' ) @ #t0)
                                                       ⇒
                                                        ((#t0 < #vr.20) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                                   (#vr.31 < #vr.20)  ∥ (#vr.20 = #vr.31) )
                                              case case_1
                                              solve( Insert( <'F_template', z.2>,
                                                             <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                              'on', 'undef', 'undef'>
                                                     ) @ #t2.8 )
                                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                solve( (#t2.6 < #t2.1)  ∥ (#t2.6 = #t2.1)  ∥
                                                       (#vr.16 < #t2.6) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( State_1111121111111111111111( ut, atts, h2, k.3, m.1,
                                                                                       v, L_h.2, ~n.5
                                                         ) ▶₀ #t2.5 )
                                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                    solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.9 < #t2.1)  ∥ (#t2.9 = #t2.1)  ∥
                                                             (#vr.16 < #t2.9) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( Insert( <'obj', h1>,
                                                                       <z, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                        x.5, 'usage', x.6>
                                                               ) @ #t2.6 )
                                                          case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                          solve( State_1111121111111( <'on', x, x.1, x.2, 
                                                                                       x.3, x.4, 'on', x.5, 
                                                                                       'usage', x.6>,
                                                                                      <'on', x, x.1, x.2, 
                                                                                       x.3, x.4, 'on', x.5, 
                                                                                       'usage', x.6>,
                                                                                      k.3, z, v, L_h.2, lock
                                                                 ) ▶₀ #t2.6 )
                                                            case lookupFtemplateattuttemvasut_0_111112111111
                                                            solve( (#vr.42 < #vr.20)  ∥ (#t2.3 < #vr.42) )
                                                              case case_1
                                                              solve( Insert( <'F_template', z.1>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* cyclic */
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( (#vr.42 < #vr.31)  ∥ (#t2.5 < #vr.42) )
                                                                case case_1
                                                                solve( Insert( <'F_template', z.1>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.10 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  by contradiction /* cyclic */
                                                                qed
                                                              next
                                                                case case_2
                                                                solve( Insert( <'F_template', z.1>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.10 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  by contradiction /* cyclic */
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case insertobjLhkatts_0_11111111111111111
                                                          solve( State_11111111111111111( lock, h1,
                                                                                          <'on', x, x.1, x.2, 
                                                                                           x.3, x.4, 'on', 
                                                                                           x.5, 'usage', x.6>,
                                                                                          z, ptr, templ
                                                                 ) ▶₀ #t2.6 )
                                                            case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                            solve( (#vr.40 < #vr.20)  ∥ (#t2.3 < #vr.40) )
                                                              case case_1
                                                              solve( Insert( <'F_template', ptr>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* from formulas */
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( (#vr.40 < #vr.31)  ∥ (#t2.5 < #vr.40) )
                                                                case case_1
                                                                solve( Insert( <'F_template', ptr>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.10 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  by contradiction /* from formulas */
                                                                qed
                                                              next
                                                                case case_2
                                                                solve( Insert( <'F_template', ptr>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.10 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  by contradiction /* from formulas */
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      next
                                                        case case_3
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case case_3
                                                  by contradiction /* from formulas */
                                                qed
                                              qed
                                            next
                                              case case_2
                                              solve( Insert( <'F_template', z.2>,
                                                             <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                              'on', 'undef', 'undef'>
                                                     ) @ #t2.8 )
                                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                solve( (#t2.6 < #t2.1)  ∥ (#t2.6 = #t2.1)  ∥
                                                       (#vr.16 < #t2.6) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( State_1111121111111111111111( ut, atts, h2, k.3, m.1,
                                                                                       v, L_h.2, ~n.5
                                                         ) ▶₀ #t2.5 )
                                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                    solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.1 < #t2.9)  ∥ (#t2.1 = #t2.9) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( Insert( <'obj', h1>,
                                                                       <z, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                        x.5, 'usage', x.6>
                                                               ) @ #t2.6 )
                                                          case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                          solve( State_1111121111111( <'on', x, x.1, x.2, 
                                                                                       x.3, x.4, 'on', x.5, 
                                                                                       'usage', x.6>,
                                                                                      <'on', x, x.1, x.2, 
                                                                                       x.3, x.4, 'on', x.5, 
                                                                                       'usage', x.6>,
                                                                                      k.3, z, v, L_h.2, lock
                                                                 ) ▶₀ #t2.6 )
                                                            case lookupFtemplateattuttemvasut_0_111112111111
                                                            solve( (#vr.42 < #vr.20)  ∥ (#t2.3 < #vr.42) )
                                                              case case_1
                                                              solve( (#vr.42 < #vr.31)  ∥ (#t2.5 < #vr.42) )
                                                                case case_1
                                                                solve( Insert( <'F_template', z.1>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.10 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  by contradiction /* cyclic */
                                                                qed
                                                              next
                                                                case case_2
                                                                solve( Insert( <'F_template', z.1>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.10 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  by contradiction /* cyclic */
                                                                qed
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( Insert( <'F_template', z.1>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* cyclic */
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case insertobjLhkatts_0_11111111111111111
                                                          solve( State_11111111111111111( lock, h1,
                                                                                          <'on', x, x.1, x.2, 
                                                                                           x.3, x.4, 'on', 
                                                                                           x.5, 'usage', x.6>,
                                                                                          z, ptr, templ
                                                                 ) ▶₀ #t2.6 )
                                                            case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                            solve( (#vr.40 < #vr.20)  ∥ (#t2.3 < #vr.40) )
                                                              case case_1
                                                              solve( (#vr.40 < #vr.31)  ∥ (#t2.5 < #vr.40) )
                                                                case case_1
                                                                solve( Insert( <'F_template', ptr>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.10 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  by contradiction /* from formulas */
                                                                qed
                                                              next
                                                                case case_2
                                                                solve( Insert( <'F_template', ptr>,
                                                                               <'on', x, x.1, x.2, x.3, x.4, 
                                                                                'on', x.5, 'usage', x.6>
                                                                       ) @ #t2.10 )
                                                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                  by contradiction /* from formulas */
                                                                qed
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( Insert( <'F_template', ptr>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* from formulas */
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case case_3
                                                  by contradiction /* from formulas */
                                                qed
                                              qed
                                            next
                                              case case_3
                                              solve( (#t2.5 < #t2.7)  ∥ (#t2.5 = #t2.7) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( (#t2.1 < #t2.6)  ∥ (#t2.1 = #t2.6) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( Insert( <'obj', h1>,
                                                                 <z, 'on', x, x.1, x.2, x.3, x.4, 'on', x.5, 
                                                                  'usage', x.6>
                                                         ) @ #t2.4 )
                                                    case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                    solve( State_1111121111111( <'on', x, x.1, x.2, x.3, x.4, 
                                                                                 'on', x.5, 'usage', x.6>,
                                                                                <'on', x, x.1, x.2, x.3, x.4, 
                                                                                 'on', x.5, 'usage', x.6>,
                                                                                k.2, z, v, L_h.1, lock
                                                           ) ▶₀ #t2.4 )
                                                      case lookupFtemplateattuttemvasut_0_111112111111
                                                      solve( (#vr.31 < #vr.20)  ∥ (#t2.3 < #vr.31) )
                                                        case case_1
                                                        solve( Insert( <'F_template', z.1>,
                                                                       <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                        x.5, 'usage', x.6>
                                                               ) @ #t2.7 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          by contradiction /* cyclic */
                                                        qed
                                                      next
                                                        case case_2
                                                        solve( Insert( <'F_template', z.1>,
                                                                       <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                        x.5, 'usage', x.6>
                                                               ) @ #t2.7 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          by contradiction /* cyclic */
                                                        qed
                                                      qed
                                                    qed
                                                  next
                                                    case insertobjLhkatts_0_11111111111111111
                                                    solve( State_11111111111111111( lock, h1,
                                                                                    <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    z, ptr, templ
                                                           ) ▶₀ #t2.4 )
                                                      case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                      solve( (#vr.29 < #vr.20)  ∥ (#t2.3 < #vr.29) )
                                                        case case_1
                                                        solve( Insert( <'F_template', ptr>,
                                                                       <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                        x.5, 'usage', x.6>
                                                               ) @ #t2.7 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        solve( Insert( <'F_template', ptr>,
                                                                       <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                        x.5, 'usage', x.6>
                                                               ) @ #t2.7 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        next
                                          case insertobjLhkatts_0_11111111111111111
                                          solve( State_11111111111111111( lock, h2,
                                                                          <'off', 'off', 'on', 'on', 'on', 
                                                                           'on', 'off', 'on', 'undef', 'undef'
                                                                          >,
                                                                          z.1, ptr, templ
                                                 ) ▶₀ #t2.4 )
                                            case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                            by contradiction /* impossible chain */
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                next
                                  case case_3
                                  solve( State_1111121111111111111111( ut, atts, h2.1, k.2, m.1, v, L_h.1,
                                                                       ~n.3
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              qed
                            next
                              case case_2
                              solve( Insert( <'F_template', z.2>,
                                             <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                                     ) @ #t2.6 )
                                case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                                by contradiction /* cyclic */
                              next
                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                solve( (#t2.4 < #t2.1)  ∥ (#t2.4 = #t2.1)  ∥ (#vr.10 < #t2.4) )
                                  case case_1
                                  by contradiction /* from formulas */
                                next
                                  case case_2
                                  solve( State_1111121111111111111111( ut, atts, h2.1, k.2, m.1, v, L_h.1,
                                                                       ~n.3
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                    solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      solve( (#t2.7 < #t2.1)  ∥ (#t2.7 = #t2.1)  ∥ (#vr.10 < #t2.7) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( Insert( <'obj', h2>,
                                                       <z.1, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                        'on', 'undef', 'undef'>
                                               ) @ #t2.4 )
                                          case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                          solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                       'off', 'on', 'undef', 'undef'>,
                                                                      <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                       'off', 'on', 'undef', 'undef'>,
                                                                      k.2, z.1, v, L_h.1, lock
                                                 ) ▶₀ #t2.4 )
                                            case lookupFtemplateattuttemvasut_0_111112111111
                                            solve( Insert( <'F_template', z.2>,
                                                           <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                            'on', 'undef', 'undef'>
                                                   ) @ #t2.8 )
                                              case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                              solve( (#t2.1 < #t2.6)  ∥ (#t2.1 = #t2.6) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( State_1111121111111111111111( ut, atts, h2, k.3, m.1,
                                                                                     v, L_h.2, ~n.5
                                                       ) ▶₀ #t2.5 )
                                                  case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                  solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.1 < #t2.9)  ∥ (#t2.1 = #t2.9) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( Insert( <'obj', h1>,
                                                                     <z, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                      x.5, 'usage', x.6>
                                                             ) @ #t2.6 )
                                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                        solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    k.3, z, v, L_h.2, lock
                                                               ) ▶₀ #t2.6 )
                                                          case lookupFtemplateattuttemvasut_0_111112111111
                                                          solve( (#vr.42 < #vr.31)  ∥ (#t2.5 < #vr.42) )
                                                            case case_1
                                                            solve( Insert( <'F_template', z.1>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.10 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* cyclic */
                                                            qed
                                                          next
                                                            case case_2
                                                            solve( Insert( <'F_template', z.1>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.10 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* cyclic */
                                                            qed
                                                          qed
                                                        qed
                                                      next
                                                        case insertobjLhkatts_0_11111111111111111
                                                        solve( State_11111111111111111( lock, h1,
                                                                                        <'on', x, x.1, x.2, 
                                                                                         x.3, x.4, 'on', x.5, 
                                                                                         'usage', x.6>,
                                                                                        z, ptr, templ
                                                               ) ▶₀ #t2.6 )
                                                          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                          solve( (#vr.40 < #vr.31)  ∥ (#t2.5 < #vr.40) )
                                                            case case_1
                                                            solve( Insert( <'F_template', ptr>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.10 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* from formulas */
                                                            qed
                                                          next
                                                            case case_2
                                                            solve( Insert( <'F_template', ptr>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.10 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* from formulas */
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        next
                                          case insertobjLhkatts_0_11111111111111111
                                          solve( State_11111111111111111( lock, h2,
                                                                          <'off', 'off', 'on', 'on', 'on', 
                                                                           'on', 'off', 'on', 'undef', 'undef'
                                                                          >,
                                                                          z.1, ptr, templ
                                                 ) ▶₀ #t2.4 )
                                            case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                            by contradiction /* impossible chain */
                                          qed
                                        qed
                                      next
                                        case case_3
                                        by contradiction /* from formulas */
                                      qed
                                    qed
                                  qed
                                next
                                  case case_3
                                  solve( State_1111121111111111111111( ut, atts, h2.1, k.2, m.1, v, L_h.1,
                                                                       ~n.3
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                    solve( (#t2.7 < #t2.9)  ∥ (#t2.7 = #t2.9) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      solve( (#t2.8 < #t2.1)  ∥ (#t2.8 = #t2.1)  ∥ (#vr.10 < #t2.8) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        by contradiction /* from formulas */
                                      next
                                        case case_3
                                        solve( (#t2.4 < #t2.8)  ∥ (#t2.4 = #t2.8) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( State_1( ) ▶₀ #t2.4 )
                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                            by contradiction /* cyclic */
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case insertobjLhkatts_0_11111111111111111
                          solve( State_11111111111111111( lock, L_h,
                                                          <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>,
                                                          k, ptr, templ
                                 ) ▶₀ #t2.2 )
                            case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                            solve( (#vr.18 < #vr.14)  ∥ (#t2 < #vr.18) )
                              case case_1
                              solve( Insert( <'F_template', ptr>,
                                             <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                                     ) @ #t2.6 )
                                case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                                solve( (#vr.5 < #t2.4)  ∥ (#vr.5 = #t2.4) )
                                  case case_1
                                  solve( State_11111111111111111111111( ~n.4, L_h, atts, k, ptr, templ
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                    solve( (#t2.4 < #t2.7)  ∥ (#t2.4 = #t2.7) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      solve( State_11( ) ▶₀ #t2.4 )
                                        case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  qed
                                next
                                  case case_2
                                  solve( State_11111111111111111111111( ~n.4, L_h, atts, k, ptr, templ
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                    solve( (#t2.4 < #t2.7)  ∥ (#t2.4 = #t2.7) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      solve( Insert( <'obj', h2>,
                                                     <z.1, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                      'undef', 'undef'>
                                             ) @ #t2.5 )
                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                        solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                     'off', 'on', 'undef', 'undef'>,
                                                                    <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                     'off', 'on', 'undef', 'undef'>,
                                                                    k, z.1, v, L_h, lock
                                               ) ▶₀ #t2.5 )
                                          case lookupFtemplateattuttemvasut_0_111112111111
                                          solve( (#vr.27 < #vr.17)  ∥ (#t2.3 < #vr.27) )
                                            case case_1
                                            solve( Insert( <'F_template', z.2>,
                                                           <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                            'on', 'undef', 'undef'>
                                                   ) @ #t2.8 )
                                              case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                              solve( (#t2.1 < #t2.7)  ∥ (#t2.1 = #t2.7) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( State_1111121111111111111111( ut, atts, h2, k.1, m.1,
                                                                                     v, L_h.1, ~n.6
                                                       ) ▶₀ #t2.6 )
                                                  case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                  solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.1 < #t2.9)  ∥ (#t2.1 = #t2.9) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( Insert( <'obj', h1>,
                                                                     <z, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                      x.5, 'usage', x.6>
                                                             ) @ #t2.7 )
                                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                        solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    k.1, z, v, L_h.1, lock
                                                               ) ▶₀ #t2.7 )
                                                          case lookupFtemplateattuttemvasut_0_111112111111
                                                          solve( (#vr.38 < #vr.17)  ∥ (#t2.3 < #vr.38) )
                                                            case case_1
                                                            solve( (#vr.38 < #vr.27)  ∥ (#t2.6 < #vr.38) )
                                                              case case_1
                                                              solve( Insert( <'F_template', z.1>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* cyclic */
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( Insert( <'F_template', z.1>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* cyclic */
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            solve( Insert( <'F_template', z.1>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.10 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* cyclic */
                                                            qed
                                                          qed
                                                        qed
                                                      next
                                                        case insertobjLhkatts_0_11111111111111111
                                                        solve( State_11111111111111111( lock, h1,
                                                                                        <'on', x, x.1, x.2, 
                                                                                         x.3, x.4, 'on', x.5, 
                                                                                         'usage', x.6>,
                                                                                        z, ptr, templ
                                                               ) ▶₀ #t2.7 )
                                                          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                          solve( (#vr.36 < #vr.17)  ∥ (#t2.3 < #vr.36) )
                                                            case case_1
                                                            solve( (#vr.36 < #vr.27)  ∥ (#t2.6 < #vr.36) )
                                                              case case_1
                                                              solve( Insert( <'F_template', ptr>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* from formulas */
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( Insert( <'F_template', ptr>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* from formulas */
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            solve( Insert( <'F_template', ptr>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.10 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* from formulas */
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( Insert( <'F_template', z.2>,
                                                           <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                            'on', 'undef', 'undef'>
                                                   ) @ #t2.8 )
                                              case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                              solve( (#t2.1 < #t2.7)  ∥ (#t2.1 = #t2.7) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( State_1111121111111111111111( ut, atts, h2, k.1, m.1,
                                                                                     v, L_h.1, ~n.6
                                                       ) ▶₀ #t2.6 )
                                                  case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                  solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.1 < #t2.9)  ∥ (#t2.1 = #t2.9) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( Insert( <'obj', h1>,
                                                                     <z, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                      x.5, 'usage', x.6>
                                                             ) @ #t2.7 )
                                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                        solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    k.1, z, v, L_h.1, lock
                                                               ) ▶₀ #t2.7 )
                                                          case lookupFtemplateattuttemvasut_0_111112111111
                                                          solve( (#vr.38 < #vr.17)  ∥ (#t2.3 < #vr.38) )
                                                            case case_1
                                                            solve( Insert( <'F_template', z.1>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.10 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* cyclic */
                                                            qed
                                                          next
                                                            case case_2
                                                            solve( (#vr.38 < #vr.27)  ∥ (#t2.6 < #vr.38) )
                                                              case case_1
                                                              solve( Insert( <'F_template', z.1>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* cyclic */
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( Insert( <'F_template', z.1>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* cyclic */
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      next
                                                        case insertobjLhkatts_0_11111111111111111
                                                        solve( State_11111111111111111( lock, h1,
                                                                                        <'on', x, x.1, x.2, 
                                                                                         x.3, x.4, 'on', x.5, 
                                                                                         'usage', x.6>,
                                                                                        z, ptr, templ
                                                               ) ▶₀ #t2.7 )
                                                          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                          solve( (#vr.36 < #vr.17)  ∥ (#t2.3 < #vr.36) )
                                                            case case_1
                                                            solve( Insert( <'F_template', ptr>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.10 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* from formulas */
                                                            qed
                                                          next
                                                            case case_2
                                                            solve( (#vr.36 < #vr.27)  ∥ (#t2.6 < #vr.36) )
                                                              case case_1
                                                              solve( Insert( <'F_template', ptr>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* from formulas */
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( Insert( <'F_template', ptr>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.10 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* from formulas */
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case insertobjLhkatts_0_11111111111111111
                                        solve( State_11111111111111111( lock, h2,
                                                                        <'off', 'off', 'on', 'on', 'on', 
                                                                         'on', 'off', 'on', 'undef', 'undef'>,
                                                                        z.1, ptr, templ
                                               ) ▶₀ #t2.5 )
                                          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                          by contradiction /* impossible chain */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              next
                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                solve( (#t2.4 < #t2.1)  ∥ (#t2.4 = #t2.1)  ∥ (#vr.10 < #t2.4) )
                                  case case_1
                                  by contradiction /* from formulas */
                                next
                                  case case_2
                                  solve( State_11111111111111111111111( ~n.4, L_h, atts, k, ptr, templ
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                    solve( (#t2.1 < #t2.6)  ∥ (#t2.1 = #t2.6) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      solve( Insert( <'obj', h2>,
                                                     <z.1, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                      'undef', 'undef'>
                                             ) @ #t2.4 )
                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                        solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                     'off', 'on', 'undef', 'undef'>,
                                                                    <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                     'off', 'on', 'undef', 'undef'>,
                                                                    k, z.1, v, L_h, lock
                                               ) ▶₀ #t2.4 )
                                          case lookupFtemplateattuttemvasut_0_111112111111
                                          solve( (#vr.28 < #vr.18)  ∥ (#t2.3 < #vr.28) )
                                            case case_1
                                            solve( Insert( <'F_template', z.2>,
                                                           <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                            'on', 'undef', 'undef'>
                                                   ) @ #t2.7 )
                                              case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                              solve( (#t2.6 < #t2.1)  ∥ (#t2.6 = #t2.1)  ∥ (#vr.17 < #t2.6) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( State_1111121111111111111111( ut, atts, h2, k.1, m.1,
                                                                                     v, L_h.1, ~n.6
                                                       ) ▶₀ #t2.5 )
                                                  case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                  solve( (#t2.7 < #t2.9)  ∥ (#t2.7 = #t2.9) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( Insert( <'obj', h1>,
                                                                     <z, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                      x.5, 'usage', x.6>
                                                             ) @ #t2.6 )
                                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                        solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    k.1, z, v, L_h.1, lock
                                                               ) ▶₀ #t2.6 )
                                                          case lookupFtemplateattuttemvasut_0_111112111111
                                                          solve( (#vr.39 < #vr.18)  ∥ (#t2.3 < #vr.39) )
                                                            case case_1
                                                            solve( (#vr.39 < #vr.28)  ∥ (#t2.5 < #vr.39) )
                                                              case case_1
                                                              solve( Insert( <'F_template', z.1>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.9 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* cyclic */
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( Insert( <'F_template', z.1>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.9 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* cyclic */
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            solve( Insert( <'F_template', z.1>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.9 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* cyclic */
                                                            qed
                                                          qed
                                                        qed
                                                      next
                                                        case insertobjLhkatts_0_11111111111111111
                                                        solve( State_11111111111111111( lock, h1,
                                                                                        <'on', x, x.1, x.2, 
                                                                                         x.3, x.4, 'on', x.5, 
                                                                                         'usage', x.6>,
                                                                                        z, ptr, templ
                                                               ) ▶₀ #t2.6 )
                                                          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                          solve( (#vr.37 < #vr.18)  ∥ (#t2.3 < #vr.37) )
                                                            case case_1
                                                            solve( (#vr.37 < #vr.28)  ∥ (#t2.5 < #vr.37) )
                                                              case case_1
                                                              solve( Insert( <'F_template', ptr>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.9 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* from formulas */
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( Insert( <'F_template', ptr>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.9 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* from formulas */
                                                              qed
                                                            qed
                                                          next
                                                            case case_2
                                                            solve( Insert( <'F_template', ptr>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.9 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* from formulas */
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case case_3
                                                by contradiction /* from formulas */
                                              qed
                                            qed
                                          next
                                            case case_2
                                            solve( Insert( <'F_template', z.2>,
                                                           <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                            'on', 'undef', 'undef'>
                                                   ) @ #t2.7 )
                                              case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                              solve( (#t2.6 < #t2.1)  ∥ (#t2.6 = #t2.1)  ∥ (#vr.17 < #t2.6) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( State_1111121111111111111111( ut, atts, h2, k.1, m.1,
                                                                                     v, L_h.1, ~n.6
                                                       ) ▶₀ #t2.5 )
                                                  case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                  solve( (#t2.7 < #t2.9)  ∥ (#t2.7 = #t2.9) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( (#t2.8 < #t2.1)  ∥ (#t2.8 = #t2.1)  ∥
                                                           (#vr.17 < #t2.8) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( Insert( <'obj', h1>,
                                                                     <z, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                      x.5, 'usage', x.6>
                                                             ) @ #t2.6 )
                                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                        solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    <'on', x, x.1, x.2, x.3, 
                                                                                     x.4, 'on', x.5, 'usage', 
                                                                                     x.6>,
                                                                                    k.1, z, v, L_h.1, lock
                                                               ) ▶₀ #t2.6 )
                                                          case lookupFtemplateattuttemvasut_0_111112111111
                                                          solve( (#vr.39 < #vr.18)  ∥ (#t2.3 < #vr.39) )
                                                            case case_1
                                                            solve( Insert( <'F_template', z.1>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.9 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* cyclic */
                                                            qed
                                                          next
                                                            case case_2
                                                            solve( (#vr.39 < #vr.28)  ∥ (#t2.5 < #vr.39) )
                                                              case case_1
                                                              solve( Insert( <'F_template', z.1>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.9 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* cyclic */
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( Insert( <'F_template', z.1>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.9 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* cyclic */
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      next
                                                        case insertobjLhkatts_0_11111111111111111
                                                        solve( State_11111111111111111( lock, h1,
                                                                                        <'on', x, x.1, x.2, 
                                                                                         x.3, x.4, 'on', x.5, 
                                                                                         'usage', x.6>,
                                                                                        z, ptr, templ
                                                               ) ▶₀ #t2.6 )
                                                          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                          solve( (#vr.37 < #vr.18)  ∥ (#t2.3 < #vr.37) )
                                                            case case_1
                                                            solve( Insert( <'F_template', ptr>,
                                                                           <'on', x, x.1, x.2, x.3, x.4, 
                                                                            'on', x.5, 'usage', x.6>
                                                                   ) @ #t2.9 )
                                                              case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                              by contradiction /* from formulas */
                                                            qed
                                                          next
                                                            case case_2
                                                            solve( (#vr.37 < #vr.28)  ∥ (#t2.5 < #vr.37) )
                                                              case case_1
                                                              solve( Insert( <'F_template', ptr>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.9 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* from formulas */
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( Insert( <'F_template', ptr>,
                                                                             <'on', x, x.1, x.2, x.3, x.4, 
                                                                              'on', x.5, 'usage', x.6>
                                                                     ) @ #t2.9 )
                                                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                                by contradiction /* from formulas */
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    next
                                                      case case_3
                                                      by contradiction /* from formulas */
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case case_3
                                                by contradiction /* from formulas */
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case insertobjLhkatts_0_11111111111111111
                                        solve( State_11111111111111111( lock, h2,
                                                                        <'off', 'off', 'on', 'on', 'on', 
                                                                         'on', 'off', 'on', 'undef', 'undef'>,
                                                                        z.1, ptr, templ
                                               ) ▶₀ #t2.4 )
                                          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                          by contradiction /* impossible chain */
                                        qed
                                      qed
                                    qed
                                  qed
                                next
                                  case case_3
                                  solve( State_11111111111111111111111( ~n.4, L_h, atts, k, ptr, templ
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              qed
                            next
                              case case_2
                              solve( Insert( <'F_template', ptr>,
                                             <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                                     ) @ #t2.6 )
                                case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                                solve( (#vr.5 < #t2.4)  ∥ (#vr.5 = #t2.4) )
                                  case case_1
                                  solve( State_11111111111111111111111( ~n.4, L_h, atts, k, ptr, templ
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                    solve( (#t2.4 < #t2.7)  ∥ (#t2.4 = #t2.7) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      solve( State_11( ) ▶₀ #t2.4 )
                                        case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  qed
                                next
                                  case case_2
                                  solve( State_11111111111111111111111( ~n.4, L_h, atts, k, ptr, templ
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                    solve( (#t2.4 < #t2.7)  ∥ (#t2.4 = #t2.7) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      solve( Insert( <'obj', h2>,
                                                     <z.1, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                      'undef', 'undef'>
                                             ) @ #t2.5 )
                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                        solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                     'off', 'on', 'undef', 'undef'>,
                                                                    <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                     'off', 'on', 'undef', 'undef'>,
                                                                    k, z.1, v, L_h, lock
                                               ) ▶₀ #t2.5 )
                                          case lookupFtemplateattuttemvasut_0_111112111111
                                          solve( Insert( <'F_template', z.2>,
                                                         <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                          'undef', 'undef'>
                                                 ) @ #t2.8 )
                                            case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                            solve( (#t2.1 < #t2.7)  ∥ (#t2.1 = #t2.7) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( State_1111121111111111111111( ut, atts, h2, k.1, m.1, v,
                                                                                   L_h.1, ~n.6
                                                     ) ▶₀ #t2.6 )
                                                case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                solve( (#t2.8 < #t2.10)  ∥ (#t2.8 = #t2.10) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( (#t2.1 < #t2.9)  ∥ (#t2.1 = #t2.9) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( Insert( <'obj', h1>,
                                                                   <z, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                    x.5, 'usage', x.6>
                                                           ) @ #t2.7 )
                                                      case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                      solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                   x.4, 'on', x.5, 'usage', 
                                                                                   x.6>,
                                                                                  <'on', x, x.1, x.2, x.3, 
                                                                                   x.4, 'on', x.5, 'usage', 
                                                                                   x.6>,
                                                                                  k.1, z, v, L_h.1, lock
                                                             ) ▶₀ #t2.7 )
                                                        case lookupFtemplateattuttemvasut_0_111112111111
                                                        solve( (#vr.38 < #vr.27)  ∥ (#t2.6 < #vr.38) )
                                                          case case_1
                                                          solve( Insert( <'F_template', z.1>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.10 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* cyclic */
                                                          qed
                                                        next
                                                          case case_2
                                                          solve( Insert( <'F_template', z.1>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.10 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* cyclic */
                                                          qed
                                                        qed
                                                      qed
                                                    next
                                                      case insertobjLhkatts_0_11111111111111111
                                                      solve( State_11111111111111111( lock, h1,
                                                                                      <'on', x, x.1, x.2, 
                                                                                       x.3, x.4, 'on', x.5, 
                                                                                       'usage', x.6>,
                                                                                      z, ptr, templ
                                                             ) ▶₀ #t2.7 )
                                                        case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                        solve( (#vr.36 < #vr.27)  ∥ (#t2.6 < #vr.36) )
                                                          case case_1
                                                          solve( Insert( <'F_template', ptr>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.10 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          solve( Insert( <'F_template', ptr>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.10 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* from formulas */
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case insertobjLhkatts_0_11111111111111111
                                        solve( State_11111111111111111( lock, h2,
                                                                        <'off', 'off', 'on', 'on', 'on', 
                                                                         'on', 'off', 'on', 'undef', 'undef'>,
                                                                        z.1, ptr, templ
                                               ) ▶₀ #t2.5 )
                                          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                          by contradiction /* impossible chain */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              next
                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                solve( (#t2.4 < #t2.1)  ∥ (#t2.4 = #t2.1)  ∥ (#vr.10 < #t2.4) )
                                  case case_1
                                  by contradiction /* from formulas */
                                next
                                  case case_2
                                  solve( State_11111111111111111111111( ~n.4, L_h, atts, k, ptr, templ
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                    solve( (#t2.6 < #t2.1)  ∥ (#t2.6 = #t2.1)  ∥ (#vr.10 < #t2.6) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      solve( Insert( <'obj', h2>,
                                                     <z.1, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                      'undef', 'undef'>
                                             ) @ #t2.4 )
                                        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                        solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                     'off', 'on', 'undef', 'undef'>,
                                                                    <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                     'off', 'on', 'undef', 'undef'>,
                                                                    k, z.1, v, L_h, lock
                                               ) ▶₀ #t2.4 )
                                          case lookupFtemplateattuttemvasut_0_111112111111
                                          solve( Insert( <'F_template', z.2>,
                                                         <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                          'undef', 'undef'>
                                                 ) @ #t2.7 )
                                            case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                            solve( (#t2.1 < #t2.6)  ∥ (#t2.1 = #t2.6) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( State_1111121111111111111111( ut, atts, h2, k.1, m.1, v,
                                                                                   L_h.1, ~n.6
                                                     ) ▶₀ #t2.5 )
                                                case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                solve( (#t2.7 < #t2.9)  ∥ (#t2.7 = #t2.9) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                    case case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_2
                                                    solve( Insert( <'obj', h1>,
                                                                   <z, 'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                    x.5, 'usage', x.6>
                                                           ) @ #t2.6 )
                                                      case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                      solve( State_1111121111111( <'on', x, x.1, x.2, x.3, 
                                                                                   x.4, 'on', x.5, 'usage', 
                                                                                   x.6>,
                                                                                  <'on', x, x.1, x.2, x.3, 
                                                                                   x.4, 'on', x.5, 'usage', 
                                                                                   x.6>,
                                                                                  k.1, z, v, L_h.1, lock
                                                             ) ▶₀ #t2.6 )
                                                        case lookupFtemplateattuttemvasut_0_111112111111
                                                        solve( (#vr.39 < #vr.28)  ∥ (#t2.5 < #vr.39) )
                                                          case case_1
                                                          solve( Insert( <'F_template', z.1>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.9 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* cyclic */
                                                          qed
                                                        next
                                                          case case_2
                                                          solve( Insert( <'F_template', z.1>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.9 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* cyclic */
                                                          qed
                                                        qed
                                                      qed
                                                    next
                                                      case insertobjLhkatts_0_11111111111111111
                                                      solve( State_11111111111111111( lock, h1,
                                                                                      <'on', x, x.1, x.2, 
                                                                                       x.3, x.4, 'on', x.5, 
                                                                                       'usage', x.6>,
                                                                                      z, ptr, templ
                                                             ) ▶₀ #t2.6 )
                                                        case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                        solve( (#vr.37 < #vr.28)  ∥ (#t2.5 < #vr.37) )
                                                          case case_1
                                                          solve( Insert( <'F_template', ptr>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.9 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          solve( Insert( <'F_template', ptr>,
                                                                         <'on', x, x.1, x.2, x.3, x.4, 'on', 
                                                                          x.5, 'usage', x.6>
                                                                 ) @ #t2.9 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* from formulas */
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case insertobjLhkatts_0_11111111111111111
                                        solve( State_11111111111111111( lock, h2,
                                                                        <'off', 'off', 'on', 'on', 'on', 
                                                                         'on', 'off', 'on', 'undef', 'undef'>,
                                                                        z.1, ptr, templ
                                               ) ▶₀ #t2.4 )
                                          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                          by contradiction /* impossible chain */
                                        qed
                                      qed
                                    next
                                      case case_3
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case case_3
                                  solve( State_11111111111111111111111( ~n.4, L_h, atts, k, ptr, templ
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                    solve( (#t2.7 < #t2.1)  ∥ (#t2.7 = #t2.1)  ∥ (#vr.10 < #t2.7) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      by contradiction /* from formulas */
                                    next
                                      case case_3
                                      solve( (#t2.4 < #t2.7)  ∥ (#t2.4 = #t2.7) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( State_1( ) ▶₀ #t2.4 )
                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                          by contradiction /* cyclic */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        by contradiction /* from formulas */
      next
        case case_4
        by contradiction /* from formulas */
      next
        case case_5
        by contradiction /* from formulas */
      next
        case case_6
        by contradiction /* from formulas */
      qed
    next
      case case_2
      solve( (#t1.1 = #t2)  ∥ (#t2 < #t1.1) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      qed
    next
      case case_3
      solve( (#t1.1 = #t3)  ∥ (#t3 < #t1.1)  ∥
             (∀ #t2.
               (Unlock_0( '0', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1.1 = #t2) ∨
                (#t2 < #t1.1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                  (¬(#t0 = #t1.1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1.1)  ∥ (#t1.1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                   (¬(#t0 = #t1.1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1.1)  ∥ (#t1.1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1.1)  ∥ (#t1.1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_4
      solve( (#t1.1 = #t3)  ∥ (#t3 < #t1.1)  ∥
             (∀ #t2.
               (Unlock_1( '1', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1.1 = #t2) ∨
                (#t2 < #t1.1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                  (¬(#t0 = #t1.1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1.1)  ∥ (#t1.1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                   (¬(#t0 = #t1.1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1.1)  ∥ (#t1.1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1.1)  ∥ (#t1.1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_5
      solve( (#t1.1 = #t3)  ∥ (#t3 < #t1.1)  ∥
             (∀ #t2.
               (Unlock_2( '2', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1.1 = #t2) ∨
                (#t2 < #t1.1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                  (¬(#t0 = #t1.1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1.1)  ∥ (#t1.1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                   (¬(#t0 = #t1.1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1.1)  ∥ (#t1.1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1.1)  ∥ (#t1.1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_6
      solve( (#t1.1 = #t3)  ∥ (#t3 < #t1.1)  ∥
             (∀ #t2.
               (Unlock_3( '3', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1.1 = #t2) ∨
                (#t2 < #t1.1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                  (¬(#t0 = #t1.1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1.1)  ∥ (#t1.1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                   (¬(#t0 = #t1.1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1.1)  ∥ (#t1.1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1.1)  ∥ (#t1.1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_7
      solve( (#t1.1 = #t3)  ∥ (#t3 < #t1.1)  ∥
             (∀ #t2.
               (Unlock_4( '4', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1.1 = #t2) ∨
                (#t2 < #t1.1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                  (¬(#t0 = #t1.1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1.1)  ∥ (#t1.1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                   (¬(#t0 = #t1.1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1.1)  ∥ (#t1.1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1.1)  ∥ (#t1.1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_8
      solve( (#t1.1 = #t3)  ∥ (#t3 < #t1.1)  ∥
             (∀ #t2.
               (Unlock_5( '5', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1.1 = #t2) ∨
                (#t2 < #t1.1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                  (¬(#t0 = #t1.1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1.1)  ∥ (#t1.1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                   (¬(#t0 = #t1.1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1.1) ∨ (#t1.1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1.1)  ∥ (#t1.1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1.1)  ∥ (#t1.1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    qed
  next
    case case_2
    solve( ((∀ k m #t1.
              (DecUsing( k, m ) @ #t1)
             ⇒
              ((last(#t1)) ∨
               (∃ h2 k2 #t2 #t3.
                 (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)) ∨
               (∃ h2 #t2 #t3 #t4.
                 (NewKey( h2, k, 'off' ) @ #t2) ∧ (!KU( k ) @ #t3) ∧ (!KU( m ) @ #t4)
                ∧
                 (¬(last(#t4))) ∧
                 (¬(last(#t3))) ∧
                 (¬(last(#t2))) ∧
                 (#t2 < #t1) ∧
                 (#t3 < #t1) ∧
                 (#t4 < #t1)) ∨
               (∃ #t2. (EncUsing( k, m ) @ #t2) ∧ (¬(last(#t2))) ∧ (#t2 < #t1)) ∨
               (∃ h2 k2 #t2 #t3 a.
                 (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)) ∨
               (∃ #t2 #t3 h1 h2 k2.
                 (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)))) ∧
            (∀ k #t2.
              (GetKeyValue( k ) @ #t2)
             ⇒
              ((last(#t2)) ∨
               (∃ L_h #t1. (NewKey( L_h, k, 'off' ) @ #t1) ∧ ¬(last(#t1))))) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'trusted'>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'untrusted'>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'trusted', ut>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'untrusted', ut>
               ) @ #t)
             ⇒
              last(#t)))  ∥
           (∃ x y #t3.
             (IsIn( x, y ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (∀ #t2.
               (Insert( x, y ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t1 yp.
                  (Insert( x, yp ) @ #t1)
                 ∧
                  (¬(last(#t1))) ∧
                  (((#t1 = #t2) ∨ (#t2 < #t1))) ∧
                  (¬(#t1 = #t2)) ∧
                  (((#t3 = #t1) ∨ (#t1 < #t3)))))))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_0( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_0( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_1( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_1( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_2( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_2( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_3( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_3( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_4( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_4( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_5( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_5( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3))) )
      case case_1
      solve( (last(#t2))  ∥
             (∃ L_h #t1. (NewKey( L_h, k, 'off' ) @ #t1) ∧ ¬(last(#t1))) )
        case case_1
        solve( State_111121111( <k, x, x.1, x.2, x.3, 'off', x.4, x.5, x.6, x.7, 
                                 x.8>,
                                L_h, lock
               ) ▶₀ #t2 )
          case lookupobjLhasv_0_11112111
          solve( Insert( <'obj', L_h>,
                         <k, x, x.1, x.2, x.3, 'off', x.4, x.5, x.6, x.7, x.8>
                 ) @ #t2.1 )
            case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
            solve( State_1111121111111( <x, x.1, x.2, x.3, 'off', x.4, x.5, x.6, 
                                         x.7, x.8>,
                                        <x, x.1, x.2, x.3, 'off', x.4, x.5, x.6, x.7, x.8>, k.1, k, v, L_h,
                                        lock
                   ) ▶₀ #t2.1 )
              case lookupFtemplateattuttemvasut_0_111112111111
              solve( Insert( <'F_template', z>,
                             <x, x.1, x.2, x.3, 'off', x.4, x.5, x.6, x.7, x.8>
                     ) @ #t2.3 )
                case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                by contradiction /* cyclic */
              qed
            qed
          next
            case insertobjLhkatts_0_11111111111111111
            solve( State_11111111111111111( lock, L_h,
                                            <x, x.1, x.2, x.3, 'off', x.4, x.5, x.6, x.7, x.8>, k, ptr, templ
                   ) ▶₀ #t2.1 )
              case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
              by contradiction /* from formulas */
            qed
          qed
        qed
      next
        case case_2
        by contradiction /* from formulas */
      qed
    next
      case case_2
      solve( (#t1 = #t2.1)  ∥ (#t2.1 < #t1) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      qed
    next
      case case_3
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_0( '0', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧ (¬(#t0 = #t2.1)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2.1 = #t0) ∨ (#t0 < #t2.1))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2.1 = #t0) ∨ (#t0 < #t2.1))) ∧
                   (¬(#t2.1 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2.1 = #t0)  ∥ (#t0 < #t2.1) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_4
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_1( '1', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧ (¬(#t0 = #t2.1)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2.1 = #t0) ∨ (#t0 < #t2.1))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2.1 = #t0) ∨ (#t0 < #t2.1))) ∧
                   (¬(#t2.1 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2.1 = #t0)  ∥ (#t0 < #t2.1) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_5
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_2( '2', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧ (¬(#t0 = #t2.1)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2.1 = #t0) ∨ (#t0 < #t2.1))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2.1 = #t0) ∨ (#t0 < #t2.1))) ∧
                   (¬(#t2.1 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2.1 = #t0)  ∥ (#t0 < #t2.1) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_6
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_3( '3', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧ (¬(#t0 = #t2.1)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2.1 = #t0) ∨ (#t0 < #t2.1))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2.1 = #t0) ∨ (#t0 < #t2.1))) ∧
                   (¬(#t2.1 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2.1 = #t0)  ∥ (#t0 < #t2.1) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_7
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_4( '4', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧ (¬(#t0 = #t2.1)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2.1 = #t0) ∨ (#t0 < #t2.1))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2.1 = #t0) ∨ (#t0 < #t2.1))) ∧
                   (¬(#t2.1 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2.1 = #t0)  ∥ (#t0 < #t2.1) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_8
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_5( '5', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧ (¬(#t0 = #t2.1)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2.1 = #t0) ∨ (#t0 < #t2.1))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2.1 = #t0) ∨ (#t0 < #t2.1))) ∧
                   (¬(#t2.1 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2.1 = #t0)  ∥ (#t0 < #t2.1) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    qed
  next
    case case_3
    solve( ((∀ k m #t1.
              (DecUsing( k, m ) @ #t1)
             ⇒
              ((last(#t1)) ∨
               (∃ h2 k2 #t2 #t3.
                 (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)) ∨
               (∃ h2 #t2 #t3 #t4.
                 (NewKey( h2, k, 'off' ) @ #t2) ∧ (!KU( k ) @ #t3) ∧ (!KU( m ) @ #t4)
                ∧
                 (¬(last(#t4))) ∧
                 (¬(last(#t3))) ∧
                 (¬(last(#t2))) ∧
                 (#t2 < #t1) ∧
                 (#t3 < #t1) ∧
                 (#t4 < #t1)) ∨
               (∃ #t2. (EncUsing( k, m ) @ #t2) ∧ (¬(last(#t2))) ∧ (#t2 < #t1)) ∨
               (∃ h2 k2 #t2 #t3 a.
                 (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)) ∨
               (∃ #t2 #t3 h1 h2 k2.
                 (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)))) ∧
            (∀ k #t2.
              (GetKeyValue( k ) @ #t2)
             ⇒
              ((last(#t2)) ∨
               (∃ L_h #t1. (NewKey( L_h, k, 'off' ) @ #t1) ∧ ¬(last(#t1))))) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'trusted'>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'untrusted'>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'trusted', ut>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'untrusted', ut>
               ) @ #t)
             ⇒
              last(#t)))  ∥
           (∃ x y #t3.
             (IsIn( x, y ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (∀ #t2.
               (Insert( x, y ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t1 yp.
                  (Insert( x, yp ) @ #t1)
                 ∧
                  (¬(last(#t1))) ∧
                  (((#t1 = #t2) ∨ (#t2 < #t1))) ∧
                  (¬(#t1 = #t2)) ∧
                  (((#t3 = #t1) ∨ (#t1 < #t3)))))))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_0( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_0( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_1( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_1( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_2( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_2( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_3( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_3( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_4( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_4( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_5( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_5( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3))) )
      case case_1
      solve( Insert( <'obj', L_h>,
                     <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'trusted'>
             ) @ #t )
        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
        solve( State_1111121111111( <wrap, unwrap, enc, dec, sens, extr, trus, 
                                     wwt, wt, 'trusted'>,
                                    <wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'trusted'>, k, k.1,
                                    v, L_h, lock
               ) ▶₀ #t )
          case lookupFtemplateattuttemvasut_0_111112111111
          by solve( Insert( <'F_template', z>,
                            <wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'trusted'>
                    ) @ #t2 )
        qed
      next
        case insertobjLhkatts_0_11111111111111111
        solve( State_11111111111111111( lock, L_h,
                                        <wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'trusted'>, k,
                                        ptr, templ
               ) ▶₀ #t )
          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
          by solve( Insert( <'F_template', ptr>,
                            <wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'trusted'>
                    ) @ #t2 )
        qed
      qed
    next
      case case_2
      solve( (#t1 = #t2)  ∥ (#t2 < #t1) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      qed
    next
      case case_3
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_0( '0', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_4
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_1( '1', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_5
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_2( '2', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_6
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_3( '3', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_7
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_4( '4', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_8
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_5( '5', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    qed
  next
    case case_4
    solve( ((∀ k m #t1.
              (DecUsing( k, m ) @ #t1)
             ⇒
              ((last(#t1)) ∨
               (∃ h2 k2 #t2 #t3.
                 (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)) ∨
               (∃ h2 #t2 #t3 #t4.
                 (NewKey( h2, k, 'off' ) @ #t2) ∧ (!KU( k ) @ #t3) ∧ (!KU( m ) @ #t4)
                ∧
                 (¬(last(#t4))) ∧
                 (¬(last(#t3))) ∧
                 (¬(last(#t2))) ∧
                 (#t2 < #t1) ∧
                 (#t3 < #t1) ∧
                 (#t4 < #t1)) ∨
               (∃ #t2. (EncUsing( k, m ) @ #t2) ∧ (¬(last(#t2))) ∧ (#t2 < #t1)) ∨
               (∃ h2 k2 #t2 #t3 a.
                 (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)) ∨
               (∃ #t2 #t3 h1 h2 k2.
                 (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)))) ∧
            (∀ k #t2.
              (GetKeyValue( k ) @ #t2)
             ⇒
              ((last(#t2)) ∨
               (∃ L_h #t1. (NewKey( L_h, k, 'off' ) @ #t1) ∧ ¬(last(#t1))))) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'trusted'>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'untrusted'>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'trusted', ut>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'untrusted', ut>
               ) @ #t)
             ⇒
              last(#t)))  ∥
           (∃ x y #t3.
             (IsIn( x, y ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (∀ #t2.
               (Insert( x, y ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t1 yp.
                  (Insert( x, yp ) @ #t1)
                 ∧
                  (¬(last(#t1))) ∧
                  (((#t1 = #t2) ∨ (#t2 < #t1))) ∧
                  (¬(#t1 = #t2)) ∧
                  (((#t3 = #t1) ∨ (#t1 < #t3)))))))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_0( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_0( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_1( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_1( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_2( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_2( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_3( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_3( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_4( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_4( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_5( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_5( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3))) )
      case case_1
      solve( Insert( <'obj', L_h>,
                     <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'untrusted'>
             ) @ #t )
        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
        solve( State_1111121111111( <wrap, unwrap, enc, dec, sens, extr, trus, 
                                     wwt, wt, 'untrusted'>,
                                    <wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'untrusted'>, k, k.1,
                                    v, L_h, lock
               ) ▶₀ #t )
          case lookupFtemplateattuttemvasut_0_111112111111
          by solve( Insert( <'F_template', z>,
                            <wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'untrusted'>
                    ) @ #t2 )
        qed
      next
        case insertobjLhkatts_0_11111111111111111
        solve( State_11111111111111111( lock, L_h,
                                        <wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'untrusted'>, k,
                                        ptr, templ
               ) ▶₀ #t )
          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
          by solve( Insert( <'F_template', ptr>,
                            <wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'untrusted'>
                    ) @ #t2 )
        qed
      qed
    next
      case case_2
      solve( (#t1 = #t2)  ∥ (#t2 < #t1) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      qed
    next
      case case_3
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_0( '0', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_4
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_1( '1', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_5
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_2( '2', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_6
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_3( '3', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_7
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_4( '4', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_8
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_5( '5', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    qed
  next
    case case_5
    solve( ((∀ k m #t1.
              (DecUsing( k, m ) @ #t1)
             ⇒
              ((last(#t1)) ∨
               (∃ h2 k2 #t2 #t3.
                 (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)) ∨
               (∃ h2 #t2 #t3 #t4.
                 (NewKey( h2, k, 'off' ) @ #t2) ∧ (!KU( k ) @ #t3) ∧ (!KU( m ) @ #t4)
                ∧
                 (¬(last(#t4))) ∧
                 (¬(last(#t3))) ∧
                 (¬(last(#t2))) ∧
                 (#t2 < #t1) ∧
                 (#t3 < #t1) ∧
                 (#t4 < #t1)) ∨
               (∃ #t2. (EncUsing( k, m ) @ #t2) ∧ (¬(last(#t2))) ∧ (#t2 < #t1)) ∨
               (∃ h2 k2 #t2 #t3 a.
                 (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)) ∨
               (∃ #t2 #t3 h1 h2 k2.
                 (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)))) ∧
            (∀ k #t2.
              (GetKeyValue( k ) @ #t2)
             ⇒
              ((last(#t2)) ∨
               (∃ L_h #t1. (NewKey( L_h, k, 'off' ) @ #t1) ∧ ¬(last(#t1))))) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'trusted'>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'untrusted'>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'trusted', ut>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'untrusted', ut>
               ) @ #t)
             ⇒
              last(#t)))  ∥
           (∃ x y #t3.
             (IsIn( x, y ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (∀ #t2.
               (Insert( x, y ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t1 yp.
                  (Insert( x, yp ) @ #t1)
                 ∧
                  (¬(last(#t1))) ∧
                  (((#t1 = #t2) ∨ (#t2 < #t1))) ∧
                  (¬(#t1 = #t2)) ∧
                  (((#t3 = #t1) ∨ (#t1 < #t3)))))))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_0( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_0( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_1( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_1( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_2( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_2( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_3( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_3( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_4( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_4( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_5( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_5( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3))) )
      case case_1
      solve( Insert( <'obj', L_h>,
                     <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'trusted', ut>
             ) @ #t )
        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
        solve( State_1111121111111( <wrap, unwrap, enc, dec, sens, extr, trus, 
                                     wwt, 'trusted', ut>,
                                    <wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'trusted', ut>, k, k.1,
                                    v, L_h, lock
               ) ▶₀ #t )
          case lookupFtemplateattuttemvasut_0_111112111111
          by solve( Insert( <'F_template', z>,
                            <wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'trusted', ut>
                    ) @ #t2 )
        qed
      next
        case insertobjLhkatts_0_11111111111111111
        solve( State_11111111111111111( lock, L_h,
                                        <wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'trusted', ut>, k,
                                        ptr, templ
               ) ▶₀ #t )
          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
          by solve( Insert( <'F_template', ptr>,
                            <wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'trusted', ut>
                    ) @ #t2 )
        qed
      qed
    next
      case case_2
      solve( (#t1 = #t2)  ∥ (#t2 < #t1) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      qed
    next
      case case_3
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_0( '0', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_4
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_1( '1', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_5
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_2( '2', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_6
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_3( '3', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_7
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_4( '4', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_8
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_5( '5', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    qed
  next
    case case_6
    solve( ((∀ k m #t1.
              (DecUsing( k, m ) @ #t1)
             ⇒
              ((last(#t1)) ∨
               (∃ h2 k2 #t2 #t3.
                 (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)) ∨
               (∃ h2 #t2 #t3 #t4.
                 (NewKey( h2, k, 'off' ) @ #t2) ∧ (!KU( k ) @ #t3) ∧ (!KU( m ) @ #t4)
                ∧
                 (¬(last(#t4))) ∧
                 (¬(last(#t3))) ∧
                 (¬(last(#t2))) ∧
                 (#t2 < #t1) ∧
                 (#t3 < #t1) ∧
                 (#t4 < #t1)) ∨
               (∃ #t2. (EncUsing( k, m ) @ #t2) ∧ (¬(last(#t2))) ∧ (#t2 < #t1)) ∨
               (∃ h2 k2 #t2 #t3 a.
                 (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)) ∨
               (∃ #t2 #t3 h1 h2 k2.
                 (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
                ∧
                 (¬(last(#t3))) ∧ (¬(last(#t2))) ∧ (#t2 < #t1) ∧ (#t3 < #t1)))) ∧
            (∀ k #t2.
              (GetKeyValue( k ) @ #t2)
             ⇒
              ((last(#t2)) ∨
               (∃ L_h #t1. (NewKey( L_h, k, 'off' ) @ #t1) ∧ ¬(last(#t1))))) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'trusted'>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt wt #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, wt, 'untrusted'>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'trusted', ut>
               ) @ #t)
             ⇒
              last(#t)) ∧
            (∀ L_h k wrap unwrap enc dec sens extr trus wwt ut #t.
              (Insert( <'obj', L_h>,
                       <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'untrusted', ut>
               ) @ #t)
             ⇒
              last(#t)))  ∥
           (∃ x y #t3.
             (IsIn( x, y ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (∀ #t2.
               (Insert( x, y ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t1 yp.
                  (Insert( x, yp ) @ #t1)
                 ∧
                  (¬(last(#t1))) ∧
                  (((#t1 = #t2) ∨ (#t2 < #t1))) ∧
                  (¬(#t1 = #t2)) ∧
                  (((#t3 = #t1) ∨ (#t1 < #t3)))))))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_0( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_0( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_1( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_1( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_2( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_2( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_3( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_3( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_4( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_4( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3)))  ∥
           (∃ p pp l x lp #t1 #t3.
             (Lock_5( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
            ∧
             (¬(last(#t3))) ∧
             (¬(last(#t1))) ∧
             (((#t1 = #t3) ∨
               (#t3 < #t1) ∨
               (∀ #t2.
                 (Unlock_5( p, l, x ) @ #t2)
                ⇒
                 ((last(#t2)) ∨
                  (#t1 = #t2) ∨
                  (#t2 < #t1) ∨
                  (#t2 = #t3) ∨
                  (#t3 < #t2) ∨
                  (∃ #t0 pp.1.
                    (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                  (∃ pp.1 lpp #t0.
                    (Lock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (¬(#t0 = #t1)) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                  (∃ pp.1 lpp #t0.
                    (Unlock( pp.1, lpp, x ) @ #t0)
                   ∧
                    (¬(last(#t0))) ∧
                    (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                    (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                    (¬(#t2 = #t0))))))) ∧
             (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
             (¬(#t1 = #t3))) )
      case case_1
      solve( Insert( <'obj', L_h>,
                     <k, wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'untrusted', ut>
             ) @ #t )
        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
        solve( State_1111121111111( <wrap, unwrap, enc, dec, sens, extr, trus, 
                                     wwt, 'untrusted', ut>,
                                    <wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'untrusted', ut>, k, k.1,
                                    v, L_h, lock
               ) ▶₀ #t )
          case lookupFtemplateattuttemvasut_0_111112111111
          by solve( Insert( <'F_template', z>,
                            <wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'untrusted', ut>
                    ) @ #t2 )
        qed
      next
        case insertobjLhkatts_0_11111111111111111
        solve( State_11111111111111111( lock, L_h,
                                        <wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'untrusted', ut>, k,
                                        ptr, templ
               ) ▶₀ #t )
          case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
          by solve( Insert( <'F_template', ptr>,
                            <wrap, unwrap, enc, dec, sens, extr, trus, wwt, 'untrusted', ut>
                    ) @ #t2 )
        qed
      qed
    next
      case case_2
      solve( (#t1 = #t2)  ∥ (#t2 < #t1) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      qed
    next
      case case_3
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_0( '0', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_4
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_1( '1', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_5
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_2( '2', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_6
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_3( '3', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_7
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_4( '4', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case case_8
      solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
             (∀ #t2.
               (Unlock_5( '5', ~n, 'device' ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.
                  (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp lpp #t0.
                  (Lock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp lpp #t0.
                  (Unlock( pp, lpp, 'device' ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      next
        case case_3
        solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (∃ #t0 pp.
                   (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
                 (∃ pp lpp #t0.
                   (Lock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (¬(#t0 = #t1)) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
                 (∃ pp lpp #t0.
                   (Unlock( pp, lpp, 'device' ) @ #t0)
                  ∧
                   (¬(last(#t0))) ∧
                   (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                   (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                   (¬(#t2 = #t0))) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_3
            solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma bad_keys [reuse, use_induction]:
  all-traces
  "∀ h2 k #t2 a.
    (Unwrapped( h2, k, a ) @ #t2) ⇒
    ((((∃ h1 #t1. (NewKey( h1, k, 'on' ) @ #t1) ∧ (#t1 < #t2)) ∨
       (∃ L_h k2 #t1 #t0.
         (((NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)) ∧ (#t1 < #t2)) ∧
         (#t0 < #t2))) ∨
      (∃ #t0 #t1 h1 h2.1 k.1.
        (((WrapKey( h2.1, k.1, 'on' ) @ #t0) ∧ (DecKey( h1, k.1, 'on' ) @ #t1)) ∧
         (#t0 < #t2)) ∧
        (#t1 < #t2))) ∨
     (∃ #t0 #t1 h1 h2.1 k.1.
       (((UnwrapKey( h2.1, k.1, 'on' ) @ #t0) ∧
         (EncKey( h1, k.1, 'on' ) @ #t1)) ∧
        (#t0 < #t2)) ∧
       (#t1 < #t2)))"
/*
guarded formula characterizing all counter-examples:
"∃ h2 k #t2 a.
  (Unwrapped( h2, k, a ) @ #t2)
 ∧
  (∀ h1 #t1. (NewKey( h1, k, 'on' ) @ #t1) ⇒ ¬(#t1 < #t2)) ∧
  (∀ L_h k2 #t1 #t0.
    (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
   ⇒
    ((¬(#t1 < #t2)) ∨ (¬(#t0 < #t2)))) ∧
  (∀ #t0 #t1 h1 h2.1 k.1.
    (WrapKey( h2.1, k.1, 'on' ) @ #t0) ∧ (DecKey( h1, k.1, 'on' ) @ #t1)
   ⇒
    ((¬(#t0 < #t2)) ∨ (¬(#t1 < #t2)))) ∧
  (∀ #t0 #t1 h1 h2.1 k.1.
    (UnwrapKey( h2.1, k.1, 'on' ) @ #t0) ∧ (EncKey( h1, k.1, 'on' ) @ #t1)
   ⇒
    ((¬(#t0 < #t2)) ∨ (¬(#t1 < #t2))))"
*/
induction
  case empty_trace
  by contradiction /* from formulas */
next
  case non_empty_trace
  simplify
  solve( (∀ h2 k #t2 a.
           (Unwrapped( h2, k, a ) @ #t2)
          ⇒
           ((last(#t2)) ∨
            (∃ h1 #t1.
              (NewKey( h1, k, 'on' ) @ #t1) ∧ (¬(last(#t1))) ∧ (#t1 < #t2)) ∨
            (∃ L_h k2 #t1 #t0.
              (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
             ∧
              (¬(last(#t0))) ∧ (¬(last(#t1))) ∧ (#t1 < #t2) ∧ (#t0 < #t2)) ∨
            (∃ #t0 #t1 h1 h2.1 k.1.
              (WrapKey( h2.1, k.1, 'on' ) @ #t0) ∧ (DecKey( h1, k.1, 'on' ) @ #t1)
             ∧
              (¬(last(#t1))) ∧ (¬(last(#t0))) ∧ (#t0 < #t2) ∧ (#t1 < #t2)) ∨
            (∃ #t0 #t1 h1 h2.1 k.1.
              (UnwrapKey( h2.1, k.1, 'on' ) @ #t0) ∧ (EncKey( h1, k.1, 'on' ) @ #t1)
             ∧
              (¬(last(#t1))) ∧ (¬(last(#t0))) ∧ (#t0 < #t2) ∧ (#t1 < #t2))))  ∥
         (∃ x y #t3.
           (IsIn( x, y ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (∀ #t2.
             (Insert( x, y ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t1 yp.
                (Insert( x, yp ) @ #t1)
               ∧
                (¬(last(#t1))) ∧
                (((#t1 = #t2) ∨ (#t2 < #t1))) ∧
                (¬(#t1 = #t2)) ∧
                (((#t3 = #t1) ∨ (#t1 < #t3)))))))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_0( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_0( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_1( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_1( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_2( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_2( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_3( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_3( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_4( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_4( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_5( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_5( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3))) )
    case case_1
    solve( (last(#t2))  ∥
           (∃ h1 #t1.
             (NewKey( h1, k.1, 'on' ) @ #t1) ∧ (¬(last(#t1))) ∧ (#t1 < #t2))  ∥
           (∃ L_h k2 #t1 #t0.
             (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
            ∧
             (¬(last(#t0))) ∧ (¬(last(#t1))) ∧ (#t1 < #t2) ∧ (#t0 < #t2))  ∥
           (∃ #t0 #t1 h1 h2 k.
             (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
            ∧
             (¬(last(#t1))) ∧ (¬(last(#t0))) ∧ (#t0 < #t2) ∧ (#t1 < #t2))  ∥
           (∃ #t0 #t1 h1 h2 k.
             (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
            ∧
             (¬(last(#t1))) ∧ (¬(last(#t0))) ∧ (#t0 < #t2) ∧ (#t1 < #t2)) )
      case case_1
      solve( State_1111121111111111( ut, a, h2, k, k.1, v, L_h, lock ) ▶₀ #t2 )
        case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
        solve( Insert( <'F_template', z>, ut ) @ #t2.1 )
          case insertFtemplatetrustedononoffoffononononusageusage_0_
          by contradiction /* from formulas */
        next
          case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
          by contradiction /* from formulas */
        next
          case insertFtemplateusageoffoffononononoffonundefundef_0_1
          solve( (#vr.8 < #t2.1)  ∥ (#vr.8 = #t2.1) )
            case case_1
            solve( State_1( ) ▶₀ #t2.1 )
              case insertFtemplatetrustedononoffoffononononusageusage_0_
              by contradiction /* cyclic */
            qed
          next
            case case_2
            solve( !KU( senc(k.1, k) ) @ #vk.3 )
              case c_senc
              solve( Insert( <'obj', L_h>,
                             <k, x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                     ) @ #t2.2 )
                case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                solve( State_1111121111111( <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 
                                             'usage'>,
                                            <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>, k.2, k, v,
                                            L_h, lock
                       ) ▶₀ #t2.2 )
                  case lookupFtemplateattuttemvasut_0_111112111111
                  solve( Insert( <'F_template', z>,
                                 <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                         ) @ #t2.4 )
                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                    by contradiction /* from formulas */
                  qed
                qed
              next
                case insertobjLhkatts_0_11111111111111111
                solve( State_11111111111111111( lock, L_h,
                                                <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>, k, ptr,
                                                templ
                       ) ▶₀ #t2.2 )
                  case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                  solve( Insert( <'F_template', ptr>,
                                 <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                         ) @ #t2.4 )
                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            next
              case eventDecUsingkm_0_111111112111111
              solve( (∃ h2 k2 #t2 #t3.
                       (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                      ∧
                       (#t2 < #vr.10) ∧ (#t3 < #vr.10))  ∥
                     (∃ h2 #t2 #t3 #t4.
                       (NewKey( h2, k.2, 'off' ) @ #t2) ∧ (!KU( k.2 ) @ #t3) ∧ (!KU( t ) @ #t4)
                      ∧
                       (#t2 < #vr.10) ∧ (#t3 < #vr.10) ∧ (#t4 < #vr.10))  ∥
                     (∃ #t2. (EncUsing( k.2, t ) @ #t2) ∧ #t2 < #vr.10)  ∥
                     (∃ h2 k2 #t2 #t3 a.
                       (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                      ∧
                       (#t2 < #vr.10) ∧ (#t3 < #vr.10))  ∥
                     (∃ #t2 #t3 h1 h2 k2.
                       (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
                      ∧
                       (#t2 < #vr.10) ∧ (#t3 < #vr.10)) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* cyclic */
              next
                case case_3
                solve( State_11111111211111111( ~n.2, m, v, L_h.1, k.2 ) ▶₀ #t2.2 )
                  case eventDecUsingkm_0_111111112111111
                  solve( (#t2.5 < #t2.6)  ∥ (#t2.5 = #t2.6) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    solve( State_111111121111( lock, m,
                                               <k.2, x.17, x.18, 'on', x.19, x.20, x.21, x.22, x.23, x.24, 
                                                x.25>,
                                               L_h.2
                           ) ▶₀ #t2.3 )
                      case lookupobjLhasv_0_11111112111
                      by contradiction /* cyclic */
                    qed
                  qed
                qed
              next
                case case_4
                solve( (∃ h1 #t1.
                         (NewKey( h1, k2, 'on' ) @ #t1) ∧ (¬(last(#t1))) ∧ (#t1 < #t2.3))  ∥
                       (∃ L_h k2 #t1 #t0.
                         (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                        ∧
                         (¬(last(#t0))) ∧ (¬(last(#t1))) ∧ (#t1 < #t2.3) ∧ (#t0 < #t2.3))  ∥
                       (∃ #t0 #t1 h1 h2 k.
                         (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                        ∧
                         (¬(last(#t1))) ∧ (¬(last(#t0))) ∧ (#t0 < #t2.3) ∧ (#t1 < #t2.3))  ∥
                       (∃ #t0 #t1 h1 h2 k.
                         (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                        ∧
                         (¬(last(#t1))) ∧ (¬(last(#t0))) ∧ (#t0 < #t2.3) ∧ (#t1 < #t2.3)) )
                  case case_1
                  by contradiction /* from formulas */
                next
                  case case_2
                  by contradiction /* from formulas */
                next
                  case case_3
                  by contradiction /* from formulas */
                next
                  case case_4
                  by contradiction /* from formulas */
                qed
              next
                case case_5
                by contradiction /* from formulas */
              qed
            next
              case ifCanencryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111121111
              solve( State_111111121111111( ~n.2, m, v, L_h.2 ) ▶₀ #t2.2 )
                case ifCanencryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111121111
                solve( (#t2.4 < #t2.5)  ∥ (#t2.4 = #t2.5) )
                  case case_1
                  by contradiction /* from formulas */
                next
                  case case_2
                  solve( Insert( <'obj', L_h>,
                                 <k, x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                         ) @ #t2.3 )
                    case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                    solve( State_1111121111111( <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 
                                                 'usage'>,
                                                <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>, k.1, k,
                                                v, L_h.1, lock
                           ) ▶₀ #t2.3 )
                      case lookupFtemplateattuttemvasut_0_111112111111
                      solve( (#vr.18 < #vr.12)  ∥ (#t2.2 < #vr.18) )
                        case case_1
                        solve( Insert( <'F_template', z>,
                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                               ) @ #t2.6 )
                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                          by contradiction /* from formulas */
                        qed
                      next
                        case case_2
                        solve( Insert( <'F_template', z>,
                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                               ) @ #t2.6 )
                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  next
                    case insertobjLhkatts_0_11111111111111111
                    solve( State_11111111111111111( lock, L_h,
                                                    <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>, k,
                                                    ptr, templ
                           ) ▶₀ #t2.3 )
                      case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                      solve( Insert( <'F_template', ptr>,
                                     <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                             ) @ #t2.6 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        solve( (#vr.8 < #t2.5)  ∥ (#vr.8 = #t2.5) )
                          case case_1
                          solve( State_11111111111111111111111( ~n.5, L_h.1, atts, k, ptr, templ
                                 ) ▶₀ #t2.4 )
                            case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                            solve( (#t2.5 < #t2.7)  ∥ (#t2.5 = #t2.7) )
                              case case_1
                              by contradiction /* from formulas */
                            next
                              case case_2
                              solve( State_( ) ▶₀ #t2.5 )
                                case Init
                                by contradiction /* cyclic */
                              qed
                            qed
                          qed
                        next
                          case case_2
                          solve( State_11111111111111111111111( ~n.5, L_h.1, atts, k, ptr, templ
                                 ) ▶₀ #t2.4 )
                            case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                            solve( (#t2.5 < #t2.7)  ∥ (#t2.5 = #t2.7) )
                              case case_1
                              by contradiction /* from formulas */
                            next
                              case case_2
                              solve( Insert( <'obj', L_h>,
                                             <~n.1, x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>
                                     ) @ #t2.6 )
                                case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                solve( State_1111121111111( <x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, 
                                                             x.8>,
                                                            <x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>,
                                                            k, ~n.1, v, L_h, lock
                                       ) ▶₀ #t2.6 )
                                  case lookupFtemplateattuttemvasut_0_111112111111
                                  solve( Insert( <'F_template', z>,
                                                 <x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>
                                         ) @ #t2.8 )
                                    case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                                    by contradiction /* from formulas */
                                  next
                                    case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                    solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      solve( State_1111121111111111111111( ut, atts, h2, k.1, m.1, v, L_h.1,
                                                                           ~n.7
                                             ) ▶₀ #t2.7 )
                                        case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                        by contradiction /* from formulas */
                                      qed
                                    qed
                                  qed
                                qed
                              next
                                case insertobjLhkatts_0_11111111111111111
                                by solve( State_11111111111111111( lock, L_h,
                                                                   <x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, 
                                                                    x.7, x.8>,
                                                                   ~n.1, ptr, templ
                                          ) ▶₀ #t2.6 )
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case ifCangetkeyvalueattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111121111
              solve( State_111111111111111( lock, L_h.2,
                                            <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>, t, ptr,
                                            <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>
                     ) ▶₀ #t1 )
                case lookupFtemplateptrastempl_0_11111111111111
                by contradiction /* impossible chain */
              qed
            next
              case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_1
              solve( (z.8 = 'off')  ∥ ((z.8 = 'on') ∧ (z = 'on')) )
                case case_1
                solve( Insert( <'F_template', z.1>,
                               <z.2, z.3, z.4, z.5, z.6, 'on', z.7, 'off', z.8, z.9>
                       ) @ #t2.4 )
                  case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                  by contradiction /* from formulas */
                qed
              next
                case case_2
                solve( Insert( <'F_template', z>,
                               <z.1, z.2, z.3, z.4, z.5, 'on', z.6, 'on', z.7, z.8>
                       ) @ #t2.4 )
                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                  by contradiction /* from formulas */
                next
                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                  solve( (#t2.1 < #t2.3)  ∥ (#t2.1 = #t2.3) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.2 ) ▶₀ #t2.2 )
                      case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                      solve( (#t2.5 < #t2.8)  ∥ (#t2.5 = #t2.8) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        solve( (#t2.1 < #t2.6)  ∥ (#t2.1 = #t2.6) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( (#t2.4 < #t2.6)  ∥ (#t2.4 = #t2.6) )
                            case case_1
                            by contradiction /* from formulas */
                          next
                            case case_2
                            solve( Insert( <'obj', L_h>,
                                           <k, x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                                   ) @ #t2.3 )
                              case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                              solve( State_1111121111111( <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 
                                                           'usage'>,
                                                          <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'
                                                          >,
                                                          k.2, k, v, L_h, lock
                                     ) ▶₀ #t2.3 )
                                case lookupFtemplateattuttemvasut_0_111112111111
                                solve( (#vr.21 < #vr.15)  ∥ (#t2.2 < #vr.21) )
                                  case case_1
                                  solve( Insert( <'F_template', z>,
                                                 <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                                         ) @ #t2.7 )
                                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case case_2
                                  solve( Insert( <'F_template', z>,
                                                 <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                                         ) @ #t2.7 )
                                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            next
                              case insertobjLhkatts_0_11111111111111111
                              solve( State_11111111111111111( lock, L_h,
                                                              <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 
                                                               'usage'>,
                                                              k, ptr, templ
                                     ) ▶₀ #t2.3 )
                                case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                solve( Insert( <'F_template', ptr>,
                                               <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                                       ) @ #t2.7 )
                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                  solve( (#vr.8 < #t2.5)  ∥ (#vr.8 = #t2.5) )
                                    case case_1
                                    solve( State_11111111111111111111111( ~n.5, L_h, atts, k.1, ptr, templ
                                           ) ▶₀ #t2.4 )
                                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                      solve( (#t2.5 < #t2.8)  ∥ (#t2.5 = #t2.8) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( State_( ) ▶₀ #t2.5 )
                                          case Init
                                          by contradiction /* cyclic */
                                        qed
                                      qed
                                    qed
                                  next
                                    case case_2
                                    solve( State_11111111111111111111111( ~n.5, L_h, atts, k.1, ptr, templ
                                           ) ▶₀ #t2.4 )
                                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                      solve( (#t2.5 < #t2.8)  ∥ (#t2.5 = #t2.8) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( Insert( <'obj', h2>,
                                                       <k, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                        'undef', 'undef'>
                                               ) @ #t2.6 )
                                          case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                          solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                       'off', 'on', 'undef', 'undef'>,
                                                                      <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                       'off', 'on', 'undef', 'undef'>,
                                                                      k.1, k, v, L_h, lock
                                                 ) ▶₀ #t2.6 )
                                            case lookupFtemplateattuttemvasut_0_111112111111
                                            solve( (#vr.28 < #vr.18)  ∥ (#t2.4 < #vr.28) )
                                              case case_1
                                              solve( Insert( <'F_template', z>,
                                                             <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                              'on', 'undef', 'undef'>
                                                     ) @ #t2.9 )
                                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( State_1111121111111111111111( ut, atts, h2, k.2, m,
                                                                                       v, L_h.1, ~n.7
                                                         ) ▶₀ #t2.7 )
                                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                    solve( (∃ h1 #t1.
                                                             (NewKey( h1, k, 'on' ) @ #t1)
                                                            ∧
                                                             (¬(last(#t1))) ∧ (#t1 < #vr.34))  ∥
                                                           (∃ L_h k2 #t1 #t0.
                                                             (NewKey( L_h, k2, 'on' ) @ #t0) ∧
                                                             (!KU( k2 ) @ #t1)
                                                            ∧
                                                             (¬(last(#t0))) ∧
                                                             (¬(last(#t1))) ∧
                                                             (#t1 < #vr.34) ∧
                                                             (#t0 < #vr.34))  ∥
                                                           (∃ #t0 #t1 h1 h2 k.
                                                             (WrapKey( h2, k, 'on' ) @ #t0) ∧
                                                             (DecKey( h1, k, 'on' ) @ #t1)
                                                            ∧
                                                             (¬(last(#t1))) ∧
                                                             (¬(last(#t0))) ∧
                                                             (#t0 < #vr.34) ∧
                                                             (#t1 < #vr.34))  ∥
                                                           (∃ #t0 #t1 h1 h2 k.
                                                             (UnwrapKey( h2, k, 'on' ) @ #t0) ∧
                                                             (EncKey( h1, k, 'on' ) @ #t1)
                                                            ∧
                                                             (¬(last(#t1))) ∧
                                                             (¬(last(#t0))) ∧
                                                             (#t0 < #vr.34) ∧
                                                             (#t1 < #vr.34)) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_3
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_4
                                                      by contradiction /* from formulas */
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            next
                                              case case_2
                                              solve( Insert( <'F_template', z>,
                                                             <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                              'on', 'undef', 'undef'>
                                                     ) @ #t2.9 )
                                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( State_1111121111111111111111( ut, atts, h2, k.2, m,
                                                                                       v, L_h.1, ~n.7
                                                         ) ▶₀ #t2.7 )
                                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                    solve( (∃ h1 #t1.
                                                             (NewKey( h1, k, 'on' ) @ #t1)
                                                            ∧
                                                             (¬(last(#t1))) ∧ (#t1 < #vr.34))  ∥
                                                           (∃ L_h k2 #t1 #t0.
                                                             (NewKey( L_h, k2, 'on' ) @ #t0) ∧
                                                             (!KU( k2 ) @ #t1)
                                                            ∧
                                                             (¬(last(#t0))) ∧
                                                             (¬(last(#t1))) ∧
                                                             (#t1 < #vr.34) ∧
                                                             (#t0 < #vr.34))  ∥
                                                           (∃ #t0 #t1 h1 h2 k.
                                                             (WrapKey( h2, k, 'on' ) @ #t0) ∧
                                                             (DecKey( h1, k, 'on' ) @ #t1)
                                                            ∧
                                                             (¬(last(#t1))) ∧
                                                             (¬(last(#t0))) ∧
                                                             (#t0 < #vr.34) ∧
                                                             (#t1 < #vr.34))  ∥
                                                           (∃ #t0 #t1 h1 h2 k.
                                                             (UnwrapKey( h2, k, 'on' ) @ #t0) ∧
                                                             (EncKey( h1, k, 'on' ) @ #t1)
                                                            ∧
                                                             (¬(last(#t1))) ∧
                                                             (¬(last(#t0))) ∧
                                                             (#t0 < #vr.34) ∧
                                                             (#t1 < #vr.34)) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_3
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_4
                                                      by contradiction /* from formulas */
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        next
                                          case insertobjLhkatts_0_11111111111111111
                                          solve( State_11111111111111111( lock, h2,
                                                                          <'off', 'off', 'on', 'on', 'on', 
                                                                           'on', 'off', 'on', 'undef', 'undef'
                                                                          >,
                                                                          k, ptr, templ
                                                 ) ▶₀ #t2.6 )
                                            case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                            by contradiction /* from formulas */
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_2
              solve( Insert( <'F_template', z.3>,
                             <z.4, z.5, z.6, z.7, z.8, 'on', z.9, 'off', z.10, z.11>
                     ) @ #t2.4 )
                case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                by contradiction /* from formulas */
              qed
            next
              case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_3
              solve( Insert( <'F_template', z.2>,
                             <z.3, z.4, z.5, z.6, z.7, 'on', z.8, 'on', z.9, z.10>
                     ) @ #t2.4 )
                case insertFtemplatetrustedononoffoffononononusageusage_0_
                by contradiction /* from formulas */
              next
                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                solve( (#t2.1 < #t2.3)  ∥ (#t2.1 = #t2.3) )
                  case case_1
                  by contradiction /* from formulas */
                next
                  case case_2
                  solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.2 ) ▶₀ #t2.2 )
                    case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                    solve( (#t2.5 < #t2.8)  ∥ (#t2.5 = #t2.8) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      solve( (#t2.1 < #t2.6)  ∥ (#t2.1 = #t2.6) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        solve( (#t2.4 < #t2.6)  ∥ (#t2.4 = #t2.6) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( Insert( <'obj', L_h>,
                                         <k, x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                                 ) @ #t2.3 )
                            case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                            solve( State_1111121111111( <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 
                                                         'usage'>,
                                                        <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>,
                                                        k.2, k, v, L_h, lock
                                   ) ▶₀ #t2.3 )
                              case lookupFtemplateattuttemvasut_0_111112111111
                              solve( (#vr.22 < #vr.16)  ∥ (#t2.2 < #vr.22) )
                                case case_1
                                solve( Insert( <'F_template', z.2>,
                                               <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                                       ) @ #t2.7 )
                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                  by contradiction /* from formulas */
                                qed
                              next
                                case case_2
                                solve( Insert( <'F_template', z.2>,
                                               <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                                       ) @ #t2.7 )
                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                  by contradiction /* from formulas */
                                qed
                              qed
                            qed
                          next
                            case insertobjLhkatts_0_11111111111111111
                            solve( State_11111111111111111( lock, L_h,
                                                            <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 
                                                             'usage'>,
                                                            k, ptr, templ
                                   ) ▶₀ #t2.3 )
                              case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                              solve( (#vr.20 < #vr.16)  ∥ (#t2.2 < #vr.20) )
                                case case_1
                                solve( Insert( <'F_template', ptr>,
                                               <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                                       ) @ #t2.7 )
                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                  solve( (#vr.8 < #t2.5)  ∥ (#vr.8 = #t2.5) )
                                    case case_1
                                    solve( State_11111111111111111111111( ~n.5, L_h, atts, k.1, ptr, templ
                                           ) ▶₀ #t2.4 )
                                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                      solve( (#t2.5 < #t2.8)  ∥ (#t2.5 = #t2.8) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( State_( ) ▶₀ #t2.5 )
                                          case Init
                                          by contradiction /* cyclic */
                                        qed
                                      qed
                                    qed
                                  next
                                    case case_2
                                    solve( State_11111111111111111111111( ~n.5, L_h, atts, k.1, ptr, templ
                                           ) ▶₀ #t2.4 )
                                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                      solve( (#t2.5 < #t2.8)  ∥ (#t2.5 = #t2.8) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( Insert( <'obj', h2>,
                                                       <z, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                        'undef', 'undef'>
                                               ) @ #t2.6 )
                                          case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                          solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                       'off', 'on', 'undef', 'undef'>,
                                                                      <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                       'off', 'on', 'undef', 'undef'>,
                                                                      k.1, z, v, L_h, lock
                                                 ) ▶₀ #t2.6 )
                                            case lookupFtemplateattuttemvasut_0_111112111111
                                            solve( (#vr.29 < #vr.19)  ∥ (#t2.4 < #vr.29) )
                                              case case_1
                                              solve( Insert( <'F_template', z.2>,
                                                             <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                              'on', 'undef', 'undef'>
                                                     ) @ #t2.9 )
                                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( State_1111121111111111111111( ut, atts, h2, k.2, m,
                                                                                       v, L_h.1, ~n.7
                                                         ) ▶₀ #t2.7 )
                                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                    solve( (∃ h1 #t1.
                                                             (NewKey( h1, m, 'on' ) @ #t1)
                                                            ∧
                                                             (¬(last(#t1))) ∧ (#t1 < #vr.35))  ∥
                                                           (∃ L_h k2 #t1 #t0.
                                                             (NewKey( L_h, k2, 'on' ) @ #t0) ∧
                                                             (!KU( k2 ) @ #t1)
                                                            ∧
                                                             (¬(last(#t0))) ∧
                                                             (¬(last(#t1))) ∧
                                                             (#t1 < #vr.35) ∧
                                                             (#t0 < #vr.35))  ∥
                                                           (∃ #t0 #t1 h1 h2 k.
                                                             (WrapKey( h2, k, 'on' ) @ #t0) ∧
                                                             (DecKey( h1, k, 'on' ) @ #t1)
                                                            ∧
                                                             (¬(last(#t1))) ∧
                                                             (¬(last(#t0))) ∧
                                                             (#t0 < #vr.35) ∧
                                                             (#t1 < #vr.35))  ∥
                                                           (∃ #t0 #t1 h1 h2 k.
                                                             (UnwrapKey( h2, k, 'on' ) @ #t0) ∧
                                                             (EncKey( h1, k, 'on' ) @ #t1)
                                                            ∧
                                                             (¬(last(#t1))) ∧
                                                             (¬(last(#t0))) ∧
                                                             (#t0 < #vr.35) ∧
                                                             (#t1 < #vr.35)) )
                                                      case case_1
                                                      solve( (#t2.9 < #t2.11)  ∥ (#t2.9 = #t2.11) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.1 < #t2.10)  ∥ (#t2.1 = #t2.10) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( State_111111111111111( lock, h1,
                                                                                        <z, z.1, z.2, z.3, 
                                                                                         'on', z.4, z.5, z.6, 
                                                                                         z.7, z.8>,
                                                                                        m, ptr,
                                                                                        <z, z.1, z.2, z.3, 
                                                                                         'on', z.4, z.5, z.6, 
                                                                                         z.7, z.8>
                                                                 ) ▶₀ #t1 )
                                                            case lookupFtemplateptrastempl_0_11111111111111
                                                            by contradiction /* impossible chain */
                                                          qed
                                                        qed
                                                      qed
                                                    next
                                                      case case_2
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_3
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_4
                                                      by contradiction /* from formulas */
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            next
                                              case case_2
                                              solve( Insert( <'F_template', z.2>,
                                                             <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                              'on', 'undef', 'undef'>
                                                     ) @ #t2.9 )
                                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( State_1111121111111111111111( ut, atts, h2, k.2, m,
                                                                                       v, L_h.1, ~n.7
                                                         ) ▶₀ #t2.7 )
                                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                    solve( (∃ h1 #t1.
                                                             (NewKey( h1, m, 'on' ) @ #t1)
                                                            ∧
                                                             (¬(last(#t1))) ∧ (#t1 < #vr.35))  ∥
                                                           (∃ L_h k2 #t1 #t0.
                                                             (NewKey( L_h, k2, 'on' ) @ #t0) ∧
                                                             (!KU( k2 ) @ #t1)
                                                            ∧
                                                             (¬(last(#t0))) ∧
                                                             (¬(last(#t1))) ∧
                                                             (#t1 < #vr.35) ∧
                                                             (#t0 < #vr.35))  ∥
                                                           (∃ #t0 #t1 h1 h2 k.
                                                             (WrapKey( h2, k, 'on' ) @ #t0) ∧
                                                             (DecKey( h1, k, 'on' ) @ #t1)
                                                            ∧
                                                             (¬(last(#t1))) ∧
                                                             (¬(last(#t0))) ∧
                                                             (#t0 < #vr.35) ∧
                                                             (#t1 < #vr.35))  ∥
                                                           (∃ #t0 #t1 h1 h2 k.
                                                             (UnwrapKey( h2, k, 'on' ) @ #t0) ∧
                                                             (EncKey( h1, k, 'on' ) @ #t1)
                                                            ∧
                                                             (¬(last(#t1))) ∧
                                                             (¬(last(#t0))) ∧
                                                             (#t0 < #vr.35) ∧
                                                             (#t1 < #vr.35)) )
                                                      case case_1
                                                      solve( (#t2.9 < #t2.11)  ∥ (#t2.9 = #t2.11) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( (#t2.1 < #t2.10)  ∥ (#t2.1 = #t2.10) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( State_111111111111111( lock, h1,
                                                                                        <z, z.1, z.2, z.3, 
                                                                                         'on', z.4, z.5, z.6, 
                                                                                         z.7, z.8>,
                                                                                        m, ptr,
                                                                                        <z, z.1, z.2, z.3, 
                                                                                         'on', z.4, z.5, z.6, 
                                                                                         z.7, z.8>
                                                                 ) ▶₀ #t1 )
                                                            case lookupFtemplateptrastempl_0_11111111111111
                                                            by contradiction /* impossible chain */
                                                          qed
                                                        qed
                                                      qed
                                                    next
                                                      case case_2
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_3
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_4
                                                      by contradiction /* from formulas */
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        next
                                          case insertobjLhkatts_0_11111111111111111
                                          solve( State_11111111111111111( lock, h2,
                                                                          <'off', 'off', 'on', 'on', 'on', 
                                                                           'on', 'off', 'on', 'undef', 'undef'
                                                                          >,
                                                                          z, ptr, templ
                                                 ) ▶₀ #t2.6 )
                                            case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                            by contradiction /* impossible chain */
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              next
                                case case_2
                                solve( Insert( <'F_template', ptr>,
                                               <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, 'usage'>
                                       ) @ #t2.7 )
                                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                                  solve( (#vr.8 < #t2.5)  ∥ (#vr.8 = #t2.5) )
                                    case case_1
                                    solve( State_11111111111111111111111( ~n.5, L_h, atts, k.1, ptr, templ
                                           ) ▶₀ #t2.4 )
                                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                      solve( (#t2.5 < #t2.8)  ∥ (#t2.5 = #t2.8) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( State_( ) ▶₀ #t2.5 )
                                          case Init
                                          by contradiction /* cyclic */
                                        qed
                                      qed
                                    qed
                                  next
                                    case case_2
                                    solve( State_11111111111111111111111( ~n.5, L_h, atts, k.1, ptr, templ
                                           ) ▶₀ #t2.4 )
                                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                      solve( (#t2.5 < #t2.8)  ∥ (#t2.5 = #t2.8) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( Insert( <'obj', h2>,
                                                       <z, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                        'undef', 'undef'>
                                               ) @ #t2.6 )
                                          case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                          solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                       'off', 'on', 'undef', 'undef'>,
                                                                      <'off', 'off', 'on', 'on', 'on', 'on', 
                                                                       'off', 'on', 'undef', 'undef'>,
                                                                      k.1, z, v, L_h, lock
                                                 ) ▶₀ #t2.6 )
                                            case lookupFtemplateattuttemvasut_0_111112111111
                                            solve( Insert( <'F_template', z.2>,
                                                           <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                            'on', 'undef', 'undef'>
                                                   ) @ #t2.9 )
                                              case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                              solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( State_1111121111111111111111( ut, atts, h2, k.2, m, v,
                                                                                     L_h.1, ~n.7
                                                       ) ▶₀ #t2.7 )
                                                  case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                  solve( (∃ h1 #t1.
                                                           (NewKey( h1, m, 'on' ) @ #t1)
                                                          ∧
                                                           (¬(last(#t1))) ∧ (#t1 < #vr.35))  ∥
                                                         (∃ L_h k2 #t1 #t0.
                                                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                                          ∧
                                                           (¬(last(#t0))) ∧
                                                           (¬(last(#t1))) ∧
                                                           (#t1 < #vr.35) ∧
                                                           (#t0 < #vr.35))  ∥
                                                         (∃ #t0 #t1 h1 h2 k.
                                                           (WrapKey( h2, k, 'on' ) @ #t0) ∧
                                                           (DecKey( h1, k, 'on' ) @ #t1)
                                                          ∧
                                                           (¬(last(#t1))) ∧
                                                           (¬(last(#t0))) ∧
                                                           (#t0 < #vr.35) ∧
                                                           (#t1 < #vr.35))  ∥
                                                         (∃ #t0 #t1 h1 h2 k.
                                                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧
                                                           (EncKey( h1, k, 'on' ) @ #t1)
                                                          ∧
                                                           (¬(last(#t1))) ∧
                                                           (¬(last(#t0))) ∧
                                                           (#t0 < #vr.35) ∧
                                                           (#t1 < #vr.35)) )
                                                    case case_1
                                                    solve( (#t2.9 < #t2.11)  ∥ (#t2.9 = #t2.11) )
                                                      case case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case case_2
                                                      solve( (#t2.1 < #t2.10)  ∥ (#t2.1 = #t2.10) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( State_111111111111111( lock, h1,
                                                                                      <z, z.1, z.2, z.3, 
                                                                                       'on', z.4, z.5, z.6, 
                                                                                       z.7, z.8>,
                                                                                      m, ptr,
                                                                                      <z, z.1, z.2, z.3, 
                                                                                       'on', z.4, z.5, z.6, 
                                                                                       z.7, z.8>
                                                               ) ▶₀ #t1 )
                                                          case lookupFtemplateptrastempl_0_11111111111111
                                                          by contradiction /* impossible chain */
                                                        qed
                                                      qed
                                                    qed
                                                  next
                                                    case case_2
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_3
                                                    by contradiction /* from formulas */
                                                  next
                                                    case case_4
                                                    by contradiction /* from formulas */
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        next
                                          case insertobjLhkatts_0_11111111111111111
                                          solve( State_11111111111111111( lock, h2,
                                                                          <'off', 'off', 'on', 'on', 'on', 
                                                                           'on', 'off', 'on', 'undef', 'undef'
                                                                          >,
                                                                          z, ptr, templ
                                                 ) ▶₀ #t2.6 )
                                            case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                            by contradiction /* impossible chain */
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      by contradiction /* from formulas */
    next
      case case_4
      by contradiction /* from formulas */
    next
      case case_5
      by contradiction /* from formulas */
    qed
  next
    case case_2
    solve( (#t1 = #t2.1)  ∥ (#t2.1 < #t1) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    qed
  next
    case case_3
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_0( '0', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧ (¬(#t0 = #t2.1)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2.1 = #t0) ∨ (#t0 < #t2.1))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2.1 = #t0) ∨ (#t0 < #t2.1))) ∧
                 (¬(#t2.1 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2.1 = #t0)  ∥ (#t0 < #t2.1) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_4
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_1( '1', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧ (¬(#t0 = #t2.1)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2.1 = #t0) ∨ (#t0 < #t2.1))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2.1 = #t0) ∨ (#t0 < #t2.1))) ∧
                 (¬(#t2.1 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2.1 = #t0)  ∥ (#t0 < #t2.1) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_5
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_2( '2', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧ (¬(#t0 = #t2.1)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2.1 = #t0) ∨ (#t0 < #t2.1))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2.1 = #t0) ∨ (#t0 < #t2.1))) ∧
                 (¬(#t2.1 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2.1 = #t0)  ∥ (#t0 < #t2.1) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_6
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_3( '3', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧ (¬(#t0 = #t2.1)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2.1 = #t0) ∨ (#t0 < #t2.1))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2.1 = #t0) ∨ (#t0 < #t2.1))) ∧
                 (¬(#t2.1 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2.1 = #t0)  ∥ (#t0 < #t2.1) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_7
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_4( '4', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧ (¬(#t0 = #t2.1)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2.1 = #t0) ∨ (#t0 < #t2.1))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2.1 = #t0) ∨ (#t0 < #t2.1))) ∧
                 (¬(#t2.1 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2.1 = #t0)  ∥ (#t0 < #t2.1) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_8
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_5( '5', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧ (¬(#t0 = #t2.1)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2.1 = #t0) ∨ (#t0 < #t2.1))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2.1 = #t0) ∨ (#t0 < #t2.1))) ∧
                 (¬(#t2.1 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2.1 = #t0)  ∥ (#t0 < #t2.1) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma no_key_is_wrap_and_dec__or_unwrap_and_dec_ind [use_induction,
                                                     reuse]:
  all-traces
  "∀ #t2 #t3 h1 h2 k.
    ((DecKey( h1, k, 'on' ) @ #t2) ∧ (WrapKey( h2, k, 'on' ) @ #t3)) ⇒
    ((∃ L_h k2 #t1 #t0.
       ((NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)) ∧
       (((#t1 < #t3) ∧ (#t0 < #t3)) ∨ ((#t1 < #t2) ∧ (#t0 < #t2)))) ∨
     (∃ #t0 #t1 h1.1 h2.1 k.1.
       ((UnwrapKey( h2.1, k.1, 'on' ) @ #t0) ∧
        (EncKey( h1.1, k.1, 'on' ) @ #t1)) ∧
       (((#t0 < #t2) ∧ (#t1 < #t2)) ∨ ((#t0 < #t3) ∧ (#t1 < #t3)))))"
/*
guarded formula characterizing all counter-examples:
"∃ #t2 #t3 h1 h2 k.
  (DecKey( h1, k, 'on' ) @ #t2) ∧ (WrapKey( h2, k, 'on' ) @ #t3)
 ∧
  (∀ L_h k2 #t1 #t0.
    (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
   ⇒
    (((¬(#t1 < #t3)) ∨ (¬(#t0 < #t3)))) ∧
    (((¬(#t1 < #t2)) ∨ (¬(#t0 < #t2))))) ∧
  (∀ #t0 #t1 h1.1 h2.1 k.1.
    (UnwrapKey( h2.1, k.1, 'on' ) @ #t0) ∧ (EncKey( h1.1, k.1, 'on' ) @ #t1)
   ⇒
    (((¬(#t0 < #t2)) ∨ (¬(#t1 < #t2)))) ∧
    (((¬(#t0 < #t3)) ∨ (¬(#t1 < #t3)))))"
*/
induction
  case empty_trace
  by contradiction /* from formulas */
next
  case non_empty_trace
  simplify
  solve( (∀ #t2 #t3 h1 h2 k.
           (DecKey( h1, k, 'on' ) @ #t2) ∧ (WrapKey( h2, k, 'on' ) @ #t3)
          ⇒
           ((last(#t3)) ∨
            (last(#t2)) ∨
            (∃ L_h k2 #t1 #t0.
              (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
             ∧
              (¬(last(#t0))) ∧
              (¬(last(#t1))) ∧
              ((((#t1 < #t3) ∧ (#t0 < #t3)) ∨ ((#t1 < #t2) ∧ (#t0 < #t2))))) ∨
            (∃ #t0 #t1 h1.1 h2.1 k.1.
              (UnwrapKey( h2.1, k.1, 'on' ) @ #t0) ∧ (EncKey( h1.1, k.1, 'on' ) @ #t1)
             ∧
              (¬(last(#t1))) ∧
              (¬(last(#t0))) ∧
              ((((#t0 < #t2) ∧ (#t1 < #t2)) ∨ ((#t0 < #t3) ∧ (#t1 < #t3)))))))  ∥
         (∃ x y #t3.
           (IsIn( x, y ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (∀ #t2.
             (Insert( x, y ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t1 yp.
                (Insert( x, yp ) @ #t1)
               ∧
                (¬(last(#t1))) ∧
                (((#t1 = #t2) ∨ (#t2 < #t1))) ∧
                (¬(#t1 = #t2)) ∧
                (((#t3 = #t1) ∨ (#t1 < #t3)))))))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_0( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_0( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_1( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_1( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_2( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_2( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_3( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_3( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_4( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_4( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_5( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_5( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3))) )
    case case_1
    solve( (last(#t3))  ∥ (last(#t2))  ∥
           (∃ L_h k2 #t1 #t0.
             (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
            ∧
             (¬(last(#t0))) ∧
             (¬(last(#t1))) ∧
             ((((#t1 < #t3) ∧ (#t0 < #t3)) ∨ ((#t1 < #t2) ∧ (#t0 < #t2)))))  ∥
           (∃ #t0 #t1 h1 h2 k.
             (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
            ∧
             (¬(last(#t1))) ∧
             (¬(last(#t0))) ∧
             ((((#t0 < #t2) ∧ (#t1 < #t2)) ∨ ((#t0 < #t3) ∧ (#t1 < #t3))))) )
      case case_1
      solve( DecKey( h1, k, 'on' ) @ #t2 )
        case eventDecKeyLhkattdecatts_0_1111111111111111111
        solve( State_1111111111111111111( lock, h1,
                                          <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>, k, ptr, templ
               ) ▶₀ #t2 )
          case eventWrapKeyLhkattwrapatts_0_111111111111111111
          solve( Insert( <'F_template', ptr>,
                         <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                 ) @ #t2.1 )
            case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
            solve( (#vr.6 < #t2.1)  ∥ (#vr.6 = #t2.1) )
              case case_1
              solve( State_11( ) ▶₀ #t2.1 )
                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                by contradiction /* cyclic */
              qed
            next
              case case_2
              solve( WrapKey( h2, ~n.2, 'on' ) @ #t3 )
                case eventWrapKeyLhkattwrapatts_0_111111111111111111
                by solve( State_111111111111111111( lock, h2,
                                                    <'on', x, x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>, ~n.2,
                                                    ptr, templ
                          ) ▶₀ #t3 )
              next
                case eventWrapKeyhmattwrapatts_0_11111211111111111
                solve( State_11111211111111111( ut,
                                                <'on', x, x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>, h2, k,
                                                ~n.2, v, L_h, lock
                       ) ▶₀ #t3 )
                  case eventUnwrappedhmatts_0_1111121111111111
                  solve( (∃ h1 #t1. (NewKey( h1, ~n.2, 'on' ) @ #t1) ∧ #t1 < #vr.9)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #vr.9) ∧ (#t0 < #vr.9))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.9) ∧ (#t1 < #vr.9))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.9) ∧ (#t1 < #vr.9)) )
                    case case_1
                    solve( Insert( <'F_template', z>,
                                   <'on', x, x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>
                           ) @ #t2.3 )
                      case insertFtemplatetrustedononoffoffononononusageusage_0_
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (¬(last(#t0.1))) ∧
                             (¬(last(#t1.1))) ∧
                             ((((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1)))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (¬(last(#t1.1))) ∧
                             (¬(last(#t0.1))) ∧
                             ((((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0))))) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_4
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            qed
          next
            case insertFtemplateusageoffoffononononoffonundefundef_0_1
            solve( (#vr.7 < #t2.1)  ∥ (#vr.7 = #t2.1) )
              case case_1
              solve( State_1( ) ▶₀ #t2.1 )
                case insertFtemplatetrustedononoffoffononononusageusage_0_
                by contradiction /* cyclic */
              qed
            next
              case case_2
              solve( WrapKey( h2, ~n.2, 'on' ) @ #t3 )
                case eventWrapKeyLhkattwrapatts_0_111111111111111111
                by solve( State_111111111111111111( lock, h2,
                                                    <'on', x, x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>, ~n.2,
                                                    ptr, templ
                          ) ▶₀ #t3 )
              next
                case eventWrapKeyhmattwrapatts_0_11111211111111111
                solve( State_11111211111111111( ut,
                                                <'on', x, x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>, h2, k,
                                                ~n.2, v, L_h, lock
                       ) ▶₀ #t3 )
                  case eventUnwrappedhmatts_0_1111121111111111
                  solve( (∃ h1 #t1. (NewKey( h1, ~n.2, 'on' ) @ #t1) ∧ #t1 < #vr.9)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #vr.9) ∧ (#t0 < #vr.9))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.9) ∧ (#t1 < #vr.9))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.9) ∧ (#t1 < #vr.9)) )
                    case case_1
                    solve( Insert( <'F_template', z>,
                                   <'on', x, x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>
                           ) @ #t2.3 )
                      case insertFtemplatetrustedononoffoffononononusageusage_0_
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (¬(last(#t0.1))) ∧
                             (¬(last(#t1.1))) ∧
                             ((((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1)))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (¬(last(#t1.1))) ∧
                             (¬(last(#t0.1))) ∧
                             ((((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0))))) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_4
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case eventDecKeyhmattdecatts_0_111112111111111111
        solve( State_111112111111111111( ut,
                                         <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>, h1, k, k.1, v,
                                         L_h, lock
               ) ▶₀ #t2 )
          case eventWrapKeyhmattwrapatts_0_11111211111111111
          solve( (∃ h1 #t1. (NewKey( h1, k.1, 'on' ) @ #t1) ∧ #t1 < #vr.1)  ∥
                 (∃ L_h k2 #t1 #t0.
                   (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                  ∧
                   (#t1 < #vr.1) ∧ (#t0 < #vr.1))  ∥
                 (∃ #t0 #t1 h1 h2 k.
                   (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                  ∧
                   (#t0 < #vr.1) ∧ (#t1 < #vr.1))  ∥
                 (∃ #t0 #t1 h1 h2 k.
                   (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                  ∧
                   (#t0 < #vr.1) ∧ (#t1 < #vr.1)) )
            case case_1
            solve( Insert( <'F_template', z>,
                           <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                   ) @ #t2.1 )
              case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
              by contradiction /* from formulas */
            next
              case insertFtemplateusageoffoffononononoffonundefundef_0_1
              solve( (#vr.10 < #t2.1)  ∥ (#vr.10 = #t2.1) )
                case case_1
                solve( State_111111111111111( lock, h1,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>, k, ptr,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  solve( Insert( <'F_template', ptr>,
                                 <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                         ) @ #t2.4 )
                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                    solve( (#vr.11 < #t2.3)  ∥ (#vr.11 = #t2.3) )
                      case case_1
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    next
                      case case_2
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    qed
                  next
                    case insertFtemplateusageoffoffononononoffonundefundef_0_1
                    solve( (#t2.3 < #t2.1)  ∥ (#t2.3 = #t2.1)  ∥ (#vr.3 < #t2.3) )
                      case case_1
                      solve( (#vr.10 < #t2.3)  ∥ (#vr.10 = #t2.3) )
                        case case_1
                        solve( State_1( ) ▶₀ #t2.1 )
                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                          by contradiction /* cyclic */
                        qed
                      next
                        case case_2
                        solve( State_1( ) ▶₀ #t2.1 )
                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                          by contradiction /* cyclic */
                        qed
                      qed
                    next
                      case case_2
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    next
                      case case_3
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( State_111111111111111( lock, h1,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>, k, ptr,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  solve( Insert( <'F_template', ptr>,
                                 <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                         ) @ #t2.4 )
                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                    solve( (#vr.10 < #t2.3)  ∥ (#vr.10 = #t2.3) )
                      case case_1
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        solve( (#t2.3 < #t2.5)  ∥ (#t2.3 = #t2.5) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( (last(#t2))  ∥
                                 (∃ L_h k2 #t1 #t0.
                                   (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                  ∧
                                   (¬(last(#t0))) ∧
                                   (¬(last(#t1))) ∧
                                   ((((#t1 < #vr.18) ∧ (#t0 < #vr.18)) ∨ ((#t1 < #t2) ∧ (#t0 < #t2)))))  ∥
                                 (∃ #t0 #t1 h1 h2 k.
                                   (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                                  ∧
                                   (¬(last(#t1))) ∧
                                   (¬(last(#t0))) ∧
                                   ((((#t0 < #t2) ∧ (#t1 < #t2)) ∨ ((#t0 < #vr.18) ∧ (#t1 < #vr.18))))) )
                            case case_1
                            solve( State_( ) ▶₀ #t2.3 )
                              case Init
                              by contradiction /* cyclic */
                            qed
                          next
                            case case_2
                            by contradiction /* from formulas */
                          next
                            case case_3
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    next
                      case case_2
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        solve( (#t2.3 < #t2.5)  ∥ (#t2.3 = #t2.5) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( (last(#t2))  ∥
                                 (∃ L_h k2 #t1 #t0.
                                   (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                  ∧
                                   (¬(last(#t0))) ∧
                                   (¬(last(#t1))) ∧
                                   ((((#t1 < #vr.17) ∧ (#t0 < #vr.17)) ∨ ((#t1 < #t2) ∧ (#t0 < #t2)))))  ∥
                                 (∃ #t0 #t1 h1 h2 k.
                                   (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                                  ∧
                                   (¬(last(#t1))) ∧
                                   (¬(last(#t0))) ∧
                                   ((((#t0 < #t2) ∧ (#t1 < #t2)) ∨ ((#t0 < #vr.17) ∧ (#t1 < #vr.17))))) )
                            case case_1
                            by solve( WrapKey( h2, ~n.2, 'on' ) @ #t2 )
                          next
                            case case_2
                            by contradiction /* from formulas */
                          next
                            case case_3
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    qed
                  next
                    case insertFtemplateusageoffoffononononoffonundefundef_0_1
                    solve( (#t2.3 < #t2.1)  ∥ (#t2.3 = #t2.1)  ∥ (#vr.3 < #t2.3) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        solve( (#t2.1 < #t2.4)  ∥ (#t2.1 = #t2.4) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( WrapKey( h2, ~n.2, 'on' ) @ #t3 )
                            case eventWrapKeyLhkattwrapatts_0_111111111111111111
                            by solve( State_111111111111111111( lock, h2,
                                                                <'on', x.8, x.9, x.10, x.11, x.12, x.13, 
                                                                 x.14, x.15, x.16>,
                                                                ~n.2, ptr, templ
                                      ) ▶₀ #t3 )
                          next
                            case eventWrapKeyhmattwrapatts_0_11111211111111111
                            solve( State_11111211111111111( ut,
                                                            <'on', x.8, x.9, x.10, x.11, x.12, x.13, x.14, 
                                                             x.15, x.16>,
                                                            h2, k.1, ~n.2, v, L_h.1, lock
                                   ) ▶₀ #t3 )
                              case eventUnwrappedhmatts_0_1111121111111111
                              solve( (∃ h1 #t1. (NewKey( h1, ~n.2, 'on' ) @ #t1) ∧ #t1 < #vr.20)  ∥
                                     (∃ L_h k2 #t1 #t0.
                                       (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                      ∧
                                       (#t1 < #vr.20) ∧ (#t0 < #vr.20))  ∥
                                     (∃ #t0 #t1 h1 h2 k.
                                       (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                                      ∧
                                       (#t0 < #vr.20) ∧ (#t1 < #vr.20))  ∥
                                     (∃ #t0 #t1 h1 h2 k.
                                       (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                                      ∧
                                       (#t0 < #vr.20) ∧ (#t1 < #vr.20)) )
                                case case_1
                                solve( ((#vr.7 < #vr.26) ∧
                                        (∃ #t2.
                                          (Unlock_4( '4', ~n.4, 'device' ) @ #t2)
                                         ∧
                                          (#vr.7 < #t2) ∧
                                          (#t2 < #vr.26) ∧
                                          (∀ #t0 pp. (Unlock( pp, ~n.4, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                          (∀ pp lpp #t0.
                                            (Lock( pp, lpp, 'device' ) @ #t0)
                                           ⇒
                                            ((#t0 < #vr.7) ∨ (#t0 = #vr.7) ∨ (#t2 < #t0))) ∧
                                          (∀ pp lpp #t0.
                                            (Unlock( pp, lpp, 'device' ) @ #t0)
                                           ⇒
                                            ((#t0 < #vr.7) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                       (#vr.26 < #vr.7) )
                                  case case_1
                                  solve( Insert( <'F_template', z>,
                                                 <'on', x.8, x.9, x.10, x.11, x.12, x.13, x.14, x.15, x.16>
                                         ) @ #t2.5 )
                                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case case_2
                                  solve( Insert( <'F_template', z>,
                                                 <'on', x.8, x.9, x.10, x.11, x.12, x.13, x.14, x.15, x.16>
                                         ) @ #t2.5 )
                                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case case_2
                                by contradiction /* from formulas */
                              next
                                case case_3
                                solve( ((#vr.7 < #vr.26) ∧
                                        (∃ #t2.
                                          (Unlock_4( '4', ~n.4, 'device' ) @ #t2)
                                         ∧
                                          (#vr.7 < #t2) ∧
                                          (#t2 < #vr.26) ∧
                                          (∀ #t0 pp. (Unlock( pp, ~n.4, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                          (∀ pp lpp #t0.
                                            (Lock( pp, lpp, 'device' ) @ #t0)
                                           ⇒
                                            ((#t0 < #vr.7) ∨ (#t0 = #vr.7) ∨ (#t2 < #t0))) ∧
                                          (∀ pp lpp #t0.
                                            (Unlock( pp, lpp, 'device' ) @ #t0)
                                           ⇒
                                            ((#t0 < #vr.7) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                       (#vr.26 < #vr.7) )
                                  case case_1
                                  solve( (∃ L_h k2 #t1.2 #t0.1.
                                           (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.2)
                                          ∧
                                           (¬(last(#t0.1))) ∧
                                           (¬(last(#t1.2))) ∧
                                           ((((#t1.2 < #t0) ∧ (#t0.1 < #t0)) ∨
                                             ((#t1.2 < #t1.1) ∧ (#t0.1 < #t1.1)))))  ∥
                                         (∃ #t0.1 #t1.2 h1 h2 k.
                                           (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                           (EncKey( h1, k, 'on' ) @ #t1.2)
                                          ∧
                                           (¬(last(#t1.2))) ∧
                                           (¬(last(#t0.1))) ∧
                                           ((((#t0.1 < #t1.1) ∧ (#t1.2 < #t1.1)) ∨
                                             ((#t0.1 < #t0) ∧ (#t1.2 < #t0))))) )
                                    case case_1
                                    by contradiction /* from formulas */
                                  next
                                    case case_2
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case case_2
                                  solve( (∃ L_h k2 #t1.2 #t0.1.
                                           (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.2)
                                          ∧
                                           (¬(last(#t0.1))) ∧
                                           (¬(last(#t1.2))) ∧
                                           ((((#t1.2 < #t0) ∧ (#t0.1 < #t0)) ∨
                                             ((#t1.2 < #t1.1) ∧ (#t0.1 < #t1.1)))))  ∥
                                         (∃ #t0.1 #t1.2 h1 h2 k.
                                           (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                           (EncKey( h1, k, 'on' ) @ #t1.2)
                                          ∧
                                           (¬(last(#t1.2))) ∧
                                           (¬(last(#t0.1))) ∧
                                           ((((#t0.1 < #t1.1) ∧ (#t1.2 < #t1.1)) ∨
                                             ((#t0.1 < #t0) ∧ (#t1.2 < #t0))))) )
                                    case case_1
                                    by contradiction /* from formulas */
                                  next
                                    case case_2
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case case_4
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case case_3
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        by contradiction /* cyclic */
                      qed
                    qed
                  qed
                qed
              qed
            qed
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            solve( (∃ L_h k2 #t1.1 #t0.1.
                     (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                    ∧
                     (¬(last(#t0.1))) ∧
                     (¬(last(#t1.1))) ∧
                     ((((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1)))))  ∥
                   (∃ #t0.1 #t1.1 h1 h2 k.
                     (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                    ∧
                     (¬(last(#t1.1))) ∧
                     (¬(last(#t0.1))) ∧
                     ((((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0))))) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_4
            by contradiction /* from formulas */
          qed
        qed
      qed
    next
      case case_2
      solve( DecKey( h1, k, 'on' ) @ #t2 )
        case eventDecKeyLhkattdecatts_0_1111111111111111111
        solve( State_1111111111111111111( lock, h1,
                                          <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>, k, ptr, templ
               ) ▶₀ #t2 )
          case eventWrapKeyLhkattwrapatts_0_111111111111111111
          solve( Insert( <'F_template', ptr>,
                         <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                 ) @ #t2.1 )
            case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
            solve( (#vr.6 < #t2.1)  ∥ (#vr.6 = #t2.1) )
              case case_1
              solve( State_11( ) ▶₀ #t2.1 )
                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                by contradiction /* cyclic */
              qed
            next
              case case_2
              solve( WrapKey( h2, ~n.2, 'on' ) @ #t3 )
                case eventWrapKeyLhkattwrapatts_0_111111111111111111
                by solve( State_111111111111111111( lock, h2,
                                                    <'on', x, x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>, ~n.2,
                                                    ptr, templ
                          ) ▶₀ #t3 )
              next
                case eventWrapKeyhmattwrapatts_0_11111211111111111
                solve( State_11111211111111111( ut,
                                                <'on', x, x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>, h2, k,
                                                ~n.2, v, L_h, lock
                       ) ▶₀ #t3 )
                  case eventUnwrappedhmatts_0_1111121111111111
                  solve( (∃ h1 #t1. (NewKey( h1, ~n.2, 'on' ) @ #t1) ∧ #t1 < #vr.9)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #vr.9) ∧ (#t0 < #vr.9))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.9) ∧ (#t1 < #vr.9))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.9) ∧ (#t1 < #vr.9)) )
                    case case_1
                    solve( Insert( <'F_template', z>,
                                   <'on', x, x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>
                           ) @ #t2.3 )
                      case insertFtemplatetrustedononoffoffononononusageusage_0_
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (¬(last(#t0.1))) ∧
                             (¬(last(#t1.1))) ∧
                             ((((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1)))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (¬(last(#t1.1))) ∧
                             (¬(last(#t0.1))) ∧
                             ((((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0))))) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_4
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            qed
          next
            case insertFtemplateusageoffoffononononoffonundefundef_0_1
            solve( (#vr.7 < #t2.1)  ∥ (#vr.7 = #t2.1) )
              case case_1
              solve( State_1( ) ▶₀ #t2.1 )
                case insertFtemplatetrustedononoffoffononononusageusage_0_
                by contradiction /* cyclic */
              qed
            next
              case case_2
              solve( WrapKey( h2, ~n.2, 'on' ) @ #t3 )
                case eventWrapKeyLhkattwrapatts_0_111111111111111111
                by solve( State_111111111111111111( lock, h2,
                                                    <'on', x, x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>, ~n.2,
                                                    ptr, templ
                          ) ▶₀ #t3 )
              next
                case eventWrapKeyhmattwrapatts_0_11111211111111111
                solve( State_11111211111111111( ut,
                                                <'on', x, x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>, h2, k,
                                                ~n.2, v, L_h, lock
                       ) ▶₀ #t3 )
                  case eventUnwrappedhmatts_0_1111121111111111
                  solve( (∃ h1 #t1. (NewKey( h1, ~n.2, 'on' ) @ #t1) ∧ #t1 < #vr.9)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #vr.9) ∧ (#t0 < #vr.9))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.9) ∧ (#t1 < #vr.9))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.9) ∧ (#t1 < #vr.9)) )
                    case case_1
                    solve( Insert( <'F_template', z>,
                                   <'on', x, x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>
                           ) @ #t2.3 )
                      case insertFtemplatetrustedononoffoffononononusageusage_0_
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (¬(last(#t0.1))) ∧
                             (¬(last(#t1.1))) ∧
                             ((((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1)))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (¬(last(#t1.1))) ∧
                             (¬(last(#t0.1))) ∧
                             ((((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0))))) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_4
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case eventDecKeyhmattdecatts_0_111112111111111111
        solve( State_111112111111111111( ut,
                                         <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>, h1, k, k.1, v,
                                         L_h, lock
               ) ▶₀ #t2 )
          case eventWrapKeyhmattwrapatts_0_11111211111111111
          solve( (∃ h1 #t1. (NewKey( h1, k.1, 'on' ) @ #t1) ∧ #t1 < #vr.1)  ∥
                 (∃ L_h k2 #t1 #t0.
                   (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                  ∧
                   (#t1 < #vr.1) ∧ (#t0 < #vr.1))  ∥
                 (∃ #t0 #t1 h1 h2 k.
                   (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                  ∧
                   (#t0 < #vr.1) ∧ (#t1 < #vr.1))  ∥
                 (∃ #t0 #t1 h1 h2 k.
                   (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                  ∧
                   (#t0 < #vr.1) ∧ (#t1 < #vr.1)) )
            case case_1
            solve( Insert( <'F_template', z>,
                           <x, x.1, x.2, 'on', x.3, x.4, x.5, x.6, x.7, x.8>
                   ) @ #t2.1 )
              case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
              by contradiction /* from formulas */
            next
              case insertFtemplateusageoffoffononononoffonundefundef_0_1
              solve( (#vr.10 < #t2.1)  ∥ (#vr.10 = #t2.1) )
                case case_1
                solve( State_111111111111111( lock, h1,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>, k, ptr,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  solve( Insert( <'F_template', ptr>,
                                 <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                         ) @ #t2.4 )
                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                    solve( (#vr.11 < #t2.3)  ∥ (#vr.11 = #t2.3) )
                      case case_1
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    next
                      case case_2
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    qed
                  next
                    case insertFtemplateusageoffoffononononoffonundefundef_0_1
                    solve( (#t2.3 < #t2.1)  ∥ (#t2.3 = #t2.1)  ∥ (#vr.3 < #t2.3) )
                      case case_1
                      solve( (#vr.10 < #t2.3)  ∥ (#vr.10 = #t2.3) )
                        case case_1
                        solve( State_1( ) ▶₀ #t2.1 )
                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                          by contradiction /* cyclic */
                        qed
                      next
                        case case_2
                        solve( State_1( ) ▶₀ #t2.1 )
                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                          by contradiction /* cyclic */
                        qed
                      qed
                    next
                      case case_2
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    next
                      case case_3
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( State_111111111111111( lock, h1,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>, k, ptr,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  solve( Insert( <'F_template', ptr>,
                                 <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                         ) @ #t2.4 )
                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                    solve( (#vr.10 < #t2.3)  ∥ (#vr.10 = #t2.3) )
                      case case_1
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        solve( (#t2.3 < #t2.5)  ∥ (#t2.3 = #t2.5) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( State_( ) ▶₀ #t2.3 )
                            case Init
                            by contradiction /* cyclic */
                          qed
                        qed
                      qed
                    next
                      case case_2
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        solve( (#t2.3 < #t2.5)  ∥ (#t2.3 = #t2.5) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( WrapKey( h2, ~n.2, 'on' ) @ #t3 )
                            case eventWrapKeyLhkattwrapatts_0_111111111111111111
                            solve( State_111111111111111111( lock, h2,
                                                             <'on', x.8, x.9, x.10, x.11, x.12, x.13, x.14, 
                                                              x.15, x.16>,
                                                             ~n.2, ptr, templ
                                   ) ▶₀ #t3 )
                              case insertobjLhkatts_0_11111111111111111
                              solve( (#t2.3 < #t2.5)  ∥ (#t2.3 = #t2.5) )
                                case case_1
                                by contradiction /* from formulas */
                              next
                                case case_2
                                solve( !KU( senc(~n.2, k) ) @ #vk.3 )
                                  case c_senc
                                  by contradiction /* from formulas */
                                next
                                  case eventDecUsingkm_0_111111112111111
                                  solve( (∃ h2 k2 #t2 #t3.
                                           (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                                          ∧
                                           (#t2 < #vr.18) ∧ (#t3 < #vr.18))  ∥
                                         (∃ h2 #t2 #t3 #t4.
                                           (NewKey( h2, k.1, 'off' ) @ #t2) ∧
                                           (!KU( k.1 ) @ #t3) ∧
                                           (!KU( t ) @ #t4)
                                          ∧
                                           (#t2 < #vr.18) ∧ (#t3 < #vr.18) ∧ (#t4 < #vr.18))  ∥
                                         (∃ #t2. (EncUsing( k.1, t ) @ #t2) ∧ #t2 < #vr.18)  ∥
                                         (∃ h2 k2 #t2 #t3 a.
                                           (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                                          ∧
                                           (#t2 < #vr.18) ∧ (#t3 < #vr.18))  ∥
                                         (∃ #t2 #t3 h1 h2 k2.
                                           (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
                                          ∧
                                           (#t2 < #vr.18) ∧ (#t3 < #vr.18)) )
                                    case case_1
                                    by contradiction /* from formulas */
                                  next
                                    case case_2
                                    by contradiction /* cyclic */
                                  next
                                    case case_3
                                    solve( (#vr.22 < #vr.12)  ∥ (#t2.2 < #vr.22) )
                                      case case_1
                                      solve( State_11111111211111111( ~n.5, m, v, L_h.1, k.1 ) ▶₀ #t2.4 )
                                        case eventDecUsingkm_0_111111112111111
                                        solve( (#t2.7 < #t2.8)  ∥ (#t2.7 = #t2.8) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( State_111111121111( lock, m,
                                                                     <k.1, x.17, x.18, 'on', x.19, x.20, 
                                                                      x.21, x.22, x.23, x.24, x.25>,
                                                                     L_h.2
                                                 ) ▶₀ #t2.5 )
                                            case lookupobjLhasv_0_11111112111
                                            by contradiction /* cyclic */
                                          qed
                                        qed
                                      qed
                                    next
                                      case case_2
                                      solve( State_11111111211111111( ~n.5, m, v, L_h.1, k.1 ) ▶₀ #t2.4 )
                                        case eventDecUsingkm_0_111111112111111
                                        solve( (#t2.7 < #t2.8)  ∥ (#t2.7 = #t2.8) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( State_111111121111( lock, m,
                                                                     <k.1, x.17, x.18, 'on', x.19, x.20, 
                                                                      x.21, x.22, x.23, x.24, x.25>,
                                                                     L_h.2
                                                 ) ▶₀ #t2.5 )
                                            case lookupobjLhasv_0_11111112111
                                            by contradiction /* cyclic */
                                          qed
                                        qed
                                      qed
                                    qed
                                  next
                                    case case_4
                                    solve( (#vr.22 < #vr.12)  ∥ (#t2.2 < #vr.22) )
                                      case case_1
                                      solve( (∃ h1 #t1. (NewKey( h1, k2, 'on' ) @ #t1) ∧ #t1 < #t2.5)  ∥
                                             (∃ L_h k2 #t1 #t0.
                                               (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                              ∧
                                               (#t1 < #t2.5) ∧ (#t0 < #t2.5))  ∥
                                             (∃ #t0 #t1 h1 h2 k.
                                               (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                                              ∧
                                               (#t0 < #t2.5) ∧ (#t1 < #t2.5))  ∥
                                             (∃ #t0 #t1 h1 h2 k.
                                               (UnwrapKey( h2, k, 'on' ) @ #t0) ∧
                                               (EncKey( h1, k, 'on' ) @ #t1)
                                              ∧
                                               (#t0 < #t2.5) ∧ (#t1 < #t2.5)) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        by contradiction /* from formulas */
                                      next
                                        case case_3
                                        solve( (∃ L_h k2 #t1.2 #t0.1.
                                                 (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.2)
                                                ∧
                                                 (¬(last(#t0.1))) ∧
                                                 (¬(last(#t1.2))) ∧
                                                 ((((#t1.2 < #t0) ∧ (#t0.1 < #t0)) ∨
                                                   ((#t1.2 < #t1.1) ∧ (#t0.1 < #t1.1)))))  ∥
                                               (∃ #t0.1 #t1.2 h1 h2 k.
                                                 (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                                 (EncKey( h1, k, 'on' ) @ #t1.2)
                                                ∧
                                                 (¬(last(#t1.2))) ∧
                                                 (¬(last(#t0.1))) ∧
                                                 ((((#t0.1 < #t1.1) ∧ (#t1.2 < #t1.1)) ∨
                                                   ((#t0.1 < #t0) ∧ (#t1.2 < #t0))))) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          by contradiction /* from formulas */
                                        qed
                                      next
                                        case case_4
                                        by contradiction /* from formulas */
                                      qed
                                    next
                                      case case_2
                                      solve( (∃ h1 #t1. (NewKey( h1, k2, 'on' ) @ #t1) ∧ #t1 < #t2.5)  ∥
                                             (∃ L_h k2 #t1 #t0.
                                               (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                              ∧
                                               (#t1 < #t2.5) ∧ (#t0 < #t2.5))  ∥
                                             (∃ #t0 #t1 h1 h2 k.
                                               (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                                              ∧
                                               (#t0 < #t2.5) ∧ (#t1 < #t2.5))  ∥
                                             (∃ #t0 #t1 h1 h2 k.
                                               (UnwrapKey( h2, k, 'on' ) @ #t0) ∧
                                               (EncKey( h1, k, 'on' ) @ #t1)
                                              ∧
                                               (#t0 < #t2.5) ∧ (#t1 < #t2.5)) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        by contradiction /* from formulas */
                                      next
                                        case case_3
                                        solve( (∃ L_h k2 #t1.2 #t0.1.
                                                 (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.2)
                                                ∧
                                                 (¬(last(#t0.1))) ∧
                                                 (¬(last(#t1.2))) ∧
                                                 ((((#t1.2 < #t0) ∧ (#t0.1 < #t0)) ∨
                                                   ((#t1.2 < #t1.1) ∧ (#t0.1 < #t1.1)))))  ∥
                                               (∃ #t0.1 #t1.2 h1 h2 k.
                                                 (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                                 (EncKey( h1, k, 'on' ) @ #t1.2)
                                                ∧
                                                 (¬(last(#t1.2))) ∧
                                                 (¬(last(#t0.1))) ∧
                                                 ((((#t0.1 < #t1.1) ∧ (#t1.2 < #t1.1)) ∨
                                                   ((#t0.1 < #t0) ∧ (#t1.2 < #t0))))) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          by contradiction /* from formulas */
                                        qed
                                      next
                                        case case_4
                                        by contradiction /* from formulas */
                                      qed
                                    qed
                                  next
                                    case case_5
                                    solve( (#vr.22 < #vr.12)  ∥ (#t2.2 < #vr.22) )
                                      case case_1
                                      solve( (∃ L_h k2 #t1 #t0.
                                               (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                              ∧
                                               (¬(last(#t0))) ∧
                                               (¬(last(#t1))) ∧
                                               ((((#t1 < #t2.7) ∧ (#t0 < #t2.7)) ∨
                                                 ((#t1 < #t3.1) ∧ (#t0 < #t3.1)))))  ∥
                                             (∃ #t0 #t1 h1 h2 k.
                                               (UnwrapKey( h2, k, 'on' ) @ #t0) ∧
                                               (EncKey( h1, k, 'on' ) @ #t1)
                                              ∧
                                               (¬(last(#t1))) ∧
                                               (¬(last(#t0))) ∧
                                               ((((#t0 < #t3.1) ∧ (#t1 < #t3.1)) ∨
                                                 ((#t0 < #t2.7) ∧ (#t1 < #t2.7))))) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        by contradiction /* from formulas */
                                      qed
                                    next
                                      case case_2
                                      solve( (∃ L_h k2 #t1 #t0.
                                               (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                              ∧
                                               (¬(last(#t0))) ∧
                                               (¬(last(#t1))) ∧
                                               ((((#t1 < #t2.7) ∧ (#t0 < #t2.7)) ∨
                                                 ((#t1 < #t3.1) ∧ (#t0 < #t3.1)))))  ∥
                                             (∃ #t0 #t1 h1 h2 k.
                                               (UnwrapKey( h2, k, 'on' ) @ #t0) ∧
                                               (EncKey( h1, k, 'on' ) @ #t1)
                                              ∧
                                               (¬(last(#t1))) ∧
                                               (¬(last(#t0))) ∧
                                               ((((#t0 < #t3.1) ∧ (#t1 < #t3.1)) ∨
                                                 ((#t0 < #t2.7) ∧ (#t1 < #t2.7))))) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        by contradiction /* from formulas */
                                      qed
                                    qed
                                  qed
                                next
                                  case ifCanencryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111121111
                                  by contradiction /* from formulas */
                                next
                                  case ifCangetkeyvalueattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111121111
                                  solve( (#vr.20 < #vr.12)  ∥ (#t2.2 < #vr.20) )
                                    case case_1
                                    solve( State_111111111111111( lock, L_h.1,
                                                                  <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, 
                                                                   z.7, z.8>,
                                                                  t, ptr,
                                                                  <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, 
                                                                   z.7, z.8>
                                           ) ▶₀ #t1.1 )
                                      case lookupFtemplateptrastempl_0_11111111111111
                                      by contradiction /* impossible chain */
                                    qed
                                  next
                                    case case_2
                                    solve( State_111111111111111( lock, L_h.1,
                                                                  <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, 
                                                                   z.7, z.8>,
                                                                  t, ptr,
                                                                  <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, 
                                                                   z.7, z.8>
                                           ) ▶₀ #t1.1 )
                                      case lookupFtemplateptrastempl_0_11111111111111
                                      by contradiction /* impossible chain */
                                    qed
                                  qed
                                next
                                  case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_1
                                  solve( (z.8 = 'off')  ∥ ((z.8 = 'on') ∧ (z = 'on')) )
                                    case case_1
                                    solve( (#vr.23 < #vr.12)  ∥ (#t2.2 < #vr.23) )
                                      case case_1
                                      solve( Insert( <'F_template', z.1>,
                                                     <z.2, z.3, z.4, z.5, z.6, 'on', z.7, 'off', z.8, z.9>
                                             ) @ #t2.6 )
                                        case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                                        by contradiction /* from formulas */
                                      qed
                                    next
                                      case case_2
                                      solve( Insert( <'F_template', z.1>,
                                                     <z.2, z.3, z.4, z.5, z.6, 'on', z.7, 'off', z.8, z.9>
                                             ) @ #t2.6 )
                                        case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                                        by contradiction /* from formulas */
                                      qed
                                    qed
                                  next
                                    case case_2
                                    solve( (#vr.23 < #vr.12)  ∥ (#t2.2 < #vr.23) )
                                      case case_1
                                      solve( Insert( <'F_template', z>,
                                                     <z.1, z.2, z.3, z.4, z.5, 'on', z.6, 'on', z.7, z.8>
                                             ) @ #t2.6 )
                                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                                        by contradiction /* from formulas */
                                      next
                                        case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                        solve( (#t2.1 < #t2.5)  ∥ (#t2.1 = #t2.5) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.5
                                                 ) ▶₀ #t2.4 )
                                            case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                                            by contradiction /* cyclic */
                                          qed
                                        qed
                                      qed
                                    next
                                      case case_2
                                      solve( Insert( <'F_template', z>,
                                                     <z.1, z.2, z.3, z.4, z.5, 'on', z.6, 'on', z.7, z.8>
                                             ) @ #t2.6 )
                                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                                        by contradiction /* from formulas */
                                      next
                                        case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                        solve( (#t2.1 < #t2.5)  ∥ (#t2.1 = #t2.5) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.5
                                                 ) ▶₀ #t2.4 )
                                            case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                                            solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  solve( Insert( <'obj', L_h>,
                                                                 <k, x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, 
                                                                  x.7, 'usage'>
                                                         ) @ #t2.5 )
                                                    case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                    solve( State_1111121111111( <x, 'on', x.1, x.2, x.3, x.4, 
                                                                                 x.5, x.6, x.7, 'usage'>,
                                                                                <x, 'on', x.1, x.2, x.3, x.4, 
                                                                                 x.5, x.6, x.7, 'usage'>,
                                                                                k.1, k, v, L_h, lock
                                                           ) ▶₀ #t2.5 )
                                                      case lookupFtemplateattuttemvasut_0_111112111111
                                                      solve( (#vr.29 < #vr.12)  ∥ (#t2.2 < #vr.29) )
                                                        case case_1
                                                        solve( Insert( <'F_template', z>,
                                                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, 
                                                                        x.6, x.7, 'usage'>
                                                               ) @ #t2.9 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        solve( (#vr.29 < #vr.23)  ∥ (#t2.4 < #vr.29) )
                                                          case case_1
                                                          solve( Insert( <'F_template', z>,
                                                                         <x, 'on', x.1, x.2, x.3, x.4, x.5, 
                                                                          x.6, x.7, 'usage'>
                                                                 ) @ #t2.9 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* from formulas */
                                                          qed
                                                        next
                                                          case case_2
                                                          solve( Insert( <'F_template', z>,
                                                                         <x, 'on', x.1, x.2, x.3, x.4, x.5, 
                                                                          x.6, x.7, 'usage'>
                                                                 ) @ #t2.9 )
                                                            case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                            by contradiction /* from formulas */
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  next
                                                    case insertobjLhkatts_0_11111111111111111
                                                    solve( State_11111111111111111( lock, L_h,
                                                                                    <x, 'on', x.1, x.2, x.3, 
                                                                                     x.4, x.5, x.6, x.7, 
                                                                                     'usage'>,
                                                                                    k, ptr, templ
                                                           ) ▶₀ #t2.5 )
                                                      case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                      solve( ((#vr.12 < #vr.27) ∧
                                                              (∃ #t2.
                                                                (Unlock_0( '0', ~n, 'device' ) @ #t2)
                                                               ∧
                                                                (#vr.12 < #t2) ∧
                                                                (#t2 < #vr.27) ∧
                                                                (∀ #t0 pp.
                                                                  (Unlock( pp, ~n, 'device' ) @ #t0)
                                                                 ⇒
                                                                  #t0 = #t2) ∧
                                                                (∀ pp lpp #t0.
                                                                  (Lock( pp, lpp, 'device' ) @ #t0)
                                                                 ⇒
                                                                  ((#t0 < #vr.12) ∨
                                                                   (#t0 = #vr.12) ∨
                                                                   (#t2 < #t0))) ∧
                                                                (∀ pp lpp #t0.
                                                                  (Unlock( pp, lpp, 'device' ) @ #t0)
                                                                 ⇒
                                                                  ((#t0 < #vr.12) ∨
                                                                   (#t2 < #t0) ∨
                                                                   (#t2 = #t0)))))  ∥
                                                             (#vr.27 < #vr.12)  ∥ (#vr.12 = #vr.27) )
                                                        case case_1
                                                        solve( Insert( <'F_template', ptr>,
                                                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, 
                                                                        x.6, x.7, 'usage'>
                                                               ) @ #t2.9 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          solve( (#t2.7 < #t2.3)  ∥ (#t2.7 = #t2.3)  ∥
                                                                 (#vr.11 < #t2.7) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                  atts, k,
                                                                                                  ptr, templ
                                                                   ) ▶₀ #t2.6 )
                                                              case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                              solve( (#t2.9 < #t2.3)  ∥ (#t2.9 = #t2.3)  ∥
                                                                     (#vr.11 < #t2.9) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( Insert( <'obj', h2>,
                                                                               <~n.2, 'off', 'off', 'on', 
                                                                                'on', 'on', 'on', 'off', 
                                                                                'on', 'undef', 'undef'>
                                                                       ) @ #t2.7 )
                                                                  case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                                  solve( State_1111121111111( <'off', 'off', 
                                                                                               'on', 'on', 
                                                                                               'on', 'on', 
                                                                                               'off', 'on', 
                                                                                               'undef', 
                                                                                               'undef'>,
                                                                                              <'off', 'off', 
                                                                                               'on', 'on', 
                                                                                               'on', 'on', 
                                                                                               'off', 'on', 
                                                                                               'undef', 
                                                                                               'undef'>,
                                                                                              k, ~n.2, v, L_h,
                                                                                              lock
                                                                         ) ▶₀ #t2.7 )
                                                                    case lookupFtemplateattuttemvasut_0_111112111111
                                                                    solve( (#vr.37 < #vr.27)  ∥
                                                                           (#t2.6 < #vr.37) )
                                                                      case case_1
                                                                      solve( Insert( <'F_template', z>,
                                                                                     <'off', 'off', 'on', 
                                                                                      'on', 'on', 'on', 
                                                                                      'off', 'on', 'undef', 
                                                                                      'undef'>
                                                                             ) @ #t2.10 )
                                                                        case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                        solve( (#t2.1 < #t2.9)  ∥
                                                                               (#t2.1 = #t2.9) )
                                                                          case case_1
                                                                          by contradiction /* from formulas */
                                                                        next
                                                                          case case_2
                                                                          solve( State_1111121111111111111111( ut,
                                                                                                               atts,
                                                                                                               h2,
                                                                                                               k.1,
                                                                                                               m,
                                                                                                               v,
                                                                                                               L_h.1,
                                                                                                               ~n.10
                                                                                 ) ▶₀ #t2.8 )
                                                                            case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                            by contradiction
                                                                               /* from formulas */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    next
                                                                      case case_2
                                                                      solve( Insert( <'F_template', z>,
                                                                                     <'off', 'off', 'on', 
                                                                                      'on', 'on', 'on', 
                                                                                      'off', 'on', 'undef', 
                                                                                      'undef'>
                                                                             ) @ #t2.10 )
                                                                        case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                        solve( (#t2.1 < #t2.9)  ∥
                                                                               (#t2.1 = #t2.9) )
                                                                          case case_1
                                                                          by contradiction /* from formulas */
                                                                        next
                                                                          case case_2
                                                                          solve( State_1111121111111111111111( ut,
                                                                                                               atts,
                                                                                                               h2,
                                                                                                               k.1,
                                                                                                               m,
                                                                                                               v,
                                                                                                               L_h.1,
                                                                                                               ~n.10
                                                                                 ) ▶₀ #t2.8 )
                                                                            case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                            by contradiction
                                                                               /* from formulas */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                next
                                                                  case insertobjLhkatts_0_11111111111111111
                                                                  by solve( State_11111111111111111( lock, h2,
                                                                                                     <'off', 
                                                                                                      'off', 
                                                                                                      'on', 
                                                                                                      'on', 
                                                                                                      'on', 
                                                                                                      'on', 
                                                                                                      'off', 
                                                                                                      'on', 
                                                                                                      'undef', 
                                                                                                      'undef'
                                                                                                     >,
                                                                                                     ~n.2,
                                                                                                     ptr,
                                                                                                     templ
                                                                            ) ▶₀ #t2.7 )
                                                                qed
                                                              next
                                                                case case_3
                                                                by contradiction /* from formulas */
                                                              qed
                                                            qed
                                                          next
                                                            case case_3
                                                            solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                  atts, k,
                                                                                                  ptr, templ
                                                                   ) ▶₀ #t2.6 )
                                                              case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                              solve( (#t2.10 < #t2.3)  ∥ (#t2.10 = #t2.3)  ∥
                                                                     (#vr.11 < #t2.10) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_3
                                                                solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10) )
                                                                  case case_1
                                                                  by contradiction /* from formulas */
                                                                next
                                                                  case case_2
                                                                  solve( State_( ) ▶₀ #t2.7 )
                                                                    case Init
                                                                    by contradiction /* cyclic */
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      next
                                                        case case_2
                                                        solve( Insert( <'F_template', ptr>,
                                                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, 
                                                                        x.6, x.7, 'usage'>
                                                               ) @ #t2.9 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          solve( (#t2.7 < #t2.3)  ∥ (#t2.7 = #t2.3)  ∥
                                                                 (#vr.11 < #t2.7) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                  atts, k,
                                                                                                  ptr, templ
                                                                   ) ▶₀ #t2.6 )
                                                              case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                              solve( (#t2.3 < #t2.9)  ∥ (#t2.3 = #t2.9) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( Insert( <'obj', h2>,
                                                                               <~n.2, 'off', 'off', 'on', 
                                                                                'on', 'on', 'on', 'off', 
                                                                                'on', 'undef', 'undef'>
                                                                       ) @ #t2.7 )
                                                                  case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                                  solve( State_1111121111111( <'off', 'off', 
                                                                                               'on', 'on', 
                                                                                               'on', 'on', 
                                                                                               'off', 'on', 
                                                                                               'undef', 
                                                                                               'undef'>,
                                                                                              <'off', 'off', 
                                                                                               'on', 'on', 
                                                                                               'on', 'on', 
                                                                                               'off', 'on', 
                                                                                               'undef', 
                                                                                               'undef'>,
                                                                                              k, ~n.2, v, L_h,
                                                                                              lock
                                                                         ) ▶₀ #t2.7 )
                                                                    case lookupFtemplateattuttemvasut_0_111112111111
                                                                    solve( Insert( <'F_template', z>,
                                                                                   <'off', 'off', 'on', 'on', 
                                                                                    'on', 'on', 'off', 'on', 
                                                                                    'undef', 'undef'>
                                                                           ) @ #t2.10 )
                                                                      case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                      solve( (#t2.1 < #t2.9)  ∥
                                                                             (#t2.1 = #t2.9) )
                                                                        case case_1
                                                                        by contradiction /* from formulas */
                                                                      next
                                                                        case case_2
                                                                        solve( State_1111121111111111111111( ut,
                                                                                                             atts,
                                                                                                             h2,
                                                                                                             k.1,
                                                                                                             m,
                                                                                                             v,
                                                                                                             L_h.1,
                                                                                                             ~n.10
                                                                               ) ▶₀ #t2.8 )
                                                                          case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                          by contradiction /* from formulas */
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                next
                                                                  case insertobjLhkatts_0_11111111111111111
                                                                  by solve( State_11111111111111111( lock, h2,
                                                                                                     <'off', 
                                                                                                      'off', 
                                                                                                      'on', 
                                                                                                      'on', 
                                                                                                      'on', 
                                                                                                      'on', 
                                                                                                      'off', 
                                                                                                      'on', 
                                                                                                      'undef', 
                                                                                                      'undef'
                                                                                                     >,
                                                                                                     ~n.2,
                                                                                                     ptr,
                                                                                                     templ
                                                                            ) ▶₀ #t2.7 )
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_3
                                                            solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                  atts, k,
                                                                                                  ptr, templ
                                                                   ) ▶₀ #t2.6 )
                                                              case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                              by contradiction /* cyclic */
                                                            qed
                                                          qed
                                                        qed
                                                      next
                                                        case case_3
                                                        solve( (#t2.3 < #t2.8)  ∥ (#t2.3 = #t2.8) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( Insert( <'obj', h2>,
                                                                         <~n.2, 'off', 'off', 'on', 'on', 
                                                                          'on', 'on', 'off', 'on', 'undef', 
                                                                          'undef'>
                                                                 ) @ #t2.6 )
                                                            case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                            solve( State_1111121111111( <'off', 'off', 'on', 
                                                                                         'on', 'on', 'on', 
                                                                                         'off', 'on', 
                                                                                         'undef', 'undef'>,
                                                                                        <'off', 'off', 'on', 
                                                                                         'on', 'on', 'on', 
                                                                                         'off', 'on', 
                                                                                         'undef', 'undef'>,
                                                                                        k, ~n.2, v, L_h, lock
                                                                   ) ▶₀ #t2.6 )
                                                              case lookupFtemplateattuttemvasut_0_111112111111
                                                              solve( Insert( <'F_template', z>,
                                                                             <'off', 'off', 'on', 'on', 'on', 
                                                                              'on', 'off', 'on', 'undef', 
                                                                              'undef'>
                                                                     ) @ #t2.9 )
                                                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                                  case case_1
                                                                  by contradiction /* from formulas */
                                                                next
                                                                  case case_2
                                                                  solve( State_1111121111111111111111( ut,
                                                                                                       atts,
                                                                                                       h2,
                                                                                                       k.1, m,
                                                                                                       v,
                                                                                                       L_h.1,
                                                                                                       ~n.7
                                                                         ) ▶₀ #t2.7 )
                                                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                    by contradiction /* from formulas */
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case insertobjLhkatts_0_11111111111111111
                                                            by solve( State_11111111111111111( lock, h2,
                                                                                               <'off', 'off', 
                                                                                                'on', 'on', 
                                                                                                'on', 'on', 
                                                                                                'off', 'on', 
                                                                                                'undef', 
                                                                                                'undef'>,
                                                                                               ~n.2, ptr,
                                                                                               templ
                                                                      ) ▶₀ #t2.6 )
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                next
                                  case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_2
                                  solve( (#vr.24 < #vr.12)  ∥ (#t2.2 < #vr.24) )
                                    case case_1
                                    solve( Insert( <'F_template', z.3>,
                                                   <z.4, z.5, z.6, z.7, z.8, 'on', z.9, 'off', z.10, z.11>
                                           ) @ #t2.6 )
                                      case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                                      by contradiction /* from formulas */
                                    qed
                                  next
                                    case case_2
                                    solve( Insert( <'F_template', z.3>,
                                                   <z.4, z.5, z.6, z.7, z.8, 'on', z.9, 'off', z.10, z.11>
                                           ) @ #t2.6 )
                                      case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_3
                                  solve( (#vr.24 < #vr.12)  ∥ (#t2.2 < #vr.24) )
                                    case case_1
                                    solve( Insert( <'F_template', z.2>,
                                                   <z.3, z.4, z.5, z.6, z.7, 'on', z.8, 'on', z.9, z.10>
                                           ) @ #t2.6 )
                                      case insertFtemplatetrustedononoffoffononononusageusage_0_
                                      by contradiction /* from formulas */
                                    next
                                      case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                      solve( (#t2.1 < #t2.5)  ∥ (#t2.1 = #t2.5) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.5 ) ▶₀ #t2.4 )
                                          case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                                          solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Insert( <'obj', L_h>,
                                                               <k, x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, 
                                                                x.7, 'usage'>
                                                       ) @ #t2.5 )
                                                  case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                  solve( State_1111121111111( <x, 'on', x.1, x.2, x.3, x.4, 
                                                                               x.5, x.6, x.7, 'usage'>,
                                                                              <x, 'on', x.1, x.2, x.3, x.4, 
                                                                               x.5, x.6, x.7, 'usage'>,
                                                                              k.1, k, v, L_h, lock
                                                         ) ▶₀ #t2.5 )
                                                    case lookupFtemplateattuttemvasut_0_111112111111
                                                    solve( (#vr.30 < #vr.12)  ∥ (#t2.2 < #vr.30) )
                                                      case case_1
                                                      solve( (#vr.30 < #vr.24)  ∥ (#t2.4 < #vr.30) )
                                                        case case_1
                                                        solve( Insert( <'F_template', z.2>,
                                                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, 
                                                                        x.6, x.7, 'usage'>
                                                               ) @ #t2.9 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        solve( Insert( <'F_template', z.2>,
                                                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, 
                                                                        x.6, x.7, 'usage'>
                                                               ) @ #t2.9 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    next
                                                      case case_2
                                                      solve( Insert( <'F_template', z.2>,
                                                                     <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, 
                                                                      x.7, 'usage'>
                                                             ) @ #t2.9 )
                                                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                        by contradiction /* from formulas */
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case insertobjLhkatts_0_11111111111111111
                                                  solve( State_11111111111111111( lock, L_h,
                                                                                  <x, 'on', x.1, x.2, x.3, 
                                                                                   x.4, x.5, x.6, x.7, 'usage'
                                                                                  >,
                                                                                  k, ptr, templ
                                                         ) ▶₀ #t2.5 )
                                                    case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                    solve( ((#vr.12 < #vr.28) ∧
                                                            (∃ #t2.
                                                              (Unlock_0( '0', ~n, 'device' ) @ #t2)
                                                             ∧
                                                              (#vr.12 < #t2) ∧
                                                              (#t2 < #vr.28) ∧
                                                              (∀ #t0 pp.
                                                                (Unlock( pp, ~n, 'device' ) @ #t0)
                                                               ⇒
                                                                #t0 = #t2) ∧
                                                              (∀ pp lpp #t0.
                                                                (Lock( pp, lpp, 'device' ) @ #t0)
                                                               ⇒
                                                                ((#t0 < #vr.12) ∨
                                                                 (#t0 = #vr.12) ∨
                                                                 (#t2 < #t0))) ∧
                                                              (∀ pp lpp #t0.
                                                                (Unlock( pp, lpp, 'device' ) @ #t0)
                                                               ⇒
                                                                ((#t0 < #vr.12) ∨
                                                                 (#t2 < #t0) ∨
                                                                 (#t2 = #t0)))))  ∥
                                                           (#vr.28 < #vr.12)  ∥ (#vr.12 = #vr.28) )
                                                      case case_1
                                                      solve( Insert( <'F_template', ptr>,
                                                                     <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, 
                                                                      x.7, 'usage'>
                                                             ) @ #t2.9 )
                                                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                        solve( (#t2.7 < #t2.3)  ∥ (#t2.7 = #t2.3)  ∥
                                                               (#vr.11 < #t2.7) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                atts, k, ptr,
                                                                                                templ
                                                                 ) ▶₀ #t2.6 )
                                                            case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                            solve( (#t2.9 < #t2.3)  ∥ (#t2.9 = #t2.3)  ∥
                                                                   (#vr.11 < #t2.9) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( Insert( <'obj', h2>,
                                                                             <z, 'off', 'off', 'on', 'on', 
                                                                              'on', 'on', 'off', 'on', 
                                                                              'undef', 'undef'>
                                                                     ) @ #t2.7 )
                                                                case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                                solve( State_1111121111111( <'off', 'off', 
                                                                                             'on', 'on', 
                                                                                             'on', 'on', 
                                                                                             'off', 'on', 
                                                                                             'undef', 'undef'
                                                                                            >,
                                                                                            <'off', 'off', 
                                                                                             'on', 'on', 
                                                                                             'on', 'on', 
                                                                                             'off', 'on', 
                                                                                             'undef', 'undef'
                                                                                            >,
                                                                                            k, z, v, L_h, lock
                                                                       ) ▶₀ #t2.7 )
                                                                  case lookupFtemplateattuttemvasut_0_111112111111
                                                                  solve( Insert( <'F_template', z.2>,
                                                                                 <'off', 'off', 'on', 'on', 
                                                                                  'on', 'on', 'off', 'on', 
                                                                                  'undef', 'undef'>
                                                                         ) @ #t2.10 )
                                                                    case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                    solve( (#t2.1 < #t2.9)  ∥
                                                                           (#t2.1 = #t2.9) )
                                                                      case case_1
                                                                      by contradiction /* from formulas */
                                                                    next
                                                                      case case_2
                                                                      solve( State_1111121111111111111111( ut,
                                                                                                           atts,
                                                                                                           h2,
                                                                                                           k.1,
                                                                                                           m,
                                                                                                           v,
                                                                                                           L_h.1,
                                                                                                           ~n.10
                                                                             ) ▶₀ #t2.8 )
                                                                        case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                        solve( (∃ h1 #t1.
                                                                                 (NewKey( h1, m, 'on' ) @ #t1)
                                                                                ∧
                                                                                 #t1 < #vr.44)  ∥
                                                                               (∃ L_h k2 #t1 #t0.
                                                                                 (NewKey( L_h, k2, 'on'
                                                                                  ) @ #t0) ∧
                                                                                 (!KU( k2 ) @ #t1)
                                                                                ∧
                                                                                 (#t1 < #vr.44) ∧
                                                                                 (#t0 < #vr.44))  ∥
                                                                               (∃ #t0 #t1 h1 h2 k.
                                                                                 (WrapKey( h2, k, 'on'
                                                                                  ) @ #t0) ∧
                                                                                 (DecKey( h1, k, 'on' ) @ #t1)
                                                                                ∧
                                                                                 (#t0 < #vr.44) ∧
                                                                                 (#t1 < #vr.44))  ∥
                                                                               (∃ #t0 #t1 h1 h2 k.
                                                                                 (UnwrapKey( h2, k, 'on'
                                                                                  ) @ #t0) ∧
                                                                                 (EncKey( h1, k, 'on' ) @ #t1)
                                                                                ∧
                                                                                 (#t0 < #vr.44) ∧
                                                                                 (#t1 < #vr.44)) )
                                                                          case case_1
                                                                          solve( (#t2.10 < #t2.12)  ∥
                                                                                 (#t2.10 = #t2.12) )
                                                                            case case_1
                                                                            by contradiction
                                                                               /* from formulas */
                                                                          next
                                                                            case case_2
                                                                            solve( (#t2.1 < #t2.11)  ∥
                                                                                   (#t2.1 = #t2.11) )
                                                                              case case_1
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            next
                                                                              case case_2
                                                                              solve( State_111111111111111( lock,
                                                                                                            h1,
                                                                                                            <
                                                                                                             z.1, 
                                                                                                             z.2, 
                                                                                                             z.3, 
                                                                                                             z.4, 
                                                                                                             'on', 
                                                                                                             z.5, 
                                                                                                             z.6, 
                                                                                                             z.7, 
                                                                                                             z.8, 
                                                                                                             z.9
                                                                                                            >,
                                                                                                            m,
                                                                                                            ptr,
                                                                                                            <
                                                                                                             z.1, 
                                                                                                             z.2, 
                                                                                                             z.3, 
                                                                                                             z.4, 
                                                                                                             'on', 
                                                                                                             z.5, 
                                                                                                             z.6, 
                                                                                                             z.7, 
                                                                                                             z.8, 
                                                                                                             z.9
                                                                                                            >
                                                                                     ) ▶₀ #t1.1 )
                                                                                case lookupFtemplateptrastempl_0_11111111111111
                                                                                by contradiction
                                                                                   /* impossible chain */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        next
                                                                          case case_2
                                                                          by contradiction /* from formulas */
                                                                        next
                                                                          case case_3
                                                                          solve( (#t2.10 < #t2.12)  ∥
                                                                                 (#t2.10 = #t2.12) )
                                                                            case case_1
                                                                            by contradiction
                                                                               /* from formulas */
                                                                          next
                                                                            case case_2
                                                                            solve( (#t2.1 < #t2.11)  ∥
                                                                                   (#t2.1 = #t2.11) )
                                                                              case case_1
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            next
                                                                              case case_2
                                                                              solve( (∃ L_h k2 #t1.2 #t0.1.
                                                                                       (NewKey( L_h, k2, 'on'
                                                                                        ) @ #t0.1) ∧
                                                                                       (!KU( k2 ) @ #t1.2)
                                                                                      ∧
                                                                                       (¬(last(#t0.1))) ∧
                                                                                       (¬(last(#t1.2))) ∧
                                                                                       ((((#t1.2 < #t0) ∧
                                                                                          (#t0.1 < #t0)) ∨
                                                                                         ((#t1.2 < #t1.1) ∧
                                                                                          (#t0.1 < #t1.1)))))  ∥
                                                                                     (∃ #t0.1 #t1.2 h1 h2 k.
                                                                                       (UnwrapKey( h2, k, 'on'
                                                                                        ) @ #t0.1) ∧
                                                                                       (EncKey( h1, k, 'on'
                                                                                        ) @ #t1.2)
                                                                                      ∧
                                                                                       (¬(last(#t1.2))) ∧
                                                                                       (¬(last(#t0.1))) ∧
                                                                                       ((((#t0.1 < #t1.1) ∧
                                                                                          (#t1.2 < #t1.1)) ∨
                                                                                         ((#t0.1 < #t0) ∧
                                                                                          (#t1.2 < #t0))))) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        next
                                                                          case case_4
                                                                          by contradiction /* from formulas */
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              next
                                                                case insertobjLhkatts_0_11111111111111111
                                                                solve( State_11111111111111111( lock, h2,
                                                                                                <'off', 
                                                                                                 'off', 'on', 
                                                                                                 'on', 'on', 
                                                                                                 'on', 'off', 
                                                                                                 'on', 
                                                                                                 'undef', 
                                                                                                 'undef'>,
                                                                                                z, ptr, templ
                                                                       ) ▶₀ #t2.7 )
                                                                  case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                                  by contradiction /* impossible chain */
                                                                qed
                                                              qed
                                                            next
                                                              case case_3
                                                              by contradiction /* from formulas */
                                                            qed
                                                          qed
                                                        next
                                                          case case_3
                                                          solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                atts, k, ptr,
                                                                                                templ
                                                                 ) ▶₀ #t2.6 )
                                                            case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                            solve( (#t2.10 < #t2.3)  ∥ (#t2.10 = #t2.3)  ∥
                                                                   (#vr.11 < #t2.10) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_3
                                                              solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( State_( ) ▶₀ #t2.7 )
                                                                  case Init
                                                                  by contradiction /* cyclic */
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    next
                                                      case case_2
                                                      solve( (#vr.28 < #vr.24)  ∥ (#t2.4 < #vr.28) )
                                                        case case_1
                                                        solve( Insert( <'F_template', ptr>,
                                                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, 
                                                                        x.6, x.7, 'usage'>
                                                               ) @ #t2.9 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          solve( (#t2.7 < #t2.3)  ∥ (#t2.7 = #t2.3)  ∥
                                                                 (#vr.11 < #t2.7) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                  atts, k,
                                                                                                  ptr, templ
                                                                   ) ▶₀ #t2.6 )
                                                              case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                              solve( (#t2.3 < #t2.9)  ∥ (#t2.3 = #t2.9) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( Insert( <'obj', h2>,
                                                                               <z, 'off', 'off', 'on', 'on', 
                                                                                'on', 'on', 'off', 'on', 
                                                                                'undef', 'undef'>
                                                                       ) @ #t2.7 )
                                                                  case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                                  solve( State_1111121111111( <'off', 'off', 
                                                                                               'on', 'on', 
                                                                                               'on', 'on', 
                                                                                               'off', 'on', 
                                                                                               'undef', 
                                                                                               'undef'>,
                                                                                              <'off', 'off', 
                                                                                               'on', 'on', 
                                                                                               'on', 'on', 
                                                                                               'off', 'on', 
                                                                                               'undef', 
                                                                                               'undef'>,
                                                                                              k, z, v, L_h,
                                                                                              lock
                                                                         ) ▶₀ #t2.7 )
                                                                    case lookupFtemplateattuttemvasut_0_111112111111
                                                                    solve( (#vr.38 < #vr.28)  ∥
                                                                           (#t2.6 < #vr.38) )
                                                                      case case_1
                                                                      solve( Insert( <'F_template', z.2>,
                                                                                     <'off', 'off', 'on', 
                                                                                      'on', 'on', 'on', 
                                                                                      'off', 'on', 'undef', 
                                                                                      'undef'>
                                                                             ) @ #t2.10 )
                                                                        case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                        solve( (#t2.1 < #t2.9)  ∥
                                                                               (#t2.1 = #t2.9) )
                                                                          case case_1
                                                                          by contradiction /* from formulas */
                                                                        next
                                                                          case case_2
                                                                          solve( State_1111121111111111111111( ut,
                                                                                                               atts,
                                                                                                               h2,
                                                                                                               k.1,
                                                                                                               m,
                                                                                                               v,
                                                                                                               L_h.1,
                                                                                                               ~n.10
                                                                                 ) ▶₀ #t2.8 )
                                                                            case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                            solve( (∃ h1 #t1.
                                                                                     (NewKey( h1, m, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     #t1 < #vr.44)  ∥
                                                                                   (∃ L_h k2 #t1 #t0.
                                                                                     (NewKey( L_h, k2, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (!KU( k2 ) @ #t1)
                                                                                    ∧
                                                                                     (#t1 < #vr.44) ∧
                                                                                     (#t0 < #vr.44))  ∥
                                                                                   (∃ #t0 #t1 h1 h2 k.
                                                                                     (WrapKey( h2, k, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (DecKey( h1, k, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     (#t0 < #vr.44) ∧
                                                                                     (#t1 < #vr.44))  ∥
                                                                                   (∃ #t0 #t1 h1 h2 k.
                                                                                     (UnwrapKey( h2, k, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (EncKey( h1, k, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     (#t0 < #vr.44) ∧
                                                                                     (#t1 < #vr.44)) )
                                                                              case case_1
                                                                              solve( (#t2.10 < #t2.12)  ∥
                                                                                     (#t2.10 = #t2.12) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (#t2.1 < #t2.11)  ∥
                                                                                       (#t2.1 = #t2.11) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( State_111111111111111( lock,
                                                                                                                h1,
                                                                                                                <
                                                                                                                 z.1, 
                                                                                                                 z.2, 
                                                                                                                 z.3, 
                                                                                                                 z.4, 
                                                                                                                 'on', 
                                                                                                                 z.5, 
                                                                                                                 z.6, 
                                                                                                                 z.7, 
                                                                                                                 z.8, 
                                                                                                                 z.9
                                                                                                                >,
                                                                                                                m,
                                                                                                                ptr,
                                                                                                                <
                                                                                                                 z.1, 
                                                                                                                 z.2, 
                                                                                                                 z.3, 
                                                                                                                 z.4, 
                                                                                                                 'on', 
                                                                                                                 z.5, 
                                                                                                                 z.6, 
                                                                                                                 z.7, 
                                                                                                                 z.8, 
                                                                                                                 z.9
                                                                                                                >
                                                                                         ) ▶₀ #t1.1 )
                                                                                    case lookupFtemplateptrastempl_0_11111111111111
                                                                                    by contradiction
                                                                                       /* impossible chain */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_2
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            next
                                                                              case case_3
                                                                              solve( (#t2.10 < #t2.12)  ∥
                                                                                     (#t2.10 = #t2.12) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (#t2.1 < #t2.11)  ∥
                                                                                       (#t2.1 = #t2.11) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( (∃ L_h k2 #t1.2
                                                                                            #t0.1.
                                                                                           (NewKey( L_h, k2,
                                                                                                    'on'
                                                                                            ) @ #t0.1) ∧
                                                                                           (!KU( k2 ) @ #t1.2)
                                                                                          ∧
                                                                                           (¬(last(#t0.1))) ∧
                                                                                           (¬(last(#t1.2))) ∧
                                                                                           ((((#t1.2 < #t0) ∧
                                                                                              (#t0.1 < #t0)) ∨
                                                                                             ((#t1.2 < #t1.1) ∧
                                                                                              (#t0.1 < #t1.1)))))  ∥
                                                                                         (∃ #t0.1 #t1.2 h1 h2
                                                                                            k.
                                                                                           (UnwrapKey( h2, k,
                                                                                                       'on'
                                                                                            ) @ #t0.1) ∧
                                                                                           (EncKey( h1, k,
                                                                                                    'on'
                                                                                            ) @ #t1.2)
                                                                                          ∧
                                                                                           (¬(last(#t1.2))) ∧
                                                                                           (¬(last(#t0.1))) ∧
                                                                                           ((((#t0.1 < #t1.1) ∧
                                                                                              (#t1.2 < #t1.1)) ∨
                                                                                             ((#t0.1 < #t0) ∧
                                                                                              (#t1.2 < #t0))))) )
                                                                                    case case_1
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  next
                                                                                    case case_2
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_4
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    next
                                                                      case case_2
                                                                      solve( Insert( <'F_template', z.2>,
                                                                                     <'off', 'off', 'on', 
                                                                                      'on', 'on', 'on', 
                                                                                      'off', 'on', 'undef', 
                                                                                      'undef'>
                                                                             ) @ #t2.10 )
                                                                        case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                        solve( (#t2.1 < #t2.9)  ∥
                                                                               (#t2.1 = #t2.9) )
                                                                          case case_1
                                                                          by contradiction /* from formulas */
                                                                        next
                                                                          case case_2
                                                                          solve( State_1111121111111111111111( ut,
                                                                                                               atts,
                                                                                                               h2,
                                                                                                               k.1,
                                                                                                               m,
                                                                                                               v,
                                                                                                               L_h.1,
                                                                                                               ~n.10
                                                                                 ) ▶₀ #t2.8 )
                                                                            case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                            solve( (∃ h1 #t1.
                                                                                     (NewKey( h1, m, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     #t1 < #vr.44)  ∥
                                                                                   (∃ L_h k2 #t1 #t0.
                                                                                     (NewKey( L_h, k2, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (!KU( k2 ) @ #t1)
                                                                                    ∧
                                                                                     (#t1 < #vr.44) ∧
                                                                                     (#t0 < #vr.44))  ∥
                                                                                   (∃ #t0 #t1 h1 h2 k.
                                                                                     (WrapKey( h2, k, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (DecKey( h1, k, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     (#t0 < #vr.44) ∧
                                                                                     (#t1 < #vr.44))  ∥
                                                                                   (∃ #t0 #t1 h1 h2 k.
                                                                                     (UnwrapKey( h2, k, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (EncKey( h1, k, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     (#t0 < #vr.44) ∧
                                                                                     (#t1 < #vr.44)) )
                                                                              case case_1
                                                                              solve( (#t2.10 < #t2.12)  ∥
                                                                                     (#t2.10 = #t2.12) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (#t2.1 < #t2.11)  ∥
                                                                                       (#t2.1 = #t2.11) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( State_111111111111111( lock,
                                                                                                                h1,
                                                                                                                <
                                                                                                                 z.1, 
                                                                                                                 z.2, 
                                                                                                                 z.3, 
                                                                                                                 z.4, 
                                                                                                                 'on', 
                                                                                                                 z.5, 
                                                                                                                 z.6, 
                                                                                                                 z.7, 
                                                                                                                 z.8, 
                                                                                                                 z.9
                                                                                                                >,
                                                                                                                m,
                                                                                                                ptr,
                                                                                                                <
                                                                                                                 z.1, 
                                                                                                                 z.2, 
                                                                                                                 z.3, 
                                                                                                                 z.4, 
                                                                                                                 'on', 
                                                                                                                 z.5, 
                                                                                                                 z.6, 
                                                                                                                 z.7, 
                                                                                                                 z.8, 
                                                                                                                 z.9
                                                                                                                >
                                                                                         ) ▶₀ #t1.1 )
                                                                                    case lookupFtemplateptrastempl_0_11111111111111
                                                                                    by contradiction
                                                                                       /* impossible chain */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_2
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            next
                                                                              case case_3
                                                                              solve( (#t2.10 < #t2.12)  ∥
                                                                                     (#t2.10 = #t2.12) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (#t2.1 < #t2.11)  ∥
                                                                                       (#t2.1 = #t2.11) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( (∃ L_h k2 #t1.2
                                                                                            #t0.1.
                                                                                           (NewKey( L_h, k2,
                                                                                                    'on'
                                                                                            ) @ #t0.1) ∧
                                                                                           (!KU( k2 ) @ #t1.2)
                                                                                          ∧
                                                                                           (¬(last(#t0.1))) ∧
                                                                                           (¬(last(#t1.2))) ∧
                                                                                           ((((#t1.2 < #t0) ∧
                                                                                              (#t0.1 < #t0)) ∨
                                                                                             ((#t1.2 < #t1.1) ∧
                                                                                              (#t0.1 < #t1.1)))))  ∥
                                                                                         (∃ #t0.1 #t1.2 h1 h2
                                                                                            k.
                                                                                           (UnwrapKey( h2, k,
                                                                                                       'on'
                                                                                            ) @ #t0.1) ∧
                                                                                           (EncKey( h1, k,
                                                                                                    'on'
                                                                                            ) @ #t1.2)
                                                                                          ∧
                                                                                           (¬(last(#t1.2))) ∧
                                                                                           (¬(last(#t0.1))) ∧
                                                                                           ((((#t0.1 < #t1.1) ∧
                                                                                              (#t1.2 < #t1.1)) ∨
                                                                                             ((#t0.1 < #t0) ∧
                                                                                              (#t1.2 < #t0))))) )
                                                                                    case case_1
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  next
                                                                                    case case_2
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_4
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                next
                                                                  case insertobjLhkatts_0_11111111111111111
                                                                  solve( State_11111111111111111( lock, h2,
                                                                                                  <'off', 
                                                                                                   'off', 
                                                                                                   'on', 
                                                                                                   'on', 
                                                                                                   'on', 
                                                                                                   'on', 
                                                                                                   'off', 
                                                                                                   'on', 
                                                                                                   'undef', 
                                                                                                   'undef'>,
                                                                                                  z, ptr,
                                                                                                  templ
                                                                         ) ▶₀ #t2.7 )
                                                                    case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                                    by contradiction /* impossible chain */
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_3
                                                            solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                  atts, k,
                                                                                                  ptr, templ
                                                                   ) ▶₀ #t2.6 )
                                                              case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                              by contradiction /* cyclic */
                                                            qed
                                                          qed
                                                        qed
                                                      next
                                                        case case_2
                                                        solve( Insert( <'F_template', ptr>,
                                                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, 
                                                                        x.6, x.7, 'usage'>
                                                               ) @ #t2.9 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          solve( (#t2.7 < #t2.3)  ∥ (#t2.7 = #t2.3)  ∥
                                                                 (#vr.11 < #t2.7) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                  atts, k,
                                                                                                  ptr, templ
                                                                   ) ▶₀ #t2.6 )
                                                              case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                              solve( (#t2.3 < #t2.9)  ∥ (#t2.3 = #t2.9) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( Insert( <'obj', h2>,
                                                                               <z, 'off', 'off', 'on', 'on', 
                                                                                'on', 'on', 'off', 'on', 
                                                                                'undef', 'undef'>
                                                                       ) @ #t2.7 )
                                                                  case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                                  solve( State_1111121111111( <'off', 'off', 
                                                                                               'on', 'on', 
                                                                                               'on', 'on', 
                                                                                               'off', 'on', 
                                                                                               'undef', 
                                                                                               'undef'>,
                                                                                              <'off', 'off', 
                                                                                               'on', 'on', 
                                                                                               'on', 'on', 
                                                                                               'off', 'on', 
                                                                                               'undef', 
                                                                                               'undef'>,
                                                                                              k, z, v, L_h,
                                                                                              lock
                                                                         ) ▶₀ #t2.7 )
                                                                    case lookupFtemplateattuttemvasut_0_111112111111
                                                                    solve( Insert( <'F_template', z.2>,
                                                                                   <'off', 'off', 'on', 'on', 
                                                                                    'on', 'on', 'off', 'on', 
                                                                                    'undef', 'undef'>
                                                                           ) @ #t2.10 )
                                                                      case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                      solve( (#t2.1 < #t2.9)  ∥
                                                                             (#t2.1 = #t2.9) )
                                                                        case case_1
                                                                        by contradiction /* from formulas */
                                                                      next
                                                                        case case_2
                                                                        solve( State_1111121111111111111111( ut,
                                                                                                             atts,
                                                                                                             h2,
                                                                                                             k.1,
                                                                                                             m,
                                                                                                             v,
                                                                                                             L_h.1,
                                                                                                             ~n.10
                                                                               ) ▶₀ #t2.8 )
                                                                          case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                          solve( (∃ h1 #t1.
                                                                                   (NewKey( h1, m, 'on'
                                                                                    ) @ #t1)
                                                                                  ∧
                                                                                   #t1 < #vr.44)  ∥
                                                                                 (∃ L_h k2 #t1 #t0.
                                                                                   (NewKey( L_h, k2, 'on'
                                                                                    ) @ #t0) ∧
                                                                                   (!KU( k2 ) @ #t1)
                                                                                  ∧
                                                                                   (#t1 < #vr.44) ∧
                                                                                   (#t0 < #vr.44))  ∥
                                                                                 (∃ #t0 #t1 h1 h2 k.
                                                                                   (WrapKey( h2, k, 'on'
                                                                                    ) @ #t0) ∧
                                                                                   (DecKey( h1, k, 'on'
                                                                                    ) @ #t1)
                                                                                  ∧
                                                                                   (#t0 < #vr.44) ∧
                                                                                   (#t1 < #vr.44))  ∥
                                                                                 (∃ #t0 #t1 h1 h2 k.
                                                                                   (UnwrapKey( h2, k, 'on'
                                                                                    ) @ #t0) ∧
                                                                                   (EncKey( h1, k, 'on'
                                                                                    ) @ #t1)
                                                                                  ∧
                                                                                   (#t0 < #vr.44) ∧
                                                                                   (#t1 < #vr.44)) )
                                                                            case case_1
                                                                            solve( (#t2.10 < #t2.12)  ∥
                                                                                   (#t2.10 = #t2.12) )
                                                                              case case_1
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            next
                                                                              case case_2
                                                                              solve( (#t2.1 < #t2.11)  ∥
                                                                                     (#t2.1 = #t2.11) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( State_111111111111111( lock,
                                                                                                              h1,
                                                                                                              <
                                                                                                               z.1, 
                                                                                                               z.2, 
                                                                                                               z.3, 
                                                                                                               z.4, 
                                                                                                               'on', 
                                                                                                               z.5, 
                                                                                                               z.6, 
                                                                                                               z.7, 
                                                                                                               z.8, 
                                                                                                               z.9
                                                                                                              >,
                                                                                                              m,
                                                                                                              ptr,
                                                                                                              <
                                                                                                               z.1, 
                                                                                                               z.2, 
                                                                                                               z.3, 
                                                                                                               z.4, 
                                                                                                               'on', 
                                                                                                               z.5, 
                                                                                                               z.6, 
                                                                                                               z.7, 
                                                                                                               z.8, 
                                                                                                               z.9
                                                                                                              >
                                                                                       ) ▶₀ #t1.1 )
                                                                                  case lookupFtemplateptrastempl_0_11111111111111
                                                                                  by contradiction
                                                                                     /* impossible chain */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          next
                                                                            case case_2
                                                                            by contradiction
                                                                               /* from formulas */
                                                                          next
                                                                            case case_3
                                                                            solve( (#t2.10 < #t2.12)  ∥
                                                                                   (#t2.10 = #t2.12) )
                                                                              case case_1
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            next
                                                                              case case_2
                                                                              solve( (#t2.1 < #t2.11)  ∥
                                                                                     (#t2.1 = #t2.11) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (∃ L_h k2 #t1.2 #t0.1.
                                                                                         (NewKey( L_h, k2,
                                                                                                  'on'
                                                                                          ) @ #t0.1) ∧
                                                                                         (!KU( k2 ) @ #t1.2)
                                                                                        ∧
                                                                                         (¬(last(#t0.1))) ∧
                                                                                         (¬(last(#t1.2))) ∧
                                                                                         ((((#t1.2 < #t0) ∧
                                                                                            (#t0.1 < #t0)) ∨
                                                                                           ((#t1.2 < #t1.1) ∧
                                                                                            (#t0.1 < #t1.1)))))  ∥
                                                                                       (∃ #t0.1 #t1.2 h1 h2 k.
                                                                                         (UnwrapKey( h2, k,
                                                                                                     'on'
                                                                                          ) @ #t0.1) ∧
                                                                                         (EncKey( h1, k, 'on'
                                                                                          ) @ #t1.2)
                                                                                        ∧
                                                                                         (¬(last(#t1.2))) ∧
                                                                                         (¬(last(#t0.1))) ∧
                                                                                         ((((#t0.1 < #t1.1) ∧
                                                                                            (#t1.2 < #t1.1)) ∨
                                                                                           ((#t0.1 < #t0) ∧
                                                                                            (#t1.2 < #t0))))) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          next
                                                                            case case_4
                                                                            by contradiction
                                                                               /* from formulas */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                next
                                                                  case insertobjLhkatts_0_11111111111111111
                                                                  solve( State_11111111111111111( lock, h2,
                                                                                                  <'off', 
                                                                                                   'off', 
                                                                                                   'on', 
                                                                                                   'on', 
                                                                                                   'on', 
                                                                                                   'on', 
                                                                                                   'off', 
                                                                                                   'on', 
                                                                                                   'undef', 
                                                                                                   'undef'>,
                                                                                                  z, ptr,
                                                                                                  templ
                                                                         ) ▶₀ #t2.7 )
                                                                    case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                                    by contradiction /* impossible chain */
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          next
                                                            case case_3
                                                            solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                  atts, k,
                                                                                                  ptr, templ
                                                                   ) ▶₀ #t2.6 )
                                                              case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                              by contradiction /* cyclic */
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    next
                                                      case case_3
                                                      solve( (#t2.3 < #t2.8)  ∥ (#t2.3 = #t2.8) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( Insert( <'obj', h2>,
                                                                       <z, 'off', 'off', 'on', 'on', 'on', 
                                                                        'on', 'off', 'on', 'undef', 'undef'>
                                                               ) @ #t2.6 )
                                                          case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                          solve( State_1111121111111( <'off', 'off', 'on', 
                                                                                       'on', 'on', 'on', 
                                                                                       'off', 'on', 'undef', 
                                                                                       'undef'>,
                                                                                      <'off', 'off', 'on', 
                                                                                       'on', 'on', 'on', 
                                                                                       'off', 'on', 'undef', 
                                                                                       'undef'>,
                                                                                      k, z, v, L_h, lock
                                                                 ) ▶₀ #t2.6 )
                                                            case lookupFtemplateattuttemvasut_0_111112111111
                                                            solve( Insert( <'F_template', z.2>,
                                                                           <'off', 'off', 'on', 'on', 'on', 
                                                                            'on', 'off', 'on', 'undef', 
                                                                            'undef'>
                                                                   ) @ #t2.9 )
                                                              case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                              solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( State_1111121111111111111111( ut, atts,
                                                                                                     h2, k.1,
                                                                                                     m, v,
                                                                                                     L_h.1,
                                                                                                     ~n.7
                                                                       ) ▶₀ #t2.7 )
                                                                  case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                  solve( (∃ h1 #t1.
                                                                           (NewKey( h1, m, 'on' ) @ #t1)
                                                                          ∧
                                                                           #t1 < #vr.35)  ∥
                                                                         (∃ L_h k2 #t1 #t0.
                                                                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧
                                                                           (!KU( k2 ) @ #t1)
                                                                          ∧
                                                                           (#t1 < #vr.35) ∧ (#t0 < #vr.35))  ∥
                                                                         (∃ #t0 #t1 h1 h2 k.
                                                                           (WrapKey( h2, k, 'on' ) @ #t0) ∧
                                                                           (DecKey( h1, k, 'on' ) @ #t1)
                                                                          ∧
                                                                           (#t0 < #vr.35) ∧ (#t1 < #vr.35))  ∥
                                                                         (∃ #t0 #t1 h1 h2 k.
                                                                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧
                                                                           (EncKey( h1, k, 'on' ) @ #t1)
                                                                          ∧
                                                                           (#t0 < #vr.35) ∧ (#t1 < #vr.35)) )
                                                                    case case_1
                                                                    solve( (#t2.9 < #t2.11)  ∥
                                                                           (#t2.9 = #t2.11) )
                                                                      case case_1
                                                                      by contradiction /* from formulas */
                                                                    next
                                                                      case case_2
                                                                      solve( (#t2.1 < #t2.10)  ∥
                                                                             (#t2.1 = #t2.10) )
                                                                        case case_1
                                                                        by contradiction /* from formulas */
                                                                      next
                                                                        case case_2
                                                                        solve( State_111111111111111( lock,
                                                                                                      h1,
                                                                                                      <z.1, 
                                                                                                       z.2, 
                                                                                                       z.3, 
                                                                                                       z.4, 
                                                                                                       'on', 
                                                                                                       z.5, 
                                                                                                       z.6, 
                                                                                                       z.7, 
                                                                                                       z.8, 
                                                                                                       z.9>,
                                                                                                      m, ptr,
                                                                                                      <z.1, 
                                                                                                       z.2, 
                                                                                                       z.3, 
                                                                                                       z.4, 
                                                                                                       'on', 
                                                                                                       z.5, 
                                                                                                       z.6, 
                                                                                                       z.7, 
                                                                                                       z.8, 
                                                                                                       z.9>
                                                                               ) ▶₀ #t1.1 )
                                                                          case lookupFtemplateptrastempl_0_11111111111111
                                                                          by contradiction
                                                                             /* impossible chain */
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  next
                                                                    case case_2
                                                                    by contradiction /* from formulas */
                                                                  next
                                                                    case case_3
                                                                    solve( (#t2.9 < #t2.11)  ∥
                                                                           (#t2.9 = #t2.11) )
                                                                      case case_1
                                                                      by contradiction /* from formulas */
                                                                    next
                                                                      case case_2
                                                                      solve( (#t2.1 < #t2.10)  ∥
                                                                             (#t2.1 = #t2.10) )
                                                                        case case_1
                                                                        by contradiction /* from formulas */
                                                                      next
                                                                        case case_2
                                                                        solve( (∃ L_h k2 #t1.2 #t0.1.
                                                                                 (NewKey( L_h, k2, 'on'
                                                                                  ) @ #t0.1) ∧
                                                                                 (!KU( k2 ) @ #t1.2)
                                                                                ∧
                                                                                 (¬(last(#t0.1))) ∧
                                                                                 (¬(last(#t1.2))) ∧
                                                                                 ((((#t1.2 < #t0) ∧
                                                                                    (#t0.1 < #t0)) ∨
                                                                                   ((#t1.2 < #t1.1) ∧
                                                                                    (#t0.1 < #t1.1)))))  ∥
                                                                               (∃ #t0.1 #t1.2 h1 h2 k.
                                                                                 (UnwrapKey( h2, k, 'on'
                                                                                  ) @ #t0.1) ∧
                                                                                 (EncKey( h1, k, 'on'
                                                                                  ) @ #t1.2)
                                                                                ∧
                                                                                 (¬(last(#t1.2))) ∧
                                                                                 (¬(last(#t0.1))) ∧
                                                                                 ((((#t0.1 < #t1.1) ∧
                                                                                    (#t1.2 < #t1.1)) ∨
                                                                                   ((#t0.1 < #t0) ∧
                                                                                    (#t1.2 < #t0))))) )
                                                                          case case_1
                                                                          by contradiction /* from formulas */
                                                                        next
                                                                          case case_2
                                                                          by contradiction /* from formulas */
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  next
                                                                    case case_4
                                                                    by contradiction /* from formulas */
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case insertobjLhkatts_0_11111111111111111
                                                          solve( State_11111111111111111( lock, h2,
                                                                                          <'off', 'off', 
                                                                                           'on', 'on', 'on', 
                                                                                           'on', 'off', 'on', 
                                                                                           'undef', 'undef'>,
                                                                                          z, ptr, templ
                                                                 ) ▶₀ #t2.6 )
                                                            case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                            by contradiction /* impossible chain */
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  next
                                    case case_2
                                    solve( Insert( <'F_template', z.2>,
                                                   <z.3, z.4, z.5, z.6, z.7, 'on', z.8, 'on', z.9, z.10>
                                           ) @ #t2.6 )
                                      case insertFtemplatetrustedononoffoffononononusageusage_0_
                                      by contradiction /* from formulas */
                                    next
                                      case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                      solve( (#t2.1 < #t2.5)  ∥ (#t2.1 = #t2.5) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.5 ) ▶₀ #t2.4 )
                                          case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                                          solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Insert( <'obj', L_h>,
                                                               <k, x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, 
                                                                x.7, 'usage'>
                                                       ) @ #t2.5 )
                                                  case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                  solve( State_1111121111111( <x, 'on', x.1, x.2, x.3, x.4, 
                                                                               x.5, x.6, x.7, 'usage'>,
                                                                              <x, 'on', x.1, x.2, x.3, x.4, 
                                                                               x.5, x.6, x.7, 'usage'>,
                                                                              k.1, k, v, L_h, lock
                                                         ) ▶₀ #t2.5 )
                                                    case lookupFtemplateattuttemvasut_0_111112111111
                                                    solve( (#vr.30 < #vr.12)  ∥ (#t2.2 < #vr.30) )
                                                      case case_1
                                                      solve( Insert( <'F_template', z.2>,
                                                                     <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, 
                                                                      x.7, 'usage'>
                                                             ) @ #t2.9 )
                                                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                        by contradiction /* from formulas */
                                                      qed
                                                    next
                                                      case case_2
                                                      solve( (#vr.30 < #vr.24)  ∥ (#t2.4 < #vr.30) )
                                                        case case_1
                                                        solve( Insert( <'F_template', z.2>,
                                                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, 
                                                                        x.6, x.7, 'usage'>
                                                               ) @ #t2.9 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        solve( Insert( <'F_template', z.2>,
                                                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, 
                                                                        x.6, x.7, 'usage'>
                                                               ) @ #t2.9 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case insertobjLhkatts_0_11111111111111111
                                                  solve( State_11111111111111111( lock, L_h,
                                                                                  <x, 'on', x.1, x.2, x.3, 
                                                                                   x.4, x.5, x.6, x.7, 'usage'
                                                                                  >,
                                                                                  k, ptr, templ
                                                         ) ▶₀ #t2.5 )
                                                    case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                    solve( ((#vr.12 < #vr.28) ∧
                                                            (∃ #t2.
                                                              (Unlock_0( '0', ~n, 'device' ) @ #t2)
                                                             ∧
                                                              (#vr.12 < #t2) ∧
                                                              (#t2 < #vr.28) ∧
                                                              (∀ #t0 pp.
                                                                (Unlock( pp, ~n, 'device' ) @ #t0)
                                                               ⇒
                                                                #t0 = #t2) ∧
                                                              (∀ pp lpp #t0.
                                                                (Lock( pp, lpp, 'device' ) @ #t0)
                                                               ⇒
                                                                ((#t0 < #vr.12) ∨
                                                                 (#t0 = #vr.12) ∨
                                                                 (#t2 < #t0))) ∧
                                                              (∀ pp lpp #t0.
                                                                (Unlock( pp, lpp, 'device' ) @ #t0)
                                                               ⇒
                                                                ((#t0 < #vr.12) ∨
                                                                 (#t2 < #t0) ∨
                                                                 (#t2 = #t0)))))  ∥
                                                           (#vr.28 < #vr.12)  ∥ (#vr.12 = #vr.28) )
                                                      case case_1
                                                      solve( (#vr.28 < #vr.24)  ∥ (#t2.4 < #vr.28) )
                                                        case case_1
                                                        solve( Insert( <'F_template', ptr>,
                                                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, 
                                                                        x.6, x.7, 'usage'>
                                                               ) @ #t2.9 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          solve( (#t2.7 < #t2.3)  ∥ (#t2.7 = #t2.3)  ∥
                                                                 (#vr.11 < #t2.7) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                  atts, k,
                                                                                                  ptr, templ
                                                                   ) ▶₀ #t2.6 )
                                                              case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                              solve( (#t2.9 < #t2.3)  ∥ (#t2.9 = #t2.3)  ∥
                                                                     (#vr.11 < #t2.9) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( Insert( <'obj', h2>,
                                                                               <z, 'off', 'off', 'on', 'on', 
                                                                                'on', 'on', 'off', 'on', 
                                                                                'undef', 'undef'>
                                                                       ) @ #t2.7 )
                                                                  case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                                  solve( State_1111121111111( <'off', 'off', 
                                                                                               'on', 'on', 
                                                                                               'on', 'on', 
                                                                                               'off', 'on', 
                                                                                               'undef', 
                                                                                               'undef'>,
                                                                                              <'off', 'off', 
                                                                                               'on', 'on', 
                                                                                               'on', 'on', 
                                                                                               'off', 'on', 
                                                                                               'undef', 
                                                                                               'undef'>,
                                                                                              k, z, v, L_h,
                                                                                              lock
                                                                         ) ▶₀ #t2.7 )
                                                                    case lookupFtemplateattuttemvasut_0_111112111111
                                                                    solve( (#vr.38 < #vr.12)  ∥
                                                                           (#t2.2 < #vr.38) )
                                                                      case case_1
                                                                      solve( Insert( <'F_template', z.2>,
                                                                                     <'off', 'off', 'on', 
                                                                                      'on', 'on', 'on', 
                                                                                      'off', 'on', 'undef', 
                                                                                      'undef'>
                                                                             ) @ #t2.10 )
                                                                        case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                        solve( (#t2.1 < #t2.9)  ∥
                                                                               (#t2.1 = #t2.9) )
                                                                          case case_1
                                                                          by contradiction /* from formulas */
                                                                        next
                                                                          case case_2
                                                                          solve( State_1111121111111111111111( ut,
                                                                                                               atts,
                                                                                                               h2,
                                                                                                               k.1,
                                                                                                               m,
                                                                                                               v,
                                                                                                               L_h.1,
                                                                                                               ~n.10
                                                                                 ) ▶₀ #t2.8 )
                                                                            case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                            solve( (∃ h1 #t1.
                                                                                     (NewKey( h1, m, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     #t1 < #vr.44)  ∥
                                                                                   (∃ L_h k2 #t1 #t0.
                                                                                     (NewKey( L_h, k2, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (!KU( k2 ) @ #t1)
                                                                                    ∧
                                                                                     (#t1 < #vr.44) ∧
                                                                                     (#t0 < #vr.44))  ∥
                                                                                   (∃ #t0 #t1 h1 h2 k.
                                                                                     (WrapKey( h2, k, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (DecKey( h1, k, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     (#t0 < #vr.44) ∧
                                                                                     (#t1 < #vr.44))  ∥
                                                                                   (∃ #t0 #t1 h1 h2 k.
                                                                                     (UnwrapKey( h2, k, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (EncKey( h1, k, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     (#t0 < #vr.44) ∧
                                                                                     (#t1 < #vr.44)) )
                                                                              case case_1
                                                                              solve( (#t2.10 < #t2.12)  ∥
                                                                                     (#t2.10 = #t2.12) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (#t2.1 < #t2.11)  ∥
                                                                                       (#t2.1 = #t2.11) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( State_111111111111111( lock,
                                                                                                                h1,
                                                                                                                <
                                                                                                                 z.1, 
                                                                                                                 z.2, 
                                                                                                                 z.3, 
                                                                                                                 z.4, 
                                                                                                                 'on', 
                                                                                                                 z.5, 
                                                                                                                 z.6, 
                                                                                                                 z.7, 
                                                                                                                 z.8, 
                                                                                                                 z.9
                                                                                                                >,
                                                                                                                m,
                                                                                                                ptr,
                                                                                                                <
                                                                                                                 z.1, 
                                                                                                                 z.2, 
                                                                                                                 z.3, 
                                                                                                                 z.4, 
                                                                                                                 'on', 
                                                                                                                 z.5, 
                                                                                                                 z.6, 
                                                                                                                 z.7, 
                                                                                                                 z.8, 
                                                                                                                 z.9
                                                                                                                >
                                                                                         ) ▶₀ #t1.1 )
                                                                                    case lookupFtemplateptrastempl_0_11111111111111
                                                                                    by contradiction
                                                                                       /* impossible chain */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_2
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            next
                                                                              case case_3
                                                                              solve( (#t2.10 < #t2.12)  ∥
                                                                                     (#t2.10 = #t2.12) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (#t2.1 < #t2.11)  ∥
                                                                                       (#t2.1 = #t2.11) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( (∃ L_h k2 #t1.2
                                                                                            #t0.1.
                                                                                           (NewKey( L_h, k2,
                                                                                                    'on'
                                                                                            ) @ #t0.1) ∧
                                                                                           (!KU( k2 ) @ #t1.2)
                                                                                          ∧
                                                                                           (¬(last(#t0.1))) ∧
                                                                                           (¬(last(#t1.2))) ∧
                                                                                           ((((#t1.2 < #t0) ∧
                                                                                              (#t0.1 < #t0)) ∨
                                                                                             ((#t1.2 < #t1.1) ∧
                                                                                              (#t0.1 < #t1.1)))))  ∥
                                                                                         (∃ #t0.1 #t1.2 h1 h2
                                                                                            k.
                                                                                           (UnwrapKey( h2, k,
                                                                                                       'on'
                                                                                            ) @ #t0.1) ∧
                                                                                           (EncKey( h1, k,
                                                                                                    'on'
                                                                                            ) @ #t1.2)
                                                                                          ∧
                                                                                           (¬(last(#t1.2))) ∧
                                                                                           (¬(last(#t0.1))) ∧
                                                                                           ((((#t0.1 < #t1.1) ∧
                                                                                              (#t1.2 < #t1.1)) ∨
                                                                                             ((#t0.1 < #t0) ∧
                                                                                              (#t1.2 < #t0))))) )
                                                                                    case case_1
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  next
                                                                                    case case_2
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_4
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    next
                                                                      case case_2
                                                                      solve( (#vr.38 < #vr.28)  ∥
                                                                             (#t2.6 < #vr.38) )
                                                                        case case_1
                                                                        solve( Insert( <'F_template', z.2>,
                                                                                       <'off', 'off', 'on', 
                                                                                        'on', 'on', 'on', 
                                                                                        'off', 'on', 'undef', 
                                                                                        'undef'>
                                                                               ) @ #t2.10 )
                                                                          case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                          solve( (#t2.1 < #t2.9)  ∥
                                                                                 (#t2.1 = #t2.9) )
                                                                            case case_1
                                                                            by contradiction
                                                                               /* from formulas */
                                                                          next
                                                                            case case_2
                                                                            solve( State_1111121111111111111111( ut,
                                                                                                                 atts,
                                                                                                                 h2,
                                                                                                                 k.1,
                                                                                                                 m,
                                                                                                                 v,
                                                                                                                 L_h.1,
                                                                                                                 ~n.10
                                                                                   ) ▶₀ #t2.8 )
                                                                              case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                              solve( (∃ h1 #t1.
                                                                                       (NewKey( h1, m, 'on'
                                                                                        ) @ #t1)
                                                                                      ∧
                                                                                       #t1 < #vr.44)  ∥
                                                                                     (∃ L_h k2 #t1 #t0.
                                                                                       (NewKey( L_h, k2, 'on'
                                                                                        ) @ #t0) ∧
                                                                                       (!KU( k2 ) @ #t1)
                                                                                      ∧
                                                                                       (#t1 < #vr.44) ∧
                                                                                       (#t0 < #vr.44))  ∥
                                                                                     (∃ #t0 #t1 h1 h2 k.
                                                                                       (WrapKey( h2, k, 'on'
                                                                                        ) @ #t0) ∧
                                                                                       (DecKey( h1, k, 'on'
                                                                                        ) @ #t1)
                                                                                      ∧
                                                                                       (#t0 < #vr.44) ∧
                                                                                       (#t1 < #vr.44))  ∥
                                                                                     (∃ #t0 #t1 h1 h2 k.
                                                                                       (UnwrapKey( h2, k, 'on'
                                                                                        ) @ #t0) ∧
                                                                                       (EncKey( h1, k, 'on'
                                                                                        ) @ #t1)
                                                                                      ∧
                                                                                       (#t0 < #vr.44) ∧
                                                                                       (#t1 < #vr.44)) )
                                                                                case case_1
                                                                                solve( (#t2.10 < #t2.12)  ∥
                                                                                       (#t2.10 = #t2.12) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( (#t2.1 < #t2.11)  ∥
                                                                                         (#t2.1 = #t2.11) )
                                                                                    case case_1
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  next
                                                                                    case case_2
                                                                                    solve( State_111111111111111( lock,
                                                                                                                  h1,
                                                                                                                  <
                                                                                                                   z.1, 
                                                                                                                   z.2, 
                                                                                                                   z.3, 
                                                                                                                   z.4, 
                                                                                                                   'on', 
                                                                                                                   z.5, 
                                                                                                                   z.6, 
                                                                                                                   z.7, 
                                                                                                                   z.8, 
                                                                                                                   z.9
                                                                                                                  >,
                                                                                                                  m,
                                                                                                                  ptr,
                                                                                                                  <
                                                                                                                   z.1, 
                                                                                                                   z.2, 
                                                                                                                   z.3, 
                                                                                                                   z.4, 
                                                                                                                   'on', 
                                                                                                                   z.5, 
                                                                                                                   z.6, 
                                                                                                                   z.7, 
                                                                                                                   z.8, 
                                                                                                                   z.9
                                                                                                                  >
                                                                                           ) ▶₀ #t1.1 )
                                                                                      case lookupFtemplateptrastempl_0_11111111111111
                                                                                      by contradiction
                                                                                         /* impossible chain
                                                                                         */
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_2
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_3
                                                                                solve( (#t2.10 < #t2.12)  ∥
                                                                                       (#t2.10 = #t2.12) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( (#t2.1 < #t2.11)  ∥
                                                                                         (#t2.1 = #t2.11) )
                                                                                    case case_1
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  next
                                                                                    case case_2
                                                                                    solve( (∃ L_h k2 #t1.2
                                                                                              #t0.1.
                                                                                             (NewKey( L_h, k2,
                                                                                                      'on'
                                                                                              ) @ #t0.1) ∧
                                                                                             (!KU( k2
                                                                                              ) @ #t1.2)
                                                                                            ∧
                                                                                             (¬(last(#t0.1))) ∧
                                                                                             (¬(last(#t1.2))) ∧
                                                                                             ((((#t1.2 < #t0) ∧
                                                                                                (#t0.1 < #t0)) ∨
                                                                                               ((#t1.2 < #t1.1) ∧
                                                                                                (#t0.1 < #t1.1)))))  ∥
                                                                                           (∃ #t0.1 #t1.2 h1
                                                                                              h2 k.
                                                                                             (UnwrapKey( h2,
                                                                                                         k,
                                                                                                         'on'
                                                                                              ) @ #t0.1) ∧
                                                                                             (EncKey( h1, k,
                                                                                                      'on'
                                                                                              ) @ #t1.2)
                                                                                            ∧
                                                                                             (¬(last(#t1.2))) ∧
                                                                                             (¬(last(#t0.1))) ∧
                                                                                             ((((#t0.1 < #t1.1) ∧
                                                                                                (#t1.2 < #t1.1)) ∨
                                                                                               ((#t0.1 < #t0) ∧
                                                                                                (#t1.2 < #t0))))) )
                                                                                      case case_1
                                                                                      by contradiction
                                                                                         /* from formulas */
                                                                                    next
                                                                                      case case_2
                                                                                      by contradiction
                                                                                         /* from formulas */
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_4
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      next
                                                                        case case_2
                                                                        solve( Insert( <'F_template', z.2>,
                                                                                       <'off', 'off', 'on', 
                                                                                        'on', 'on', 'on', 
                                                                                        'off', 'on', 'undef', 
                                                                                        'undef'>
                                                                               ) @ #t2.10 )
                                                                          case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                          solve( (#t2.1 < #t2.9)  ∥
                                                                                 (#t2.1 = #t2.9) )
                                                                            case case_1
                                                                            by contradiction
                                                                               /* from formulas */
                                                                          next
                                                                            case case_2
                                                                            solve( State_1111121111111111111111( ut,
                                                                                                                 atts,
                                                                                                                 h2,
                                                                                                                 k.1,
                                                                                                                 m,
                                                                                                                 v,
                                                                                                                 L_h.1,
                                                                                                                 ~n.10
                                                                                   ) ▶₀ #t2.8 )
                                                                              case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                              solve( (∃ h1 #t1.
                                                                                       (NewKey( h1, m, 'on'
                                                                                        ) @ #t1)
                                                                                      ∧
                                                                                       #t1 < #vr.44)  ∥
                                                                                     (∃ L_h k2 #t1 #t0.
                                                                                       (NewKey( L_h, k2, 'on'
                                                                                        ) @ #t0) ∧
                                                                                       (!KU( k2 ) @ #t1)
                                                                                      ∧
                                                                                       (#t1 < #vr.44) ∧
                                                                                       (#t0 < #vr.44))  ∥
                                                                                     (∃ #t0 #t1 h1 h2 k.
                                                                                       (WrapKey( h2, k, 'on'
                                                                                        ) @ #t0) ∧
                                                                                       (DecKey( h1, k, 'on'
                                                                                        ) @ #t1)
                                                                                      ∧
                                                                                       (#t0 < #vr.44) ∧
                                                                                       (#t1 < #vr.44))  ∥
                                                                                     (∃ #t0 #t1 h1 h2 k.
                                                                                       (UnwrapKey( h2, k, 'on'
                                                                                        ) @ #t0) ∧
                                                                                       (EncKey( h1, k, 'on'
                                                                                        ) @ #t1)
                                                                                      ∧
                                                                                       (#t0 < #vr.44) ∧
                                                                                       (#t1 < #vr.44)) )
                                                                                case case_1
                                                                                solve( (#t2.10 < #t2.12)  ∥
                                                                                       (#t2.10 = #t2.12) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( (#t2.1 < #t2.11)  ∥
                                                                                         (#t2.1 = #t2.11) )
                                                                                    case case_1
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  next
                                                                                    case case_2
                                                                                    solve( State_111111111111111( lock,
                                                                                                                  h1,
                                                                                                                  <
                                                                                                                   z.1, 
                                                                                                                   z.2, 
                                                                                                                   z.3, 
                                                                                                                   z.4, 
                                                                                                                   'on', 
                                                                                                                   z.5, 
                                                                                                                   z.6, 
                                                                                                                   z.7, 
                                                                                                                   z.8, 
                                                                                                                   z.9
                                                                                                                  >,
                                                                                                                  m,
                                                                                                                  ptr,
                                                                                                                  <
                                                                                                                   z.1, 
                                                                                                                   z.2, 
                                                                                                                   z.3, 
                                                                                                                   z.4, 
                                                                                                                   'on', 
                                                                                                                   z.5, 
                                                                                                                   z.6, 
                                                                                                                   z.7, 
                                                                                                                   z.8, 
                                                                                                                   z.9
                                                                                                                  >
                                                                                           ) ▶₀ #t1.1 )
                                                                                      case lookupFtemplateptrastempl_0_11111111111111
                                                                                      by contradiction
                                                                                         /* impossible chain
                                                                                         */
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_2
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_3
                                                                                solve( (#t2.10 < #t2.12)  ∥
                                                                                       (#t2.10 = #t2.12) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( (#t2.1 < #t2.11)  ∥
                                                                                         (#t2.1 = #t2.11) )
                                                                                    case case_1
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  next
                                                                                    case case_2
                                                                                    solve( (∃ L_h k2 #t1.2
                                                                                              #t0.1.
                                                                                             (NewKey( L_h, k2,
                                                                                                      'on'
                                                                                              ) @ #t0.1) ∧
                                                                                             (!KU( k2
                                                                                              ) @ #t1.2)
                                                                                            ∧
                                                                                             (¬(last(#t0.1))) ∧
                                                                                             (¬(last(#t1.2))) ∧
                                                                                             ((((#t1.2 < #t0) ∧
                                                                                                (#t0.1 < #t0)) ∨
                                                                                               ((#t1.2 < #t1.1) ∧
                                                                                                (#t0.1 < #t1.1)))))  ∥
                                                                                           (∃ #t0.1 #t1.2 h1
                                                                                              h2 k.
                                                                                             (UnwrapKey( h2,
                                                                                                         k,
                                                                                                         'on'
                                                                                              ) @ #t0.1) ∧
                                                                                             (EncKey( h1, k,
                                                                                                      'on'
                                                                                              ) @ #t1.2)
                                                                                            ∧
                                                                                             (¬(last(#t1.2))) ∧
                                                                                             (¬(last(#t0.1))) ∧
                                                                                             ((((#t0.1 < #t1.1) ∧
                                                                                                (#t1.2 < #t1.1)) ∨
                                                                                               ((#t0.1 < #t0) ∧
                                                                                                (#t1.2 < #t0))))) )
                                                                                      case case_1
                                                                                      by contradiction
                                                                                         /* from formulas */
                                                                                    next
                                                                                      case case_2
                                                                                      by contradiction
                                                                                         /* from formulas */
                                                                                    qed
                                                                                  qed
                                                                                qed
                                                                              next
                                                                                case case_4
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              qed
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                next
                                                                  case insertobjLhkatts_0_11111111111111111
                                                                  solve( State_11111111111111111( lock, h2,
                                                                                                  <'off', 
                                                                                                   'off', 
                                                                                                   'on', 
                                                                                                   'on', 
                                                                                                   'on', 
                                                                                                   'on', 
                                                                                                   'off', 
                                                                                                   'on', 
                                                                                                   'undef', 
                                                                                                   'undef'>,
                                                                                                  z, ptr,
                                                                                                  templ
                                                                         ) ▶₀ #t2.7 )
                                                                    case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                                    by contradiction /* impossible chain */
                                                                  qed
                                                                qed
                                                              next
                                                                case case_3
                                                                by contradiction /* from formulas */
                                                              qed
                                                            qed
                                                          next
                                                            case case_3
                                                            solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                  atts, k,
                                                                                                  ptr, templ
                                                                   ) ▶₀ #t2.6 )
                                                              case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                              solve( (#t2.10 < #t2.3)  ∥ (#t2.10 = #t2.3)  ∥
                                                                     (#vr.11 < #t2.10) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_3
                                                                solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10) )
                                                                  case case_1
                                                                  by contradiction /* from formulas */
                                                                next
                                                                  case case_2
                                                                  solve( State_( ) ▶₀ #t2.7 )
                                                                    case Init
                                                                    by contradiction /* cyclic */
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      next
                                                        case case_2
                                                        solve( Insert( <'F_template', ptr>,
                                                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, 
                                                                        x.6, x.7, 'usage'>
                                                               ) @ #t2.9 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          solve( (#t2.7 < #t2.3)  ∥ (#t2.7 = #t2.3)  ∥
                                                                 (#vr.11 < #t2.7) )
                                                            case case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case case_2
                                                            solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                  atts, k,
                                                                                                  ptr, templ
                                                                   ) ▶₀ #t2.6 )
                                                              case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                              solve( (#t2.9 < #t2.3)  ∥ (#t2.9 = #t2.3)  ∥
                                                                     (#vr.11 < #t2.9) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                solve( Insert( <'obj', h2>,
                                                                               <z, 'off', 'off', 'on', 'on', 
                                                                                'on', 'on', 'off', 'on', 
                                                                                'undef', 'undef'>
                                                                       ) @ #t2.7 )
                                                                  case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                                  solve( State_1111121111111( <'off', 'off', 
                                                                                               'on', 'on', 
                                                                                               'on', 'on', 
                                                                                               'off', 'on', 
                                                                                               'undef', 
                                                                                               'undef'>,
                                                                                              <'off', 'off', 
                                                                                               'on', 'on', 
                                                                                               'on', 'on', 
                                                                                               'off', 'on', 
                                                                                               'undef', 
                                                                                               'undef'>,
                                                                                              k, z, v, L_h,
                                                                                              lock
                                                                         ) ▶₀ #t2.7 )
                                                                    case lookupFtemplateattuttemvasut_0_111112111111
                                                                    solve( (#vr.38 < #vr.12)  ∥
                                                                           (#t2.2 < #vr.38) )
                                                                      case case_1
                                                                      solve( Insert( <'F_template', z.2>,
                                                                                     <'off', 'off', 'on', 
                                                                                      'on', 'on', 'on', 
                                                                                      'off', 'on', 'undef', 
                                                                                      'undef'>
                                                                             ) @ #t2.10 )
                                                                        case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                        solve( (#t2.1 < #t2.9)  ∥
                                                                               (#t2.1 = #t2.9) )
                                                                          case case_1
                                                                          by contradiction /* from formulas */
                                                                        next
                                                                          case case_2
                                                                          solve( State_1111121111111111111111( ut,
                                                                                                               atts,
                                                                                                               h2,
                                                                                                               k.1,
                                                                                                               m,
                                                                                                               v,
                                                                                                               L_h.1,
                                                                                                               ~n.10
                                                                                 ) ▶₀ #t2.8 )
                                                                            case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                            solve( (∃ h1 #t1.
                                                                                     (NewKey( h1, m, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     #t1 < #vr.44)  ∥
                                                                                   (∃ L_h k2 #t1 #t0.
                                                                                     (NewKey( L_h, k2, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (!KU( k2 ) @ #t1)
                                                                                    ∧
                                                                                     (#t1 < #vr.44) ∧
                                                                                     (#t0 < #vr.44))  ∥
                                                                                   (∃ #t0 #t1 h1 h2 k.
                                                                                     (WrapKey( h2, k, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (DecKey( h1, k, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     (#t0 < #vr.44) ∧
                                                                                     (#t1 < #vr.44))  ∥
                                                                                   (∃ #t0 #t1 h1 h2 k.
                                                                                     (UnwrapKey( h2, k, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (EncKey( h1, k, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     (#t0 < #vr.44) ∧
                                                                                     (#t1 < #vr.44)) )
                                                                              case case_1
                                                                              solve( (#t2.10 < #t2.12)  ∥
                                                                                     (#t2.10 = #t2.12) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (#t2.1 < #t2.11)  ∥
                                                                                       (#t2.1 = #t2.11) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( State_111111111111111( lock,
                                                                                                                h1,
                                                                                                                <
                                                                                                                 z.1, 
                                                                                                                 z.2, 
                                                                                                                 z.3, 
                                                                                                                 z.4, 
                                                                                                                 'on', 
                                                                                                                 z.5, 
                                                                                                                 z.6, 
                                                                                                                 z.7, 
                                                                                                                 z.8, 
                                                                                                                 z.9
                                                                                                                >,
                                                                                                                m,
                                                                                                                ptr,
                                                                                                                <
                                                                                                                 z.1, 
                                                                                                                 z.2, 
                                                                                                                 z.3, 
                                                                                                                 z.4, 
                                                                                                                 'on', 
                                                                                                                 z.5, 
                                                                                                                 z.6, 
                                                                                                                 z.7, 
                                                                                                                 z.8, 
                                                                                                                 z.9
                                                                                                                >
                                                                                         ) ▶₀ #t1.1 )
                                                                                    case lookupFtemplateptrastempl_0_11111111111111
                                                                                    by contradiction
                                                                                       /* impossible chain */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_2
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            next
                                                                              case case_3
                                                                              solve( (#t2.10 < #t2.12)  ∥
                                                                                     (#t2.10 = #t2.12) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (#t2.1 < #t2.11)  ∥
                                                                                       (#t2.1 = #t2.11) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( (∃ L_h k2 #t1.2
                                                                                            #t0.1.
                                                                                           (NewKey( L_h, k2,
                                                                                                    'on'
                                                                                            ) @ #t0.1) ∧
                                                                                           (!KU( k2 ) @ #t1.2)
                                                                                          ∧
                                                                                           (¬(last(#t0.1))) ∧
                                                                                           (¬(last(#t1.2))) ∧
                                                                                           ((((#t1.2 < #t0) ∧
                                                                                              (#t0.1 < #t0)) ∨
                                                                                             ((#t1.2 < #t1.1) ∧
                                                                                              (#t0.1 < #t1.1)))))  ∥
                                                                                         (∃ #t0.1 #t1.2 h1 h2
                                                                                            k.
                                                                                           (UnwrapKey( h2, k,
                                                                                                       'on'
                                                                                            ) @ #t0.1) ∧
                                                                                           (EncKey( h1, k,
                                                                                                    'on'
                                                                                            ) @ #t1.2)
                                                                                          ∧
                                                                                           (¬(last(#t1.2))) ∧
                                                                                           (¬(last(#t0.1))) ∧
                                                                                           ((((#t0.1 < #t1.1) ∧
                                                                                              (#t1.2 < #t1.1)) ∨
                                                                                             ((#t0.1 < #t0) ∧
                                                                                              (#t1.2 < #t0))))) )
                                                                                    case case_1
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  next
                                                                                    case case_2
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_4
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    next
                                                                      case case_2
                                                                      solve( Insert( <'F_template', z.2>,
                                                                                     <'off', 'off', 'on', 
                                                                                      'on', 'on', 'on', 
                                                                                      'off', 'on', 'undef', 
                                                                                      'undef'>
                                                                             ) @ #t2.10 )
                                                                        case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                        solve( (#t2.1 < #t2.9)  ∥
                                                                               (#t2.1 = #t2.9) )
                                                                          case case_1
                                                                          by contradiction /* from formulas */
                                                                        next
                                                                          case case_2
                                                                          solve( State_1111121111111111111111( ut,
                                                                                                               atts,
                                                                                                               h2,
                                                                                                               k.1,
                                                                                                               m,
                                                                                                               v,
                                                                                                               L_h.1,
                                                                                                               ~n.10
                                                                                 ) ▶₀ #t2.8 )
                                                                            case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                            solve( (∃ h1 #t1.
                                                                                     (NewKey( h1, m, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     #t1 < #vr.44)  ∥
                                                                                   (∃ L_h k2 #t1 #t0.
                                                                                     (NewKey( L_h, k2, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (!KU( k2 ) @ #t1)
                                                                                    ∧
                                                                                     (#t1 < #vr.44) ∧
                                                                                     (#t0 < #vr.44))  ∥
                                                                                   (∃ #t0 #t1 h1 h2 k.
                                                                                     (WrapKey( h2, k, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (DecKey( h1, k, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     (#t0 < #vr.44) ∧
                                                                                     (#t1 < #vr.44))  ∥
                                                                                   (∃ #t0 #t1 h1 h2 k.
                                                                                     (UnwrapKey( h2, k, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (EncKey( h1, k, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     (#t0 < #vr.44) ∧
                                                                                     (#t1 < #vr.44)) )
                                                                              case case_1
                                                                              solve( (#t2.10 < #t2.12)  ∥
                                                                                     (#t2.10 = #t2.12) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (#t2.1 < #t2.11)  ∥
                                                                                       (#t2.1 = #t2.11) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( State_111111111111111( lock,
                                                                                                                h1,
                                                                                                                <
                                                                                                                 z.1, 
                                                                                                                 z.2, 
                                                                                                                 z.3, 
                                                                                                                 z.4, 
                                                                                                                 'on', 
                                                                                                                 z.5, 
                                                                                                                 z.6, 
                                                                                                                 z.7, 
                                                                                                                 z.8, 
                                                                                                                 z.9
                                                                                                                >,
                                                                                                                m,
                                                                                                                ptr,
                                                                                                                <
                                                                                                                 z.1, 
                                                                                                                 z.2, 
                                                                                                                 z.3, 
                                                                                                                 z.4, 
                                                                                                                 'on', 
                                                                                                                 z.5, 
                                                                                                                 z.6, 
                                                                                                                 z.7, 
                                                                                                                 z.8, 
                                                                                                                 z.9
                                                                                                                >
                                                                                         ) ▶₀ #t1.1 )
                                                                                    case lookupFtemplateptrastempl_0_11111111111111
                                                                                    by contradiction
                                                                                       /* impossible chain */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_2
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            next
                                                                              case case_3
                                                                              solve( (#t2.10 < #t2.12)  ∥
                                                                                     (#t2.10 = #t2.12) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (#t2.1 < #t2.11)  ∥
                                                                                       (#t2.1 = #t2.11) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( (∃ L_h k2 #t1.2
                                                                                            #t0.1.
                                                                                           (NewKey( L_h, k2,
                                                                                                    'on'
                                                                                            ) @ #t0.1) ∧
                                                                                           (!KU( k2 ) @ #t1.2)
                                                                                          ∧
                                                                                           (¬(last(#t0.1))) ∧
                                                                                           (¬(last(#t1.2))) ∧
                                                                                           ((((#t1.2 < #t0) ∧
                                                                                              (#t0.1 < #t0)) ∨
                                                                                             ((#t1.2 < #t1.1) ∧
                                                                                              (#t0.1 < #t1.1)))))  ∥
                                                                                         (∃ #t0.1 #t1.2 h1 h2
                                                                                            k.
                                                                                           (UnwrapKey( h2, k,
                                                                                                       'on'
                                                                                            ) @ #t0.1) ∧
                                                                                           (EncKey( h1, k,
                                                                                                    'on'
                                                                                            ) @ #t1.2)
                                                                                          ∧
                                                                                           (¬(last(#t1.2))) ∧
                                                                                           (¬(last(#t0.1))) ∧
                                                                                           ((((#t0.1 < #t1.1) ∧
                                                                                              (#t1.2 < #t1.1)) ∨
                                                                                             ((#t0.1 < #t0) ∧
                                                                                              (#t1.2 < #t0))))) )
                                                                                    case case_1
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  next
                                                                                    case case_2
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_4
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                next
                                                                  case insertobjLhkatts_0_11111111111111111
                                                                  solve( State_11111111111111111( lock, h2,
                                                                                                  <'off', 
                                                                                                   'off', 
                                                                                                   'on', 
                                                                                                   'on', 
                                                                                                   'on', 
                                                                                                   'on', 
                                                                                                   'off', 
                                                                                                   'on', 
                                                                                                   'undef', 
                                                                                                   'undef'>,
                                                                                                  z, ptr,
                                                                                                  templ
                                                                         ) ▶₀ #t2.7 )
                                                                    case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                                    by contradiction /* impossible chain */
                                                                  qed
                                                                qed
                                                              next
                                                                case case_3
                                                                by contradiction /* from formulas */
                                                              qed
                                                            qed
                                                          next
                                                            case case_3
                                                            solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                  atts, k,
                                                                                                  ptr, templ
                                                                   ) ▶₀ #t2.6 )
                                                              case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                              solve( (#t2.10 < #t2.3)  ∥ (#t2.10 = #t2.3)  ∥
                                                                     (#vr.11 < #t2.10) )
                                                                case case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_2
                                                                by contradiction /* from formulas */
                                                              next
                                                                case case_3
                                                                solve( (#t2.7 < #t2.10)  ∥ (#t2.7 = #t2.10) )
                                                                  case case_1
                                                                  by contradiction /* from formulas */
                                                                next
                                                                  case case_2
                                                                  solve( State_( ) ▶₀ #t2.7 )
                                                                    case Init
                                                                    by contradiction /* cyclic */
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    next
                                                      case case_2
                                                      solve( Insert( <'F_template', ptr>,
                                                                     <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, 
                                                                      x.7, 'usage'>
                                                             ) @ #t2.9 )
                                                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                        solve( (#t2.7 < #t2.3)  ∥ (#t2.7 = #t2.3)  ∥
                                                               (#vr.11 < #t2.7) )
                                                          case case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case case_2
                                                          solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                atts, k, ptr,
                                                                                                templ
                                                                 ) ▶₀ #t2.6 )
                                                            case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                            solve( (#t2.3 < #t2.9)  ∥ (#t2.3 = #t2.9) )
                                                              case case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case case_2
                                                              solve( Insert( <'obj', h2>,
                                                                             <z, 'off', 'off', 'on', 'on', 
                                                                              'on', 'on', 'off', 'on', 
                                                                              'undef', 'undef'>
                                                                     ) @ #t2.7 )
                                                                case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                                solve( State_1111121111111( <'off', 'off', 
                                                                                             'on', 'on', 
                                                                                             'on', 'on', 
                                                                                             'off', 'on', 
                                                                                             'undef', 'undef'
                                                                                            >,
                                                                                            <'off', 'off', 
                                                                                             'on', 'on', 
                                                                                             'on', 'on', 
                                                                                             'off', 'on', 
                                                                                             'undef', 'undef'
                                                                                            >,
                                                                                            k, z, v, L_h, lock
                                                                       ) ▶₀ #t2.7 )
                                                                  case lookupFtemplateattuttemvasut_0_111112111111
                                                                  solve( (#vr.38 < #vr.12)  ∥
                                                                         (#t2.2 < #vr.38) )
                                                                    case case_1
                                                                    solve( (#vr.38 < #vr.28)  ∥
                                                                           (#t2.6 < #vr.38) )
                                                                      case case_1
                                                                      solve( Insert( <'F_template', z.2>,
                                                                                     <'off', 'off', 'on', 
                                                                                      'on', 'on', 'on', 
                                                                                      'off', 'on', 'undef', 
                                                                                      'undef'>
                                                                             ) @ #t2.10 )
                                                                        case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                        solve( (#t2.1 < #t2.9)  ∥
                                                                               (#t2.1 = #t2.9) )
                                                                          case case_1
                                                                          by contradiction /* from formulas */
                                                                        next
                                                                          case case_2
                                                                          solve( State_1111121111111111111111( ut,
                                                                                                               atts,
                                                                                                               h2,
                                                                                                               k.1,
                                                                                                               m,
                                                                                                               v,
                                                                                                               L_h.1,
                                                                                                               ~n.10
                                                                                 ) ▶₀ #t2.8 )
                                                                            case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                            solve( (∃ h1 #t1.
                                                                                     (NewKey( h1, m, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     #t1 < #vr.44)  ∥
                                                                                   (∃ L_h k2 #t1 #t0.
                                                                                     (NewKey( L_h, k2, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (!KU( k2 ) @ #t1)
                                                                                    ∧
                                                                                     (#t1 < #vr.44) ∧
                                                                                     (#t0 < #vr.44))  ∥
                                                                                   (∃ #t0 #t1 h1 h2 k.
                                                                                     (WrapKey( h2, k, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (DecKey( h1, k, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     (#t0 < #vr.44) ∧
                                                                                     (#t1 < #vr.44))  ∥
                                                                                   (∃ #t0 #t1 h1 h2 k.
                                                                                     (UnwrapKey( h2, k, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (EncKey( h1, k, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     (#t0 < #vr.44) ∧
                                                                                     (#t1 < #vr.44)) )
                                                                              case case_1
                                                                              solve( (#t2.10 < #t2.12)  ∥
                                                                                     (#t2.10 = #t2.12) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (#t2.1 < #t2.11)  ∥
                                                                                       (#t2.1 = #t2.11) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( State_111111111111111( lock,
                                                                                                                h1,
                                                                                                                <
                                                                                                                 z.1, 
                                                                                                                 z.2, 
                                                                                                                 z.3, 
                                                                                                                 z.4, 
                                                                                                                 'on', 
                                                                                                                 z.5, 
                                                                                                                 z.6, 
                                                                                                                 z.7, 
                                                                                                                 z.8, 
                                                                                                                 z.9
                                                                                                                >,
                                                                                                                m,
                                                                                                                ptr,
                                                                                                                <
                                                                                                                 z.1, 
                                                                                                                 z.2, 
                                                                                                                 z.3, 
                                                                                                                 z.4, 
                                                                                                                 'on', 
                                                                                                                 z.5, 
                                                                                                                 z.6, 
                                                                                                                 z.7, 
                                                                                                                 z.8, 
                                                                                                                 z.9
                                                                                                                >
                                                                                         ) ▶₀ #t1.1 )
                                                                                    case lookupFtemplateptrastempl_0_11111111111111
                                                                                    by contradiction
                                                                                       /* impossible chain */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_2
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            next
                                                                              case case_3
                                                                              solve( (#t2.10 < #t2.12)  ∥
                                                                                     (#t2.10 = #t2.12) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (#t2.1 < #t2.11)  ∥
                                                                                       (#t2.1 = #t2.11) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( (∃ L_h k2 #t1.2
                                                                                            #t0.1.
                                                                                           (NewKey( L_h, k2,
                                                                                                    'on'
                                                                                            ) @ #t0.1) ∧
                                                                                           (!KU( k2 ) @ #t1.2)
                                                                                          ∧
                                                                                           (¬(last(#t0.1))) ∧
                                                                                           (¬(last(#t1.2))) ∧
                                                                                           ((((#t1.2 < #t0) ∧
                                                                                              (#t0.1 < #t0)) ∨
                                                                                             ((#t1.2 < #t1.1) ∧
                                                                                              (#t0.1 < #t1.1)))))  ∥
                                                                                         (∃ #t0.1 #t1.2 h1 h2
                                                                                            k.
                                                                                           (UnwrapKey( h2, k,
                                                                                                       'on'
                                                                                            ) @ #t0.1) ∧
                                                                                           (EncKey( h1, k,
                                                                                                    'on'
                                                                                            ) @ #t1.2)
                                                                                          ∧
                                                                                           (¬(last(#t1.2))) ∧
                                                                                           (¬(last(#t0.1))) ∧
                                                                                           ((((#t0.1 < #t1.1) ∧
                                                                                              (#t1.2 < #t1.1)) ∨
                                                                                             ((#t0.1 < #t0) ∧
                                                                                              (#t1.2 < #t0))))) )
                                                                                    case case_1
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  next
                                                                                    case case_2
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_4
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    next
                                                                      case case_2
                                                                      solve( Insert( <'F_template', z.2>,
                                                                                     <'off', 'off', 'on', 
                                                                                      'on', 'on', 'on', 
                                                                                      'off', 'on', 'undef', 
                                                                                      'undef'>
                                                                             ) @ #t2.10 )
                                                                        case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                        solve( (#t2.1 < #t2.9)  ∥
                                                                               (#t2.1 = #t2.9) )
                                                                          case case_1
                                                                          by contradiction /* from formulas */
                                                                        next
                                                                          case case_2
                                                                          solve( State_1111121111111111111111( ut,
                                                                                                               atts,
                                                                                                               h2,
                                                                                                               k.1,
                                                                                                               m,
                                                                                                               v,
                                                                                                               L_h.1,
                                                                                                               ~n.10
                                                                                 ) ▶₀ #t2.8 )
                                                                            case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                            solve( (∃ h1 #t1.
                                                                                     (NewKey( h1, m, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     #t1 < #vr.44)  ∥
                                                                                   (∃ L_h k2 #t1 #t0.
                                                                                     (NewKey( L_h, k2, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (!KU( k2 ) @ #t1)
                                                                                    ∧
                                                                                     (#t1 < #vr.44) ∧
                                                                                     (#t0 < #vr.44))  ∥
                                                                                   (∃ #t0 #t1 h1 h2 k.
                                                                                     (WrapKey( h2, k, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (DecKey( h1, k, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     (#t0 < #vr.44) ∧
                                                                                     (#t1 < #vr.44))  ∥
                                                                                   (∃ #t0 #t1 h1 h2 k.
                                                                                     (UnwrapKey( h2, k, 'on'
                                                                                      ) @ #t0) ∧
                                                                                     (EncKey( h1, k, 'on'
                                                                                      ) @ #t1)
                                                                                    ∧
                                                                                     (#t0 < #vr.44) ∧
                                                                                     (#t1 < #vr.44)) )
                                                                              case case_1
                                                                              solve( (#t2.10 < #t2.12)  ∥
                                                                                     (#t2.10 = #t2.12) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (#t2.1 < #t2.11)  ∥
                                                                                       (#t2.1 = #t2.11) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( State_111111111111111( lock,
                                                                                                                h1,
                                                                                                                <
                                                                                                                 z.1, 
                                                                                                                 z.2, 
                                                                                                                 z.3, 
                                                                                                                 z.4, 
                                                                                                                 'on', 
                                                                                                                 z.5, 
                                                                                                                 z.6, 
                                                                                                                 z.7, 
                                                                                                                 z.8, 
                                                                                                                 z.9
                                                                                                                >,
                                                                                                                m,
                                                                                                                ptr,
                                                                                                                <
                                                                                                                 z.1, 
                                                                                                                 z.2, 
                                                                                                                 z.3, 
                                                                                                                 z.4, 
                                                                                                                 'on', 
                                                                                                                 z.5, 
                                                                                                                 z.6, 
                                                                                                                 z.7, 
                                                                                                                 z.8, 
                                                                                                                 z.9
                                                                                                                >
                                                                                         ) ▶₀ #t1.1 )
                                                                                    case lookupFtemplateptrastempl_0_11111111111111
                                                                                    by contradiction
                                                                                       /* impossible chain */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_2
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            next
                                                                              case case_3
                                                                              solve( (#t2.10 < #t2.12)  ∥
                                                                                     (#t2.10 = #t2.12) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (#t2.1 < #t2.11)  ∥
                                                                                       (#t2.1 = #t2.11) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  solve( (∃ L_h k2 #t1.2
                                                                                            #t0.1.
                                                                                           (NewKey( L_h, k2,
                                                                                                    'on'
                                                                                            ) @ #t0.1) ∧
                                                                                           (!KU( k2 ) @ #t1.2)
                                                                                          ∧
                                                                                           (¬(last(#t0.1))) ∧
                                                                                           (¬(last(#t1.2))) ∧
                                                                                           ((((#t1.2 < #t0) ∧
                                                                                              (#t0.1 < #t0)) ∨
                                                                                             ((#t1.2 < #t1.1) ∧
                                                                                              (#t0.1 < #t1.1)))))  ∥
                                                                                         (∃ #t0.1 #t1.2 h1 h2
                                                                                            k.
                                                                                           (UnwrapKey( h2, k,
                                                                                                       'on'
                                                                                            ) @ #t0.1) ∧
                                                                                           (EncKey( h1, k,
                                                                                                    'on'
                                                                                            ) @ #t1.2)
                                                                                          ∧
                                                                                           (¬(last(#t1.2))) ∧
                                                                                           (¬(last(#t0.1))) ∧
                                                                                           ((((#t0.1 < #t1.1) ∧
                                                                                              (#t1.2 < #t1.1)) ∨
                                                                                             ((#t0.1 < #t0) ∧
                                                                                              (#t1.2 < #t0))))) )
                                                                                    case case_1
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  next
                                                                                    case case_2
                                                                                    by contradiction
                                                                                       /* from formulas */
                                                                                  qed
                                                                                qed
                                                                              qed
                                                                            next
                                                                              case case_4
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            qed
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  next
                                                                    case case_2
                                                                    solve( Insert( <'F_template', z.2>,
                                                                                   <'off', 'off', 'on', 'on', 
                                                                                    'on', 'on', 'off', 'on', 
                                                                                    'undef', 'undef'>
                                                                           ) @ #t2.10 )
                                                                      case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                      solve( (#t2.1 < #t2.9)  ∥
                                                                             (#t2.1 = #t2.9) )
                                                                        case case_1
                                                                        by contradiction /* from formulas */
                                                                      next
                                                                        case case_2
                                                                        solve( State_1111121111111111111111( ut,
                                                                                                             atts,
                                                                                                             h2,
                                                                                                             k.1,
                                                                                                             m,
                                                                                                             v,
                                                                                                             L_h.1,
                                                                                                             ~n.10
                                                                               ) ▶₀ #t2.8 )
                                                                          case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                          solve( (∃ h1 #t1.
                                                                                   (NewKey( h1, m, 'on'
                                                                                    ) @ #t1)
                                                                                  ∧
                                                                                   #t1 < #vr.44)  ∥
                                                                                 (∃ L_h k2 #t1 #t0.
                                                                                   (NewKey( L_h, k2, 'on'
                                                                                    ) @ #t0) ∧
                                                                                   (!KU( k2 ) @ #t1)
                                                                                  ∧
                                                                                   (#t1 < #vr.44) ∧
                                                                                   (#t0 < #vr.44))  ∥
                                                                                 (∃ #t0 #t1 h1 h2 k.
                                                                                   (WrapKey( h2, k, 'on'
                                                                                    ) @ #t0) ∧
                                                                                   (DecKey( h1, k, 'on'
                                                                                    ) @ #t1)
                                                                                  ∧
                                                                                   (#t0 < #vr.44) ∧
                                                                                   (#t1 < #vr.44))  ∥
                                                                                 (∃ #t0 #t1 h1 h2 k.
                                                                                   (UnwrapKey( h2, k, 'on'
                                                                                    ) @ #t0) ∧
                                                                                   (EncKey( h1, k, 'on'
                                                                                    ) @ #t1)
                                                                                  ∧
                                                                                   (#t0 < #vr.44) ∧
                                                                                   (#t1 < #vr.44)) )
                                                                            case case_1
                                                                            solve( (#t2.10 < #t2.12)  ∥
                                                                                   (#t2.10 = #t2.12) )
                                                                              case case_1
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            next
                                                                              case case_2
                                                                              solve( (#t2.1 < #t2.11)  ∥
                                                                                     (#t2.1 = #t2.11) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( State_111111111111111( lock,
                                                                                                              h1,
                                                                                                              <
                                                                                                               z.1, 
                                                                                                               z.2, 
                                                                                                               z.3, 
                                                                                                               z.4, 
                                                                                                               'on', 
                                                                                                               z.5, 
                                                                                                               z.6, 
                                                                                                               z.7, 
                                                                                                               z.8, 
                                                                                                               z.9
                                                                                                              >,
                                                                                                              m,
                                                                                                              ptr,
                                                                                                              <
                                                                                                               z.1, 
                                                                                                               z.2, 
                                                                                                               z.3, 
                                                                                                               z.4, 
                                                                                                               'on', 
                                                                                                               z.5, 
                                                                                                               z.6, 
                                                                                                               z.7, 
                                                                                                               z.8, 
                                                                                                               z.9
                                                                                                              >
                                                                                       ) ▶₀ #t1.1 )
                                                                                  case lookupFtemplateptrastempl_0_11111111111111
                                                                                  by contradiction
                                                                                     /* impossible chain */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          next
                                                                            case case_2
                                                                            by contradiction
                                                                               /* from formulas */
                                                                          next
                                                                            case case_3
                                                                            solve( (#t2.10 < #t2.12)  ∥
                                                                                   (#t2.10 = #t2.12) )
                                                                              case case_1
                                                                              by contradiction
                                                                                 /* from formulas */
                                                                            next
                                                                              case case_2
                                                                              solve( (#t2.1 < #t2.11)  ∥
                                                                                     (#t2.1 = #t2.11) )
                                                                                case case_1
                                                                                by contradiction
                                                                                   /* from formulas */
                                                                              next
                                                                                case case_2
                                                                                solve( (∃ L_h k2 #t1.2 #t0.1.
                                                                                         (NewKey( L_h, k2,
                                                                                                  'on'
                                                                                          ) @ #t0.1) ∧
                                                                                         (!KU( k2 ) @ #t1.2)
                                                                                        ∧
                                                                                         (¬(last(#t0.1))) ∧
                                                                                         (¬(last(#t1.2))) ∧
                                                                                         ((((#t1.2 < #t0) ∧
                                                                                            (#t0.1 < #t0)) ∨
                                                                                           ((#t1.2 < #t1.1) ∧
                                                                                            (#t0.1 < #t1.1)))))  ∥
                                                                                       (∃ #t0.1 #t1.2 h1 h2 k.
                                                                                         (UnwrapKey( h2, k,
                                                                                                     'on'
                                                                                          ) @ #t0.1) ∧
                                                                                         (EncKey( h1, k, 'on'
                                                                                          ) @ #t1.2)
                                                                                        ∧
                                                                                         (¬(last(#t1.2))) ∧
                                                                                         (¬(last(#t0.1))) ∧
                                                                                         ((((#t0.1 < #t1.1) ∧
                                                                                            (#t1.2 < #t1.1)) ∨
                                                                                           ((#t0.1 < #t0) ∧
                                                                                            (#t1.2 < #t0))))) )
                                                                                  case case_1
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                next
                                                                                  case case_2
                                                                                  by contradiction
                                                                                     /* from formulas */
                                                                                qed
                                                                              qed
                                                                            qed
                                                                          next
                                                                            case case_4
                                                                            by contradiction
                                                                               /* from formulas */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    qed
                                                                  qed
                                                                qed
                                                              next
                                                                case insertobjLhkatts_0_11111111111111111
                                                                solve( State_11111111111111111( lock, h2,
                                                                                                <'off', 
                                                                                                 'off', 'on', 
                                                                                                 'on', 'on', 
                                                                                                 'on', 'off', 
                                                                                                 'on', 
                                                                                                 'undef', 
                                                                                                 'undef'>,
                                                                                                z, ptr, templ
                                                                       ) ▶₀ #t2.7 )
                                                                  case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                                  by contradiction /* impossible chain */
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case case_3
                                                          solve( State_11111111111111111111111( ~n.8, L_h,
                                                                                                atts, k, ptr,
                                                                                                templ
                                                                 ) ▶₀ #t2.6 )
                                                            case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                                                            by contradiction /* cyclic */
                                                          qed
                                                        qed
                                                      qed
                                                    next
                                                      case case_3
                                                      solve( (#t2.3 < #t2.8)  ∥ (#t2.3 = #t2.8) )
                                                        case case_1
                                                        by contradiction /* from formulas */
                                                      next
                                                        case case_2
                                                        solve( Insert( <'obj', h2>,
                                                                       <z, 'off', 'off', 'on', 'on', 'on', 
                                                                        'on', 'off', 'on', 'undef', 'undef'>
                                                               ) @ #t2.6 )
                                                          case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                          solve( State_1111121111111( <'off', 'off', 'on', 
                                                                                       'on', 'on', 'on', 
                                                                                       'off', 'on', 'undef', 
                                                                                       'undef'>,
                                                                                      <'off', 'off', 'on', 
                                                                                       'on', 'on', 'on', 
                                                                                       'off', 'on', 'undef', 
                                                                                       'undef'>,
                                                                                      k, z, v, L_h, lock
                                                                 ) ▶₀ #t2.6 )
                                                            case lookupFtemplateattuttemvasut_0_111112111111
                                                            solve( (#vr.29 < #vr.12)  ∥ (#t2.2 < #vr.29) )
                                                              case case_1
                                                              solve( Insert( <'F_template', z.2>,
                                                                             <'off', 'off', 'on', 'on', 'on', 
                                                                              'on', 'off', 'on', 'undef', 
                                                                              'undef'>
                                                                     ) @ #t2.9 )
                                                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                                  case case_1
                                                                  by contradiction /* from formulas */
                                                                next
                                                                  case case_2
                                                                  solve( State_1111121111111111111111( ut,
                                                                                                       atts,
                                                                                                       h2,
                                                                                                       k.1, m,
                                                                                                       v,
                                                                                                       L_h.1,
                                                                                                       ~n.7
                                                                         ) ▶₀ #t2.7 )
                                                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                    solve( (∃ h1 #t1.
                                                                             (NewKey( h1, m, 'on' ) @ #t1)
                                                                            ∧
                                                                             #t1 < #vr.35)  ∥
                                                                           (∃ L_h k2 #t1 #t0.
                                                                             (NewKey( L_h, k2, 'on' ) @ #t0) ∧
                                                                             (!KU( k2 ) @ #t1)
                                                                            ∧
                                                                             (#t1 < #vr.35) ∧
                                                                             (#t0 < #vr.35))  ∥
                                                                           (∃ #t0 #t1 h1 h2 k.
                                                                             (WrapKey( h2, k, 'on' ) @ #t0) ∧
                                                                             (DecKey( h1, k, 'on' ) @ #t1)
                                                                            ∧
                                                                             (#t0 < #vr.35) ∧
                                                                             (#t1 < #vr.35))  ∥
                                                                           (∃ #t0 #t1 h1 h2 k.
                                                                             (UnwrapKey( h2, k, 'on'
                                                                              ) @ #t0) ∧
                                                                             (EncKey( h1, k, 'on' ) @ #t1)
                                                                            ∧
                                                                             (#t0 < #vr.35) ∧
                                                                             (#t1 < #vr.35)) )
                                                                      case case_1
                                                                      solve( (#t2.9 < #t2.11)  ∥
                                                                             (#t2.9 = #t2.11) )
                                                                        case case_1
                                                                        by contradiction /* from formulas */
                                                                      next
                                                                        case case_2
                                                                        solve( (#t2.1 < #t2.10)  ∥
                                                                               (#t2.1 = #t2.10) )
                                                                          case case_1
                                                                          by contradiction /* from formulas */
                                                                        next
                                                                          case case_2
                                                                          solve( State_111111111111111( lock,
                                                                                                        h1,
                                                                                                        <z.1, 
                                                                                                         z.2, 
                                                                                                         z.3, 
                                                                                                         z.4, 
                                                                                                         'on', 
                                                                                                         z.5, 
                                                                                                         z.6, 
                                                                                                         z.7, 
                                                                                                         z.8, 
                                                                                                         z.9>,
                                                                                                        m,
                                                                                                        ptr,
                                                                                                        <z.1, 
                                                                                                         z.2, 
                                                                                                         z.3, 
                                                                                                         z.4, 
                                                                                                         'on', 
                                                                                                         z.5, 
                                                                                                         z.6, 
                                                                                                         z.7, 
                                                                                                         z.8, 
                                                                                                         z.9>
                                                                                 ) ▶₀ #t1.1 )
                                                                            case lookupFtemplateptrastempl_0_11111111111111
                                                                            by contradiction
                                                                               /* impossible chain */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    next
                                                                      case case_2
                                                                      by contradiction /* from formulas */
                                                                    next
                                                                      case case_3
                                                                      solve( (#t2.9 < #t2.11)  ∥
                                                                             (#t2.9 = #t2.11) )
                                                                        case case_1
                                                                        by contradiction /* from formulas */
                                                                      next
                                                                        case case_2
                                                                        solve( (#t2.1 < #t2.10)  ∥
                                                                               (#t2.1 = #t2.10) )
                                                                          case case_1
                                                                          by contradiction /* from formulas */
                                                                        next
                                                                          case case_2
                                                                          solve( (∃ L_h k2 #t1.2 #t0.1.
                                                                                   (NewKey( L_h, k2, 'on'
                                                                                    ) @ #t0.1) ∧
                                                                                   (!KU( k2 ) @ #t1.2)
                                                                                  ∧
                                                                                   (¬(last(#t0.1))) ∧
                                                                                   (¬(last(#t1.2))) ∧
                                                                                   ((((#t1.2 < #t0) ∧
                                                                                      (#t0.1 < #t0)) ∨
                                                                                     ((#t1.2 < #t1.1) ∧
                                                                                      (#t0.1 < #t1.1)))))  ∥
                                                                                 (∃ #t0.1 #t1.2 h1 h2 k.
                                                                                   (UnwrapKey( h2, k, 'on'
                                                                                    ) @ #t0.1) ∧
                                                                                   (EncKey( h1, k, 'on'
                                                                                    ) @ #t1.2)
                                                                                  ∧
                                                                                   (¬(last(#t1.2))) ∧
                                                                                   (¬(last(#t0.1))) ∧
                                                                                   ((((#t0.1 < #t1.1) ∧
                                                                                      (#t1.2 < #t1.1)) ∨
                                                                                     ((#t0.1 < #t0) ∧
                                                                                      (#t1.2 < #t0))))) )
                                                                            case case_1
                                                                            by contradiction
                                                                               /* from formulas */
                                                                          next
                                                                            case case_2
                                                                            by contradiction
                                                                               /* from formulas */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    next
                                                                      case case_4
                                                                      by contradiction /* from formulas */
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            next
                                                              case case_2
                                                              solve( Insert( <'F_template', z.2>,
                                                                             <'off', 'off', 'on', 'on', 'on', 
                                                                              'on', 'off', 'on', 'undef', 
                                                                              'undef'>
                                                                     ) @ #t2.9 )
                                                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                                                solve( (#t2.1 < #t2.8)  ∥ (#t2.1 = #t2.8) )
                                                                  case case_1
                                                                  by contradiction /* from formulas */
                                                                next
                                                                  case case_2
                                                                  solve( State_1111121111111111111111( ut,
                                                                                                       atts,
                                                                                                       h2,
                                                                                                       k.1, m,
                                                                                                       v,
                                                                                                       L_h.1,
                                                                                                       ~n.7
                                                                         ) ▶₀ #t2.7 )
                                                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                                                    solve( (∃ h1 #t1.
                                                                             (NewKey( h1, m, 'on' ) @ #t1)
                                                                            ∧
                                                                             #t1 < #vr.35)  ∥
                                                                           (∃ L_h k2 #t1 #t0.
                                                                             (NewKey( L_h, k2, 'on' ) @ #t0) ∧
                                                                             (!KU( k2 ) @ #t1)
                                                                            ∧
                                                                             (#t1 < #vr.35) ∧
                                                                             (#t0 < #vr.35))  ∥
                                                                           (∃ #t0 #t1 h1 h2 k.
                                                                             (WrapKey( h2, k, 'on' ) @ #t0) ∧
                                                                             (DecKey( h1, k, 'on' ) @ #t1)
                                                                            ∧
                                                                             (#t0 < #vr.35) ∧
                                                                             (#t1 < #vr.35))  ∥
                                                                           (∃ #t0 #t1 h1 h2 k.
                                                                             (UnwrapKey( h2, k, 'on'
                                                                              ) @ #t0) ∧
                                                                             (EncKey( h1, k, 'on' ) @ #t1)
                                                                            ∧
                                                                             (#t0 < #vr.35) ∧
                                                                             (#t1 < #vr.35)) )
                                                                      case case_1
                                                                      solve( (#t2.9 < #t2.11)  ∥
                                                                             (#t2.9 = #t2.11) )
                                                                        case case_1
                                                                        by contradiction /* from formulas */
                                                                      next
                                                                        case case_2
                                                                        solve( (#t2.1 < #t2.10)  ∥
                                                                               (#t2.1 = #t2.10) )
                                                                          case case_1
                                                                          by contradiction /* from formulas */
                                                                        next
                                                                          case case_2
                                                                          solve( State_111111111111111( lock,
                                                                                                        h1,
                                                                                                        <z.1, 
                                                                                                         z.2, 
                                                                                                         z.3, 
                                                                                                         z.4, 
                                                                                                         'on', 
                                                                                                         z.5, 
                                                                                                         z.6, 
                                                                                                         z.7, 
                                                                                                         z.8, 
                                                                                                         z.9>,
                                                                                                        m,
                                                                                                        ptr,
                                                                                                        <z.1, 
                                                                                                         z.2, 
                                                                                                         z.3, 
                                                                                                         z.4, 
                                                                                                         'on', 
                                                                                                         z.5, 
                                                                                                         z.6, 
                                                                                                         z.7, 
                                                                                                         z.8, 
                                                                                                         z.9>
                                                                                 ) ▶₀ #t1.1 )
                                                                            case lookupFtemplateptrastempl_0_11111111111111
                                                                            by contradiction
                                                                               /* impossible chain */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    next
                                                                      case case_2
                                                                      by contradiction /* from formulas */
                                                                    next
                                                                      case case_3
                                                                      solve( (#t2.9 < #t2.11)  ∥
                                                                             (#t2.9 = #t2.11) )
                                                                        case case_1
                                                                        by contradiction /* from formulas */
                                                                      next
                                                                        case case_2
                                                                        solve( (#t2.1 < #t2.10)  ∥
                                                                               (#t2.1 = #t2.10) )
                                                                          case case_1
                                                                          by contradiction /* from formulas */
                                                                        next
                                                                          case case_2
                                                                          solve( (∃ L_h k2 #t1.2 #t0.1.
                                                                                   (NewKey( L_h, k2, 'on'
                                                                                    ) @ #t0.1) ∧
                                                                                   (!KU( k2 ) @ #t1.2)
                                                                                  ∧
                                                                                   (¬(last(#t0.1))) ∧
                                                                                   (¬(last(#t1.2))) ∧
                                                                                   ((((#t1.2 < #t0) ∧
                                                                                      (#t0.1 < #t0)) ∨
                                                                                     ((#t1.2 < #t1.1) ∧
                                                                                      (#t0.1 < #t1.1)))))  ∥
                                                                                 (∃ #t0.1 #t1.2 h1 h2 k.
                                                                                   (UnwrapKey( h2, k, 'on'
                                                                                    ) @ #t0.1) ∧
                                                                                   (EncKey( h1, k, 'on'
                                                                                    ) @ #t1.2)
                                                                                  ∧
                                                                                   (¬(last(#t1.2))) ∧
                                                                                   (¬(last(#t0.1))) ∧
                                                                                   ((((#t0.1 < #t1.1) ∧
                                                                                      (#t1.2 < #t1.1)) ∨
                                                                                     ((#t0.1 < #t0) ∧
                                                                                      (#t1.2 < #t0))))) )
                                                                            case case_1
                                                                            by contradiction
                                                                               /* from formulas */
                                                                          next
                                                                            case case_2
                                                                            by contradiction
                                                                               /* from formulas */
                                                                          qed
                                                                        qed
                                                                      qed
                                                                    next
                                                                      case case_4
                                                                      by contradiction /* from formulas */
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case insertobjLhkatts_0_11111111111111111
                                                          solve( State_11111111111111111( lock, h2,
                                                                                          <'off', 'off', 
                                                                                           'on', 'on', 'on', 
                                                                                           'on', 'off', 'on', 
                                                                                           'undef', 'undef'>,
                                                                                          z, ptr, templ
                                                                 ) ▶₀ #t2.6 )
                                                            case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                            by contradiction /* impossible chain */
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case eventWrapKeyhmattwrapatts_0_11111211111111111
                            solve( State_11111211111111111( ut,
                                                            <'on', x.8, x.9, x.10, x.11, x.12, x.13, x.14, 
                                                             x.15, x.16>,
                                                            h2, k.1, ~n.2, v, L_h.1, lock
                                   ) ▶₀ #t3 )
                              case eventUnwrappedhmatts_0_1111121111111111
                              solve( (∃ h1 #t1. (NewKey( h1, ~n.2, 'on' ) @ #t1) ∧ #t1 < #vr.19)  ∥
                                     (∃ L_h k2 #t1 #t0.
                                       (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                      ∧
                                       (#t1 < #vr.19) ∧ (#t0 < #vr.19))  ∥
                                     (∃ #t0 #t1 h1 h2 k.
                                       (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                                      ∧
                                       (#t0 < #vr.19) ∧ (#t1 < #vr.19))  ∥
                                     (∃ #t0 #t1 h1 h2 k.
                                       (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                                      ∧
                                       (#t0 < #vr.19) ∧ (#t1 < #vr.19)) )
                                case case_1
                                solve( ((#vr.7 < #vr.25) ∧
                                        (∃ #t2.
                                          (Unlock_4( '4', ~n.4, 'device' ) @ #t2)
                                         ∧
                                          (#vr.7 < #t2) ∧
                                          (#t2 < #vr.25) ∧
                                          (∀ #t0 pp. (Unlock( pp, ~n.4, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                          (∀ pp lpp #t0.
                                            (Lock( pp, lpp, 'device' ) @ #t0)
                                           ⇒
                                            ((#t0 < #vr.7) ∨ (#t0 = #vr.7) ∨ (#t2 < #t0))) ∧
                                          (∀ pp lpp #t0.
                                            (Unlock( pp, lpp, 'device' ) @ #t0)
                                           ⇒
                                            ((#t0 < #vr.7) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                       (#vr.25 < #vr.7) )
                                  case case_1
                                  solve( Insert( <'F_template', z>,
                                                 <'on', x.8, x.9, x.10, x.11, x.12, x.13, x.14, x.15, x.16>
                                         ) @ #t2.6 )
                                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case case_2
                                  solve( Insert( <'F_template', z>,
                                                 <'on', x.8, x.9, x.10, x.11, x.12, x.13, x.14, x.15, x.16>
                                         ) @ #t2.6 )
                                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case case_2
                                by contradiction /* from formulas */
                              next
                                case case_3
                                solve( ((#vr.7 < #vr.25) ∧
                                        (∃ #t2.
                                          (Unlock_4( '4', ~n.4, 'device' ) @ #t2)
                                         ∧
                                          (#vr.7 < #t2) ∧
                                          (#t2 < #vr.25) ∧
                                          (∀ #t0 pp. (Unlock( pp, ~n.4, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                          (∀ pp lpp #t0.
                                            (Lock( pp, lpp, 'device' ) @ #t0)
                                           ⇒
                                            ((#t0 < #vr.7) ∨ (#t0 = #vr.7) ∨ (#t2 < #t0))) ∧
                                          (∀ pp lpp #t0.
                                            (Unlock( pp, lpp, 'device' ) @ #t0)
                                           ⇒
                                            ((#t0 < #vr.7) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                       (#vr.25 < #vr.7) )
                                  case case_1
                                  solve( (∃ L_h k2 #t1.2 #t0.1.
                                           (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.2)
                                          ∧
                                           (¬(last(#t0.1))) ∧
                                           (¬(last(#t1.2))) ∧
                                           ((((#t1.2 < #t0) ∧ (#t0.1 < #t0)) ∨
                                             ((#t1.2 < #t1.1) ∧ (#t0.1 < #t1.1)))))  ∥
                                         (∃ #t0.1 #t1.2 h1 h2 k.
                                           (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                           (EncKey( h1, k, 'on' ) @ #t1.2)
                                          ∧
                                           (¬(last(#t1.2))) ∧
                                           (¬(last(#t0.1))) ∧
                                           ((((#t0.1 < #t1.1) ∧ (#t1.2 < #t1.1)) ∨
                                             ((#t0.1 < #t0) ∧ (#t1.2 < #t0))))) )
                                    case case_1
                                    by contradiction /* from formulas */
                                  next
                                    case case_2
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case case_2
                                  solve( (∃ L_h k2 #t1.2 #t0.1.
                                           (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.2)
                                          ∧
                                           (¬(last(#t0.1))) ∧
                                           (¬(last(#t1.2))) ∧
                                           ((((#t1.2 < #t0) ∧ (#t0.1 < #t0)) ∨
                                             ((#t1.2 < #t1.1) ∧ (#t0.1 < #t1.1)))))  ∥
                                         (∃ #t0.1 #t1.2 h1 h2 k.
                                           (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                           (EncKey( h1, k, 'on' ) @ #t1.2)
                                          ∧
                                           (¬(last(#t1.2))) ∧
                                           (¬(last(#t0.1))) ∧
                                           ((((#t0.1 < #t1.1) ∧ (#t1.2 < #t1.1)) ∨
                                             ((#t0.1 < #t0) ∧ (#t1.2 < #t0))))) )
                                    case case_1
                                    by contradiction /* from formulas */
                                  next
                                    case case_2
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case case_4
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case insertFtemplateusageoffoffononononoffonundefundef_0_1
                    solve( (#t2.3 < #t2.1)  ∥ (#t2.3 = #t2.1)  ∥ (#vr.3 < #t2.3) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        solve( (#t2.1 < #t2.4)  ∥ (#t2.1 = #t2.4) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( (last(#t3))  ∥
                                 (∃ L_h k2 #t1 #t0.
                                   (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                  ∧
                                   (¬(last(#t0))) ∧
                                   (¬(last(#t1))) ∧
                                   ((((#t1 < #t3) ∧ (#t0 < #t3)) ∨ ((#t1 < #vr.17) ∧ (#t0 < #vr.17)))))  ∥
                                 (∃ #t0 #t1 h1 h2 k.
                                   (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                                  ∧
                                   (¬(last(#t1))) ∧
                                   (¬(last(#t0))) ∧
                                   ((((#t0 < #vr.17) ∧ (#t1 < #vr.17)) ∨ ((#t0 < #t3) ∧ (#t1 < #t3))))) )
                            case case_1
                            by solve( WrapKey( h2, ~n.2, 'on' ) @ #t2 )
                          next
                            case case_2
                            by contradiction /* from formulas */
                          next
                            case case_3
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    next
                      case case_3
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        by contradiction /* cyclic */
                      qed
                    qed
                  qed
                qed
              qed
            qed
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            solve( (∃ L_h k2 #t1.1 #t0.1.
                     (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                    ∧
                     (¬(last(#t0.1))) ∧
                     (¬(last(#t1.1))) ∧
                     ((((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1)))))  ∥
                   (∃ #t0.1 #t1.1 h1 h2 k.
                     (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                    ∧
                     (¬(last(#t1.1))) ∧
                     (¬(last(#t0.1))) ∧
                     ((((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0))))) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          next
            case case_4
            by contradiction /* from formulas */
          qed
        qed
      qed
    next
      case case_3
      solve( ((#t1 < #t3) ∧ (#t0 < #t3))  ∥ ((#t1 < #t2) ∧ (#t0 < #t2)) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      qed
    next
      case case_4
      solve( ((#t0 < #t2) ∧ (#t1 < #t2))  ∥ ((#t0 < #t3) ∧ (#t1 < #t3)) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      qed
    qed
  next
    case case_2
    solve( (#t1 = #t2)  ∥ (#t2 < #t1) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    qed
  next
    case case_3
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_0( '0', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_4
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_1( '1', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_5
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_2( '2', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_6
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_3( '3', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_7
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_4( '4', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_8
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_5( '5', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma no_key_is_enc_and_unwrap [use_induction, reuse]:
  all-traces
  "∀ #t2 #t3 h1 h2 k.
    ((EncKey( h1, k, 'on' ) @ #t2) ∧ (UnwrapKey( h2, k, 'on' ) @ #t3)) ⇒
    (∃ L_h k2 #t1 #t0.
      ((NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)) ∧
      (((#t1 < #t3) ∧ (#t0 < #t3)) ∨ ((#t1 < #t2) ∧ (#t0 < #t2))))"
/*
guarded formula characterizing all counter-examples:
"∃ #t2 #t3 h1 h2 k.
  (EncKey( h1, k, 'on' ) @ #t2) ∧ (UnwrapKey( h2, k, 'on' ) @ #t3)
 ∧
  ∀ L_h k2 #t1 #t0.
   (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
  ⇒
   (((¬(#t1 < #t3)) ∨ (¬(#t0 < #t3)))) ∧
   (((¬(#t1 < #t2)) ∨ (¬(#t0 < #t2))))"
*/
induction
  case empty_trace
  by contradiction /* from formulas */
next
  case non_empty_trace
  simplify
  solve( (∀ #t2 #t3 h1 h2 k.
           (EncKey( h1, k, 'on' ) @ #t2) ∧ (UnwrapKey( h2, k, 'on' ) @ #t3)
          ⇒
           ((last(#t3)) ∨
            (last(#t2)) ∨
            (∃ L_h k2 #t1 #t0.
              (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
             ∧
              (¬(last(#t0))) ∧
              (¬(last(#t1))) ∧
              ((((#t1 < #t3) ∧ (#t0 < #t3)) ∨ ((#t1 < #t2) ∧ (#t0 < #t2)))))))  ∥
         (∃ x y #t3.
           (IsIn( x, y ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (∀ #t2.
             (Insert( x, y ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t1 yp.
                (Insert( x, yp ) @ #t1)
               ∧
                (¬(last(#t1))) ∧
                (((#t1 = #t2) ∨ (#t2 < #t1))) ∧
                (¬(#t1 = #t2)) ∧
                (((#t3 = #t1) ∨ (#t1 < #t3)))))))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_0( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_0( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_1( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_1( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_2( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_2( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_3( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_3( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_4( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_4( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_5( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_5( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3))) )
    case case_1
    solve( (last(#t3))  ∥ (last(#t2))  ∥
           (∃ L_h k2 #t1 #t0.
             (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
            ∧
             (¬(last(#t0))) ∧
             (¬(last(#t1))) ∧
             ((((#t1 < #t3) ∧ (#t0 < #t3)) ∨ ((#t1 < #t2) ∧ (#t0 < #t2))))) )
      case case_1
      solve( EncKey( h1, k, 'on' ) @ #t2 )
        case eventEncKeyLhkattencatts_0_11111111111111111111
        solve( State_11111111111111111111( lock, h1,
                                           <x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>, k, ptr, templ
               ) ▶₀ #t2 )
          case eventDecKeyLhkattdecatts_0_1111111111111111111
          solve( Insert( <'F_template', ptr>,
                         <x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>
                 ) @ #t2.1 )
            case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
            solve( (#vr.7 < #t2.1)  ∥ (#vr.7 = #t2.1) )
              case case_1
              solve( State_11( ) ▶₀ #t2.1 )
                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                by contradiction /* cyclic */
              qed
            next
              case case_2
              solve( UnwrapKey( h2, ~n.2, 'on' ) @ #t3 )
                case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                by solve( State_111111111111111111111( lock, h2,
                                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>,
                                                       ~n.2, ptr, templ
                          ) ▶₀ #t3 )
              next
                case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                solve( State_11111211111111111111( ut,
                                                   <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>, h2, k,
                                                   ~n.2, v, L_h, lock
                       ) ▶₀ #t3 )
                  case eventEncKeyhmattencatts_0_1111121111111111111
                  solve( (∃ h1 #t1. (NewKey( h1, ~n.2, 'on' ) @ #t1) ∧ #t1 < #vr.13)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #vr.13) ∧ (#t0 < #vr.13))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.13) ∧ (#t1 < #vr.13))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.13) ∧ (#t1 < #vr.13)) )
                    case case_1
                    solve( Insert( <'F_template', z>,
                                   <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>
                           ) @ #t2.3 )
                      case insertFtemplatetrustedononoffoffononononusageusage_0_
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      solve( ((#t0.1 < #t1) ∧ (#t1.1 < #t1))  ∥
                             ((#t0.1 < #t0) ∧ (#t1.1 < #t0)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case case_4
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            qed
          next
            case insertFtemplateusageoffoffononononoffonundefundef_0_1
            solve( (#vr.8 < #t2.1)  ∥ (#vr.8 = #t2.1) )
              case case_1
              solve( State_1( ) ▶₀ #t2.1 )
                case insertFtemplatetrustedononoffoffononononusageusage_0_
                by contradiction /* cyclic */
              qed
            next
              case case_2
              solve( UnwrapKey( h2, ~n.2, 'on' ) @ #t3 )
                case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                by solve( State_111111111111111111111( lock, h2,
                                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>,
                                                       ~n.2, ptr, templ
                          ) ▶₀ #t3 )
              next
                case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                solve( State_11111211111111111111( ut,
                                                   <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>, h2, k,
                                                   ~n.2, v, L_h, lock
                       ) ▶₀ #t3 )
                  case eventEncKeyhmattencatts_0_1111121111111111111
                  solve( (∃ h1 #t1. (NewKey( h1, ~n.2, 'on' ) @ #t1) ∧ #t1 < #vr.13)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #vr.13) ∧ (#t0 < #vr.13))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.13) ∧ (#t1 < #vr.13))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.13) ∧ (#t1 < #vr.13)) )
                    case case_1
                    solve( Insert( <'F_template', z>,
                                   <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>
                           ) @ #t2.3 )
                      case insertFtemplatetrustedononoffoffononononusageusage_0_
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      solve( ((#t0.1 < #t1) ∧ (#t1.1 < #t1))  ∥
                             ((#t0.1 < #t0) ∧ (#t1.1 < #t0)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case case_4
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case eventEncKeyhmattencatts_0_1111121111111111111
        solve( State_1111121111111111111( ut,
                                          <x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>, h1, k, k.1, v,
                                          L_h, lock
               ) ▶₀ #t2 )
          case eventDecKeyhmattdecatts_0_111112111111111111
          solve( (∃ h1 #t1. (NewKey( h1, k.1, 'on' ) @ #t1) ∧ #t1 < #vr.2)  ∥
                 (∃ L_h k2 #t1 #t0.
                   (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                  ∧
                   (#t1 < #vr.2) ∧ (#t0 < #vr.2))  ∥
                 (∃ #t0 #t1 h1 h2 k.
                   (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                  ∧
                   (#t0 < #vr.2) ∧ (#t1 < #vr.2))  ∥
                 (∃ #t0 #t1 h1 h2 k.
                   (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                  ∧
                   (#t0 < #vr.2) ∧ (#t1 < #vr.2)) )
            case case_1
            solve( Insert( <'F_template', z>,
                           <x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>
                   ) @ #t2.1 )
              case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
              by contradiction /* from formulas */
            next
              case insertFtemplateusageoffoffononononoffonundefundef_0_1
              solve( (#vr.11 < #t2.1)  ∥ (#vr.11 = #t2.1) )
                case case_1
                solve( State_111111111111111( lock, h1,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>, k, ptr,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  solve( Insert( <'F_template', ptr>,
                                 <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                         ) @ #t2.4 )
                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                    solve( (#vr.12 < #t2.3)  ∥ (#vr.12 = #t2.3) )
                      case case_1
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    next
                      case case_2
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    qed
                  next
                    case insertFtemplateusageoffoffononononoffonundefundef_0_1
                    solve( (#t2.3 < #t2.1)  ∥ (#t2.3 = #t2.1)  ∥ (#vr.4 < #t2.3) )
                      case case_1
                      solve( (#vr.11 < #t2.3)  ∥ (#vr.11 = #t2.3) )
                        case case_1
                        solve( State_1( ) ▶₀ #t2.1 )
                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                          by contradiction /* cyclic */
                        qed
                      next
                        case case_2
                        solve( State_1( ) ▶₀ #t2.1 )
                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                          by contradiction /* cyclic */
                        qed
                      qed
                    next
                      case case_2
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    next
                      case case_3
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( State_111111111111111( lock, h1,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>, k, ptr,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  solve( Insert( <'F_template', ptr>,
                                 <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                         ) @ #t2.4 )
                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                    solve( (#vr.11 < #t2.3)  ∥ (#vr.11 = #t2.3) )
                      case case_1
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        solve( (∃ L_h k2 #t1 #t0.
                                 (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                ∧
                                 (((#t1 < #vr.19) ∧ (#t0 < #vr.19)) ∨ ((#t1 < #vr) ∧ (#t0 < #vr))))  ∥
                               (∃ #t0 #t1 h1 h2 k.
                                 (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                                ∧
                                 (((#t0 < #vr) ∧ (#t1 < #vr)) ∨ ((#t0 < #vr.19) ∧ (#t1 < #vr.19)))) )
                          case case_1
                          solve( (#t2.3 < #t2.5)  ∥ (#t2.3 = #t2.5) )
                            case case_1
                            by contradiction /* from formulas */
                          next
                            case case_2
                            solve( (last(#t2))  ∥
                                   (∃ L_h k2 #t1 #t0.
                                     (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                    ∧
                                     (¬(last(#t0))) ∧
                                     (¬(last(#t1))) ∧
                                     ((((#t1 < #vr.16) ∧ (#t0 < #vr.16)) ∨ ((#t1 < #t2) ∧ (#t0 < #t2))))) )
                              case case_1
                              by contradiction /* from formulas */
                            next
                              case case_2
                              by contradiction /* from formulas */
                            qed
                          qed
                        next
                          case case_2
                          solve( (#t2.3 < #t2.5)  ∥ (#t2.3 = #t2.5) )
                            case case_1
                            by contradiction /* from formulas */
                          next
                            case case_2
                            solve( (last(#t2))  ∥
                                   (∃ L_h k2 #t1 #t0.
                                     (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                    ∧
                                     (¬(last(#t0))) ∧
                                     (¬(last(#t1))) ∧
                                     ((((#t1 < #vr.16) ∧ (#t0 < #vr.16)) ∨ ((#t1 < #t2) ∧ (#t0 < #t2))))) )
                              case case_1
                              solve( ((#t0 < #vr) ∧ (#t1.1 < #vr))  ∥
                                     ((#t0 < #vr.19) ∧ (#t1.1 < #vr.19)) )
                                case case_1
                                by contradiction /* from formulas */
                              next
                                case case_2
                                by contradiction /* from formulas */
                              qed
                            next
                              case case_2
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    next
                      case case_2
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        solve( (∃ L_h k2 #t1 #t0.
                                 (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                ∧
                                 (((#t1 < #vr.18) ∧ (#t0 < #vr.18)) ∨ ((#t1 < #vr) ∧ (#t0 < #vr))))  ∥
                               (∃ #t0 #t1 h1 h2 k.
                                 (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                                ∧
                                 (((#t0 < #vr) ∧ (#t1 < #vr)) ∨ ((#t0 < #vr.18) ∧ (#t1 < #vr.18)))) )
                          case case_1
                          solve( (#t2.3 < #t2.5)  ∥ (#t2.3 = #t2.5) )
                            case case_1
                            by contradiction /* from formulas */
                          next
                            case case_2
                            solve( (last(#t2))  ∥
                                   (∃ L_h k2 #t1 #t0.
                                     (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                    ∧
                                     (¬(last(#t0))) ∧
                                     (¬(last(#t1))) ∧
                                     ((((#t1 < #vr.15) ∧ (#t0 < #vr.15)) ∨ ((#t1 < #t2) ∧ (#t0 < #t2))))) )
                              case case_1
                              by contradiction /* from formulas */
                            next
                              case case_2
                              by contradiction /* from formulas */
                            qed
                          qed
                        next
                          case case_2
                          solve( (#t2.3 < #t2.5)  ∥ (#t2.3 = #t2.5) )
                            case case_1
                            by contradiction /* from formulas */
                          next
                            case case_2
                            solve( (last(#t2))  ∥
                                   (∃ L_h k2 #t1 #t0.
                                     (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                    ∧
                                     (¬(last(#t0))) ∧
                                     (¬(last(#t1))) ∧
                                     ((((#t1 < #vr.15) ∧ (#t0 < #vr.15)) ∨ ((#t1 < #t2) ∧ (#t0 < #t2))))) )
                              case case_1
                              solve( ((#t0 < #vr) ∧ (#t1.1 < #vr))  ∥
                                     ((#t0 < #vr.18) ∧ (#t1.1 < #vr.18)) )
                                case case_1
                                by contradiction /* from formulas */
                              next
                                case case_2
                                by contradiction /* from formulas */
                              qed
                            next
                              case case_2
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case insertFtemplateusageoffoffononononoffonundefundef_0_1
                    solve( (#t2.3 < #t2.1)  ∥ (#t2.3 = #t2.1)  ∥ (#vr.4 < #t2.3) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        solve( (#t2.1 < #t2.4)  ∥ (#t2.1 = #t2.4) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( UnwrapKey( h2, ~n.2, 'on' ) @ #t3 )
                            case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                            by solve( State_111111111111111111111( lock, h2,
                                                                   <x.8, 'on', x.9, x.10, x.11, x.12, x.13, 
                                                                    x.14, x.15, x.16>,
                                                                   ~n.2, ptr, templ
                                      ) ▶₀ #t3 )
                          next
                            case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                            solve( State_11111211111111111111( ut,
                                                               <x.8, 'on', x.9, x.10, x.11, x.12, x.13, x.14, 
                                                                x.15, x.16>,
                                                               h2, k.1, ~n.2, v, L_h.1, lock
                                   ) ▶₀ #t3 )
                              case eventEncKeyhmattencatts_0_1111121111111111111
                              solve( (∃ h1 #t1. (NewKey( h1, ~n.2, 'on' ) @ #t1) ∧ #t1 < #vr.24)  ∥
                                     (∃ L_h k2 #t1 #t0.
                                       (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                      ∧
                                       (#t1 < #vr.24) ∧ (#t0 < #vr.24))  ∥
                                     (∃ #t0 #t1 h1 h2 k.
                                       (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                                      ∧
                                       (#t0 < #vr.24) ∧ (#t1 < #vr.24))  ∥
                                     (∃ #t0 #t1 h1 h2 k.
                                       (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                                      ∧
                                       (#t0 < #vr.24) ∧ (#t1 < #vr.24)) )
                                case case_1
                                solve( ((#vr.8 < #vr.30) ∧
                                        (∃ #t2.
                                          (Unlock_4( '4', ~n.4, 'device' ) @ #t2)
                                         ∧
                                          (#vr.8 < #t2) ∧
                                          (#t2 < #vr.30) ∧
                                          (∀ #t0 pp. (Unlock( pp, ~n.4, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                          (∀ pp lpp #t0.
                                            (Lock( pp, lpp, 'device' ) @ #t0)
                                           ⇒
                                            ((#t0 < #vr.8) ∨ (#t0 = #vr.8) ∨ (#t2 < #t0))) ∧
                                          (∀ pp lpp #t0.
                                            (Unlock( pp, lpp, 'device' ) @ #t0)
                                           ⇒
                                            ((#t0 < #vr.8) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                       (#vr.30 < #vr.8) )
                                  case case_1
                                  solve( Insert( <'F_template', z>,
                                                 <x.8, 'on', x.9, x.10, x.11, x.12, x.13, x.14, x.15, x.16>
                                         ) @ #t2.5 )
                                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case case_2
                                  solve( Insert( <'F_template', z>,
                                                 <x.8, 'on', x.9, x.10, x.11, x.12, x.13, x.14, x.15, x.16>
                                         ) @ #t2.5 )
                                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              next
                                case case_2
                                by contradiction /* from formulas */
                              next
                                case case_3
                                solve( ((#vr.8 < #vr.30) ∧
                                        (∃ #t2.
                                          (Unlock_4( '4', ~n.4, 'device' ) @ #t2)
                                         ∧
                                          (#vr.8 < #t2) ∧
                                          (#t2 < #vr.30) ∧
                                          (∀ #t0 pp. (Unlock( pp, ~n.4, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                                          (∀ pp lpp #t0.
                                            (Lock( pp, lpp, 'device' ) @ #t0)
                                           ⇒
                                            ((#t0 < #vr.8) ∨ (#t0 = #vr.8) ∨ (#t2 < #t0))) ∧
                                          (∀ pp lpp #t0.
                                            (Unlock( pp, lpp, 'device' ) @ #t0)
                                           ⇒
                                            ((#t0 < #vr.8) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                                       (#vr.30 < #vr.8) )
                                  case case_1
                                  solve( (∃ L_h k2 #t1.2 #t0.1.
                                           (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.2)
                                          ∧
                                           (((#t1.2 < #t0) ∧ (#t0.1 < #t0)) ∨
                                            ((#t1.2 < #t1.1) ∧ (#t0.1 < #t1.1))))  ∥
                                         (∃ #t0.1 #t1.2 h1 h2 k.
                                           (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                           (EncKey( h1, k, 'on' ) @ #t1.2)
                                          ∧
                                           (((#t0.1 < #t1.1) ∧ (#t1.2 < #t1.1)) ∨
                                            ((#t0.1 < #t0) ∧ (#t1.2 < #t0)))) )
                                    case case_1
                                    by contradiction /* from formulas */
                                  next
                                    case case_2
                                    solve( ((#t0.1 < #t1.1) ∧ (#t1.2 < #t1.1))  ∥
                                           ((#t0.1 < #t0) ∧ (#t1.2 < #t0)) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case case_2
                                  solve( (∃ L_h k2 #t1.2 #t0.1.
                                           (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.2)
                                          ∧
                                           (((#t1.2 < #t0) ∧ (#t0.1 < #t0)) ∨
                                            ((#t1.2 < #t1.1) ∧ (#t0.1 < #t1.1))))  ∥
                                         (∃ #t0.1 #t1.2 h1 h2 k.
                                           (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                           (EncKey( h1, k, 'on' ) @ #t1.2)
                                          ∧
                                           (((#t0.1 < #t1.1) ∧ (#t1.2 < #t1.1)) ∨
                                            ((#t0.1 < #t0) ∧ (#t1.2 < #t0)))) )
                                    case case_1
                                    by contradiction /* from formulas */
                                  next
                                    case case_2
                                    solve( ((#t0.1 < #t1.1) ∧ (#t1.2 < #t1.1))  ∥
                                           ((#t0.1 < #t0) ∧ (#t1.2 < #t0)) )
                                      case case_1
                                      by contradiction /* from formulas */
                                    next
                                      case case_2
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              next
                                case case_4
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case case_3
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        by contradiction /* cyclic */
                      qed
                    qed
                  qed
                qed
              qed
            qed
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            solve( (∃ L_h k2 #t1.1 #t0.1.
                     (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                    ∧
                     (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                   (∃ #t0.1 #t1.1 h1 h2 k.
                     (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                    ∧
                     (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
              case case_1
              solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                     ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            next
              case case_2
              solve( ((#t0.1 < #t1) ∧ (#t1.1 < #t1))  ∥
                     ((#t0.1 < #t0) ∧ (#t1.1 < #t0)) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          next
            case case_4
            by contradiction /* from formulas */
          qed
        qed
      qed
    next
      case case_2
      solve( EncKey( h1, k, 'on' ) @ #t2 )
        case eventEncKeyLhkattencatts_0_11111111111111111111
        solve( State_11111111111111111111( lock, h1,
                                           <x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>, k, ptr, templ
               ) ▶₀ #t2 )
          case eventDecKeyLhkattdecatts_0_1111111111111111111
          solve( Insert( <'F_template', ptr>,
                         <x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>
                 ) @ #t2.1 )
            case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
            solve( (#vr.7 < #t2.1)  ∥ (#vr.7 = #t2.1) )
              case case_1
              solve( State_11( ) ▶₀ #t2.1 )
                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                by contradiction /* cyclic */
              qed
            next
              case case_2
              solve( UnwrapKey( h2, ~n.2, 'on' ) @ #t3 )
                case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                by solve( State_111111111111111111111( lock, h2,
                                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>,
                                                       ~n.2, ptr, templ
                          ) ▶₀ #t3 )
              next
                case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                solve( State_11111211111111111111( ut,
                                                   <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>, h2, k,
                                                   ~n.2, v, L_h, lock
                       ) ▶₀ #t3 )
                  case eventEncKeyhmattencatts_0_1111121111111111111
                  solve( (∃ h1 #t1. (NewKey( h1, ~n.2, 'on' ) @ #t1) ∧ #t1 < #vr.13)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #vr.13) ∧ (#t0 < #vr.13))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.13) ∧ (#t1 < #vr.13))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.13) ∧ (#t1 < #vr.13)) )
                    case case_1
                    solve( Insert( <'F_template', z>,
                                   <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>
                           ) @ #t2.3 )
                      case insertFtemplatetrustedononoffoffononononusageusage_0_
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      solve( ((#t0.1 < #t1) ∧ (#t1.1 < #t1))  ∥
                             ((#t0.1 < #t0) ∧ (#t1.1 < #t0)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case case_4
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            qed
          next
            case insertFtemplateusageoffoffononononoffonundefundef_0_1
            solve( (#vr.8 < #t2.1)  ∥ (#vr.8 = #t2.1) )
              case case_1
              solve( State_1( ) ▶₀ #t2.1 )
                case insertFtemplatetrustedononoffoffononononusageusage_0_
                by contradiction /* cyclic */
              qed
            next
              case case_2
              solve( UnwrapKey( h2, ~n.2, 'on' ) @ #t3 )
                case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                by solve( State_111111111111111111111( lock, h2,
                                                       <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>,
                                                       ~n.2, ptr, templ
                          ) ▶₀ #t3 )
              next
                case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                solve( State_11111211111111111111( ut,
                                                   <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>, h2, k,
                                                   ~n.2, v, L_h, lock
                       ) ▶₀ #t3 )
                  case eventEncKeyhmattencatts_0_1111121111111111111
                  solve( (∃ h1 #t1. (NewKey( h1, ~n.2, 'on' ) @ #t1) ∧ #t1 < #vr.13)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #vr.13) ∧ (#t0 < #vr.13))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.13) ∧ (#t1 < #vr.13))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #vr.13) ∧ (#t1 < #vr.13)) )
                    case case_1
                    solve( Insert( <'F_template', z>,
                                   <x, 'on', x.1, x.2, x.3, x.4, x.5, x.6, x.7, x.8>
                           ) @ #t2.3 )
                      case insertFtemplatetrustedononoffoffononononusageusage_0_
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      solve( ((#t0.1 < #t1) ∧ (#t1.1 < #t1))  ∥
                             ((#t0.1 < #t0) ∧ (#t1.1 < #t0)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    qed
                  next
                    case case_4
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case eventEncKeyhmattencatts_0_1111121111111111111
        solve( State_1111121111111111111( ut,
                                          <x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>, h1, k, k.1, v,
                                          L_h, lock
               ) ▶₀ #t2 )
          case eventDecKeyhmattdecatts_0_111112111111111111
          solve( (∃ h1 #t1. (NewKey( h1, k.1, 'on' ) @ #t1) ∧ #t1 < #vr.2)  ∥
                 (∃ L_h k2 #t1 #t0.
                   (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                  ∧
                   (#t1 < #vr.2) ∧ (#t0 < #vr.2))  ∥
                 (∃ #t0 #t1 h1 h2 k.
                   (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                  ∧
                   (#t0 < #vr.2) ∧ (#t1 < #vr.2))  ∥
                 (∃ #t0 #t1 h1 h2 k.
                   (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                  ∧
                   (#t0 < #vr.2) ∧ (#t1 < #vr.2)) )
            case case_1
            solve( Insert( <'F_template', z>,
                           <x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>
                   ) @ #t2.1 )
              case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
              by contradiction /* from formulas */
            next
              case insertFtemplateusageoffoffononononoffonundefundef_0_1
              solve( (#vr.11 < #t2.1)  ∥ (#vr.11 = #t2.1) )
                case case_1
                solve( State_111111111111111( lock, h1,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>, k, ptr,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  solve( Insert( <'F_template', ptr>,
                                 <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                         ) @ #t2.4 )
                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                    solve( (#vr.12 < #t2.3)  ∥ (#vr.12 = #t2.3) )
                      case case_1
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    next
                      case case_2
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    qed
                  next
                    case insertFtemplateusageoffoffononononoffonundefundef_0_1
                    solve( (#t2.3 < #t2.1)  ∥ (#t2.3 = #t2.1)  ∥ (#vr.4 < #t2.3) )
                      case case_1
                      solve( (#vr.11 < #t2.3)  ∥ (#vr.11 = #t2.3) )
                        case case_1
                        solve( State_1( ) ▶₀ #t2.1 )
                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                          by contradiction /* cyclic */
                        qed
                      next
                        case case_2
                        solve( State_1( ) ▶₀ #t2.1 )
                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                          by contradiction /* cyclic */
                        qed
                      qed
                    next
                      case case_2
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    next
                      case case_3
                      solve( State_1( ) ▶₀ #t2.1 )
                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                        by contradiction /* cyclic */
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( State_111111111111111( lock, h1,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>, k, ptr,
                                              <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  solve( Insert( <'F_template', ptr>,
                                 <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
                         ) @ #t2.4 )
                    case insertFtemplatetrustedononoffoffononononusageusage_0_
                    solve( (#vr.11 < #t2.3)  ∥ (#vr.11 = #t2.3) )
                      case case_1
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        solve( (∃ L_h k2 #t1 #t0.
                                 (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                ∧
                                 (((#t1 < #vr.19) ∧ (#t0 < #vr.19)) ∨ ((#t1 < #vr) ∧ (#t0 < #vr))))  ∥
                               (∃ #t0 #t1 h1 h2 k.
                                 (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                                ∧
                                 (((#t0 < #vr) ∧ (#t1 < #vr)) ∨ ((#t0 < #vr.19) ∧ (#t1 < #vr.19)))) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( (#t2.3 < #t2.5)  ∥ (#t2.3 = #t2.5) )
                            case case_1
                            by contradiction /* from formulas */
                          next
                            case case_2
                            solve( ((#t0 < #vr) ∧ (#t1.1 < #vr))  ∥
                                   ((#t0 < #vr.19) ∧ (#t1.1 < #vr.19)) )
                              case case_1
                              by contradiction /* from formulas */
                            next
                              case case_2
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    next
                      case case_2
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        solve( (∃ L_h k2 #t1 #t0.
                                 (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                ∧
                                 (((#t1 < #vr.18) ∧ (#t0 < #vr.18)) ∨ ((#t1 < #vr) ∧ (#t0 < #vr))))  ∥
                               (∃ #t0 #t1 h1 h2 k.
                                 (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                                ∧
                                 (((#t0 < #vr) ∧ (#t1 < #vr)) ∨ ((#t0 < #vr.18) ∧ (#t1 < #vr.18)))) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( (#t2.3 < #t2.5)  ∥ (#t2.3 = #t2.5) )
                            case case_1
                            by contradiction /* from formulas */
                          next
                            case case_2
                            solve( ((#t0 < #vr) ∧ (#t1.1 < #vr))  ∥
                                   ((#t0 < #vr.18) ∧ (#t1.1 < #vr.18)) )
                              case case_1
                              by contradiction /* from formulas */
                            next
                              case case_2
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case insertFtemplateusageoffoffononononoffonundefundef_0_1
                    solve( (#t2.3 < #t2.1)  ∥ (#t2.3 = #t2.1)  ∥ (#vr.4 < #t2.3) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        solve( (#t2.1 < #t2.4)  ∥ (#t2.1 = #t2.4) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( (last(#t3))  ∥
                                 (∃ L_h k2 #t1 #t0.
                                   (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                  ∧
                                   (¬(last(#t0))) ∧
                                   (¬(last(#t1))) ∧
                                   ((((#t1 < #t3) ∧ (#t0 < #t3)) ∨ ((#t1 < #vr.17) ∧ (#t0 < #vr.17))))) )
                            case case_1
                            by solve( UnwrapKey( h2, ~n.2, 'on' ) @ #t2 )
                          next
                            case case_2
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    next
                      case case_3
                      solve( State_11111111111111111111111( ~n, L_h.1, atts, k.1, ptr, templ
                             ) ▶₀ #t2.2 )
                        case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                        by contradiction /* cyclic */
                      qed
                    qed
                  qed
                qed
              qed
            qed
          next
            case case_2
            by contradiction /* from formulas */
          next
            case case_3
            solve( (∃ L_h k2 #t1.1 #t0.1.
                     (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                    ∧
                     (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                   (∃ #t0.1 #t1.1 h1 h2 k.
                     (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                    ∧
                     (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              solve( ((#t0.1 < #t1) ∧ (#t1.1 < #t1))  ∥
                     ((#t0.1 < #t0) ∧ (#t1.1 < #t0)) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          next
            case case_4
            by contradiction /* from formulas */
          qed
        qed
      qed
    next
      case case_3
      solve( ((#t1 < #t3) ∧ (#t0 < #t3))  ∥ ((#t1 < #t2) ∧ (#t0 < #t2)) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        by contradiction /* from formulas */
      qed
    qed
  next
    case case_2
    solve( (#t1 = #t2)  ∥ (#t2 < #t1) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    qed
  next
    case case_3
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_0( '0', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_4
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_1( '1', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_5
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_2( '2', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_6
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_3( '3', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_7
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_4( '4', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_8
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_5( '5', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma cannot_obtain_key_ind [reuse, use_induction]:
  all-traces
  "¬(∃ #i #j L_h k. (NewKey( L_h, k, 'on' ) @ #i) ∧ (!KU( k ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ #i #j L_h k. (NewKey( L_h, k, 'on' ) @ #i) ∧ (!KU( k ) @ #j)"
*/
induction
  case empty_trace
  by contradiction /* from formulas */
next
  case non_empty_trace
  simplify
  solve( (∀ #i #j L_h k.
           (NewKey( L_h, k, 'on' ) @ #i) ∧ (!KU( k ) @ #j)
          ⇒
           ((last(#j)) ∨ (last(#i))))  ∥
         (∃ x y #t3.
           (IsIn( x, y ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (∀ #t2.
             (Insert( x, y ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t1 yp.
                (Insert( x, yp ) @ #t1)
               ∧
                (¬(last(#t1))) ∧
                (((#t1 = #t2) ∨ (#t2 < #t1))) ∧
                (¬(#t1 = #t2)) ∧
                (((#t3 = #t1) ∨ (#t1 < #t3)))))))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_0( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_0( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_1( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_1( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_2( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_2( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_3( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_3( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_4( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_4( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3)))  ∥
         (∃ p pp l x lp #t1 #t3.
           (Lock_5( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)
          ∧
           (¬(last(#t3))) ∧
           (¬(last(#t1))) ∧
           (((#t1 = #t3) ∨
             (#t3 < #t1) ∨
             (∀ #t2.
               (Unlock_5( p, l, x ) @ #t2)
              ⇒
               ((last(#t2)) ∨
                (#t1 = #t2) ∨
                (#t2 < #t1) ∨
                (#t2 = #t3) ∨
                (#t3 < #t2) ∨
                (∃ #t0 pp.1.
                  (Unlock( pp.1, l, x ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
                (∃ pp.1 lpp #t0.
                  (Lock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (¬(#t0 = #t1)) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
                (∃ pp.1 lpp #t0.
                  (Unlock( pp.1, lpp, x ) @ #t0)
                 ∧
                  (¬(last(#t0))) ∧
                  (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                  (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                  (¬(#t2 = #t0))))))) ∧
           (((#t3 = #t1) ∨ (#t1 < #t3))) ∧
           (¬(#t1 = #t3))) )
    case case_1
    solve( (last(#j))  ∥ (last(#i)) )
      case case_1
      solve( State_111111111111111( lock, L_h,
                                    <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>, k, ptr,
                                    <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
             ) ▶₀ #i )
        case lookupFtemplateptrastempl_0_11111111111111
        solve( Insert( <'F_template', ptr>,
                       <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
               ) @ #t2 )
          case insertFtemplatetrustedononoffoffononononusageusage_0_
          solve( (#vr.5 < #t2)  ∥ (#vr.5 = #t2) )
            case case_1
            solve( State_( ) ▶₀ #t2 )
              case Init
              by contradiction /* cyclic */
            qed
          next
            case case_2
            solve( !KU( ~n.2 ) @ #j )
              case eventDecUsingkm_0_111111112111111
              solve( (∃ h2 k2 #t2 #t3.
                       (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6))  ∥
                     (∃ h2 #t2 #t3 #t4.
                       (NewKey( h2, k, 'off' ) @ #t2) ∧ (!KU( k ) @ #t3) ∧ (!KU( t ) @ #t4)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6) ∧ (#t4 < #vr.6))  ∥
                     (∃ #t2. (EncUsing( k, t ) @ #t2) ∧ #t2 < #vr.6)  ∥
                     (∃ h2 k2 #t2 #t3 a.
                       (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6))  ∥
                     (∃ #t2 #t3 h1 h2 k2.
                       (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6)) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* cyclic */
              next
                case case_3
                solve( ((#vr.1 < #vr.10) ∧
                        (∃ #t2.
                          (Unlock_0( '0', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.1 < #t2) ∧
                          (#t2 < #vr.10) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.10 < #vr.1) )
                  case case_1
                  solve( State_111111121111( lock, t,
                                             <k, x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>, L_h
                         ) ▶₀ #t2.1 )
                    case lookupobjLhasv_0_11111112111
                    by contradiction /* cyclic */
                  qed
                next
                  case case_2
                  solve( State_111111121111( lock, t,
                                             <k, x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>, L_h
                         ) ▶₀ #t2.1 )
                    case lookupobjLhasv_0_11111112111
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case case_4
                solve( ((#vr.1 < #vr.10) ∧
                        (∃ #t2.
                          (Unlock_0( '0', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.1 < #t2) ∧
                          (#t2 < #vr.10) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.10 < #vr.1) )
                  case case_1
                  solve( (∃ h1 #t1. (NewKey( h1, k2, 'on' ) @ #t1) ∧ #t1 < #t2.1)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #t2.1) ∧ (#t0 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1)) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_4
                    by contradiction /* from formulas */
                  qed
                next
                  case case_2
                  solve( (∃ h1 #t1. (NewKey( h1, k2, 'on' ) @ #t1) ∧ #t1 < #t2.1)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #t2.1) ∧ (#t0 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1)) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_4
                    by contradiction /* from formulas */
                  qed
                qed
              next
                case case_5
                solve( ((#vr.1 < #vr.10) ∧
                        (∃ #t2.
                          (Unlock_0( '0', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.1 < #t2) ∧
                          (#t2 < #vr.10) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.10 < #vr.1) )
                  case case_1
                  solve( (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (((#t1 < #t2.3) ∧ (#t0 < #t2.3)) ∨ ((#t1 < #t3) ∧ (#t0 < #t3))))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (((#t0 < #t3) ∧ (#t1 < #t3)) ∨ ((#t0 < #t2.3) ∧ (#t1 < #t2.3)))) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    by contradiction /* from formulas */
                  qed
                next
                  case case_2
                  solve( (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (((#t1 < #t2.3) ∧ (#t0 < #t2.3)) ∨ ((#t1 < #t3) ∧ (#t0 < #t3))))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (((#t0 < #t3) ∧ (#t1 < #t3)) ∨ ((#t0 < #t2.3) ∧ (#t1 < #t2.3)))) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            next
              case ifCangetkeyvalueattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111121111
              solve( ((#vr.1 < #vr.8) ∧
                      (∃ #t2.
                        (Unlock_0( '0', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.1 < #t2) ∧
                        (#t2 < #vr.8) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.8 < #vr.1) )
                case case_1
                solve( State_111111111111111( lock, L_h,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>, t, ptr,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  by solve( (#vl, 0) ~~> (#j, 0) )
                qed
              next
                case case_2
                solve( State_111111111111111( lock, L_h,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>, t, ptr,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  by solve( (#vl, 0) ~~> (#j, 0) )
                qed
              qed
            next
              case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_1
              solve( ((#vr.1 < #vr.12) ∧
                      (∃ #t2.
                        (Unlock_0( '0', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.1 < #t2) ∧
                        (#t2 < #vr.12) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.12 < #vr.1) )
                case case_1
                solve( Insert( <'F_template', z.3>,
                               <z.4, z.5, z.6, z.7, z.8, 'on', z.9, 'off', z.10, z.11>
                       ) @ #t2.2 )
                  case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                  by contradiction /* from formulas */
                qed
              next
                case case_2
                solve( Insert( <'F_template', z.3>,
                               <z.4, z.5, z.6, z.7, z.8, 'on', z.9, 'off', z.10, z.11>
                       ) @ #t2.2 )
                  case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                  by contradiction /* from formulas */
                qed
              qed
            next
              case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_2
              solve( ((#vr.1 < #vr.12) ∧
                      (∃ #t2.
                        (Unlock_0( '0', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.1 < #t2) ∧
                        (#t2 < #vr.12) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.12 < #vr.1) )
                case case_1
                solve( Insert( <'F_template', z.2>,
                               <z.3, z.4, z.5, z.6, z.7, 'on', z.8, 'on', z.9, z.10>
                       ) @ #t2.2 )
                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                  by contradiction /* from formulas */
                next
                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                  solve( (#vr.4 < #t2.2)  ∥ (#vr.4 = #t2.2) )
                    case case_1
                    solve( State_11111111111111111111111( ~n, L_h, atts, k, ptr, templ
                           ) ▶₀ #t2.1 )
                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                      solve( (#t2 < #t2.5)  ∥ (#t2 = #t2.5) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        solve( State_1( ) ▶₀ #t2.2 )
                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                          by contradiction /* cyclic */
                        qed
                      qed
                    qed
                  next
                    case case_2
                    solve( State_11111111111111111111111( ~n, L_h, atts, k, ptr, templ
                           ) ▶₀ #t2.1 )
                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                      solve( (#t2 < #t2.5)  ∥ (#t2 = #t2.5) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        solve( Insert( <'obj', h2>,
                                       <z, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 'undef'
                                       >
                               ) @ #t2.3 )
                          case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                          solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                       'off', 'on', 'undef', 'undef'>,
                                                      <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                       'undef', 'undef'>,
                                                      k, z, v, L_h, lock
                                 ) ▶₀ #t2.3 )
                            case lookupFtemplateattuttemvasut_0_111112111111
                            solve( (#vr.22 < #vr.1)  ∥ (#t2.1 < #vr.22) )
                              case case_1
                              solve( Insert( <'F_template', z.2>,
                                             <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 
                                              'undef'>
                                     ) @ #t2.6 )
                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                solve( (#t2.2 < #t2.5)  ∥ (#t2.2 = #t2.5) )
                                  case case_1
                                  by contradiction /* from formulas */
                                next
                                  case case_2
                                  solve( State_1111121111111111111111( ut, atts, h2, k.1, m, v, L_h.1, ~n.3
                                         ) ▶₀ #t2.4 )
                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                    solve( (∃ h1 #t1. (NewKey( h1, m, 'on' ) @ #t1) ∧ #t1 < #vr.28)  ∥
                                           (∃ L_h k2 #t1 #t0.
                                             (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                            ∧
                                             (#t1 < #vr.28) ∧ (#t0 < #vr.28))  ∥
                                           (∃ #t0 #t1 h1 h2 k.
                                             (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                                            ∧
                                             (#t0 < #vr.28) ∧ (#t1 < #vr.28))  ∥
                                           (∃ #t0 #t1 h1 h2 k.
                                             (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                                            ∧
                                             (#t0 < #vr.28) ∧ (#t1 < #vr.28)) )
                                      case case_1
                                      solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( (#t2.2 < #t2.7)  ∥ (#t2.2 = #t2.7) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( State_111111111111111( lock, h1,
                                                                        <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                         z.6, z.7, z.8>,
                                                                        m, ptr,
                                                                        <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                         z.6, z.7, z.8>
                                                 ) ▶₀ #t1 )
                                            case lookupFtemplateptrastempl_0_11111111111111
                                            solve( (#vr.6, 0) ~~> (#j, 0) )
                                              case Var_fresh_5_n
                                              by contradiction /* cyclic */
                                            qed
                                          qed
                                        qed
                                      qed
                                    next
                                      case case_2
                                      by contradiction /* from formulas */
                                    next
                                      case case_3
                                      solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( (#t2.2 < #t2.7)  ∥ (#t2.2 = #t2.7) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (∃ L_h k2 #t1.1 #t0.1.
                                                   (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                                                  ∧
                                                   (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨
                                                    ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                                                 (∃ #t0.1 #t1.1 h1 h2 k.
                                                   (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                                   (EncKey( h1, k, 'on' ) @ #t1.1)
                                                  ∧
                                                   (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨
                                                    ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            by contradiction /* from formulas */
                                          qed
                                        qed
                                      qed
                                    next
                                      case case_4
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case case_2
                              solve( Insert( <'F_template', z.2>,
                                             <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 
                                              'undef'>
                                     ) @ #t2.6 )
                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                solve( (#t2.2 < #t2.5)  ∥ (#t2.2 = #t2.5) )
                                  case case_1
                                  by contradiction /* from formulas */
                                next
                                  case case_2
                                  solve( State_1111121111111111111111( ut, atts, h2, k.1, m, v, L_h.1, ~n.3
                                         ) ▶₀ #t2.4 )
                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                    solve( (∃ h1 #t1. (NewKey( h1, m, 'on' ) @ #t1) ∧ #t1 < #vr.28)  ∥
                                           (∃ L_h k2 #t1 #t0.
                                             (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                            ∧
                                             (#t1 < #vr.28) ∧ (#t0 < #vr.28))  ∥
                                           (∃ #t0 #t1 h1 h2 k.
                                             (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                                            ∧
                                             (#t0 < #vr.28) ∧ (#t1 < #vr.28))  ∥
                                           (∃ #t0 #t1 h1 h2 k.
                                             (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                                            ∧
                                             (#t0 < #vr.28) ∧ (#t1 < #vr.28)) )
                                      case case_1
                                      solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( (#t2.2 < #t2.7)  ∥ (#t2.2 = #t2.7) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( State_111111111111111( lock, h1,
                                                                        <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                         z.6, z.7, z.8>,
                                                                        m, ptr,
                                                                        <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                         z.6, z.7, z.8>
                                                 ) ▶₀ #t1 )
                                            case lookupFtemplateptrastempl_0_11111111111111
                                            solve( (#vr.6, 0) ~~> (#j, 0) )
                                              case Var_fresh_5_n
                                              by contradiction /* from formulas */
                                            qed
                                          qed
                                        qed
                                      qed
                                    next
                                      case case_2
                                      by contradiction /* from formulas */
                                    next
                                      case case_3
                                      solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( (#t2.2 < #t2.7)  ∥ (#t2.2 = #t2.7) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (∃ L_h k2 #t1.1 #t0.1.
                                                   (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                                                  ∧
                                                   (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨
                                                    ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                                                 (∃ #t0.1 #t1.1 h1 h2 k.
                                                   (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                                   (EncKey( h1, k, 'on' ) @ #t1.1)
                                                  ∧
                                                   (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨
                                                    ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            by contradiction /* from formulas */
                                          qed
                                        qed
                                      qed
                                    next
                                      case case_4
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case insertobjLhkatts_0_11111111111111111
                          solve( State_11111111111111111( lock, h2,
                                                          <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                           'undef', 'undef'>,
                                                          z, ptr, templ
                                 ) ▶₀ #t2.3 )
                            case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                            by solve( (#vr.6, 0) ~~> (#j, 0) )
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( Insert( <'F_template', z.2>,
                               <z.3, z.4, z.5, z.6, z.7, 'on', z.8, 'on', z.9, z.10>
                       ) @ #t2.2 )
                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                  by contradiction /* from formulas */
                next
                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                  solve( (#vr.4 < #t2.2)  ∥ (#vr.4 = #t2.2) )
                    case case_1
                    solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.3 ) ▶₀ #t2.1 )
                      case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                      solve( (#t2.4 < #t2.7)  ∥ (#t2.4 = #t2.7) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        solve( (#t2.3 < #t2.6)  ∥ (#t2.3 = #t2.6) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( (#vr.4 < #t2.5)  ∥ (#vr.4 = #t2.5) )
                            case case_1
                            solve( (#t2.2 < #t2.5)  ∥ (#t2.2 = #t2.5) )
                              case case_1
                              by contradiction /* from formulas */
                            next
                              case case_2
                              solve( State_1( ) ▶₀ #t2.2 )
                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case case_2
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    qed
                  next
                    case case_2
                    solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.3 ) ▶₀ #t2.1 )
                      case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                      solve( (#t2.4 < #t2.7)  ∥ (#t2.4 = #t2.7) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        solve( (#t2.2 < #t2.5)  ∥ (#t2.2 = #t2.5) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( (#t2.3 < #t2.5)  ∥ (#t2.3 = #t2.5) )
                            case case_1
                            by contradiction /* from formulas */
                          next
                            case case_2
                            solve( Insert( <'obj', h2>,
                                           <z, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 
                                            'undef'>
                                   ) @ #t2.3 )
                              case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                              solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                           'off', 'on', 'undef', 'undef'>,
                                                          <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                           'undef', 'undef'>,
                                                          k, z, v, L_h, lock
                                     ) ▶₀ #t2.3 )
                                case lookupFtemplateattuttemvasut_0_111112111111
                                solve( Insert( <'F_template', z.2>,
                                               <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 
                                                'undef'>
                                       ) @ #t2.6 )
                                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                  solve( (#t2.2 < #t2.5)  ∥ (#t2.2 = #t2.5) )
                                    case case_1
                                    by contradiction /* from formulas */
                                  next
                                    case case_2
                                    solve( State_1111121111111111111111( ut, atts, h2, k.1, m, v, L_h.1, ~n.5
                                           ) ▶₀ #t2.4 )
                                      case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                      solve( (∃ h1 #t1. (NewKey( h1, m, 'on' ) @ #t1) ∧ #t1 < #vr.23)  ∥
                                             (∃ L_h k2 #t1 #t0.
                                               (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                              ∧
                                               (#t1 < #vr.23) ∧ (#t0 < #vr.23))  ∥
                                             (∃ #t0 #t1 h1 h2 k.
                                               (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                                              ∧
                                               (#t0 < #vr.23) ∧ (#t1 < #vr.23))  ∥
                                             (∃ #t0 #t1 h1 h2 k.
                                               (UnwrapKey( h2, k, 'on' ) @ #t0) ∧
                                               (EncKey( h1, k, 'on' ) @ #t1)
                                              ∧
                                               (#t0 < #vr.23) ∧ (#t1 < #vr.23)) )
                                        case case_1
                                        solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (#t2.2 < #t2.7)  ∥ (#t2.2 = #t2.7) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            solve( State_111111111111111( lock, h1,
                                                                          <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                           z.6, z.7, z.8>,
                                                                          m, ptr,
                                                                          <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                           z.6, z.7, z.8>
                                                   ) ▶₀ #t1 )
                                              case lookupFtemplateptrastempl_0_11111111111111
                                              solve( (#vr.6, 0) ~~> (#j, 0) )
                                                case Var_fresh_5_n
                                                by contradiction /* cyclic */
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case case_2
                                        by contradiction /* from formulas */
                                      next
                                        case case_3
                                        solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (#t2.2 < #t2.7)  ∥ (#t2.2 = #t2.7) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            solve( (∃ L_h k2 #t1.1 #t0.1.
                                                     (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                                                    ∧
                                                     (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨
                                                      ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                                                   (∃ #t0.1 #t1.1 h1 h2 k.
                                                     (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                                     (EncKey( h1, k, 'on' ) @ #t1.1)
                                                    ∧
                                                     (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨
                                                      ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              by contradiction /* from formulas */
                                            qed
                                          qed
                                        qed
                                      next
                                        case case_4
                                        by contradiction /* from formulas */
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case insertobjLhkatts_0_11111111111111111
                              solve( State_11111111111111111( lock, h2,
                                                              <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                               'on', 'undef', 'undef'>,
                                                              z, ptr, templ
                                     ) ▶₀ #t2.3 )
                                case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                by solve( (#vr.6, 0) ~~> (#j, 0) )
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        next
          case insertFtemplateusageoffoffononononoffonundefundef_0_1
          solve( (#vr.4 < #t2)  ∥ (#vr.4 = #t2) )
            case case_1
            solve( State_1( ) ▶₀ #t2 )
              case insertFtemplatetrustedononoffoffononononusageusage_0_
              by contradiction /* cyclic */
            qed
          next
            case case_2
            solve( !KU( ~n.2 ) @ #j )
              case eventDecUsingkm_0_111111112111111
              solve( (∃ h2 k2 #t2 #t3.
                       (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6))  ∥
                     (∃ h2 #t2 #t3 #t4.
                       (NewKey( h2, k, 'off' ) @ #t2) ∧ (!KU( k ) @ #t3) ∧ (!KU( t ) @ #t4)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6) ∧ (#t4 < #vr.6))  ∥
                     (∃ #t2. (EncUsing( k, t ) @ #t2) ∧ #t2 < #vr.6)  ∥
                     (∃ h2 k2 #t2 #t3 a.
                       (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6))  ∥
                     (∃ #t2 #t3 h1 h2 k2.
                       (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6)) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* cyclic */
              next
                case case_3
                solve( ((#vr.1 < #vr.10) ∧
                        (∃ #t2.
                          (Unlock_0( '0', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.1 < #t2) ∧
                          (#t2 < #vr.10) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.10 < #vr.1) )
                  case case_1
                  solve( State_111111121111( lock, t,
                                             <k, x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>, L_h
                         ) ▶₀ #t2.1 )
                    case lookupobjLhasv_0_11111112111
                    by contradiction /* cyclic */
                  qed
                next
                  case case_2
                  solve( State_111111121111( lock, t,
                                             <k, x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>, L_h
                         ) ▶₀ #t2.1 )
                    case lookupobjLhasv_0_11111112111
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case case_4
                solve( ((#vr.1 < #vr.10) ∧
                        (∃ #t2.
                          (Unlock_0( '0', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.1 < #t2) ∧
                          (#t2 < #vr.10) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.10 < #vr.1) )
                  case case_1
                  solve( (∃ h1 #t1. (NewKey( h1, k2, 'on' ) @ #t1) ∧ #t1 < #t2.1)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #t2.1) ∧ (#t0 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1)) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_4
                    by contradiction /* from formulas */
                  qed
                next
                  case case_2
                  solve( (∃ h1 #t1. (NewKey( h1, k2, 'on' ) @ #t1) ∧ #t1 < #t2.1)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #t2.1) ∧ (#t0 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1)) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_4
                    by contradiction /* from formulas */
                  qed
                qed
              next
                case case_5
                solve( ((#vr.1 < #vr.10) ∧
                        (∃ #t2.
                          (Unlock_0( '0', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.1 < #t2) ∧
                          (#t2 < #vr.10) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.10 < #vr.1) )
                  case case_1
                  solve( (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (((#t1 < #t2.3) ∧ (#t0 < #t2.3)) ∨ ((#t1 < #t3) ∧ (#t0 < #t3))))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (((#t0 < #t3) ∧ (#t1 < #t3)) ∨ ((#t0 < #t2.3) ∧ (#t1 < #t2.3)))) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    by contradiction /* from formulas */
                  qed
                next
                  case case_2
                  solve( (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (((#t1 < #t2.3) ∧ (#t0 < #t2.3)) ∨ ((#t1 < #t3) ∧ (#t0 < #t3))))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (((#t0 < #t3) ∧ (#t1 < #t3)) ∨ ((#t0 < #t2.3) ∧ (#t1 < #t2.3)))) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            next
              case ifCangetkeyvalueattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111121111
              solve( ((#vr.1 < #vr.8) ∧
                      (∃ #t2.
                        (Unlock_0( '0', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.1 < #t2) ∧
                        (#t2 < #vr.8) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.8 < #vr.1) )
                case case_1
                solve( State_111111111111111( lock, L_h,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>, t, ptr,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  by solve( (#vl, 0) ~~> (#j, 0) )
                qed
              next
                case case_2
                solve( State_111111111111111( lock, L_h,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>, t, ptr,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  by solve( (#vl, 0) ~~> (#j, 0) )
                qed
              qed
            next
              case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_1
              solve( ((#vr.1 < #vr.12) ∧
                      (∃ #t2.
                        (Unlock_0( '0', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.1 < #t2) ∧
                        (#t2 < #vr.12) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.12 < #vr.1) )
                case case_1
                solve( Insert( <'F_template', z.3>,
                               <z.4, z.5, z.6, z.7, z.8, 'on', z.9, 'off', z.10, z.11>
                       ) @ #t2.2 )
                  case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                  by contradiction /* from formulas */
                qed
              next
                case case_2
                solve( Insert( <'F_template', z.3>,
                               <z.4, z.5, z.6, z.7, z.8, 'on', z.9, 'off', z.10, z.11>
                       ) @ #t2.2 )
                  case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                  by contradiction /* from formulas */
                qed
              qed
            next
              case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_2
              solve( ((#vr.1 < #vr.12) ∧
                      (∃ #t2.
                        (Unlock_0( '0', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.1 < #t2) ∧
                        (#t2 < #vr.12) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.12 < #vr.1) )
                case case_1
                solve( Insert( <'F_template', z.2>,
                               <z.3, z.4, z.5, z.6, z.7, 'on', z.8, 'on', z.9, z.10>
                       ) @ #t2.2 )
                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                  by contradiction /* from formulas */
                next
                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                  solve( (#t2.2 < #t2)  ∥ (#t2.2 = #t2)  ∥ (#vr < #t2.2) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    solve( State_11111111111111111111111( ~n, L_h, atts, k, ptr, templ
                           ) ▶₀ #t2.1 )
                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                      solve( (#t2 < #t2.4)  ∥ (#t2 = #t2.4) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        solve( Insert( <'obj', h2>,
                                       <z, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 'undef'
                                       >
                               ) @ #t2.2 )
                          case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                          solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                       'off', 'on', 'undef', 'undef'>,
                                                      <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                       'undef', 'undef'>,
                                                      k, z, v, L_h, lock
                                 ) ▶₀ #t2.2 )
                            case lookupFtemplateattuttemvasut_0_111112111111
                            solve( (#vr.23 < #vr.1)  ∥ (#t2.1 < #vr.23) )
                              case case_1
                              solve( Insert( <'F_template', z.2>,
                                             <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 
                                              'undef'>
                                     ) @ #t2.5 )
                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                solve( (#t2.4 < #t2)  ∥ (#t2.4 = #t2)  ∥ (#vr < #t2.4) )
                                  case case_1
                                  by contradiction /* from formulas */
                                next
                                  case case_2
                                  solve( State_1111121111111111111111( ut, atts, h2, k.1, m, v, L_h.1, ~n.3
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                    solve( (∃ h1 #t1. (NewKey( h1, m, 'on' ) @ #t1) ∧ #t1 < #vr.29)  ∥
                                           (∃ L_h k2 #t1 #t0.
                                             (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                            ∧
                                             (#t1 < #vr.29) ∧ (#t0 < #vr.29))  ∥
                                           (∃ #t0 #t1 h1 h2 k.
                                             (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                                            ∧
                                             (#t0 < #vr.29) ∧ (#t1 < #vr.29))  ∥
                                           (∃ #t0 #t1 h1 h2 k.
                                             (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                                            ∧
                                             (#t0 < #vr.29) ∧ (#t1 < #vr.29)) )
                                      case case_1
                                      solve( (#t2.5 < #t2.7)  ∥ (#t2.5 = #t2.7) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( (#t2 < #t2.6)  ∥ (#t2 = #t2.6) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( State_111111111111111( lock, h1,
                                                                        <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                         z.6, z.7, z.8>,
                                                                        m, ptr,
                                                                        <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                         z.6, z.7, z.8>
                                                 ) ▶₀ #t1 )
                                            case lookupFtemplateptrastempl_0_11111111111111
                                            solve( (#vr.7, 0) ~~> (#j, 0) )
                                              case Var_fresh_5_n
                                              by contradiction /* cyclic */
                                            qed
                                          qed
                                        qed
                                      qed
                                    next
                                      case case_2
                                      by contradiction /* from formulas */
                                    next
                                      case case_3
                                      solve( (#t2.5 < #t2.7)  ∥ (#t2.5 = #t2.7) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( (#t2 < #t2.6)  ∥ (#t2 = #t2.6) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (∃ L_h k2 #t1.1 #t0.1.
                                                   (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                                                  ∧
                                                   (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨
                                                    ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                                                 (∃ #t0.1 #t1.1 h1 h2 k.
                                                   (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                                   (EncKey( h1, k, 'on' ) @ #t1.1)
                                                  ∧
                                                   (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨
                                                    ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            by contradiction /* from formulas */
                                          qed
                                        qed
                                      qed
                                    next
                                      case case_4
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case case_3
                                  by contradiction /* from formulas */
                                qed
                              qed
                            next
                              case case_2
                              solve( Insert( <'F_template', z.2>,
                                             <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 
                                              'undef'>
                                     ) @ #t2.5 )
                                case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                solve( (#t2.4 < #t2)  ∥ (#t2.4 = #t2)  ∥ (#vr < #t2.4) )
                                  case case_1
                                  by contradiction /* from formulas */
                                next
                                  case case_2
                                  solve( State_1111121111111111111111( ut, atts, h2, k.1, m, v, L_h.1, ~n.3
                                         ) ▶₀ #t2.3 )
                                    case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                    solve( (∃ h1 #t1. (NewKey( h1, m, 'on' ) @ #t1) ∧ #t1 < #vr.29)  ∥
                                           (∃ L_h k2 #t1 #t0.
                                             (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                            ∧
                                             (#t1 < #vr.29) ∧ (#t0 < #vr.29))  ∥
                                           (∃ #t0 #t1 h1 h2 k.
                                             (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                                            ∧
                                             (#t0 < #vr.29) ∧ (#t1 < #vr.29))  ∥
                                           (∃ #t0 #t1 h1 h2 k.
                                             (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                                            ∧
                                             (#t0 < #vr.29) ∧ (#t1 < #vr.29)) )
                                      case case_1
                                      solve( (#t2.5 < #t2.7)  ∥ (#t2.5 = #t2.7) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( (#t2.6 < #t2)  ∥ (#t2.6 = #t2)  ∥ (#vr < #t2.6) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( State_111111111111111( lock, h1,
                                                                        <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                         z.6, z.7, z.8>,
                                                                        m, ptr,
                                                                        <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                         z.6, z.7, z.8>
                                                 ) ▶₀ #t1 )
                                            case lookupFtemplateptrastempl_0_11111111111111
                                            solve( (#vr.7, 0) ~~> (#j, 0) )
                                              case Var_fresh_5_n
                                              solve( (#t2 < #t2.6)  ∥ (#t2 = #t2.6) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                solve( Insert( <'obj', h1>,
                                                               <z, 'on', x.8, x.9, x.10, x.11, x.12, 'on', 
                                                                x.13, 'usage', x.14>
                                                       ) @ #t2.4 )
                                                  case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                                  solve( State_1111121111111( <'on', x.8, x.9, x.10, x.11, 
                                                                               x.12, 'on', x.13, 'usage', x.14
                                                                              >,
                                                                              <'on', x.8, x.9, x.10, x.11, 
                                                                               x.12, 'on', x.13, 'usage', x.14
                                                                              >,
                                                                              k.1, z, v, L_h.1, lock
                                                         ) ▶₀ #t2.4 )
                                                    case lookupFtemplateattuttemvasut_0_111112111111
                                                    solve( (#vr.34 < #vr.1)  ∥ (#t2.1 < #vr.34) )
                                                      case case_1
                                                      solve( Insert( <'F_template', z.1>,
                                                                     <'on', x.8, x.9, x.10, x.11, x.12, 'on', 
                                                                      x.13, 'usage', x.14>
                                                             ) @ #t2.7 )
                                                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                        by contradiction /* from formulas */
                                                      qed
                                                    next
                                                      case case_2
                                                      solve( (#vr.34 < #vr.23)  ∥ (#t2.3 < #vr.34) )
                                                        case case_1
                                                        solve( Insert( <'F_template', z.1>,
                                                                       <'on', x.8, x.9, x.10, x.11, x.12, 
                                                                        'on', x.13, 'usage', x.14>
                                                               ) @ #t2.7 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        solve( Insert( <'F_template', z.1>,
                                                                       <'on', x.8, x.9, x.10, x.11, x.12, 
                                                                        'on', x.13, 'usage', x.14>
                                                               ) @ #t2.7 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case insertobjLhkatts_0_11111111111111111
                                                  solve( State_11111111111111111( lock, h1,
                                                                                  <'on', x.8, x.9, x.10, 
                                                                                   x.11, x.12, 'on', x.13, 
                                                                                   'usage', x.14>,
                                                                                  z, ptr, templ
                                                         ) ▶₀ #t2.4 )
                                                    case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                                    solve( (#vr.32 < #vr.1)  ∥ (#t2.1 < #vr.32) )
                                                      case case_1
                                                      solve( Insert( <'F_template', ptr>,
                                                                     <'on', x.8, x.9, x.10, x.11, x.12, 'on', 
                                                                      x.13, 'usage', x.14>
                                                             ) @ #t2.7 )
                                                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                        by contradiction /* from formulas */
                                                      qed
                                                    next
                                                      case case_2
                                                      solve( (#vr.32 < #vr.23)  ∥ (#t2.3 < #vr.32) )
                                                        case case_1
                                                        solve( Insert( <'F_template', ptr>,
                                                                       <'on', x.8, x.9, x.10, x.11, x.12, 
                                                                        'on', x.13, 'usage', x.14>
                                                               ) @ #t2.7 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          by contradiction /* from formulas */
                                                        qed
                                                      next
                                                        case case_2
                                                        solve( Insert( <'F_template', ptr>,
                                                                       <'on', x.8, x.9, x.10, x.11, x.12, 
                                                                        'on', x.13, 'usage', x.14>
                                                               ) @ #t2.7 )
                                                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                                                          by contradiction /* from formulas */
                                                        qed
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        next
                                          case case_3
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    next
                                      case case_2
                                      by contradiction /* from formulas */
                                    next
                                      case case_3
                                      solve( (#t2.5 < #t2.7)  ∥ (#t2.5 = #t2.7) )
                                        case case_1
                                        by contradiction /* from formulas */
                                      next
                                        case case_2
                                        solve( (#t2.6 < #t2)  ∥ (#t2.6 = #t2)  ∥ (#vr < #t2.6) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (∃ L_h k2 #t1.1 #t0.1.
                                                   (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                                                  ∧
                                                   (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨
                                                    ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                                                 (∃ #t0.1 #t1.1 h1 h2 k.
                                                   (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                                   (EncKey( h1, k, 'on' ) @ #t1.1)
                                                  ∧
                                                   (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨
                                                    ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            by contradiction /* from formulas */
                                          qed
                                        next
                                          case case_3
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    next
                                      case case_4
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                next
                                  case case_3
                                  by contradiction /* from formulas */
                                qed
                              qed
                            qed
                          qed
                        next
                          case insertobjLhkatts_0_11111111111111111
                          solve( State_11111111111111111( lock, h2,
                                                          <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                           'undef', 'undef'>,
                                                          z, ptr, templ
                                 ) ▶₀ #t2.2 )
                            case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                            solve( (#vr.7, 0) ~~> (#j, 0) )
                              case Var_fresh_3_n
                              solve( (#t2 < #t2.4)  ∥ (#t2 = #t2.4) )
                                case case_1
                                by contradiction /* from formulas */
                              next
                                case case_2
                                solve( Insert( <'obj', h1>,
                                               <z, 'on', x, x.1, x.2, x.3, x.4, 'on', x.5, 'usage', x.6>
                                       ) @ #t2.3 )
                                  case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                                  solve( State_1111121111111( <'on', x, x.1, x.2, x.3, x.4, 'on', x.5, 
                                                               'usage', x.6>,
                                                              <'on', x, x.1, x.2, x.3, x.4, 'on', x.5, 
                                                               'usage', x.6>,
                                                              k, z, v, L_h, lock
                                         ) ▶₀ #t2.3 )
                                    case lookupFtemplateattuttemvasut_0_111112111111
                                    solve( (#vr.22 < #vr.1)  ∥ (#t2.1 < #vr.22) )
                                      case case_1
                                      solve( Insert( <'F_template', z.1>,
                                                     <'on', x, x.1, x.2, x.3, x.4, 'on', x.5, 'usage', x.6>
                                             ) @ #t2.5 )
                                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                                        by contradiction /* from formulas */
                                      qed
                                    next
                                      case case_2
                                      solve( Insert( <'F_template', z.1>,
                                                     <'on', x, x.1, x.2, x.3, x.4, 'on', x.5, 'usage', x.6>
                                             ) @ #t2.5 )
                                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                                        by contradiction /* from formulas */
                                      qed
                                    qed
                                  qed
                                next
                                  case insertobjLhkatts_0_11111111111111111
                                  solve( State_11111111111111111( lock, h1,
                                                                  <'on', x, x.1, x.2, x.3, x.4, 'on', x.5, 
                                                                   'usage', x.6>,
                                                                  z, ptr, templ
                                         ) ▶₀ #t2.3 )
                                    case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                    solve( (#vr.20 < #vr.1)  ∥ (#t2.1 < #vr.20) )
                                      case case_1
                                      solve( Insert( <'F_template', ptr>,
                                                     <'on', x, x.1, x.2, x.3, x.4, 'on', x.5, 'usage', x.6>
                                             ) @ #t2.5 )
                                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                                        by contradiction /* from formulas */
                                      qed
                                    next
                                      case case_2
                                      solve( Insert( <'F_template', ptr>,
                                                     <'on', x, x.1, x.2, x.3, x.4, 'on', x.5, 'usage', x.6>
                                             ) @ #t2.5 )
                                        case insertFtemplatetrustedononoffoffononononusageusage_0_
                                        by contradiction /* from formulas */
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case case_3
                    solve( State_11111111111111111111111( ~n, L_h, atts, k, ptr, templ
                           ) ▶₀ #t2.1 )
                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                      solve( (#t2 < #t2.5)  ∥ (#t2 = #t2.5) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        solve( State_1( ) ▶₀ #t2.2 )
                          case insertFtemplatetrustedononoffoffononononusageusage_0_
                          by contradiction /* cyclic */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case case_2
                solve( Insert( <'F_template', z.2>,
                               <z.3, z.4, z.5, z.6, z.7, 'on', z.8, 'on', z.9, z.10>
                       ) @ #t2.2 )
                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                  by contradiction /* from formulas */
                next
                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                  solve( (#t2.2 < #t2)  ∥ (#t2.2 = #t2)  ∥ (#vr < #t2.2) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.3 ) ▶₀ #t2.1 )
                      case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                      solve( (#t2.3 < #t2.6)  ∥ (#t2.3 = #t2.6) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        solve( (#t2 < #t2.4)  ∥ (#t2 = #t2.4) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( (#t2.2 < #t2.4)  ∥ (#t2.2 = #t2.4) )
                            case case_1
                            by contradiction /* from formulas */
                          next
                            case case_2
                            solve( Insert( <'obj', h2>,
                                           <z, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 
                                            'undef'>
                                   ) @ #t2.2 )
                              case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                              solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                           'off', 'on', 'undef', 'undef'>,
                                                          <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                           'undef', 'undef'>,
                                                          k, z, v, L_h, lock
                                     ) ▶₀ #t2.2 )
                                case lookupFtemplateattuttemvasut_0_111112111111
                                solve( Insert( <'F_template', z.2>,
                                               <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 
                                                'undef'>
                                       ) @ #t2.5 )
                                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                  solve( (#t2 < #t2.4)  ∥ (#t2 = #t2.4) )
                                    case case_1
                                    by contradiction /* from formulas */
                                  next
                                    case case_2
                                    solve( State_1111121111111111111111( ut, atts, h2, k.1, m, v, L_h.1, ~n.5
                                           ) ▶₀ #t2.3 )
                                      case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                      solve( (∃ h1 #t1. (NewKey( h1, m, 'on' ) @ #t1) ∧ #t1 < #vr.24)  ∥
                                             (∃ L_h k2 #t1 #t0.
                                               (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                              ∧
                                               (#t1 < #vr.24) ∧ (#t0 < #vr.24))  ∥
                                             (∃ #t0 #t1 h1 h2 k.
                                               (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                                              ∧
                                               (#t0 < #vr.24) ∧ (#t1 < #vr.24))  ∥
                                             (∃ #t0 #t1 h1 h2 k.
                                               (UnwrapKey( h2, k, 'on' ) @ #t0) ∧
                                               (EncKey( h1, k, 'on' ) @ #t1)
                                              ∧
                                               (#t0 < #vr.24) ∧ (#t1 < #vr.24)) )
                                        case case_1
                                        solve( (#t2.5 < #t2.7)  ∥ (#t2.5 = #t2.7) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (#t2 < #t2.6)  ∥ (#t2 = #t2.6) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            solve( State_111111111111111( lock, h1,
                                                                          <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                           z.6, z.7, z.8>,
                                                                          m, ptr,
                                                                          <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                           z.6, z.7, z.8>
                                                   ) ▶₀ #t1 )
                                              case lookupFtemplateptrastempl_0_11111111111111
                                              solve( (#vr.7, 0) ~~> (#j, 0) )
                                                case Var_fresh_5_n
                                                by contradiction /* cyclic */
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case case_2
                                        by contradiction /* from formulas */
                                      next
                                        case case_3
                                        solve( (#t2.5 < #t2.7)  ∥ (#t2.5 = #t2.7) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (#t2 < #t2.6)  ∥ (#t2 = #t2.6) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            solve( (∃ L_h k2 #t1.1 #t0.1.
                                                     (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                                                    ∧
                                                     (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨
                                                      ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                                                   (∃ #t0.1 #t1.1 h1 h2 k.
                                                     (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                                     (EncKey( h1, k, 'on' ) @ #t1.1)
                                                    ∧
                                                     (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨
                                                      ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              by contradiction /* from formulas */
                                            qed
                                          qed
                                        qed
                                      next
                                        case case_4
                                        by contradiction /* from formulas */
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case insertobjLhkatts_0_11111111111111111
                              solve( State_11111111111111111( lock, h2,
                                                              <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                               'on', 'undef', 'undef'>,
                                                              z, ptr, templ
                                     ) ▶₀ #t2.2 )
                                case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                solve( (#vr.7, 0) ~~> (#j, 0) )
                                  case Var_fresh_3_n
                                  by contradiction /* cyclic */
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case case_3
                    solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.3 ) ▶₀ #t2.1 )
                      case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                      by contradiction /* cyclic */
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case case_2
      solve( State_111111111111111( lock, L_h,
                                    <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>, k, ptr,
                                    <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
             ) ▶₀ #i )
        case lookupFtemplateptrastempl_0_11111111111111
        solve( Insert( <'F_template', ptr>,
                       <z, z.1, z.2, z.3, 'on', z.4, z.5, z.6, z.7, z.8>
               ) @ #t2 )
          case insertFtemplatetrustedononoffoffononononusageusage_0_
          solve( (#vr.5 < #t2)  ∥ (#vr.5 = #t2) )
            case case_1
            solve( State_( ) ▶₀ #t2 )
              case Init
              by contradiction /* cyclic */
            qed
          next
            case case_2
            solve( !KU( ~n.2 ) @ #j )
              case eventDecUsingkm_0_111111112111111
              solve( (∃ h2 k2 #t2 #t3.
                       (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6))  ∥
                     (∃ h2 #t2 #t3 #t4.
                       (NewKey( h2, k, 'off' ) @ #t2) ∧ (!KU( k ) @ #t3) ∧ (!KU( t ) @ #t4)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6) ∧ (#t4 < #vr.6))  ∥
                     (∃ #t2. (EncUsing( k, t ) @ #t2) ∧ #t2 < #vr.6)  ∥
                     (∃ h2 k2 #t2 #t3 a.
                       (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6))  ∥
                     (∃ #t2 #t3 h1 h2 k2.
                       (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6)) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* cyclic */
              next
                case case_3
                solve( ((#vr.1 < #vr.10) ∧
                        (∃ #t2.
                          (Unlock_0( '0', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.1 < #t2) ∧
                          (#t2 < #vr.10) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.10 < #vr.1) )
                  case case_1
                  solve( State_111111121111( lock, t,
                                             <k, x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>, L_h
                         ) ▶₀ #t2.1 )
                    case lookupobjLhasv_0_11111112111
                    by contradiction /* cyclic */
                  qed
                next
                  case case_2
                  solve( State_111111121111( lock, t,
                                             <k, x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>, L_h
                         ) ▶₀ #t2.1 )
                    case lookupobjLhasv_0_11111112111
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case case_4
                solve( ((#vr.1 < #vr.10) ∧
                        (∃ #t2.
                          (Unlock_0( '0', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.1 < #t2) ∧
                          (#t2 < #vr.10) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.10 < #vr.1) )
                  case case_1
                  solve( (∃ h1 #t1. (NewKey( h1, k2, 'on' ) @ #t1) ∧ #t1 < #t2.1)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #t2.1) ∧ (#t0 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1)) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                      case case_1
                      solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                             ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    next
                      case case_2
                      solve( ((#t0.2 < #t1) ∧ (#t1.2 < #t1))  ∥
                             ((#t0.2 < #t0.1) ∧ (#t1.2 < #t0.1)) )
                        case case_1
                        solve( ((#t1.2 < #t0.2) ∧ (#t0 < #t0.2))  ∥
                               ((#t1.2 < #t1.1) ∧ (#t0 < #t1.1)) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          by contradiction /* from formulas */
                        qed
                      next
                        case case_2
                        solve( ((#t1.2 < #t0.2) ∧ (#t0 < #t0.2))  ∥
                               ((#t1.2 < #t1.1) ∧ (#t0 < #t1.1)) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  next
                    case case_4
                    solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                           ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case case_2
                  solve( (∃ h1 #t1. (NewKey( h1, k2, 'on' ) @ #t1) ∧ #t1 < #t2.1)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #t2.1) ∧ (#t0 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1)) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                      case case_1
                      solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                             ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    next
                      case case_2
                      solve( ((#t0.2 < #t1) ∧ (#t1.2 < #t1))  ∥
                             ((#t0.2 < #t0.1) ∧ (#t1.2 < #t0.1)) )
                        case case_1
                        solve( ((#t1.2 < #t0.2) ∧ (#t0 < #t0.2))  ∥
                               ((#t1.2 < #t1.1) ∧ (#t0 < #t1.1)) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          by contradiction /* from formulas */
                        qed
                      next
                        case case_2
                        solve( ((#t1.2 < #t0.2) ∧ (#t0 < #t0.2))  ∥
                               ((#t1.2 < #t1.1) ∧ (#t0 < #t1.1)) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  next
                    case case_4
                    solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                           ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              next
                case case_5
                solve( ((#vr.1 < #vr.10) ∧
                        (∃ #t2.
                          (Unlock_0( '0', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.1 < #t2) ∧
                          (#t2 < #vr.10) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.10 < #vr.1) )
                  case case_1
                  solve( (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (((#t1 < #t2.3) ∧ (#t0 < #t2.3)) ∨ ((#t1 < #t3) ∧ (#t0 < #t3))))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (((#t0 < #t3) ∧ (#t1 < #t3)) ∨ ((#t0 < #t2.3) ∧ (#t1 < #t2.3)))) )
                    case case_1
                    solve( ((#t1 < #t2.3) ∧ (#t0 < #t2.3))  ∥ ((#t1 < #t3) ∧ (#t0 < #t3)) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_2
                    solve( ((#t0.1 < #t3) ∧ (#t1.1 < #t3))  ∥
                           ((#t0.1 < #t2.3) ∧ (#t1.1 < #t2.3)) )
                      case case_1
                      solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                             ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    next
                      case case_2
                      solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                             ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case case_2
                  solve( (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (((#t1 < #t2.3) ∧ (#t0 < #t2.3)) ∨ ((#t1 < #t3) ∧ (#t0 < #t3))))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (((#t0 < #t3) ∧ (#t1 < #t3)) ∨ ((#t0 < #t2.3) ∧ (#t1 < #t2.3)))) )
                    case case_1
                    solve( ((#t1 < #t2.3) ∧ (#t0 < #t2.3))  ∥ ((#t1 < #t3) ∧ (#t0 < #t3)) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_2
                    solve( ((#t0.1 < #t3) ∧ (#t1.1 < #t3))  ∥
                           ((#t0.1 < #t2.3) ∧ (#t1.1 < #t2.3)) )
                      case case_1
                      solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                             ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    next
                      case case_2
                      solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                             ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                qed
              qed
            next
              case ifCangetkeyvalueattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111121111
              solve( ((#vr.1 < #vr.8) ∧
                      (∃ #t2.
                        (Unlock_0( '0', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.1 < #t2) ∧
                        (#t2 < #vr.8) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.8 < #vr.1) )
                case case_1
                solve( State_111111111111111( lock, L_h,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>, t, ptr,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  by solve( (#vl, 0) ~~> (#j, 0) )
                qed
              next
                case case_2
                solve( State_111111111111111( lock, L_h,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>, t, ptr,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  by solve( (#vl, 0) ~~> (#j, 0) )
                qed
              qed
            next
              case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_1
              solve( ((#vr.1 < #vr.12) ∧
                      (∃ #t2.
                        (Unlock_0( '0', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.1 < #t2) ∧
                        (#t2 < #vr.12) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.12 < #vr.1) )
                case case_1
                solve( Insert( <'F_template', z.3>,
                               <z.4, z.5, z.6, z.7, z.8, 'on', z.9, 'off', z.10, z.11>
                       ) @ #t2.2 )
                  case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                  by contradiction /* from formulas */
                qed
              next
                case case_2
                solve( Insert( <'F_template', z.3>,
                               <z.4, z.5, z.6, z.7, z.8, 'on', z.9, 'off', z.10, z.11>
                       ) @ #t2.2 )
                  case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                  by contradiction /* from formulas */
                qed
              qed
            next
              case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_2
              solve( ((#vr.1 < #vr.12) ∧
                      (∃ #t2.
                        (Unlock_0( '0', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.1 < #t2) ∧
                        (#t2 < #vr.12) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.12 < #vr.1) )
                case case_1
                solve( Insert( <'F_template', z.2>,
                               <z.3, z.4, z.5, z.6, z.7, 'on', z.8, 'on', z.9, z.10>
                       ) @ #t2.2 )
                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                  by contradiction /* from formulas */
                next
                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                  solve( (#vr.4 < #t2.2)  ∥ (#vr.4 = #t2.2) )
                    case case_1
                    solve( State_11111111111111111111111( ~n, L_h, atts, k, ptr, templ
                           ) ▶₀ #t2.1 )
                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_2
                    solve( State_11111111111111111111111( ~n, L_h, atts, k, ptr, templ
                           ) ▶₀ #t2.1 )
                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              next
                case case_2
                solve( Insert( <'F_template', z.2>,
                               <z.3, z.4, z.5, z.6, z.7, 'on', z.8, 'on', z.9, z.10>
                       ) @ #t2.2 )
                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                  by contradiction /* from formulas */
                next
                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                  solve( (#vr.4 < #t2.2)  ∥ (#vr.4 = #t2.2) )
                    case case_1
                    solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.3 ) ▶₀ #t2.1 )
                      case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                      solve( (#t2.4 < #t2.7)  ∥ (#t2.4 = #t2.7) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        solve( (#t2.3 < #t2.6)  ∥ (#t2.3 = #t2.6) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( (#vr.4 < #t2.5)  ∥ (#vr.4 = #t2.5) )
                            case case_1
                            solve( (#t2.2 < #t2.5)  ∥ (#t2.2 = #t2.5) )
                              case case_1
                              by contradiction /* from formulas */
                            next
                              case case_2
                              solve( State_1( ) ▶₀ #t2.2 )
                                case insertFtemplatetrustedononoffoffononononusageusage_0_
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case case_2
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    qed
                  next
                    case case_2
                    solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.3 ) ▶₀ #t2.1 )
                      case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                      solve( (#t2.4 < #t2.7)  ∥ (#t2.4 = #t2.7) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        solve( (#t2.2 < #t2.5)  ∥ (#t2.2 = #t2.5) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( (#t2.3 < #t2.5)  ∥ (#t2.3 = #t2.5) )
                            case case_1
                            by contradiction /* from formulas */
                          next
                            case case_2
                            solve( Insert( <'obj', h2>,
                                           <z, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 
                                            'undef'>
                                   ) @ #t2.3 )
                              case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                              solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                           'off', 'on', 'undef', 'undef'>,
                                                          <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                           'undef', 'undef'>,
                                                          k, z, v, L_h, lock
                                     ) ▶₀ #t2.3 )
                                case lookupFtemplateattuttemvasut_0_111112111111
                                solve( Insert( <'F_template', z.2>,
                                               <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 
                                                'undef'>
                                       ) @ #t2.6 )
                                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                  solve( (#t2.2 < #t2.5)  ∥ (#t2.2 = #t2.5) )
                                    case case_1
                                    by contradiction /* from formulas */
                                  next
                                    case case_2
                                    solve( State_1111121111111111111111( ut, atts, h2, k.1, m, v, L_h.1, ~n.5
                                           ) ▶₀ #t2.4 )
                                      case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                      solve( (∃ h1 #t1. (NewKey( h1, m, 'on' ) @ #t1) ∧ #t1 < #vr.23)  ∥
                                             (∃ L_h k2 #t1 #t0.
                                               (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                              ∧
                                               (#t1 < #vr.23) ∧ (#t0 < #vr.23))  ∥
                                             (∃ #t0 #t1 h1 h2 k.
                                               (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                                              ∧
                                               (#t0 < #vr.23) ∧ (#t1 < #vr.23))  ∥
                                             (∃ #t0 #t1 h1 h2 k.
                                               (UnwrapKey( h2, k, 'on' ) @ #t0) ∧
                                               (EncKey( h1, k, 'on' ) @ #t1)
                                              ∧
                                               (#t0 < #vr.23) ∧ (#t1 < #vr.23)) )
                                        case case_1
                                        solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (#t2.2 < #t2.7)  ∥ (#t2.2 = #t2.7) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            solve( State_111111111111111( lock, h1,
                                                                          <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                           z.6, z.7, z.8>,
                                                                          m, ptr,
                                                                          <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                           z.6, z.7, z.8>
                                                   ) ▶₀ #t1 )
                                              case lookupFtemplateptrastempl_0_11111111111111
                                              solve( (#vr.6, 0) ~~> (#j, 0) )
                                                case Var_fresh_5_n
                                                by contradiction /* cyclic */
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case case_2
                                        by contradiction /* from formulas */
                                      next
                                        case case_3
                                        solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (#t2.2 < #t2.7)  ∥ (#t2.2 = #t2.7) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            solve( (∃ L_h k2 #t1.1 #t0.1.
                                                     (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                                                    ∧
                                                     (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨
                                                      ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                                                   (∃ #t0.1 #t1.1 h1 h2 k.
                                                     (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                                     (EncKey( h1, k, 'on' ) @ #t1.1)
                                                    ∧
                                                     (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨
                                                      ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                                              case case_1
                                              solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                                                     ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                by contradiction /* from formulas */
                                              qed
                                            next
                                              case case_2
                                              solve( ((#t0.2 < #t1) ∧ (#t1.2 < #t1))  ∥
                                                     ((#t0.2 < #t0.1) ∧ (#t1.2 < #t0.1)) )
                                                case case_1
                                                solve( ((#t1.2 < #t0.2) ∧ (#t0 < #t0.2))  ∥
                                                       ((#t1.2 < #t1.1) ∧ (#t0 < #t1.1)) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  by contradiction /* from formulas */
                                                qed
                                              next
                                                case case_2
                                                solve( ((#t1.2 < #t0.2) ∧ (#t0 < #t0.2))  ∥
                                                       ((#t1.2 < #t1.1) ∧ (#t0 < #t1.1)) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  by contradiction /* from formulas */
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case case_4
                                        solve( (#t2.6 < #t2.8)  ∥ (#t2.6 = #t2.8) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (#t2.2 < #t2.7)  ∥ (#t2.2 = #t2.7) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                                                   ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              by contradiction /* from formulas */
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case insertobjLhkatts_0_11111111111111111
                              solve( State_11111111111111111( lock, h2,
                                                              <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                               'on', 'undef', 'undef'>,
                                                              z, ptr, templ
                                     ) ▶₀ #t2.3 )
                                case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                by solve( (#vr.6, 0) ~~> (#j, 0) )
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        next
          case insertFtemplateusageoffoffononononoffonundefundef_0_1
          solve( (#vr.4 < #t2)  ∥ (#vr.4 = #t2) )
            case case_1
            solve( State_1( ) ▶₀ #t2 )
              case insertFtemplatetrustedononoffoffononononusageusage_0_
              by contradiction /* cyclic */
            qed
          next
            case case_2
            solve( !KU( ~n.2 ) @ #j )
              case eventDecUsingkm_0_111111112111111
              solve( (∃ h2 k2 #t2 #t3.
                       (NewKey( h2, k2, 'on' ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6))  ∥
                     (∃ h2 #t2 #t3 #t4.
                       (NewKey( h2, k, 'off' ) @ #t2) ∧ (!KU( k ) @ #t3) ∧ (!KU( t ) @ #t4)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6) ∧ (#t4 < #vr.6))  ∥
                     (∃ #t2. (EncUsing( k, t ) @ #t2) ∧ #t2 < #vr.6)  ∥
                     (∃ h2 k2 #t2 #t3 a.
                       (Unwrapped( h2, k2, a ) @ #t2) ∧ (!KU( k2 ) @ #t3)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6))  ∥
                     (∃ #t2 #t3 h1 h2 k2.
                       (WrapKey( h2, k2, 'on' ) @ #t2) ∧ (DecKey( h1, k2, 'on' ) @ #t3)
                      ∧
                       (#t2 < #vr.6) ∧ (#t3 < #vr.6)) )
                case case_1
                by contradiction /* from formulas */
              next
                case case_2
                by contradiction /* cyclic */
              next
                case case_3
                solve( ((#vr.1 < #vr.10) ∧
                        (∃ #t2.
                          (Unlock_0( '0', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.1 < #t2) ∧
                          (#t2 < #vr.10) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.10 < #vr.1) )
                  case case_1
                  solve( State_111111121111( lock, t,
                                             <k, x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>, L_h
                         ) ▶₀ #t2.1 )
                    case lookupobjLhasv_0_11111112111
                    by contradiction /* cyclic */
                  qed
                next
                  case case_2
                  solve( State_111111121111( lock, t,
                                             <k, x, x.1, 'on', x.2, x.3, x.4, x.5, x.6, x.7, x.8>, L_h
                         ) ▶₀ #t2.1 )
                    case lookupobjLhasv_0_11111112111
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case case_4
                solve( ((#vr.1 < #vr.10) ∧
                        (∃ #t2.
                          (Unlock_0( '0', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.1 < #t2) ∧
                          (#t2 < #vr.10) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.10 < #vr.1) )
                  case case_1
                  solve( (∃ h1 #t1. (NewKey( h1, k2, 'on' ) @ #t1) ∧ #t1 < #t2.1)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #t2.1) ∧ (#t0 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1)) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                      case case_1
                      solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                             ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    next
                      case case_2
                      solve( ((#t0.2 < #t1) ∧ (#t1.2 < #t1))  ∥
                             ((#t0.2 < #t0.1) ∧ (#t1.2 < #t0.1)) )
                        case case_1
                        solve( ((#t1.2 < #t0.2) ∧ (#t0 < #t0.2))  ∥
                               ((#t1.2 < #t1.1) ∧ (#t0 < #t1.1)) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          by contradiction /* from formulas */
                        qed
                      next
                        case case_2
                        solve( ((#t1.2 < #t0.2) ∧ (#t0 < #t0.2))  ∥
                               ((#t1.2 < #t1.1) ∧ (#t0 < #t1.1)) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  next
                    case case_4
                    solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                           ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  qed
                next
                  case case_2
                  solve( (∃ h1 #t1. (NewKey( h1, k2, 'on' ) @ #t1) ∧ #t1 < #t2.1)  ∥
                         (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (#t1 < #t2.1) ∧ (#t0 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (#t0 < #t2.1) ∧ (#t1 < #t2.1)) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    by contradiction /* from formulas */
                  next
                    case case_3
                    solve( (∃ L_h k2 #t1.1 #t0.1.
                             (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                            ∧
                             (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨ ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                           (∃ #t0.1 #t1.1 h1 h2 k.
                             (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧ (EncKey( h1, k, 'on' ) @ #t1.1)
                            ∧
                             (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨ ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                      case case_1
                      solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                             ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    next
                      case case_2
                      solve( ((#t0.2 < #t1) ∧ (#t1.2 < #t1))  ∥
                             ((#t0.2 < #t0.1) ∧ (#t1.2 < #t0.1)) )
                        case case_1
                        solve( ((#t1.2 < #t0.2) ∧ (#t0 < #t0.2))  ∥
                               ((#t1.2 < #t1.1) ∧ (#t0 < #t1.1)) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          by contradiction /* from formulas */
                        qed
                      next
                        case case_2
                        solve( ((#t1.2 < #t0.2) ∧ (#t0 < #t0.2))  ∥
                               ((#t1.2 < #t1.1) ∧ (#t0 < #t1.1)) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  next
                    case case_4
                    solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                           ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              next
                case case_5
                solve( ((#vr.1 < #vr.10) ∧
                        (∃ #t2.
                          (Unlock_0( '0', ~n, 'device' ) @ #t2)
                         ∧
                          (#vr.1 < #t2) ∧
                          (#t2 < #vr.10) ∧
                          (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                          (∀ pp lpp #t0.
                            (Lock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                          (∀ pp lpp #t0.
                            (Unlock( pp, lpp, 'device' ) @ #t0)
                           ⇒
                            ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                       (#vr.10 < #vr.1) )
                  case case_1
                  solve( (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (((#t1 < #t2.3) ∧ (#t0 < #t2.3)) ∨ ((#t1 < #t3) ∧ (#t0 < #t3))))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (((#t0 < #t3) ∧ (#t1 < #t3)) ∨ ((#t0 < #t2.3) ∧ (#t1 < #t2.3)))) )
                    case case_1
                    solve( ((#t1 < #t2.3) ∧ (#t0 < #t2.3))  ∥ ((#t1 < #t3) ∧ (#t0 < #t3)) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_2
                    solve( ((#t0.1 < #t3) ∧ (#t1.1 < #t3))  ∥
                           ((#t0.1 < #t2.3) ∧ (#t1.1 < #t2.3)) )
                      case case_1
                      solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                             ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    next
                      case case_2
                      solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                             ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                next
                  case case_2
                  solve( (∃ L_h k2 #t1 #t0.
                           (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                          ∧
                           (((#t1 < #t2.3) ∧ (#t0 < #t2.3)) ∨ ((#t1 < #t3) ∧ (#t0 < #t3))))  ∥
                         (∃ #t0 #t1 h1 h2 k.
                           (UnwrapKey( h2, k, 'on' ) @ #t0) ∧ (EncKey( h1, k, 'on' ) @ #t1)
                          ∧
                           (((#t0 < #t3) ∧ (#t1 < #t3)) ∨ ((#t0 < #t2.3) ∧ (#t1 < #t2.3)))) )
                    case case_1
                    solve( ((#t1 < #t2.3) ∧ (#t0 < #t2.3))  ∥ ((#t1 < #t3) ∧ (#t0 < #t3)) )
                      case case_1
                      by contradiction /* from formulas */
                    next
                      case case_2
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_2
                    solve( ((#t0.1 < #t3) ∧ (#t1.1 < #t3))  ∥
                           ((#t0.1 < #t2.3) ∧ (#t1.1 < #t2.3)) )
                      case case_1
                      solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                             ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    next
                      case case_2
                      solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                             ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                qed
              qed
            next
              case ifCangetkeyvalueattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111121111
              solve( ((#vr.1 < #vr.8) ∧
                      (∃ #t2.
                        (Unlock_0( '0', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.1 < #t2) ∧
                        (#t2 < #vr.8) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.8 < #vr.1) )
                case case_1
                solve( State_111111111111111( lock, L_h,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>, t, ptr,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  by solve( (#vl, 0) ~~> (#j, 0) )
                qed
              next
                case case_2
                solve( State_111111111111111( lock, L_h,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>, t, ptr,
                                              <z, z.1, z.2, z.3, 'off', z.4, z.5, z.6, z.7, z.8>
                       ) ▶₀ #t1 )
                  case lookupFtemplateptrastempl_0_11111111111111
                  by solve( (#vl, 0) ~~> (#j, 0) )
                qed
              qed
            next
              case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_1
              solve( ((#vr.1 < #vr.12) ∧
                      (∃ #t2.
                        (Unlock_0( '0', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.1 < #t2) ∧
                        (#t2 < #vr.12) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.12 < #vr.1) )
                case case_1
                solve( Insert( <'F_template', z.3>,
                               <z.4, z.5, z.6, z.7, z.8, 'on', z.9, 'off', z.10, z.11>
                       ) @ #t2.2 )
                  case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                  by contradiction /* from formulas */
                qed
              next
                case case_2
                solve( Insert( <'F_template', z.3>,
                               <z.4, z.5, z.6, z.7, z.8, 'on', z.9, 'off', z.10, z.11>
                       ) @ #t2.2 )
                  case insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11
                  by contradiction /* from formulas */
                qed
              qed
            next
              case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_case_2
              solve( ((#vr.1 < #vr.12) ∧
                      (∃ #t2.
                        (Unlock_0( '0', ~n, 'device' ) @ #t2)
                       ∧
                        (#vr.1 < #t2) ∧
                        (#t2 < #vr.12) ∧
                        (∀ #t0 pp. (Unlock( pp, ~n, 'device' ) @ #t0) ⇒ #t0 = #t2) ∧
                        (∀ pp lpp #t0.
                          (Lock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t0 = #vr.1) ∨ (#t2 < #t0))) ∧
                        (∀ pp lpp #t0.
                          (Unlock( pp, lpp, 'device' ) @ #t0)
                         ⇒
                          ((#t0 < #vr.1) ∨ (#t2 < #t0) ∨ (#t2 = #t0)))))  ∥
                     (#vr.12 < #vr.1) )
                case case_1
                solve( Insert( <'F_template', z.2>,
                               <z.3, z.4, z.5, z.6, z.7, 'on', z.8, 'on', z.9, z.10>
                       ) @ #t2.2 )
                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                  by contradiction /* from formulas */
                next
                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                  solve( (#t2.2 < #t2)  ∥ (#t2.2 = #t2)  ∥ (#vr < #t2.2) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    solve( State_11111111111111111111111( ~n, L_h, atts, k, ptr, templ
                           ) ▶₀ #t2.1 )
                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                      by contradiction /* from formulas */
                    qed
                  next
                    case case_3
                    solve( State_11111111111111111111111( ~n, L_h, atts, k, ptr, templ
                           ) ▶₀ #t2.1 )
                      case eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              next
                case case_2
                solve( Insert( <'F_template', z.2>,
                               <z.3, z.4, z.5, z.6, z.7, 'on', z.8, 'on', z.9, z.10>
                       ) @ #t2.2 )
                  case insertFtemplatetrustedononoffoffononononusageusage_0_
                  by contradiction /* from formulas */
                next
                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                  solve( (#t2.2 < #t2)  ∥ (#t2.2 = #t2)  ∥ (#vr < #t2.2) )
                    case case_1
                    by contradiction /* from formulas */
                  next
                    case case_2
                    solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.3 ) ▶₀ #t2.1 )
                      case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                      solve( (#t2.3 < #t2.6)  ∥ (#t2.3 = #t2.6) )
                        case case_1
                        by contradiction /* from formulas */
                      next
                        case case_2
                        solve( (#t2 < #t2.4)  ∥ (#t2 = #t2.4) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( (#t2.2 < #t2.4)  ∥ (#t2.2 = #t2.4) )
                            case case_1
                            by contradiction /* from formulas */
                          next
                            case case_2
                            solve( Insert( <'obj', h2>,
                                           <z, 'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 
                                            'undef'>
                                   ) @ #t2.2 )
                              case ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111
                              solve( State_1111121111111( <'off', 'off', 'on', 'on', 'on', 'on', 
                                                           'off', 'on', 'undef', 'undef'>,
                                                          <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 
                                                           'undef', 'undef'>,
                                                          k, z, v, L_h, lock
                                     ) ▶₀ #t2.2 )
                                case lookupFtemplateattuttemvasut_0_111112111111
                                solve( Insert( <'F_template', z.2>,
                                               <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 
                                                'undef'>
                                       ) @ #t2.5 )
                                  case insertFtemplateusageoffoffononononoffonundefundef_0_1
                                  solve( (#t2 < #t2.4)  ∥ (#t2 = #t2.4) )
                                    case case_1
                                    by contradiction /* from formulas */
                                  next
                                    case case_2
                                    solve( State_1111121111111111111111( ut, atts, h2, k.1, m, v, L_h.1, ~n.5
                                           ) ▶₀ #t2.3 )
                                      case eventUnwrapKeyhmattunwrapatts_0_11111211111111111111
                                      solve( (∃ h1 #t1. (NewKey( h1, m, 'on' ) @ #t1) ∧ #t1 < #vr.24)  ∥
                                             (∃ L_h k2 #t1 #t0.
                                               (NewKey( L_h, k2, 'on' ) @ #t0) ∧ (!KU( k2 ) @ #t1)
                                              ∧
                                               (#t1 < #vr.24) ∧ (#t0 < #vr.24))  ∥
                                             (∃ #t0 #t1 h1 h2 k.
                                               (WrapKey( h2, k, 'on' ) @ #t0) ∧ (DecKey( h1, k, 'on' ) @ #t1)
                                              ∧
                                               (#t0 < #vr.24) ∧ (#t1 < #vr.24))  ∥
                                             (∃ #t0 #t1 h1 h2 k.
                                               (UnwrapKey( h2, k, 'on' ) @ #t0) ∧
                                               (EncKey( h1, k, 'on' ) @ #t1)
                                              ∧
                                               (#t0 < #vr.24) ∧ (#t1 < #vr.24)) )
                                        case case_1
                                        solve( (#t2.5 < #t2.7)  ∥ (#t2.5 = #t2.7) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (#t2 < #t2.6)  ∥ (#t2 = #t2.6) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            solve( State_111111111111111( lock, h1,
                                                                          <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                           z.6, z.7, z.8>,
                                                                          m, ptr,
                                                                          <z, z.1, z.2, z.3, 'on', z.4, z.5, 
                                                                           z.6, z.7, z.8>
                                                   ) ▶₀ #t1 )
                                              case lookupFtemplateptrastempl_0_11111111111111
                                              solve( (#vr.7, 0) ~~> (#j, 0) )
                                                case Var_fresh_5_n
                                                by contradiction /* cyclic */
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case case_2
                                        by contradiction /* from formulas */
                                      next
                                        case case_3
                                        solve( (#t2.5 < #t2.7)  ∥ (#t2.5 = #t2.7) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (#t2 < #t2.6)  ∥ (#t2 = #t2.6) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            solve( (∃ L_h k2 #t1.1 #t0.1.
                                                     (NewKey( L_h, k2, 'on' ) @ #t0.1) ∧ (!KU( k2 ) @ #t1.1)
                                                    ∧
                                                     (((#t1.1 < #t0) ∧ (#t0.1 < #t0)) ∨
                                                      ((#t1.1 < #t1) ∧ (#t0.1 < #t1))))  ∥
                                                   (∃ #t0.1 #t1.1 h1 h2 k.
                                                     (UnwrapKey( h2, k, 'on' ) @ #t0.1) ∧
                                                     (EncKey( h1, k, 'on' ) @ #t1.1)
                                                    ∧
                                                     (((#t0.1 < #t1) ∧ (#t1.1 < #t1)) ∨
                                                      ((#t0.1 < #t0) ∧ (#t1.1 < #t0)))) )
                                              case case_1
                                              solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                                                     ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                                                case case_1
                                                by contradiction /* from formulas */
                                              next
                                                case case_2
                                                by contradiction /* from formulas */
                                              qed
                                            next
                                              case case_2
                                              solve( ((#t0.2 < #t1) ∧ (#t1.2 < #t1))  ∥
                                                     ((#t0.2 < #t0.1) ∧ (#t1.2 < #t0.1)) )
                                                case case_1
                                                solve( ((#t1.2 < #t0.2) ∧ (#t0 < #t0.2))  ∥
                                                       ((#t1.2 < #t1.1) ∧ (#t0 < #t1.1)) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  by contradiction /* from formulas */
                                                qed
                                              next
                                                case case_2
                                                solve( ((#t1.2 < #t0.2) ∧ (#t0 < #t0.2))  ∥
                                                       ((#t1.2 < #t1.1) ∧ (#t0 < #t1.1)) )
                                                  case case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case case_2
                                                  by contradiction /* from formulas */
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case case_4
                                        solve( (#t2.5 < #t2.7)  ∥ (#t2.5 = #t2.7) )
                                          case case_1
                                          by contradiction /* from formulas */
                                        next
                                          case case_2
                                          solve( (#t2 < #t2.6)  ∥ (#t2 = #t2.6) )
                                            case case_1
                                            by contradiction /* from formulas */
                                          next
                                            case case_2
                                            solve( ((#t1.1 < #t0.1) ∧ (#t0 < #t0.1))  ∥
                                                   ((#t1.1 < #t1) ∧ (#t0 < #t1)) )
                                              case case_1
                                              by contradiction /* from formulas */
                                            next
                                              case case_2
                                              by contradiction /* from formulas */
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case insertobjLhkatts_0_11111111111111111
                              solve( State_11111111111111111( lock, h2,
                                                              <'off', 'off', 'on', 'on', 'on', 'on', 'off', 
                                                               'on', 'undef', 'undef'>,
                                                              z, ptr, templ
                                     ) ▶₀ #t2.2 )
                                case ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111
                                solve( (#vr.7, 0) ~~> (#j, 0) )
                                  case Var_fresh_3_n
                                  by contradiction /* cyclic */
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case case_3
                    solve( State_11111121111111111( h1, h2, v1, v2, wt, ~n.3 ) ▶₀ #t2.1 )
                      case ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111
                      by contradiction /* cyclic */
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  next
    case case_2
    solve( (#t1 = #t2)  ∥ (#t2 < #t1) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    qed
  next
    case case_3
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_0( '0', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_4
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_1( '1', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_5
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_2( '2', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_6
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_3( '3', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_7
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_4( '4', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_8
    solve( (#t1 = #t3)  ∥ (#t3 < #t1)  ∥
           (∀ #t2.
             (Unlock_5( '5', ~n, 'device' ) @ #t2)
            ⇒
             ((last(#t2)) ∨
              (#t1 = #t2) ∨
              (#t2 < #t1) ∨
              (#t2 = #t3) ∨
              (#t3 < #t2) ∨
              (∃ #t0 pp.
                (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2))) ∨
              (∃ pp lpp #t0.
                (Lock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (¬(#t0 = #t1)) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2)))) ∨
              (∃ pp lpp #t0.
                (Unlock( pp, lpp, 'device' ) @ #t0)
               ∧
                (¬(last(#t0))) ∧
                (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                (¬(#t2 = #t0))))) )
      case case_1
      by contradiction /* from formulas */
    next
      case case_2
      by contradiction /* from formulas */
    next
      case case_3
      solve( (#t3 = #t1)  ∥ (#t1 < #t3) )
        case case_1
        by contradiction /* from formulas */
      next
        case case_2
        solve( (∃ #t0 pp.
                 (Unlock( pp, ~n, 'device' ) @ #t0) ∧ (¬(last(#t0))) ∧ (¬(#t0 = #t2)))  ∥
               (∃ pp lpp #t0.
                 (Lock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (¬(#t0 = #t1)) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))))  ∥
               (∃ pp lpp #t0.
                 (Unlock( pp, lpp, 'device' ) @ #t0)
                ∧
                 (¬(last(#t0))) ∧
                 (((#t0 = #t1) ∨ (#t1 < #t0))) ∧
                 (((#t2 = #t0) ∨ (#t0 < #t2))) ∧
                 (¬(#t2 = #t0))) )
          case case_1
          by contradiction /* from formulas */
        next
          case case_2
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            by contradiction /* from formulas */
          qed
        next
          case case_3
          solve( (#t0 = #t1)  ∥ (#t1 < #t0) )
            case case_1
            by contradiction /* from formulas */
          next
            case case_2
            solve( (#t2 = #t0)  ∥ (#t0 < #t2) )
              case case_1
              by contradiction /* from formulas */
            next
              case case_2
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma cannot_obtain_key:
  all-traces
  "¬(∃ #i #j L_h k. (NewKey( L_h, k, 'on' ) @ #i) ∧ (K( k ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ #i #j L_h k. (NewKey( L_h, k, 'on' ) @ #i) ∧ (K( k ) @ #j)"
*/
simplify
by contradiction /* from formulas */



































rule (modulo E) Init[color=#ffffff,
                     process="insert <'F_template', 'trusted'>,<'on', 'on', 'off', 'off', 'on', 'on', 'on', 'on', 'usage', 'usage'
>;"]:
   [ ] --[ Init( ) ]-> [ State_( ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) insertFtemplatetrustedononoffoffononononusageusage_0_[color=#ffffff,
                                                                      process="insert <'F_template', 'trusted'>,<'on', 'on', 'off', 'off', 'on', 'on', 'on', 'on', 'usage', 'usage'
>;"]:
   [ State_( ) ]
  --[
  Insert( <'F_template', 'trusted'>,
          <'on', 'on', 'off', 'off', 'on', 'on', 'on', 'on', 'usage', 'usage'>
  )
  ]->
   [ State_1( ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) insertFtemplateusageoffoffononononoffonundefundef_0_1[color=#ffffff,
                                                                      process="insert <'F_template', 'usage'>,<'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 
 'undef'>;"]:
   [ State_1( ) ]
  --[
  Insert( <'F_template', 'usage'>,
          <'off', 'off', 'on', 'on', 'on', 'on', 'off', 'on', 'undef', 'undef'>
  )
  ]->
   [ State_11( ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) insertFtemplateuntrustedoffoffononoffonoffoffundefundef_0_11[color=#ffffff,
                                                                             process="insert <'F_template', 'untrusted'>,<'off', 'off', 'on', 'on', 'off', 'on', 'off', 'off', 'undef', 
 'undef'>;"]:
   [ State_11( ) ]
  --[
  Insert( <'F_template', 'untrusted'>,
          <'off', 'off', 'on', 'on', 'off', 'on', 'off', 'off', 'undef', 'undef'>
  )
  ]->
   [ !Semistate_1111( ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) increateattsptr_0_1111111111[color=#408056,
                                             process="in(<'create', atts.1, ptr.1>);"]:
   [
   State_1111111111( ), In( <'create', atts.1, ptr.1> ), Fr( lock ),
   Fr( L_h.1 ), Fr( k.1 )
   ]
  --[ Lock_0( '0', lock, 'device' ), Lock( '0', lock, 'device' ) ]->
   [ State_11111111111111( lock, L_h.1, atts.1, k.1, ptr.1 ) ]

  /*
  rule (modulo AC) increateattsptr_0_1111111111[color=#408056,
                                                process="in(<'create', atts.1, ptr.1>);"]:
     [
     State_1111111111( ), In( <'create', atts, ptr> ), Fr( lock ), Fr( L_h ),
     Fr( k )
     ]
    --[ Lock_0( '0', lock, 'device' ), Lock( '0', lock, 'device' ) ]->
     [ State_11111111111111( lock, L_h, atts, k, ptr ) ]
  */

rule (modulo E) lookupFtemplateptrastempl_0_11111111111111[color=#408056,
                                                           process="lookup <'F_template', ptr.1> as templ.1"]:
   [ State_11111111111111( lock, L_h.1, atts.1, k.1, ptr.1 ) ]
  --[ IsIn( <'F_template', ptr.1>, templ.1 ) ]->
   [ State_111111111111111( lock, L_h.1, atts.1, k.1, ptr.1, templ.1 ) ]

  /*
  rule (modulo AC) lookupFtemplateptrastempl_0_11111111111111[color=#408056,
                                                              process="lookup <'F_template', ptr.1> as templ.1"]:
     [ State_11111111111111( lock, L_h, atts, k, ptr ) ]
    --[ IsIn( <'F_template', ptr>, templ ) ]->
     [ State_111111111111111( lock, L_h, atts, k, ptr, templ ) ]
  */

restriction Restr_ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111_1:
  "∀ x #NOW x.1 x.2 x.3 x.4 x.5 x.6 x.7 x.8 x.9 x.10 x.11 x.12 x.13 x.14
     x.15 x.16 x.17 x.18 x.19.
    (Restr_ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111_1( x,
                                                                                                                                                                                                                                                                      x.1,
                                                                                                                                                                                                                                                                      x.2,
                                                                                                                                                                                                                                                                      x.3,
                                                                                                                                                                                                                                                                      x.4,
                                                                                                                                                                                                                                                                      x.5,
                                                                                                                                                                                                                                                                      x.6,
                                                                                                                                                                                                                                                                      x.7,
                                                                                                                                                                                                                                                                      x.8,
                                                                                                                                                                                                                                                                      x.9,
                                                                                                                                                                                                                                                                      x.10,
                                                                                                                                                                                                                                                                      x.11,
                                                                                                                                                                                                                                                                      x.12,
                                                                                                                                                                                                                                                                      x.13,
                                                                                                                                                                                                                                                                      x.14,
                                                                                                                                                                                                                                                                      x.15,
                                                                                                                                                                                                                                                                      x.16,
                                                                                                                                                                                                                                                                      x.17,
                                                                                                                                                                                                                                                                      x.18,
                                                                                                                                                                                                                                                                      x.19
     ) @ #NOW) ⇒
    ((((((((((x = x.1) ∧ (x.2 = x.3)) ∧ (x.4 = x.5)) ∧ (x.6 = x.7)) ∧
          (x.8 = x.9)) ∧
         (x.10 = x.11)) ∧
        (x.12 = x.13)) ∧
       (x.14 = x.15)) ∧
      (x.16 = x.17)) ∧
     (x.18 = x.19))"
  // safety formula

rule (modulo E) ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111[color=#408056,
                                                                                                                                                                                                                                                                        process="if Permits( attwrap(templ.1), attunwrap(templ.1), attenc(templ.1),
         attdec(templ.1), attsens(templ.1), attextr(templ.1),
         atttrus(templ.1), attwwt(templ.1), attwt(templ.1), attut(templ.1),
         attwrap(atts.1), attunwrap(atts.1), attenc(atts.1), attdec(atts.1),
         attsens(atts.1), attextr(atts.1), atttrus(atts.1), attwwt(atts.1),
         attwt(atts.1), attut(atts.1)
)"]:
   [ State_111111111111111( lock, L_h.1, atts.1, k.1, ptr.1, templ.1 ) ]
  --[
  NewKey( L_h.1, k.1, attsens(atts.1) ),
  Restr_ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111_1( attwrap(templ.1),
                                                                                                                                                                                                                                                                   attwrap(atts.1),
                                                                                                                                                                                                                                                                   attunwrap(templ.1),
                                                                                                                                                                                                                                                                   attunwrap(atts.1),
                                                                                                                                                                                                                                                                   attenc(templ.1),
                                                                                                                                                                                                                                                                   attenc(atts.1),
                                                                                                                                                                                                                                                                   attdec(templ.1),
                                                                                                                                                                                                                                                                   attdec(atts.1),
                                                                                                                                                                                                                                                                   attsens(templ.1),
                                                                                                                                                                                                                                                                   attsens(atts.1),
                                                                                                                                                                                                                                                                   attextr(templ.1),
                                                                                                                                                                                                                                                                   attextr(atts.1),
                                                                                                                                                                                                                                                                   atttrus(templ.1),
                                                                                                                                                                                                                                                                   atttrus(atts.1),
                                                                                                                                                                                                                                                                   attwwt(templ.1),
                                                                                                                                                                                                                                                                   attwwt(atts.1),
                                                                                                                                                                                                                                                                   attwt(templ.1),
                                                                                                                                                                                                                                                                   attwt(atts.1),
                                                                                                                                                                                                                                                                   attut(templ.1),
                                                                                                                                                                                                                                                                   attut(atts.1)
  )
  ]->
   [ State_11111111111111111( lock, L_h.1, atts.1, k.1, ptr.1, templ.1 ) ]

  /*
  rule (modulo AC) ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111[color=#408056,
                                                                                                                                                                                                                                                                           process="if Permits( attwrap(templ.1), attunwrap(templ.1), attenc(templ.1),
         attdec(templ.1), attsens(templ.1), attextr(templ.1),
         atttrus(templ.1), attwwt(templ.1), attwt(templ.1), attut(templ.1),
         attwrap(atts.1), attunwrap(atts.1), attenc(atts.1), attdec(atts.1),
         attsens(atts.1), attextr(atts.1), atttrus(atts.1), attwwt(atts.1),
         attwt(atts.1), attut(atts.1)
)"]:
     [ State_111111111111111( lock, L_h, atts, k, ptr, templ ) ]
    --[
    NewKey( L_h, k, z ),
    Restr_ifPermitsattwraptemplattunwraptemplattenctemplattdectemplattsenstemplattextrtemplatttrustemplattwwttemplattwttemplattuttemplattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_111111111111111_1( z.1,
                                                                                                                                                                                                                                                                     z.2,
                                                                                                                                                                                                                                                                     z.3,
                                                                                                                                                                                                                                                                     z.4,
                                                                                                                                                                                                                                                                     z.5,
                                                                                                                                                                                                                                                                     z.6,
                                                                                                                                                                                                                                                                     z.7,
                                                                                                                                                                                                                                                                     z.8,
                                                                                                                                                                                                                                                                     z.9,
                                                                                                                                                                                                                                                                     z,
                                                                                                                                                                                                                                                                     z.10,
                                                                                                                                                                                                                                                                     z.11,
                                                                                                                                                                                                                                                                     z.12,
                                                                                                                                                                                                                                                                     z.13,
                                                                                                                                                                                                                                                                     z.14,
                                                                                                                                                                                                                                                                     z.15,
                                                                                                                                                                                                                                                                     z.16,
                                                                                                                                                                                                                                                                     z.17,
                                                                                                                                                                                                                                                                     z.18,
                                                                                                                                                                                                                                                                     z.19
    )
    ]->
     [ State_11111111111111111( lock, L_h, atts, k, ptr, templ ) ]
    variants (modulo AC)
    1. atts  = atts.29
       templ = templ.29
       z     = attsens(atts.29)
       z.1   = attwrap(templ.29)
       z.2   = attwrap(atts.29)
       z.3   = attunwrap(templ.29)
       z.4   = attunwrap(atts.29)
       z.5   = attenc(templ.29)
       z.6   = attenc(atts.29)
       z.7   = attdec(templ.29)
       z.8   = attdec(atts.29)
       z.9   = attsens(templ.29)
       z.10  = attextr(templ.29)
       z.11  = attextr(atts.29)
       z.12  = atttrus(templ.29)
       z.13  = atttrus(atts.29)
       z.14  = attwwt(templ.29)
       z.15  = attwwt(atts.29)
       z.16  = attwt(templ.29)
       z.17  = attwt(atts.29)
       z.18  = attut(templ.29)
       z.19  = attut(atts.29)
    
    2. atts  = atts.39
       templ = <x.28, x.29, x.30, x.31, x.32, x.33, x.34, x.35, x.36, x.37>
       z     = attsens(atts.39)
       z.1   = x.28
       z.2   = attwrap(atts.39)
       z.3   = x.29
       z.4   = attunwrap(atts.39)
       z.5   = x.30
       z.6   = attenc(atts.39)
       z.7   = x.31
       z.8   = attdec(atts.39)
       z.9   = x.32
       z.10  = x.33
       z.11  = attextr(atts.39)
       z.12  = x.34
       z.13  = atttrus(atts.39)
       z.14  = x.35
       z.15  = attwwt(atts.39)
       z.16  = x.36
       z.17  = attwt(atts.39)
       z.18  = x.37
       z.19  = attut(atts.39)
    
    3. atts  = <x.28, x.29, x.30, x.31, x.32, x.33, x.34, x.35, x.36, x.37>
       templ = templ.39
       z     = x.32
       z.1   = attwrap(templ.39)
       z.2   = x.28
       z.3   = attunwrap(templ.39)
       z.4   = x.29
       z.5   = attenc(templ.39)
       z.6   = x.30
       z.7   = attdec(templ.39)
       z.8   = x.31
       z.9   = attsens(templ.39)
       z.10  = attextr(templ.39)
       z.11  = x.33
       z.12  = atttrus(templ.39)
       z.13  = x.34
       z.14  = attwwt(templ.39)
       z.15  = x.35
       z.16  = attwt(templ.39)
       z.17  = x.36
       z.18  = attut(templ.39)
       z.19  = x.37
    
    4. atts  = <x.28, x.29, x.30, x.31, x.32, x.33, x.34, x.35, x.36, x.37>
       templ = <x.40, x.41, x.42, x.43, x.44, x.45, x.46, x.47, x.48, x.49>
       z     = x.32
       z.1   = x.40
       z.2   = x.28
       z.3   = x.41
       z.4   = x.29
       z.5   = x.42
       z.6   = x.30
       z.7   = x.43
       z.8   = x.31
       z.9   = x.44
       z.10  = x.45
       z.11  = x.33
       z.12  = x.46
       z.13  = x.34
       z.14  = x.47
       z.15  = x.35
       z.16  = x.48
       z.17  = x.36
       z.18  = x.49
       z.19  = x.37
  */

rule (modulo E) insertobjLhkatts_0_11111111111111111[color=#408056,
                                                     process="insert <'obj', L_h.1>,<k.1, atts.1>;"]:
   [ State_11111111111111111( lock, L_h.1, atts.1, k.1, ptr.1, templ.1 ) ]
  --[ Insert( <'obj', L_h.1>, <k.1, atts.1> ) ]->
   [ State_111111111111111111( lock, L_h.1, atts.1, k.1, ptr.1, templ.1 ) ]

  /*
  rule (modulo AC) insertobjLhkatts_0_11111111111111111[color=#408056,
                                                        process="insert <'obj', L_h.1>,<k.1, atts.1>;"]:
     [ State_11111111111111111( lock, L_h, atts, k, ptr, templ ) ]
    --[ Insert( <'obj', L_h>, <k, atts> ) ]->
     [ State_111111111111111111( lock, L_h, atts, k, ptr, templ ) ]
  */

rule (modulo E) eventWrapKeyLhkattwrapatts_0_111111111111111111[color=#408056,
                                                                process="event WrapKey( L_h.1, k.1, attwrap(atts.1) );"]:
   [ State_111111111111111111( lock, L_h.1, atts.1, k.1, ptr.1, templ.1 ) ]
  --[ WrapKey( L_h.1, k.1, attwrap(atts.1) ) ]->
   [ State_1111111111111111111( lock, L_h.1, atts.1, k.1, ptr.1, templ.1 ) ]

  /*
  rule (modulo AC) eventWrapKeyLhkattwrapatts_0_111111111111111111[color=#408056,
                                                                   process="event WrapKey( L_h.1, k.1, attwrap(atts.1) );"]:
     [ State_111111111111111111( lock, L_h, atts, k, ptr, templ ) ]
    --[ WrapKey( L_h, k, z ) ]->
     [ State_1111111111111111111( lock, L_h, atts, k, ptr, templ ) ]
    variants (modulo AC)
    1. atts  = atts.10
       z     = attwrap(atts.10)
    
    2. atts  = <x.9, x.10, x.11, x.12, x.13, x.14, x.15, x.16, x.17, x.18>
       z     = x.9
  */

rule (modulo E) eventDecKeyLhkattdecatts_0_1111111111111111111[color=#408056,
                                                               process="event DecKey( L_h.1, k.1, attdec(atts.1) );"]:
   [ State_1111111111111111111( lock, L_h.1, atts.1, k.1, ptr.1, templ.1 ) ]
  --[ DecKey( L_h.1, k.1, attdec(atts.1) ) ]->
   [ State_11111111111111111111( lock, L_h.1, atts.1, k.1, ptr.1, templ.1 )
   ]

  /*
  rule (modulo AC) eventDecKeyLhkattdecatts_0_1111111111111111111[color=#408056,
                                                                  process="event DecKey( L_h.1, k.1, attdec(atts.1) );"]:
     [ State_1111111111111111111( lock, L_h, atts, k, ptr, templ ) ]
    --[ DecKey( L_h, k, z ) ]->
     [ State_11111111111111111111( lock, L_h, atts, k, ptr, templ ) ]
    variants (modulo AC)
    1. atts  = atts.10
       z     = attdec(atts.10)
    
    2. atts  = <x.9, x.10, x.11, x.12, x.13, x.14, x.15, x.16, x.17, x.18>
       z     = x.12
  */

rule (modulo E) eventEncKeyLhkattencatts_0_11111111111111111111[color=#408056,
                                                                process="event EncKey( L_h.1, k.1, attenc(atts.1) );"]:
   [ State_11111111111111111111( lock, L_h.1, atts.1, k.1, ptr.1, templ.1 )
   ]
  --[ EncKey( L_h.1, k.1, attenc(atts.1) ) ]->
   [ State_111111111111111111111( lock, L_h.1, atts.1, k.1, ptr.1, templ.1 )
   ]

  /*
  rule (modulo AC) eventEncKeyLhkattencatts_0_11111111111111111111[color=#408056,
                                                                   process="event EncKey( L_h.1, k.1, attenc(atts.1) );"]:
     [ State_11111111111111111111( lock, L_h, atts, k, ptr, templ ) ]
    --[ EncKey( L_h, k, z ) ]->
     [ State_111111111111111111111( lock, L_h, atts, k, ptr, templ ) ]
    variants (modulo AC)
    1. atts  = atts.10
       z     = attenc(atts.10)
    
    2. atts  = <x.9, x.10, x.11, x.12, x.13, x.14, x.15, x.16, x.17, x.18>
       z     = x.11
  */

rule (modulo E) eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111[color=#408056,
                                                                       process="event UnwrapKey( L_h.1, k.1, attunwrap(atts.1) );"]:
   [ State_111111111111111111111( lock, L_h.1, atts.1, k.1, ptr.1, templ.1 )
   ]
  --[ UnwrapKey( L_h.1, k.1, attunwrap(atts.1) ) ]->
   [
   State_11111111111111111111111( lock, L_h.1, atts.1, k.1, ptr.1, templ.1
   ),
   Out( L_h.1 )
   ]

  /*
  rule (modulo AC) eventUnwrapKeyLhkattunwrapatts_0_111111111111111111111[color=#408056,
                                                                          process="event UnwrapKey( L_h.1, k.1, attunwrap(atts.1) );"]:
     [ State_111111111111111111111( lock, L_h, atts, k, ptr, templ ) ]
    --[ UnwrapKey( L_h, k, z ) ]->
     [
     State_11111111111111111111111( lock, L_h, atts, k, ptr, templ ),
     Out( L_h )
     ]
    variants (modulo AC)
    1. atts  = atts.10
       z     = attunwrap(atts.10)
    
    2. atts  = <x.9, x.10, x.11, x.12, x.13, x.14, x.15, x.16, x.17, x.18>
       z     = x.10
  */

rule (modulo E) unlockdevice_0_11111111111111111111111[color=#408056,
                                                       process="unlock 'device';"]:
   [
   State_11111111111111111111111( lock, L_h.1, atts.1, k.1, ptr.1, templ.1 )
   ]
  --[ Unlock_0( '0', lock, 'device' ), Unlock( '0', lock, 'device' ) ]->
   [ ]

  /*
  rule (modulo AC) unlockdevice_0_11111111111111111111111[color=#408056,
                                                          process="unlock 'device';"]:
     [ State_11111111111111111111111( lock, L_h, atts, k, ptr, templ ) ]
    --[ Unlock_0( '0', lock, 'device' ), Unlock( '0', lock, 'device' ) ]->
     [ ]
  */

rule (modulo E) lookupFtemplateptrastempl_1_11111111111111[color=#408056,
                                                           process="lookup <'F_template', ptr.1> as templ.1"]:
   [ State_11111111111111( lock, L_h.1, atts.1, k.1, ptr.1 ) ]
  --[ IsNotSet( <'F_template', ptr.1> ) ]->
   [ ]

  /*
  rule (modulo AC) lookupFtemplateptrastempl_1_11111111111111[color=#408056,
                                                              process="lookup <'F_template', ptr.1> as templ.1"]:
     [ State_11111111111111( lock, L_h, atts, k, ptr ) ]
    --[ IsNotSet( <'F_template', ptr> ) ]->
     [ ]
  */

rule (modulo E) inLhsencmk_0_1111111121[color=#408078,
                                        process="in(<L_h.2, senc(m.1, k.2)>);"]:
   [ State_1111111121( ), In( <L_h.2, senc(m.1, k.2)> ), Fr( lock.1 ) ]
  --[ Lock_1( '1', lock.1, 'device' ), Lock( '1', lock.1, 'device' ) ]->
   [ State_111111112111( lock.1, m.1, L_h.2, k.2 ) ]

  /*
  rule (modulo AC) inLhsencmk_0_1111111121[color=#408078,
                                           process="in(<L_h.2, senc(m.1, k.2)>);"]:
     [ State_1111111121( ), In( <L_h, senc(m, k)> ), Fr( lock ) ]
    --[ Lock_1( '1', lock, 'device' ), Lock( '1', lock, 'device' ) ]->
     [ State_111111112111( lock, m, L_h, k ) ]
  */

rule (modulo E) lookupobjLhasv_0_111111112111[color=#408078,
                                              process="lookup <'obj', L_h.2> as v.1"]:
   [ State_111111112111( lock.1, m.1, L_h.2, k.2 ) ]
  --[ IsIn( <'obj', L_h.2>, v.1 ) ]->
   [ State_1111111121111( lock.1, m.1, v.1, L_h.2, k.2 ) ]

  /*
  rule (modulo AC) lookupobjLhasv_0_111111112111[color=#408078,
                                                 process="lookup <'obj', L_h.2> as v.1"]:
     [ State_111111112111( lock, m, L_h, k ) ]
    --[ IsIn( <'obj', L_h>, v ) ]->
     [ State_1111111121111( lock, m, v, L_h, k ) ]
  */

restriction Restr_ifCandecryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_1111111121111_1:
  "∀ x #NOW.
    (Restr_ifCandecryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_1111111121111_1( x
     ) @ #NOW) ⇒
    (x = 'on')"
  // safety formula

rule (modulo E) ifCandecryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_1111111121111[color=#408078,
                                                                                                                                                      process="if Can_decrypt( attwrap(tem(v.1)), attunwrap(tem(v.1)),
             attenc(tem(v.1)), attdec(tem(v.1)), attsens(tem(v.1)),
             attextr(tem(v.1)), atttrus(tem(v.1)), attwwt(tem(v.1)),
             attwt(tem(v.1)), attut(tem(v.1))
)"]:
   [ State_1111111121111( lock.1, m.1, v.1, L_h.2, k.2 ) ]
  --[
  Restr_ifCandecryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_1111111121111_1( attdec(tem(v.1))
  )
  ]->
   [ State_11111111211111( lock.1, m.1, v.1, L_h.2, k.2 ) ]

  /*
  rule (modulo AC) ifCandecryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_1111111121111[color=#408078,
                                                                                                                                                         process="if Can_decrypt( attwrap(tem(v.1)), attunwrap(tem(v.1)),
             attenc(tem(v.1)), attdec(tem(v.1)), attsens(tem(v.1)),
             attextr(tem(v.1)), atttrus(tem(v.1)), attwwt(tem(v.1)),
             attwt(tem(v.1)), attut(tem(v.1))
)"]:
     [ State_1111111121111( lock, m, v, L_h, k ) ]
    --[
    Restr_ifCandecryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_1111111121111_1( z
    )
    ]->
     [ State_11111111211111( lock, m, v, L_h, k ) ]
    variants (modulo AC)
    1. v     = v.9
       z     = attdec(tem(v.9))
    
    2. v     = <x.9, x.10>
       z     = attdec(x.10)
    
    3. v     = <x.9, x.10, x.11, x.12, x.13, x.14, x.15, x.16, x.17, x.18, 
                x.19>
       z     = x.13
  */

rule (modulo E) ifkeyvk_0_11111111211111[color=#408078,
                                         process="if key(v.1)=k.2"]:
   [ State_11111111211111( lock.1, m.1, v.1, L_h.2, k.2 ) ]
  --[ Pred_Eq( key(v.1), k.2 ) ]->
   [ State_111111112111111( lock.1, m.1, v.1, L_h.2, k.2 ) ]

  /*
  rule (modulo AC) ifkeyvk_0_11111111211111[color=#408078,
                                            process="if key(v.1)=k.2"]:
     [ State_11111111211111( lock, m, v, L_h, k ) ]
    --[ Pred_Eq( z, k ) ]->
     [ State_111111112111111( lock, m, v, L_h, k ) ]
    variants (modulo AC)
    1. v     = v.9
       z     = key(v.9)
    
    2. v     = <x.9, x.10>
       z     = x.9
  */

rule (modulo E) eventDecUsingkm_0_111111112111111[color=#408078,
                                                  process="event DecUsing( k.2, m.1 );"]:
   [ State_111111112111111( lock.1, m.1, v.1, L_h.2, k.2 ) ]
  --[ DecUsing( k.2, m.1 ) ]->
   [ State_11111111211111111( lock.1, m.1, v.1, L_h.2, k.2 ), Out( m.1 ) ]

  /*
  rule (modulo AC) eventDecUsingkm_0_111111112111111[color=#408078,
                                                     process="event DecUsing( k.2, m.1 );"]:
     [ State_111111112111111( lock, m, v, L_h, k ) ]
    --[ DecUsing( k, m ) ]->
     [ State_11111111211111111( lock, m, v, L_h, k ), Out( m ) ]
  */

rule (modulo E) unlockdevice_0_11111111211111111[color=#408078,
                                                 process="unlock 'device';"]:
   [ State_11111111211111111( lock.1, m.1, v.1, L_h.2, k.2 ) ]
  --[ Unlock_1( '1', lock.1, 'device' ), Unlock( '1', lock.1, 'device' )
  ]->
   [ ]

  /*
  rule (modulo AC) unlockdevice_0_11111111211111111[color=#408078,
                                                    process="unlock 'device';"]:
     [ State_11111111211111111( lock, m, v, L_h, k ) ]
    --[ Unlock_1( '1', lock, 'device' ), Unlock( '1', lock, 'device' ) ]->
     [ ]
  */

rule (modulo E) ifkeyvk_1_11111111211111[color=#408078,
                                         process="if key(v.1)=k.2"]:
   [ State_11111111211111( lock.1, m.1, v.1, L_h.2, k.2 ) ]
  --[ Pred_Not_Eq( key(v.1), k.2 ) ]->
   [ ]

  /*
  rule (modulo AC) ifkeyvk_1_11111111211111[color=#408078,
                                            process="if key(v.1)=k.2"]:
     [ State_11111111211111( lock, m, v, L_h, k ) ]
    --[ Pred_Not_Eq( z, k ) ]->
     [ ]
    variants (modulo AC)
    1. v     = v.9
       z     = key(v.9)
    
    2. v     = <x.9, x.10>
       z     = x.9
  */

rule (modulo E) lookupobjLhasv_1_111111112111[color=#408078,
                                              process="lookup <'obj', L_h.2> as v.1"]:
   [ State_111111112111( lock.1, m.1, L_h.2, k.2 ) ]
  --[ IsNotSet( <'obj', L_h.2> ) ]->
   [ ]

  /*
  rule (modulo AC) lookupobjLhasv_1_111111112111[color=#408078,
                                                 process="lookup <'obj', L_h.2> as v.1"]:
     [ State_111111112111( lock, m, L_h, k ) ]
    --[ IsNotSet( <'obj', L_h> ) ]->
     [ ]
  */

rule (modulo E) inLhm_0_111111121[color=#408071,
                                  process="in(<L_h.3, m.2>);"]:
   [ State_111111121( ), In( <L_h.3, m.2> ), Fr( lock.2 ) ]
  --[ Lock_2( '2', lock.2, 'device' ), Lock( '2', lock.2, 'device' ) ]->
   [ State_11111112111( lock.2, m.2, L_h.3 ) ]

  /*
  rule (modulo AC) inLhm_0_111111121[color=#408071,
                                     process="in(<L_h.3, m.2>);"]:
     [ State_111111121( ), In( <L_h, m> ), Fr( lock ) ]
    --[ Lock_2( '2', lock, 'device' ), Lock( '2', lock, 'device' ) ]->
     [ State_11111112111( lock, m, L_h ) ]
  */

rule (modulo E) lookupobjLhasv_0_11111112111[color=#408071,
                                             process="lookup <'obj', L_h.3> as v.2"]:
   [ State_11111112111( lock.2, m.2, L_h.3 ) ]
  --[ IsIn( <'obj', L_h.3>, v.2 ) ]->
   [ State_111111121111( lock.2, m.2, v.2, L_h.3 ) ]

  /*
  rule (modulo AC) lookupobjLhasv_0_11111112111[color=#408071,
                                                process="lookup <'obj', L_h.3> as v.2"]:
     [ State_11111112111( lock, m, L_h ) ]
    --[ IsIn( <'obj', L_h>, v ) ]->
     [ State_111111121111( lock, m, v, L_h ) ]
  */

restriction Restr_ifCanencryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111121111_1:
  "∀ x #NOW.
    (Restr_ifCanencryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111121111_1( x
     ) @ #NOW) ⇒
    (x = 'on')"
  // safety formula

rule (modulo E) ifCanencryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111121111[color=#408071,
                                                                                                                                                     process="if Can_encrypt( attwrap(tem(v.2)), attunwrap(tem(v.2)),
             attenc(tem(v.2)), attdec(tem(v.2)), attsens(tem(v.2)),
             attextr(tem(v.2)), atttrus(tem(v.2)), attwwt(tem(v.2)),
             attwt(tem(v.2)), attut(tem(v.2))
)"]:
   [ State_111111121111( lock.2, m.2, v.2, L_h.3 ) ]
  --[
  EncUsing( key(v.2), m.2 ),
  Restr_ifCanencryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111121111_1( attenc(tem(v.2))
  )
  ]->
   [
   State_111111121111111( lock.2, m.2, v.2, L_h.3 ),
   Out( senc(m.2, key(v.2)) )
   ]

  /*
  rule (modulo AC) ifCanencryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111121111[color=#408071,
                                                                                                                                                        process="if Can_encrypt( attwrap(tem(v.2)), attunwrap(tem(v.2)),
             attenc(tem(v.2)), attdec(tem(v.2)), attsens(tem(v.2)),
             attextr(tem(v.2)), atttrus(tem(v.2)), attwwt(tem(v.2)),
             attwt(tem(v.2)), attut(tem(v.2))
)"]:
     [ State_111111121111( lock, m, v, L_h ) ]
    --[
    EncUsing( z, m ),
    Restr_ifCanencryptattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111121111_1( z.1
    )
    ]->
     [ State_111111121111111( lock, m, v, L_h ), Out( senc(m, z) ) ]
    variants (modulo AC)
    1. v     = v.10
       z     = key(v.10)
       z.1   = attenc(tem(v.10))
    
    2. v     = <x.10, x.11>
       z     = x.10
       z.1   = attenc(x.11)
    
    3. v     = <x.10, x.11, x.12, x.13, x.14, x.15, x.16, x.17, x.18, x.19, 
                x.20>
       z     = x.10
       z.1   = x.13
  */

rule (modulo E) unlockdevice_0_111111121111111[color=#408071,
                                               process="unlock 'device';"]:
   [ State_111111121111111( lock.2, m.2, v.2, L_h.3 ) ]
  --[ Unlock_2( '2', lock.2, 'device' ), Unlock( '2', lock.2, 'device' )
  ]->
   [ ]

  /*
  rule (modulo AC) unlockdevice_0_111111121111111[color=#408071,
                                                  process="unlock 'device';"]:
     [ State_111111121111111( lock, m, v, L_h ) ]
    --[ Unlock_2( '2', lock, 'device' ), Unlock( '2', lock, 'device' ) ]->
     [ ]
  */

rule (modulo E) lookupobjLhasv_1_11111112111[color=#408071,
                                             process="lookup <'obj', L_h.3> as v.2"]:
   [ State_11111112111( lock.2, m.2, L_h.3 ) ]
  --[ IsNotSet( <'obj', L_h.3> ) ]->
   [ ]

  /*
  rule (modulo AC) lookupobjLhasv_1_11111112111[color=#408071,
                                                process="lookup <'obj', L_h.3> as v.2"]:
     [ State_11111112111( lock, m, L_h ) ]
    --[ IsNotSet( <'obj', L_h> ) ]->
     [ ]
  */

rule (modulo E) inhh_0_11111121[color=#408044,
                                process="in(<h1.1, h2.1>);"]:
   [ State_11111121( ), In( <h1.1, h2.1> ), Fr( lock.3 ) ]
  --[ Lock_3( '3', lock.3, 'device' ), Lock( '3', lock.3, 'device' ) ]->
   [ State_1111112111( h1.1, h2.1, lock.3 ) ]

  /*
  rule (modulo AC) inhh_0_11111121[color=#408044,
                                   process="in(<h1.1, h2.1>);"]:
     [ State_11111121( ), In( <h1, h2> ), Fr( lock ) ]
    --[ Lock_3( '3', lock, 'device' ), Lock( '3', lock, 'device' ) ]->
     [ State_1111112111( h1, h2, lock ) ]
  */

rule (modulo E) lookupobjhasv_0_1111112111[color=#408044,
                                           process="lookup <'obj', h1.1> as v1.1"]:
   [ State_1111112111( h1.1, h2.1, lock.3 ) ]
  --[ IsIn( <'obj', h1.1>, v1.1 ) ]->
   [ State_11111121111( h1.1, h2.1, v1.1, lock.3 ) ]

  /*
  rule (modulo AC) lookupobjhasv_0_1111112111[color=#408044,
                                              process="lookup <'obj', h1.1> as v1.1"]:
     [ State_1111112111( h1, h2, lock ) ]
    --[ IsIn( <'obj', h1>, v1 ) ]->
     [ State_11111121111( h1, h2, v1, lock ) ]
  */

rule (modulo E) lookupobjhasv_0_11111121111[color=#408044,
                                            process="lookup <'obj', h2.1> as v2.1"]:
   [ State_11111121111( h1.1, h2.1, v1.1, lock.3 ) ]
  --[ IsIn( <'obj', h2.1>, v2.1 ) ]->
   [ State_111111211111( h1.1, h2.1, v1.1, v2.1, lock.3 ) ]

  /*
  rule (modulo AC) lookupobjhasv_0_11111121111[color=#408044,
                                               process="lookup <'obj', h2.1> as v2.1"]:
     [ State_11111121111( h1, h2, v1, lock ) ]
    --[ IsIn( <'obj', h2>, v2 ) ]->
     [ State_111111211111( h1, h2, v1, v2, lock ) ]
  */

restriction Restr_ifCanwrapattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemvattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111211111_1:
  "∀ x #NOW x.1 x.2 x.3 x.4.
    (Restr_ifCanwrapattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemvattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111211111_1( x,
                                                                                                                                                                                                                                                         x.1,
                                                                                                                                                                                                                                                         x.2,
                                                                                                                                                                                                                                                         x.3,
                                                                                                                                                                                                                                                         x.4
     ) @ #NOW) ⇒
    (((x = 'on') ∧ (x.1 = 'on')) ∧
     ((x.2 = 'off') ∨ ((x.3 = 'on') ∧ (x.4 = 'on'))))"
  // safety formula

rule (modulo E) ifCanwrapattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemvattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111211111[color=#408044,
                                                                                                                                                                                                                                                           process="if Can_wrap( attwrap(tem(v1.1)), attunwrap(tem(v1.1)),
          attenc(tem(v1.1)), attdec(tem(v1.1)), attsens(tem(v1.1)),
          attextr(tem(v1.1)), atttrus(tem(v1.1)), attwwt(tem(v1.1)),
          attwt(tem(v1.1)), attut(tem(v1.1)), attwrap(tem(v2.1)),
          attunwrap(tem(v2.1)), attenc(tem(v2.1)), attdec(tem(v2.1)),
          attsens(tem(v2.1)), attextr(tem(v2.1)), atttrus(tem(v2.1)),
          attwwt(tem(v2.1)), attwt(tem(v2.1)), attut(tem(v2.1))
)"]:
   [ State_111111211111( h1.1, h2.1, v1.1, v2.1, lock.3 ) ]
  --[
  Restr_ifCanwrapattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemvattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111211111_1( attwrap(tem(v1.1)),
                                                                                                                                                                                                                                                      attextr(tem(v2.1)),
                                                                                                                                                                                                                                                      attwwt(tem(v2.1)),
                                                                                                                                                                                                                                                      attwwt(tem(v2.1)),
                                                                                                                                                                                                                                                      atttrus(tem(v1.1))
  )
  ]->
   [ State_1111112111111( h1.1, h2.1, v1.1, v2.1, lock.3 ) ]

  /*
  rule (modulo AC) ifCanwrapattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemvattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111211111[color=#408044,
                                                                                                                                                                                                                                                              process="if Can_wrap( attwrap(tem(v1.1)), attunwrap(tem(v1.1)),
          attenc(tem(v1.1)), attdec(tem(v1.1)), attsens(tem(v1.1)),
          attextr(tem(v1.1)), atttrus(tem(v1.1)), attwwt(tem(v1.1)),
          attwt(tem(v1.1)), attut(tem(v1.1)), attwrap(tem(v2.1)),
          attunwrap(tem(v2.1)), attenc(tem(v2.1)), attdec(tem(v2.1)),
          attsens(tem(v2.1)), attextr(tem(v2.1)), atttrus(tem(v2.1)),
          attwwt(tem(v2.1)), attwt(tem(v2.1)), attut(tem(v2.1))
)"]:
     [ State_111111211111( h1, h2, v1, v2, lock ) ]
    --[
    Restr_ifCanwrapattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemvattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111111211111_1( z,
                                                                                                                                                                                                                                                        z.1,
                                                                                                                                                                                                                                                        z.2,
                                                                                                                                                                                                                                                        z.2,
                                                                                                                                                                                                                                                        z.3
    )
    ]->
     [ State_1111112111111( h1, h2, v1, v2, lock ) ]
    variants (modulo AC)
    1. v1    = v1.13
       v2    = v2.13
       z     = attwrap(tem(v1.13))
       z.1   = attextr(tem(v2.13))
       z.2   = attwwt(tem(v2.13))
       z.3   = atttrus(tem(v1.13))
    
    2. v1    = v1.15
       v2    = <x.13, x.14>
       z     = attwrap(tem(v1.15))
       z.1   = attextr(x.14)
       z.2   = attwwt(x.14)
       z.3   = atttrus(tem(v1.15))
    
    3. v1    = v1.24
       v2    = <x.13, x.14, x.15, x.16, x.17, x.18, x.19, x.20, x.21, x.22, x.23
               >
       z     = attwrap(tem(v1.24))
       z.1   = x.19
       z.2   = x.21
       z.3   = atttrus(tem(v1.24))
    
    4. v1    = <x.13, x.14>
       v2    = v2.15
       z     = attwrap(x.14)
       z.1   = attextr(tem(v2.15))
       z.2   = attwwt(tem(v2.15))
       z.3   = atttrus(x.14)
    
    5. v1    = <x.13, x.14>
       v2    = <x.15, x.16>
       z     = attwrap(x.14)
       z.1   = attextr(x.16)
       z.2   = attwwt(x.16)
       z.3   = atttrus(x.14)
    
    6. v1    = <x.13, x.14>
       v2    = <x.15, x.16, x.17, x.18, x.19, x.20, x.21, x.22, x.23, x.24, x.25
               >
       z     = attwrap(x.14)
       z.1   = x.21
       z.2   = x.23
       z.3   = atttrus(x.14)
    
    7. v1    = <x.13, x.14, x.15, x.16, x.17, x.18, x.19, x.20, x.21, x.22, 
                x.23>
       v2    = v2.24
       z     = x.14
       z.1   = attextr(tem(v2.24))
       z.2   = attwwt(tem(v2.24))
       z.3   = x.20
    
    8. v1    = <x.13, x.14, x.15, x.16, x.17, x.18, x.19, x.20, x.21, x.22, 
                x.23>
       v2    = <x.24, x.25>
       z     = x.14
       z.1   = attextr(x.25)
       z.2   = attwwt(x.25)
       z.3   = x.20
    
    9. v1    = <x.13, x.14, x.15, x.16, x.17, x.18, x.19, x.20, x.21, x.22, 
                x.23>
       v2    = <x.24, x.25, x.26, x.27, x.28, x.29, x.30, x.31, x.32, x.33, x.34
               >
       z     = x.14
       z.1   = x.30
       z.2   = x.32
       z.3   = x.20
  */

rule (modulo E) lookupFtemplateattwttemvaswt_0_1111112111111[color=#408044,
                                                             process="lookup <'F_template', attwt(tem(v1.1))> as wt.1"]:
   [ State_1111112111111( h1.1, h2.1, v1.1, v2.1, lock.3 ) ]
  --[ IsIn( <'F_template', attwt(tem(v1.1))>, wt.1 ) ]->
   [ State_11111121111111( h1.1, h2.1, v1.1, v2.1, wt.1, lock.3 ) ]

  /*
  rule (modulo AC) lookupFtemplateattwttemvaswt_0_1111112111111[color=#408044,
                                                                process="lookup <'F_template', attwt(tem(v1.1))> as wt.1"]:
     [ State_1111112111111( h1, h2, v1, v2, lock ) ]
    --[ IsIn( <'F_template', z>, wt ) ]->
     [ State_11111121111111( h1, h2, v1, v2, wt, lock ) ]
    variants (modulo AC)
    1. v1    = v1.13
       z     = attwt(tem(v1.13))
    
    2. v1    = <x.14, x.15>
       z     = attwt(x.15)
    
    3. v1    = <x.24, x.25, x.26, x.27, x.28, x.29, x.30, x.31, x.32, z.23, 
                x.34>
       z     = z.23
  */

restriction Restr_ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_1:
  "∀ x #NOW x.1 x.2 x.3 x.4 x.5 x.6 x.7 x.8 x.9 x.10 x.11 x.12 x.13 x.14
     x.15 x.16 x.17 x.18 x.19.
    (Restr_ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_1( x,
                                                                                                                                                                                                                                       x.1,
                                                                                                                                                                                                                                       x.2,
                                                                                                                                                                                                                                       x.3,
                                                                                                                                                                                                                                       x.4,
                                                                                                                                                                                                                                       x.5,
                                                                                                                                                                                                                                       x.6,
                                                                                                                                                                                                                                       x.7,
                                                                                                                                                                                                                                       x.8,
                                                                                                                                                                                                                                       x.9,
                                                                                                                                                                                                                                       x.10,
                                                                                                                                                                                                                                       x.11,
                                                                                                                                                                                                                                       x.12,
                                                                                                                                                                                                                                       x.13,
                                                                                                                                                                                                                                       x.14,
                                                                                                                                                                                                                                       x.15,
                                                                                                                                                                                                                                       x.16,
                                                                                                                                                                                                                                       x.17,
                                                                                                                                                                                                                                       x.18,
                                                                                                                                                                                                                                       x.19
     ) @ #NOW) ⇒
    ((((((((((x = x.1) ∧ (x.2 = x.3)) ∧ (x.4 = x.5)) ∧ (x.6 = x.7)) ∧
          (x.8 = x.9)) ∧
         (x.10 = x.11)) ∧
        (x.12 = x.13)) ∧
       (x.14 = x.15)) ∧
      (x.16 = x.17)) ∧
     (x.18 = x.19))"
  // safety formula

rule (modulo E) ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111[color=#408044,
                                                                                                                                                                                                                                         process="if Permits( attwrap(wt.1), attunwrap(wt.1), attenc(wt.1),
         attdec(wt.1), attsens(wt.1), attextr(wt.1), atttrus(wt.1),
         attwwt(wt.1), attwt(wt.1), attut(wt.1), attwrap(tem(v2.1)),
         attunwrap(tem(v2.1)), attenc(tem(v2.1)), attdec(tem(v2.1)),
         attsens(tem(v2.1)), attextr(tem(v2.1)), atttrus(tem(v2.1)),
         attwwt(tem(v2.1)), attwt(tem(v2.1)), attut(tem(v2.1))
)"]:
   [ State_11111121111111( h1.1, h2.1, v1.1, v2.1, wt.1, lock.3 ) ]
  --[
  Wrap( key(v1.1), key(v2.1) ),
  Restr_ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_1( attwrap(wt.1),
                                                                                                                                                                                                                                    attwrap(tem(v2.1)),
                                                                                                                                                                                                                                    attunwrap(wt.1),
                                                                                                                                                                                                                                    attunwrap(tem(v2.1)),
                                                                                                                                                                                                                                    attenc(wt.1),
                                                                                                                                                                                                                                    attenc(tem(v2.1)),
                                                                                                                                                                                                                                    attdec(wt.1),
                                                                                                                                                                                                                                    attdec(tem(v2.1)),
                                                                                                                                                                                                                                    attsens(wt.1),
                                                                                                                                                                                                                                    attsens(tem(v2.1)),
                                                                                                                                                                                                                                    attextr(wt.1),
                                                                                                                                                                                                                                    attextr(tem(v2.1)),
                                                                                                                                                                                                                                    atttrus(wt.1),
                                                                                                                                                                                                                                    atttrus(tem(v2.1)),
                                                                                                                                                                                                                                    attwwt(wt.1),
                                                                                                                                                                                                                                    attwwt(tem(v2.1)),
                                                                                                                                                                                                                                    attwt(wt.1),
                                                                                                                                                                                                                                    attwt(tem(v2.1)),
                                                                                                                                                                                                                                    attut(wt.1),
                                                                                                                                                                                                                                    attut(tem(v2.1))
  )
  ]->
   [
   State_11111121111111111( h1.1, h2.1, v1.1, v2.1, wt.1, lock.3 ),
   Out( senc(key(v2.1), key(v1.1)) )
   ]

  /*
  rule (modulo AC) ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111[color=#408044,
                                                                                                                                                                                                                                            process="if Permits( attwrap(wt.1), attunwrap(wt.1), attenc(wt.1),
         attdec(wt.1), attsens(wt.1), attextr(wt.1), atttrus(wt.1),
         attwwt(wt.1), attwt(wt.1), attut(wt.1), attwrap(tem(v2.1)),
         attunwrap(tem(v2.1)), attenc(tem(v2.1)), attdec(tem(v2.1)),
         attsens(tem(v2.1)), attextr(tem(v2.1)), atttrus(tem(v2.1)),
         attwwt(tem(v2.1)), attwt(tem(v2.1)), attut(tem(v2.1))
)"]:
     [ State_11111121111111( h1, h2, v1, v2, wt, lock ) ]
    --[
    Wrap( z.1, z ),
    Restr_ifPermitsattwrapwtattunwrapwtattencwtattdecwtattsenswtattextrwtatttruswtattwwtwtattwtwtattutwtattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_11111121111111_1( z.2,
                                                                                                                                                                                                                                      z.3,
                                                                                                                                                                                                                                      z.4,
                                                                                                                                                                                                                                      z.5,
                                                                                                                                                                                                                                      z.6,
                                                                                                                                                                                                                                      z.7,
                                                                                                                                                                                                                                      z.8,
                                                                                                                                                                                                                                      z.9,
                                                                                                                                                                                                                                      z.10,
                                                                                                                                                                                                                                      z.11,
                                                                                                                                                                                                                                      z.12,
                                                                                                                                                                                                                                      z.13,
                                                                                                                                                                                                                                      z.14,
                                                                                                                                                                                                                                      z.15,
                                                                                                                                                                                                                                      z.16,
                                                                                                                                                                                                                                      z.17,
                                                                                                                                                                                                                                      z.18,
                                                                                                                                                                                                                                      z.19,
                                                                                                                                                                                                                                      z.20,
                                                                                                                                                                                                                                      z.21
    )
    ]->
     [
     State_11111121111111111( h1, h2, v1, v2, wt, lock ), Out( senc(z, z.1) )
     ]
    variants (modulo AC)
     1. v1    = v1.32
        v2    = v2.32
        wt    = wt.32
        z     = key(v2.32)
        z.1   = key(v1.32)
        z.2   = attwrap(wt.32)
        z.3   = attwrap(tem(v2.32))
        z.4   = attunwrap(wt.32)
        z.5   = attunwrap(tem(v2.32))
        z.6   = attenc(wt.32)
        z.7   = attenc(tem(v2.32))
        z.8   = attdec(wt.32)
        z.9   = attdec(tem(v2.32))
        z.10  = attsens(wt.32)
        z.11  = attsens(tem(v2.32))
        z.12  = attextr(wt.32)
        z.13  = attextr(tem(v2.32))
        z.14  = atttrus(wt.32)
        z.15  = atttrus(tem(v2.32))
        z.16  = attwwt(wt.32)
        z.17  = attwwt(tem(v2.32))
        z.18  = attwt(wt.32)
        z.19  = attwt(tem(v2.32))
        z.20  = attut(wt.32)
        z.21  = attut(tem(v2.32))
    
     2. v1    = v1.34
        v2    = <x.32, x.33>
        wt    = wt.34
        z     = x.32
        z.1   = key(v1.34)
        z.2   = attwrap(wt.34)
        z.3   = attwrap(x.33)
        z.4   = attunwrap(wt.34)
        z.5   = attunwrap(x.33)
        z.6   = attenc(wt.34)
        z.7   = attenc(x.33)
        z.8   = attdec(wt.34)
        z.9   = attdec(x.33)
        z.10  = attsens(wt.34)
        z.11  = attsens(x.33)
        z.12  = attextr(wt.34)
        z.13  = attextr(x.33)
        z.14  = atttrus(wt.34)
        z.15  = atttrus(x.33)
        z.16  = attwwt(wt.34)
        z.17  = attwwt(x.33)
        z.18  = attwt(wt.34)
        z.19  = attwt(x.33)
        z.20  = attut(wt.34)
        z.21  = attut(x.33)
    
     3. v1    = v1.42
        v2    = v2.42
        wt    = <x.32, x.33, x.34, x.35, x.36, x.37, x.38, x.39, x.40, x.41>
        z     = key(v2.42)
        z.1   = key(v1.42)
        z.2   = x.32
        z.3   = attwrap(tem(v2.42))
        z.4   = x.33
        z.5   = attunwrap(tem(v2.42))
        z.6   = x.34
        z.7   = attenc(tem(v2.42))
        z.8   = x.35
        z.9   = attdec(tem(v2.42))
        z.10  = x.36
        z.11  = attsens(tem(v2.42))
        z.12  = x.37
        z.13  = attextr(tem(v2.42))
        z.14  = x.38
        z.15  = atttrus(tem(v2.42))
        z.16  = x.39
        z.17  = attwwt(tem(v2.42))
        z.18  = x.40
        z.19  = attwt(tem(v2.42))
        z.20  = x.41
        z.21  = attut(tem(v2.42))
    
     4. v1    = v1.43
        v2    = <x.32, x.33, x.34, x.35, x.36, x.37, x.38, x.39, x.40, x.41, x.42
                >
        wt    = wt.43
        z     = x.32
        z.1   = key(v1.43)
        z.2   = attwrap(wt.43)
        z.3   = x.33
        z.4   = attunwrap(wt.43)
        z.5   = x.34
        z.6   = attenc(wt.43)
        z.7   = x.35
        z.8   = attdec(wt.43)
        z.9   = x.36
        z.10  = attsens(wt.43)
        z.11  = x.37
        z.12  = attextr(wt.43)
        z.13  = x.38
        z.14  = atttrus(wt.43)
        z.15  = x.39
        z.16  = attwwt(wt.43)
        z.17  = x.40
        z.18  = attwt(wt.43)
        z.19  = x.41
        z.20  = attut(wt.43)
        z.21  = x.42
    
     5. v1    = v1.44
        v2    = <x.32, x.33>
        wt    = <x.34, x.35, x.36, x.37, x.38, x.39, x.40, x.41, x.42, x.43>
        z     = x.32
        z.1   = key(v1.44)
        z.2   = x.34
        z.3   = attwrap(x.33)
        z.4   = x.35
        z.5   = attunwrap(x.33)
        z.6   = x.36
        z.7   = attenc(x.33)
        z.8   = x.37
        z.9   = attdec(x.33)
        z.10  = x.38
        z.11  = attsens(x.33)
        z.12  = x.39
        z.13  = attextr(x.33)
        z.14  = x.40
        z.15  = atttrus(x.33)
        z.16  = x.41
        z.17  = attwwt(x.33)
        z.18  = x.42
        z.19  = attwt(x.33)
        z.20  = x.43
        z.21  = attut(x.33)
    
     6. v1    = v1.53
        v2    = <x.32, x.33, x.34, x.35, x.36, x.37, x.38, x.39, x.40, x.41, x.42
                >
        wt    = <x.43, x.44, x.45, x.46, x.47, x.48, x.49, x.50, x.51, x.52>
        z     = x.32
        z.1   = key(v1.53)
        z.2   = x.43
        z.3   = x.33
        z.4   = x.44
        z.5   = x.34
        z.6   = x.45
        z.7   = x.35
        z.8   = x.46
        z.9   = x.36
        z.10  = x.47
        z.11  = x.37
        z.12  = x.48
        z.13  = x.38
        z.14  = x.49
        z.15  = x.39
        z.16  = x.50
        z.17  = x.40
        z.18  = x.51
        z.19  = x.41
        z.20  = x.52
        z.21  = x.42
    
     7. v1    = <x.32, x.33>
        v2    = v2.34
        wt    = wt.34
        z     = key(v2.34)
        z.1   = x.32
        z.2   = attwrap(wt.34)
        z.3   = attwrap(tem(v2.34))
        z.4   = attunwrap(wt.34)
        z.5   = attunwrap(tem(v2.34))
        z.6   = attenc(wt.34)
        z.7   = attenc(tem(v2.34))
        z.8   = attdec(wt.34)
        z.9   = attdec(tem(v2.34))
        z.10  = attsens(wt.34)
        z.11  = attsens(tem(v2.34))
        z.12  = attextr(wt.34)
        z.13  = attextr(tem(v2.34))
        z.14  = atttrus(wt.34)
        z.15  = atttrus(tem(v2.34))
        z.16  = attwwt(wt.34)
        z.17  = attwwt(tem(v2.34))
        z.18  = attwt(wt.34)
        z.19  = attwt(tem(v2.34))
        z.20  = attut(wt.34)
        z.21  = attut(tem(v2.34))
    
     8. v1    = <x.32, x.33>
        v2    = v2.45
        wt    = <x.35, x.36, x.37, x.38, x.39, x.40, x.41, x.42, x.43, x.44>
        z     = key(v2.45)
        z.1   = x.32
        z.2   = x.35
        z.3   = attwrap(tem(v2.45))
        z.4   = x.36
        z.5   = attunwrap(tem(v2.45))
        z.6   = x.37
        z.7   = attenc(tem(v2.45))
        z.8   = x.38
        z.9   = attdec(tem(v2.45))
        z.10  = x.39
        z.11  = attsens(tem(v2.45))
        z.12  = x.40
        z.13  = attextr(tem(v2.45))
        z.14  = x.41
        z.15  = atttrus(tem(v2.45))
        z.16  = x.42
        z.17  = attwwt(tem(v2.45))
        z.18  = x.43
        z.19  = attwt(tem(v2.45))
        z.20  = x.44
        z.21  = attut(tem(v2.45))
    
     9. v1    = <x.32, x.33>
        v2    = <x.34, x.35>
        wt    = wt.36
        z     = x.34
        z.1   = x.32
        z.2   = attwrap(wt.36)
        z.3   = attwrap(x.35)
        z.4   = attunwrap(wt.36)
        z.5   = attunwrap(x.35)
        z.6   = attenc(wt.36)
        z.7   = attenc(x.35)
        z.8   = attdec(wt.36)
        z.9   = attdec(x.35)
        z.10  = attsens(wt.36)
        z.11  = attsens(x.35)
        z.12  = attextr(wt.36)
        z.13  = attextr(x.35)
        z.14  = atttrus(wt.36)
        z.15  = atttrus(x.35)
        z.16  = attwwt(wt.36)
        z.17  = attwwt(x.35)
        z.18  = attwt(wt.36)
        z.19  = attwt(x.35)
        z.20  = attut(wt.36)
        z.21  = attut(x.35)
    
    10. v1    = <x.32, x.33>
        v2    = <x.34, x.35>
        wt    = <x.36, x.37, x.38, x.39, x.40, x.41, x.42, x.43, x.44, x.45>
        z     = x.34
        z.1   = x.32
        z.2   = x.36
        z.3   = attwrap(x.35)
        z.4   = x.37
        z.5   = attunwrap(x.35)
        z.6   = x.38
        z.7   = attenc(x.35)
        z.8   = x.39
        z.9   = attdec(x.35)
        z.10  = x.40
        z.11  = attsens(x.35)
        z.12  = x.41
        z.13  = attextr(x.35)
        z.14  = x.42
        z.15  = atttrus(x.35)
        z.16  = x.43
        z.17  = attwwt(x.35)
        z.18  = x.44
        z.19  = attwt(x.35)
        z.20  = x.45
        z.21  = attut(x.35)
    
    11. v1    = <x.32, x.33>
        v2    = <x.34, x.35, x.36, x.37, x.38, x.39, x.40, x.41, x.42, x.43, x.44
                >
        wt    = wt.45
        z     = x.34
        z.1   = x.32
        z.2   = attwrap(wt.45)
        z.3   = x.35
        z.4   = attunwrap(wt.45)
        z.5   = x.36
        z.6   = attenc(wt.45)
        z.7   = x.37
        z.8   = attdec(wt.45)
        z.9   = x.38
        z.10  = attsens(wt.45)
        z.11  = x.39
        z.12  = attextr(wt.45)
        z.13  = x.40
        z.14  = atttrus(wt.45)
        z.15  = x.41
        z.16  = attwwt(wt.45)
        z.17  = x.42
        z.18  = attwt(wt.45)
        z.19  = x.43
        z.20  = attut(wt.45)
        z.21  = x.44
    
    12. v1    = <x.32, x.33>
        v2    = <x.34, x.35, x.36, x.37, x.38, x.39, x.40, x.41, x.42, x.43, x.44
                >
        wt    = <x.45, x.46, x.47, x.48, x.49, x.50, x.51, x.52, x.53, x.54>
        z     = x.34
        z.1   = x.32
        z.2   = x.45
        z.3   = x.35
        z.4   = x.46
        z.5   = x.36
        z.6   = x.47
        z.7   = x.37
        z.8   = x.48
        z.9   = x.38
        z.10  = x.49
        z.11  = x.39
        z.12  = x.50
        z.13  = x.40
        z.14  = x.51
        z.15  = x.41
        z.16  = x.52
        z.17  = x.42
        z.18  = x.53
        z.19  = x.43
        z.20  = x.54
        z.21  = x.44
  */

rule (modulo E) unlockdevice_0_11111121111111111[color=#408044,
                                                 process="unlock 'device';"]:
   [ State_11111121111111111( h1.1, h2.1, v1.1, v2.1, wt.1, lock.3 ) ]
  --[ Unlock_3( '3', lock.3, 'device' ), Unlock( '3', lock.3, 'device' )
  ]->
   [ ]

  /*
  rule (modulo AC) unlockdevice_0_11111121111111111[color=#408044,
                                                    process="unlock 'device';"]:
     [ State_11111121111111111( h1, h2, v1, v2, wt, lock ) ]
    --[ Unlock_3( '3', lock, 'device' ), Unlock( '3', lock, 'device' ) ]->
     [ ]
  */

rule (modulo E) lookupFtemplateattwttemvaswt_1_1111112111111[color=#408044,
                                                             process="lookup <'F_template', attwt(tem(v1.1))> as wt.1"]:
   [ State_1111112111111( h1.1, h2.1, v1.1, v2.1, lock.3 ) ]
  --[ IsNotSet( <'F_template', attwt(tem(v1.1))> ) ]->
   [ ]

  /*
  rule (modulo AC) lookupFtemplateattwttemvaswt_1_1111112111111[color=#408044,
                                                                process="lookup <'F_template', attwt(tem(v1.1))> as wt.1"]:
     [ State_1111112111111( h1, h2, v1, v2, lock ) ]
    --[ IsNotSet( <'F_template', z> ) ]->
     [ ]
    variants (modulo AC)
    1. v1    = v1.12
       z     = attwt(tem(v1.12))
    
    2. v1    = <x.13, x.14>
       z     = attwt(x.14)
    
    3. v1    = <x.23, x.24, x.25, x.26, x.27, x.28, x.29, x.30, x.31, z.22, 
                x.33>
       z     = z.22
  */

rule (modulo E) lookupobjhasv_1_11111121111[color=#408044,
                                            process="lookup <'obj', h2.1> as v2.1"]:
   [ State_11111121111( h1.1, h2.1, v1.1, lock.3 ) ]
  --[ IsNotSet( <'obj', h2.1> ) ]->
   [ ]

  /*
  rule (modulo AC) lookupobjhasv_1_11111121111[color=#408044,
                                               process="lookup <'obj', h2.1> as v2.1"]:
     [ State_11111121111( h1, h2, v1, lock ) ]
    --[ IsNotSet( <'obj', h2> ) ]->
     [ ]
  */

rule (modulo E) lookupobjhasv_1_1111112111[color=#408044,
                                           process="lookup <'obj', h1.1> as v1.1"]:
   [ State_1111112111( h1.1, h2.1, lock.3 ) ]
  --[ IsNotSet( <'obj', h1.1> ) ]->
   [ ]

  /*
  rule (modulo AC) lookupobjhasv_1_1111112111[color=#408044,
                                              process="lookup <'obj', h1.1> as v1.1"]:
     [ State_1111112111( h1, h2, lock ) ] --[ IsNotSet( <'obj', h1> ) ]-> [ ]
  */

rule (modulo E) inLhsencmkatts_0_1111121[color=#40804a,
                                         process="in(<L_h.4, senc(m.3, k.3), atts.2>);"]:
   [ State_1111121( ), In( <L_h.4, senc(m.3, k.3), atts.2> ), Fr( lock.4 ) ]
  --[ Lock_4( '4', lock.4, 'device' ), Lock( '4', lock.4, 'device' ) ]->
   [ State_111112111( atts.2, k.3, m.3, L_h.4, lock.4 ) ]

  /*
  rule (modulo AC) inLhsencmkatts_0_1111121[color=#40804a,
                                            process="in(<L_h.4, senc(m.3, k.3), atts.2>);"]:
     [ State_1111121( ), In( <L_h, senc(m, k), atts> ), Fr( lock ) ]
    --[ Lock_4( '4', lock, 'device' ), Lock( '4', lock, 'device' ) ]->
     [ State_111112111( atts, k, m, L_h, lock ) ]
  */

rule (modulo E) lookupobjLhasv_0_111112111[color=#40804a,
                                           process="lookup <'obj', L_h.4> as v.3"]:
   [ State_111112111( atts.2, k.3, m.3, L_h.4, lock.4 ) ]
  --[ IsIn( <'obj', L_h.4>, v.3 ) ]->
   [ State_1111121111( atts.2, k.3, m.3, v.3, L_h.4, lock.4 ) ]

  /*
  rule (modulo AC) lookupobjLhasv_0_111112111[color=#40804a,
                                              process="lookup <'obj', L_h.4> as v.3"]:
     [ State_111112111( atts, k, m, L_h, lock ) ]
    --[ IsIn( <'obj', L_h>, v ) ]->
     [ State_1111121111( atts, k, m, v, L_h, lock ) ]
  */

restriction Restr_ifCanunwrapattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_1111121111_1:
  "∀ x #NOW.
    (Restr_ifCanunwrapattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_1111121111_1( x
     ) @ #NOW) ⇒
    (x = 'on')"
  // safety formula

rule (modulo E) ifCanunwrapattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_1111121111[color=#40804a,
                                                                                                                                                  process="if Can_unwrap( attwrap(tem(v.3)), attunwrap(tem(v.3)),
            attenc(tem(v.3)), attdec(tem(v.3)), attsens(tem(v.3)),
            attextr(tem(v.3)), atttrus(tem(v.3)), attwwt(tem(v.3)),
            attwt(tem(v.3)), attut(tem(v.3))
)"]:
   [ State_1111121111( atts.2, k.3, m.3, v.3, L_h.4, lock.4 ) ]
  --[
  Restr_ifCanunwrapattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_1111121111_1( attunwrap(tem(v.3))
  )
  ]->
   [ State_11111211111( atts.2, k.3, m.3, v.3, L_h.4, lock.4 ) ]

  /*
  rule (modulo AC) ifCanunwrapattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_1111121111[color=#40804a,
                                                                                                                                                     process="if Can_unwrap( attwrap(tem(v.3)), attunwrap(tem(v.3)),
            attenc(tem(v.3)), attdec(tem(v.3)), attsens(tem(v.3)),
            attextr(tem(v.3)), atttrus(tem(v.3)), attwwt(tem(v.3)),
            attwt(tem(v.3)), attut(tem(v.3))
)"]:
     [ State_1111121111( atts, k, m, v, L_h, lock ) ]
    --[
    Restr_ifCanunwrapattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_1111121111_1( z
    )
    ]->
     [ State_11111211111( atts, k, m, v, L_h, lock ) ]
    variants (modulo AC)
    1. v     = v.13
       z     = attunwrap(tem(v.13))
    
    2. v     = <x.12, x.13>
       z     = attunwrap(x.13)
    
    3. v     = <x.12, x.13, x.14, x.15, x.16, x.17, x.18, x.19, x.20, x.21, 
                x.22>
       z     = x.14
  */

rule (modulo E) ifkeyvk_0_11111211111[color=#40804a,
                                      process="if key(v.3)=k.3"]:
   [ State_11111211111( atts.2, k.3, m.3, v.3, L_h.4, lock.4 ) ]
  --[ Pred_Eq( key(v.3), k.3 ) ]->
   [ State_111112111111( atts.2, k.3, m.3, v.3, L_h.4, lock.4 ) ]

  /*
  rule (modulo AC) ifkeyvk_0_11111211111[color=#40804a,
                                         process="if key(v.3)=k.3"]:
     [ State_11111211111( atts, k, m, v, L_h, lock ) ]
    --[ Pred_Eq( z, k ) ]->
     [ State_111112111111( atts, k, m, v, L_h, lock ) ]
    variants (modulo AC)
    1. v     = v.13
       z     = key(v.13)
    
    2. v     = <x.12, x.13>
       z     = x.12
  */

rule (modulo E) lookupFtemplateattuttemvasut_0_111112111111[color=#40804a,
                                                            process="lookup <'F_template', attut(tem(v.3))> as ut.1"]:
   [ State_111112111111( atts.2, k.3, m.3, v.3, L_h.4, lock.4 ) ]
  --[ IsIn( <'F_template', attut(tem(v.3))>, ut.1 ) ]->
   [ State_1111121111111( ut.1, atts.2, k.3, m.3, v.3, L_h.4, lock.4 ) ]

  /*
  rule (modulo AC) lookupFtemplateattuttemvasut_0_111112111111[color=#40804a,
                                                               process="lookup <'F_template', attut(tem(v.3))> as ut.1"]:
     [ State_111112111111( atts, k, m, v, L_h, lock ) ]
    --[ IsIn( <'F_template', z>, ut ) ]->
     [ State_1111121111111( ut, atts, k, m, v, L_h, lock ) ]
    variants (modulo AC)
    1. v     = v.15
       z     = attut(tem(v.15))
    
    2. v     = <x.16, x.17>
       z     = attut(x.17)
    
    3. v     = <x.26, x.27, x.28, x.29, x.30, x.31, x.32, x.33, x.34, x.35, 
                z.25>
       z     = z.25
  */

restriction Restr_ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111_1:
  "∀ x #NOW x.1 x.2 x.3 x.4 x.5 x.6 x.7 x.8 x.9 x.10 x.11 x.12 x.13 x.14
     x.15 x.16 x.17 x.18 x.19.
    (Restr_ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111_1( x,
                                                                                                                                                                                                                                      x.1,
                                                                                                                                                                                                                                      x.2,
                                                                                                                                                                                                                                      x.3,
                                                                                                                                                                                                                                      x.4,
                                                                                                                                                                                                                                      x.5,
                                                                                                                                                                                                                                      x.6,
                                                                                                                                                                                                                                      x.7,
                                                                                                                                                                                                                                      x.8,
                                                                                                                                                                                                                                      x.9,
                                                                                                                                                                                                                                      x.10,
                                                                                                                                                                                                                                      x.11,
                                                                                                                                                                                                                                      x.12,
                                                                                                                                                                                                                                      x.13,
                                                                                                                                                                                                                                      x.14,
                                                                                                                                                                                                                                      x.15,
                                                                                                                                                                                                                                      x.16,
                                                                                                                                                                                                                                      x.17,
                                                                                                                                                                                                                                      x.18,
                                                                                                                                                                                                                                      x.19
     ) @ #NOW) ⇒
    ((((((((((x = x.1) ∧ (x.2 = x.3)) ∧ (x.4 = x.5)) ∧ (x.6 = x.7)) ∧
          (x.8 = x.9)) ∧
         (x.10 = x.11)) ∧
        (x.12 = x.13)) ∧
       (x.14 = x.15)) ∧
      (x.16 = x.17)) ∧
     (x.18 = x.19))"
  // safety formula

rule (modulo E) ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111[color=#40804a,
                                                                                                                                                                                                                                        process="if Permits( attwrap(ut.1), attunwrap(ut.1), attenc(ut.1),
         attdec(ut.1), attsens(ut.1), attextr(ut.1), atttrus(ut.1),
         attwwt(ut.1), attwt(ut.1), attut(ut.1), attwrap(atts.2),
         attunwrap(atts.2), attenc(atts.2), attdec(atts.2), attsens(atts.2),
         attextr(atts.2), atttrus(atts.2), attwwt(atts.2), attwt(atts.2),
         attut(atts.2)
)"]:
   [
   State_1111121111111( ut.1, atts.2, k.3, m.3, v.3, L_h.4, lock.4 ),
   Fr( h2.2 )
   ]
  --[
  Insert( <'obj', h2.2>, <m.3, atts.2> ),
  Restr_ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111_1( attwrap(ut.1),
                                                                                                                                                                                                                                   attwrap(atts.2),
                                                                                                                                                                                                                                   attunwrap(ut.1),
                                                                                                                                                                                                                                   attunwrap(atts.2),
                                                                                                                                                                                                                                   attenc(ut.1),
                                                                                                                                                                                                                                   attenc(atts.2),
                                                                                                                                                                                                                                   attdec(ut.1),
                                                                                                                                                                                                                                   attdec(atts.2),
                                                                                                                                                                                                                                   attsens(ut.1),
                                                                                                                                                                                                                                   attsens(atts.2),
                                                                                                                                                                                                                                   attextr(ut.1),
                                                                                                                                                                                                                                   attextr(atts.2),
                                                                                                                                                                                                                                   atttrus(ut.1),
                                                                                                                                                                                                                                   atttrus(atts.2),
                                                                                                                                                                                                                                   attwwt(ut.1),
                                                                                                                                                                                                                                   attwwt(atts.2),
                                                                                                                                                                                                                                   attwt(ut.1),
                                                                                                                                                                                                                                   attwt(atts.2),
                                                                                                                                                                                                                                   attut(ut.1),
                                                                                                                                                                                                                                   attut(atts.2)
  )
  ]->
   [
   State_1111121111111111( ut.1, atts.2, h2.2, k.3, m.3, v.3, L_h.4, lock.4
   )
   ]

  /*
  rule (modulo AC) ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111[color=#40804a,
                                                                                                                                                                                                                                           process="if Permits( attwrap(ut.1), attunwrap(ut.1), attenc(ut.1),
         attdec(ut.1), attsens(ut.1), attextr(ut.1), atttrus(ut.1),
         attwwt(ut.1), attwt(ut.1), attut(ut.1), attwrap(atts.2),
         attunwrap(atts.2), attenc(atts.2), attdec(atts.2), attsens(atts.2),
         attextr(atts.2), atttrus(atts.2), attwwt(atts.2), attwt(atts.2),
         attut(atts.2)
)"]:
     [ State_1111121111111( ut, atts, k, m, v, L_h, lock ), Fr( h2 ) ]
    --[
    Insert( <'obj', h2>, <m, atts> ),
    Restr_ifPermitsattwraputattunwraputattencutattdecutattsensutattextrutatttrusutattwwtutattwtutattututattwrapattsattunwrapattsattencattsattdecattsattsensattsattextrattsatttrusattsattwwtattsattwtattsattutatts_0_1111121111111_1( z,
                                                                                                                                                                                                                                     z.1,
                                                                                                                                                                                                                                     z.2,
                                                                                                                                                                                                                                     z.3,
                                                                                                                                                                                                                                     z.4,
                                                                                                                                                                                                                                     z.5,
                                                                                                                                                                                                                                     z.6,
                                                                                                                                                                                                                                     z.7,
                                                                                                                                                                                                                                     z.8,
                                                                                                                                                                                                                                     z.9,
                                                                                                                                                                                                                                     z.10,
                                                                                                                                                                                                                                     z.11,
                                                                                                                                                                                                                                     z.12,
                                                                                                                                                                                                                                     z.13,
                                                                                                                                                                                                                                     z.14,
                                                                                                                                                                                                                                     z.15,
                                                                                                                                                                                                                                     z.16,
                                                                                                                                                                                                                                     z.17,
                                                                                                                                                                                                                                     z.18,
                                                                                                                                                                                                                                     z.19
    )
    ]->
     [ State_1111121111111111( ut, atts, h2, k, m, v, L_h, lock ) ]
    variants (modulo AC)
    1. atts  = atts.37
       ut    = ut.36
       z     = attwrap(ut.36)
       z.1   = attwrap(atts.37)
       z.2   = attunwrap(ut.36)
       z.3   = attunwrap(atts.37)
       z.4   = attenc(ut.36)
       z.5   = attenc(atts.37)
       z.6   = attdec(ut.36)
       z.7   = attdec(atts.37)
       z.8   = attsens(ut.36)
       z.9   = attsens(atts.37)
       z.10  = attextr(ut.36)
       z.11  = attextr(atts.37)
       z.12  = atttrus(ut.36)
       z.13  = atttrus(atts.37)
       z.14  = attwwt(ut.36)
       z.15  = attwwt(atts.37)
       z.16  = attwt(ut.36)
       z.17  = attwt(atts.37)
       z.18  = attut(ut.36)
       z.19  = attut(atts.37)
    
    2. atts  = <z.55, z.57, z.59, z.61, z.63, z.65, z.67, z.69, z.71, z.73>
       ut    = ut.45
       z     = attwrap(ut.45)
       z.1   = z.55
       z.2   = attunwrap(ut.45)
       z.3   = z.57
       z.4   = attenc(ut.45)
       z.5   = z.59
       z.6   = attdec(ut.45)
       z.7   = z.61
       z.8   = attsens(ut.45)
       z.9   = z.63
       z.10  = attextr(ut.45)
       z.11  = z.65
       z.12  = atttrus(ut.45)
       z.13  = z.67
       z.14  = attwwt(ut.45)
       z.15  = z.69
       z.16  = attwt(ut.45)
       z.17  = z.71
       z.18  = attut(ut.45)
       z.19  = z.73
    
    3. atts  = atts.45
       ut    = <z.53, z.55, z.57, z.59, z.61, z.63, z.65, z.67, z.69, z.71>
       z     = z.53
       z.1   = attwrap(atts.45)
       z.2   = z.55
       z.3   = attunwrap(atts.45)
       z.4   = z.57
       z.5   = attenc(atts.45)
       z.6   = z.59
       z.7   = attdec(atts.45)
       z.8   = z.61
       z.9   = attsens(atts.45)
       z.10  = z.63
       z.11  = attextr(atts.45)
       z.12  = z.65
       z.13  = atttrus(atts.45)
       z.14  = z.67
       z.15  = attwwt(atts.45)
       z.16  = z.69
       z.17  = attwt(atts.45)
       z.18  = z.71
       z.19  = attut(atts.45)
    
    4. atts  = <z.55, z.57, z.59, z.61, z.63, z.65, z.67, z.69, z.71, z.73>
       ut    = <z.54, z.56, z.58, z.60, z.62, z.64, z.66, z.68, z.70, z.72>
       z     = z.54
       z.1   = z.55
       z.2   = z.56
       z.3   = z.57
       z.4   = z.58
       z.5   = z.59
       z.6   = z.60
       z.7   = z.61
       z.8   = z.62
       z.9   = z.63
       z.10  = z.64
       z.11  = z.65
       z.12  = z.66
       z.13  = z.67
       z.14  = z.68
       z.15  = z.69
       z.16  = z.70
       z.17  = z.71
       z.18  = z.72
       z.19  = z.73
  */

rule (modulo E) eventUnwrappedhmatts_0_1111121111111111[color=#40804a,
                                                        process="event Unwrapped( h2.2, m.3, atts.2 );"]:
   [
   State_1111121111111111( ut.1, atts.2, h2.2, k.3, m.3, v.3, L_h.4, lock.4
   )
   ]
  --[ Unwrapped( h2.2, m.3, atts.2 ) ]->
   [
   State_11111211111111111( ut.1, atts.2, h2.2, k.3, m.3, v.3, L_h.4, lock.4
   )
   ]

  /*
  rule (modulo AC) eventUnwrappedhmatts_0_1111121111111111[color=#40804a,
                                                           process="event Unwrapped( h2.2, m.3, atts.2 );"]:
     [ State_1111121111111111( ut, atts, h2, k, m, v, L_h, lock ) ]
    --[ Unwrapped( h2, m, atts ) ]->
     [ State_11111211111111111( ut, atts, h2, k, m, v, L_h, lock ) ]
  */

rule (modulo E) eventWrapKeyhmattwrapatts_0_11111211111111111[color=#40804a,
                                                              process="event WrapKey( h2.2, m.3, attwrap(atts.2) );"]:
   [
   State_11111211111111111( ut.1, atts.2, h2.2, k.3, m.3, v.3, L_h.4, lock.4
   )
   ]
  --[ WrapKey( h2.2, m.3, attwrap(atts.2) ) ]->
   [
   State_111112111111111111( ut.1, atts.2, h2.2, k.3, m.3, v.3, L_h.4,
                             lock.4
   )
   ]

  /*
  rule (modulo AC) eventWrapKeyhmattwrapatts_0_11111211111111111[color=#40804a,
                                                                 process="event WrapKey( h2.2, m.3, attwrap(atts.2) );"]:
     [ State_11111211111111111( ut, atts, h2, k, m, v, L_h, lock ) ]
    --[ WrapKey( h2, m, z ) ]->
     [ State_111112111111111111( ut, atts, h2, k, m, v, L_h, lock ) ]
    variants (modulo AC)
    1. atts  = atts.15
       z     = attwrap(atts.15)
    
    2. atts  = <x.14, x.15, x.16, x.17, x.18, x.19, x.20, x.21, x.22, x.23>
       z     = x.14
  */

rule (modulo E) eventDecKeyhmattdecatts_0_111112111111111111[color=#40804a,
                                                             process="event DecKey( h2.2, m.3, attdec(atts.2) );"]:
   [
   State_111112111111111111( ut.1, atts.2, h2.2, k.3, m.3, v.3, L_h.4,
                             lock.4
   )
   ]
  --[ DecKey( h2.2, m.3, attdec(atts.2) ) ]->
   [
   State_1111121111111111111( ut.1, atts.2, h2.2, k.3, m.3, v.3, L_h.4,
                              lock.4
   )
   ]

  /*
  rule (modulo AC) eventDecKeyhmattdecatts_0_111112111111111111[color=#40804a,
                                                                process="event DecKey( h2.2, m.3, attdec(atts.2) );"]:
     [ State_111112111111111111( ut, atts, h2, k, m, v, L_h, lock ) ]
    --[ DecKey( h2, m, z ) ]->
     [ State_1111121111111111111( ut, atts, h2, k, m, v, L_h, lock ) ]
    variants (modulo AC)
    1. atts  = atts.15
       z     = attdec(atts.15)
    
    2. atts  = <x.14, x.15, x.16, x.17, x.18, x.19, x.20, x.21, x.22, x.23>
       z     = x.17
  */

rule (modulo E) eventEncKeyhmattencatts_0_1111121111111111111[color=#40804a,
                                                              process="event EncKey( h2.2, m.3, attenc(atts.2) );"]:
   [
   State_1111121111111111111( ut.1, atts.2, h2.2, k.3, m.3, v.3, L_h.4,
                              lock.4
   )
   ]
  --[ EncKey( h2.2, m.3, attenc(atts.2) ) ]->
   [
   State_11111211111111111111( ut.1, atts.2, h2.2, k.3, m.3, v.3, L_h.4,
                               lock.4
   )
   ]

  /*
  rule (modulo AC) eventEncKeyhmattencatts_0_1111121111111111111[color=#40804a,
                                                                 process="event EncKey( h2.2, m.3, attenc(atts.2) );"]:
     [ State_1111121111111111111( ut, atts, h2, k, m, v, L_h, lock ) ]
    --[ EncKey( h2, m, z ) ]->
     [ State_11111211111111111111( ut, atts, h2, k, m, v, L_h, lock ) ]
    variants (modulo AC)
    1. atts  = atts.15
       z     = attenc(atts.15)
    
    2. atts  = <x.14, x.15, x.16, x.17, x.18, x.19, x.20, x.21, x.22, x.23>
       z     = x.16
  */

rule (modulo E) eventUnwrapKeyhmattunwrapatts_0_11111211111111111111[color=#40804a,
                                                                     process="event UnwrapKey( h2.2, m.3, attunwrap(atts.2) );"]:
   [
   State_11111211111111111111( ut.1, atts.2, h2.2, k.3, m.3, v.3, L_h.4,
                               lock.4
   )
   ]
  --[ UnwrapKey( h2.2, m.3, attunwrap(atts.2) ) ]->
   [
   State_1111121111111111111111( ut.1, atts.2, h2.2, k.3, m.3, v.3, L_h.4,
                                 lock.4
   ),
   Out( h2.2 )
   ]

  /*
  rule (modulo AC) eventUnwrapKeyhmattunwrapatts_0_11111211111111111111[color=#40804a,
                                                                        process="event UnwrapKey( h2.2, m.3, attunwrap(atts.2) );"]:
     [ State_11111211111111111111( ut, atts, h2, k, m, v, L_h, lock ) ]
    --[ UnwrapKey( h2, m, z ) ]->
     [
     State_1111121111111111111111( ut, atts, h2, k, m, v, L_h, lock ),
     Out( h2 )
     ]
    variants (modulo AC)
    1. atts  = atts.15
       z     = attunwrap(atts.15)
    
    2. atts  = <x.14, x.15, x.16, x.17, x.18, x.19, x.20, x.21, x.22, x.23>
       z     = x.15
  */

rule (modulo E) unlockdevice_0_1111121111111111111111[color=#40804a,
                                                      process="unlock 'device';"]:
   [
   State_1111121111111111111111( ut.1, atts.2, h2.2, k.3, m.3, v.3, L_h.4,
                                 lock.4
   )
   ]
  --[ Unlock_4( '4', lock.4, 'device' ), Unlock( '4', lock.4, 'device' )
  ]->
   [ ]

  /*
  rule (modulo AC) unlockdevice_0_1111121111111111111111[color=#40804a,
                                                         process="unlock 'device';"]:
     [ State_1111121111111111111111( ut, atts, h2, k, m, v, L_h, lock ) ]
    --[ Unlock_4( '4', lock, 'device' ), Unlock( '4', lock, 'device' ) ]->
     [ ]
  */

rule (modulo E) lookupFtemplateattuttemvasut_1_111112111111[color=#40804a,
                                                            process="lookup <'F_template', attut(tem(v.3))> as ut.1"]:
   [ State_111112111111( atts.2, k.3, m.3, v.3, L_h.4, lock.4 ) ]
  --[ IsNotSet( <'F_template', attut(tem(v.3))> ) ]->
   [ ]

  /*
  rule (modulo AC) lookupFtemplateattuttemvasut_1_111112111111[color=#40804a,
                                                               process="lookup <'F_template', attut(tem(v.3))> as ut.1"]:
     [ State_111112111111( atts, k, m, v, L_h, lock ) ]
    --[ IsNotSet( <'F_template', z> ) ]->
     [ ]
    variants (modulo AC)
    1. v     = v.14
       z     = attut(tem(v.14))
    
    2. v     = <x.15, x.16>
       z     = attut(x.16)
    
    3. v     = <x.25, x.26, x.27, x.28, x.29, x.30, x.31, x.32, x.33, x.34, 
                z.24>
       z     = z.24
  */

rule (modulo E) ifkeyvk_1_11111211111[color=#40804a,
                                      process="if key(v.3)=k.3"]:
   [ State_11111211111( atts.2, k.3, m.3, v.3, L_h.4, lock.4 ) ]
  --[ Pred_Not_Eq( key(v.3), k.3 ) ]->
   [ ]

  /*
  rule (modulo AC) ifkeyvk_1_11111211111[color=#40804a,
                                         process="if key(v.3)=k.3"]:
     [ State_11111211111( atts, k, m, v, L_h, lock ) ]
    --[ Pred_Not_Eq( z, k ) ]->
     [ ]
    variants (modulo AC)
    1. v     = v.13
       z     = key(v.13)
    
    2. v     = <x.12, x.13>
       z     = x.12
  */

rule (modulo E) lookupobjLhasv_1_111112111[color=#40804a,
                                           process="lookup <'obj', L_h.4> as v.3"]:
   [ State_111112111( atts.2, k.3, m.3, L_h.4, lock.4 ) ]
  --[ IsNotSet( <'obj', L_h.4> ) ]->
   [ ]

  /*
  rule (modulo AC) lookupobjLhasv_1_111112111[color=#40804a,
                                              process="lookup <'obj', L_h.4> as v.3"]:
     [ State_111112111( atts, k, m, L_h, lock ) ]
    --[ IsNotSet( <'obj', L_h> ) ]->
     [ ]
  */

rule (modulo E) p_1_111[color=#ffffff, process="!"]:
   [ !Semistate_1111( ) ]
  -->
   [
   State_111121( ), State_1111121( ), State_11111121( ), State_111111121( ),
   State_1111111121( ), State_1111111111( )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) inLh_0_111121[color=#408051, process="in(L_h.5);"]:
   [ State_111121( ), In( L_h.5 ), Fr( lock.5 ) ]
  --[ Lock_5( '5', lock.5, 'device' ), Lock( '5', lock.5, 'device' ) ]->
   [ State_11112111( L_h.5, lock.5 ) ]

  /*
  rule (modulo AC) inLh_0_111121[color=#408051, process="in(L_h.5);"]:
     [ State_111121( ), In( L_h ), Fr( lock ) ]
    --[ Lock_5( '5', lock, 'device' ), Lock( '5', lock, 'device' ) ]->
     [ State_11112111( L_h, lock ) ]
  */

rule (modulo E) lookupobjLhasv_0_11112111[color=#408051,
                                          process="lookup <'obj', L_h.5> as v.4"]:
   [ State_11112111( L_h.5, lock.5 ) ]
  --[ IsIn( <'obj', L_h.5>, v.4 ) ]->
   [ State_111121111( v.4, L_h.5, lock.5 ) ]

  /*
  rule (modulo AC) lookupobjLhasv_0_11112111[color=#408051,
                                             process="lookup <'obj', L_h.5> as v.4"]:
     [ State_11112111( L_h, lock ) ]
    --[ IsIn( <'obj', L_h>, v ) ]->
     [ State_111121111( v, L_h, lock ) ]
  */

restriction Restr_ifCangetkeyvalueattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111121111_1:
  "∀ x #NOW.
    (Restr_ifCangetkeyvalueattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111121111_1( x
     ) @ #NOW) ⇒
    (x = 'off')"
  // safety formula

rule (modulo E) ifCangetkeyvalueattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111121111[color=#408051,
                                                                                                                                                      process="if Can_get_keyvalue( attwrap(tem(v.4)), attunwrap(tem(v.4)),
                  attenc(tem(v.4)), attdec(tem(v.4)), attsens(tem(v.4)),
                  attextr(tem(v.4)), atttrus(tem(v.4)), attwwt(tem(v.4)),
                  attwt(tem(v.4)), attut(tem(v.4))
)"]:
   [ State_111121111( v.4, L_h.5, lock.5 ) ]
  --[
  GetKeyValue( key(v.4) ),
  Restr_ifCangetkeyvalueattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111121111_1( attsens(tem(v.4))
  )
  ]->
   [ State_111121111111( v.4, L_h.5, lock.5 ), Out( key(v.4) ) ]

  /*
  rule (modulo AC) ifCangetkeyvalueattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111121111[color=#408051,
                                                                                                                                                         process="if Can_get_keyvalue( attwrap(tem(v.4)), attunwrap(tem(v.4)),
                  attenc(tem(v.4)), attdec(tem(v.4)), attsens(tem(v.4)),
                  attextr(tem(v.4)), atttrus(tem(v.4)), attwwt(tem(v.4)),
                  attwt(tem(v.4)), attut(tem(v.4))
)"]:
     [ State_111121111( v, L_h, lock ) ]
    --[
    GetKeyValue( z ),
    Restr_ifCangetkeyvalueattwraptemvattunwraptemvattenctemvattdectemvattsenstemvattextrtemvatttrustemvattwwttemvattwttemvattuttemv_0_111121111_1( z.1
    )
    ]->
     [ State_111121111111( v, L_h, lock ), Out( z ) ]
    variants (modulo AC)
    1. v     = v.11
       z     = key(v.11)
       z.1   = attsens(tem(v.11))
    
    2. v     = <x.11, x.12>
       z     = x.11
       z.1   = attsens(x.12)
    
    3. v     = <x.11, x.12, x.13, x.14, x.15, x.16, x.17, x.18, x.19, x.20, 
                x.21>
       z     = x.11
       z.1   = x.16
  */

rule (modulo E) unlockdevice_0_111121111111[color=#408051,
                                            process="unlock 'device';"]:
   [ State_111121111111( v.4, L_h.5, lock.5 ) ]
  --[ Unlock_5( '5', lock.5, 'device' ), Unlock( '5', lock.5, 'device' )
  ]->
   [ ]

  /*
  rule (modulo AC) unlockdevice_0_111121111111[color=#408051,
                                               process="unlock 'device';"]:
     [ State_111121111111( v, L_h, lock ) ]
    --[ Unlock_5( '5', lock, 'device' ), Unlock( '5', lock, 'device' ) ]->
     [ ]
  */

rule (modulo E) lookupobjLhasv_1_11112111[color=#408051,
                                          process="lookup <'obj', L_h.5> as v.4"]:
   [ State_11112111( L_h.5, lock.5 ) ]
  --[ IsNotSet( <'obj', L_h.5> ) ]->
   [ ]

  /*
  rule (modulo AC) lookupobjLhasv_1_11112111[color=#408051,
                                             process="lookup <'obj', L_h.5> as v.4"]:
     [ State_11112111( L_h, lock ) ] --[ IsNotSet( <'obj', L_h> ) ]-> [ ]
  */

restriction set_in:
  "∀ x y #t3.
    (IsIn( x, y ) @ #t3) ⇒
    (∃ #t2.
      ((Insert( x, y ) @ #t2) ∧ (#t2 < #t3)) ∧
      (∀ #t1 yp.
        (Insert( x, yp ) @ #t1) ⇒ (((#t1 < #t2) ∨ (#t1 = #t2)) ∨ (#t3 < #t1))))"

restriction set_notin:
  "∀ x #t3.
    (IsNotSet( x ) @ #t3) ⇒ (∀ #t1 y. (Insert( x, y ) @ #t1) ⇒ (#t3 < #t1))"
  // safety formula

restriction predicate_eq:
  "∀ #i a b. (Pred_Eq( a, b ) @ #i) ⇒ (a = b)"
  // safety formula

restriction predicate_not_eq:
  "∀ #i a b. (Pred_Not_Eq( a, b ) @ #i) ⇒ (¬(a = b))"
  // safety formula

restriction single_session:
  "∀ #i #j. ((Init( ) @ #i) ∧ (Init( ) @ #j)) ⇒ (#i = #j)"
  // safety formula

restriction locking_0:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_0( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_0( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

restriction locking_1:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_1( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_1( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

restriction locking_2:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_2( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_2( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

restriction locking_3:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_3( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_3( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

restriction locking_4:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_4( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_4( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

restriction locking_5:
  "∀ p pp l x lp #t1 #t3.
    ((Lock_5( p, l, x ) @ #t1) ∧ (Lock( pp, lp, x ) @ #t3)) ⇒
    ((((#t1 < #t3) ∧
       (∃ #t2.
         (((((Unlock_5( p, l, x ) @ #t2) ∧ (#t1 < #t2)) ∧ (#t2 < #t3)) ∧
           (∀ #t0 pp.1. (Unlock( pp.1, l, x ) @ #t0) ⇒ (#t0 = #t2))) ∧
          (∀ pp.1 lpp #t0.
            (Lock( pp.1, lpp, x ) @ #t0) ⇒
            (((#t0 < #t1) ∨ (#t0 = #t1)) ∨ (#t2 < #t0)))) ∧
         (∀ pp.1 lpp #t0.
           (Unlock( pp.1, lpp, x ) @ #t0) ⇒
           (((#t0 < #t1) ∨ (#t2 < #t0)) ∨ (#t2 = #t0))))) ∨
      (#t3 < #t1)) ∨
     (#t1 = #t3))"

/*
WARNING: the following wellformedness checks failed!

Timed Out
  Derivation Checks
*/

/*
Generated from:
Tamarin version 1.7.1
Maude version 3.2.1
Git revision: 4b299c253445d7bbc7fce41abf0b0d5659bb1d58, branch: develop
Compiled at: 2023-06-26 11:54:20.223793825 UTC
*/

end
/* Output
maude tool: 'maude'
 checking version: 3.2.1. OK.
 checking installation: OK.

==============================================================================
summary of summaries:

analyzed: examples/sapic/slow/PKCS11/pkcs11-templates.spthy

  output:          examples/sapic/slow/PKCS11/pkcs11-templates.spthy.tmp
  processing time: 105.67s
  
  WARNING: 1 wellformedness check failed!
           The analysis results might be wrong!
  
  dec_limits (all-traces): verified (1411 steps)
  bad_keys (all-traces): verified (311 steps)
  no_key_is_wrap_and_dec__or_unwrap_and_dec_ind (all-traces): verified (906 steps)
  no_key_is_enc_and_unwrap (all-traces): verified (320 steps)
  cannot_obtain_key_ind (all-traces): verified (723 steps)
  cannot_obtain_key (all-traces): verified (2 steps)

==============================================================================
*/
