theory TPM_Envelope begin

// Function signature and definition of the equational theory E

functions: adec/2, aenc/2, fst/1, h/1, pair/2, pk/1, sign/2, snd/1,
           true/0, verify/3
equations:
    adec(aenc(x.1, pk(x.2)), x.2) = x.1,
    fst(<x.1, x.2>) = x.1,
    snd(<x.1, x.2>) = x.2,
    verify(sign(x.1, x.2), x.1, pk(x.2)) = true

rule (modulo E) PCR_Init:
   [ Fr( ~aik ) ]
  --[ PCR_Init( ), PCR_Write( 'pcr0' ) ]->
   [ PCR( 'pcr0' ), PCR_Write( 'pcr0' ), !AIK( ~aik ), Out( pk(~aik) ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) PCR_Extend:
   [ PCR_Write( x ), PCR( x ), In( y ) ]
  --[ PCR_Write( h(<x, y>) ) ]->
   [ PCR( h(<x, y>) ), PCR_Write( h(<x, y>) ) ]

  // loop breakers: [0,1]
  /* has exactly the trivial AC variant */

rule (modulo E) PCR_CertKey:
   [ !AIK( aik ), !KeyTable( lock, sk ) ]
  -->
   [ Out( sign(<'certkey', lock, pk(sk)>, aik) ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) PCR_Quote:
   [ PCR( x ), !AIK( aik ) ]
  --[ PCR_Read( x ) ]->
   [ Out( sign(<'certpcr', x>, aik) ), PCR( x ) ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

rule (modulo E) PCR_Unbind:
   [ PCR( x ), !KeyTable( x, sk ), In( aenc(m, pk(sk)) ) ]
  --[ PCR_Unbind( x, sk, m ), PCR_Read( x ) ]->
   [ PCR( x ), Out( m ) ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

rule (modulo E) Alice1:
   [ Fr( ~n ), PCR( x ), PCR_Write( x ) ]
  --[ PCR_Write( h(<x, ~n>) ) ]->
   [ PCR( h(<x, ~n>) ), PCR_Write( h(<x, ~n>) ), Alice1( ~n ) ]

  // loop breakers: [1,2]
  /* has exactly the trivial AC variant */

rule (modulo E) Alice2:
   [
   Alice1( n ), Fr( ~s ), !AIK( aik ),
   In( sign(<'certkey', h(<h(<'pcr0', n>), 'obtain'>), pk>, aik) )
   ]
  --[ Secret( ~s ) ]->
   [ Out( aenc(~s, pk) ), Alice2( n, ~s ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Alice3:
   [
   Alice2( n, s ), !AIK( aik ),
   In( sign(<'certpcr', h(<h(<'pcr0', n>), 'deny'>)>, aik) )
   ]
  --[ Denied( s ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) CreateLockedKey:
   [ PCR( x ), Fr( ~sk ), In( lock ) ]
  --[ PCR_Read( x ) ]->
   [ PCR( x ), !KeyTable( h(<x, lock>), ~sk ), Out( pk(~sk) ) ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

restriction PCR_Init_unique:
  "∀ #i #j. ((PCR_Init( ) @ #i) ∧ (PCR_Init( ) @ #j)) ⇒ (#i = #j)"
  // safety formula

lemma types [sources]:
  all-traces
  "∀ m d1 d2 #i.
    (PCR_Unbind( d1, d2, m ) @ #i) ⇒
    ((∃ #j. (!KU( m ) @ #j) ∧ (#j < #i)) ∨ (∃ #j. Secret( m ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ m d1 d2 #i.
  (PCR_Unbind( d1, d2, m ) @ #i)
 ∧
  (∀ #j. (!KU( m ) @ #j) ⇒ ¬(#j < #i)) ∧ (∀ #j. (Secret( m ) @ #j) ⇒ ⊥)"
*/
induction
  case empty_trace
  by contradiction /* from formulas */
next
  case non_empty_trace
  simplify
  solve( (last(#i))  ∥
         (∃ #j. (!KU( m ) @ #j) ∧ (¬(last(#j))) ∧ (#j < #i))  ∥
         (∃ #j. (Secret( m ) @ #j) ∧ ¬(last(#j))) )
    case case_1
    solve( !KeyTable( d1, d2 ) ▶₁ #i )
      case CreateLockedKey
      solve( !KU( aenc(m, pk(~sk)) ) @ #vk )
        case Alice2
        by contradiction /* from formulas */
      next
        case PCR_Unbind
        solve( (∃ #j. (!KU( t ) @ #j) ∧ (¬(last(#j))) ∧ (#j < #vr.1))  ∥
               (∃ #j. (Secret( t ) @ #j) ∧ ¬(last(#j))) )
          case case_1
          by contradiction /* cyclic */
        next
          case case_2
          by contradiction /* impossible chain */
        qed
      next
        case c_aenc
        by contradiction /* from formulas */
      qed
    qed
  next
    case case_2
    by contradiction /* from formulas */
  next
    case case_3
    by contradiction /* from formulas */
  qed
qed

lemma PCR_Write_charn [reuse, use_induction]:
  all-traces "∀ x #i. (PCR_Read( x ) @ #i) ⇒ (∃ #j. PCR_Write( x ) @ #j)"
/*
guarded formula characterizing all counter-examples:
"∃ x #i. (PCR_Read( x ) @ #i) ∧ ∀ #j. (PCR_Write( x ) @ #j) ⇒ ⊥"
*/
induction
  case empty_trace
  by contradiction /* from formulas */
next
  case non_empty_trace
  simplify
  solve( (last(#i))  ∥ (∃ #j. (PCR_Write( x ) @ #j) ∧ ¬(last(#j))) )
    case case_1
    solve( PCR_Read( x ) @ #i )
      case CreateLockedKey
      solve( PCR( x ) ▶₀ #i )
        case Alice1
        by contradiction /* from formulas */
      next
        case CreateLockedKey
        by contradiction /* from formulas */
      next
        case PCR_Extend
        by contradiction /* from formulas */
      next
        case PCR_Init
        by contradiction /* from formulas */
      next
        case PCR_Quote
        by contradiction /* from formulas */
      next
        case PCR_Unbind
        by contradiction /* from formulas */
      qed
    next
      case PCR_Quote
      solve( !AIK( aik ) ▶₁ #i )
        case PCR_Init
        solve( PCR( x ) ▶₀ #i )
          case Alice1
          by contradiction /* from formulas */
        next
          case CreateLockedKey
          by contradiction /* from formulas */
        next
          case PCR_Extend
          by contradiction /* from formulas */
        next
          case PCR_Init
          by contradiction /* from formulas */
        next
          case PCR_Quote
          by contradiction /* from formulas */
        next
          case PCR_Unbind
          by contradiction /* from formulas */
        qed
      qed
    next
      case PCR_Unbind
      solve( !KeyTable( x, sk ) ▶₁ #i )
        case CreateLockedKey
        solve( PCR_Write( x ) @ #j )
          case Alice1
          solve( !KU( aenc(m, pk(~sk)) ) @ #vk )
            case Alice2
            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk)>,
                             ~aik)
                   ) @ #vk.2 )
              case PCR_CertKey
              solve( PCR_Write( h(<'pcr0', ~n>) ) @ #j.1 )
                case Alice1
                solve( PCR( h(<h(<'pcr0', ~n>), 'obtain'>) ) ▶₀ #i )
                  case CreateLockedKey
                  by contradiction /* from formulas */
                next
                  case PCR_Extend
                  by contradiction /* from formulas */
                next
                  case PCR_Quote
                  by contradiction /* from formulas */
                next
                  case PCR_Unbind
                  by contradiction /* from formulas */
                qed
              next
                case PCR_Extend
                by solve( !KU( ~n ) @ #vk.3 )
              qed
            next
              case c_sign
              by solve( !KU( ~aik ) @ #vk.4 )
            qed
          next
            case c_aenc
            solve( PCR( h(<h(<x, ~n>), lock>) ) ▶₀ #i )
              case Alice1
              by contradiction /* from formulas */
            next
              case CreateLockedKey
              by contradiction /* from formulas */
            next
              case PCR_Extend
              by contradiction /* from formulas */
            next
              case PCR_Quote
              by contradiction /* from formulas */
            next
              case PCR_Unbind
              by contradiction /* from formulas */
            qed
          qed
        next
          case PCR_Extend
          solve( !KU( aenc(m, pk(~sk)) ) @ #vk )
            case Alice2
            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n>), 'obtain'>), pk(~sk)>,
                             ~aik)
                   ) @ #vk.3 )
              case PCR_CertKey
              solve( PCR_Write( h(<'pcr0', ~n>) ) @ #j.1 )
                case Alice1
                by solve( !KU( ~n ) @ #vk.3 )
              next
                case PCR_Extend
                by solve( !KU( ~n ) @ #vk.3 )
              qed
            next
              case c_sign
              by solve( !KU( ~aik ) @ #vk.5 )
            qed
          next
            case c_aenc
            solve( PCR( h(<h(<x, y>), lock>) ) ▶₀ #i )
              case Alice1
              by contradiction /* from formulas */
            next
              case CreateLockedKey
              by contradiction /* from formulas */
            next
              case PCR_Extend
              by contradiction /* from formulas */
            next
              case PCR_Quote
              by contradiction /* from formulas */
            next
              case PCR_Unbind
              by contradiction /* from formulas */
            qed
          qed
        next
          case PCR_Init
          solve( !KU( aenc(m, pk(~sk)) ) @ #vk )
            case Alice2
            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n>), 'obtain'>), pk(~sk)>,
                             ~aik)
                   ) @ #vk.2 )
              case c_sign
              by solve( !KU( ~aik ) @ #vk.4 )
            qed
          next
            case c_aenc
            solve( PCR( h(<'pcr0', lock>) ) ▶₀ #i )
              case Alice1
              by contradiction /* from formulas */
            next
              case CreateLockedKey
              by contradiction /* from formulas */
            next
              case PCR_Extend
              by contradiction /* from formulas */
            next
              case PCR_Quote
              by contradiction /* from formulas */
            next
              case PCR_Unbind
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    qed
  next
    case case_2
    by contradiction /* from formulas */
  qed
qed

lemma Secret_and_Denied_exclusive:
  all-traces
  "¬(∃ s #i #j #k.
      ((Secret( s ) @ #i) ∧ (Denied( s ) @ #j)) ∧ (K( s ) @ #k))"
/*
guarded formula characterizing all counter-examples:
"∃ s #i #j #k. (Secret( s ) @ #i) ∧ (Denied( s ) @ #j) ∧ (K( s ) @ #k)"
*/
simplify
solve( Alice1( n ) ▶₀ #i )
  case Alice1
  solve( !AIK( aik ) ▶₂ #i )
    case PCR_Init
    solve( Alice2( n.1, ~s ) ▶₀ #j )
      case Alice2
      solve( !AIK( aik.1 ) ▶₁ #j )
        case PCR_Init
        solve( !KU( ~s ) @ #vk.2 )
          case Alice2
          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n>), 'obtain'>), pk(x)>,
                           ~aik)
                 ) @ #vk.1 )
            case PCR_CertKey
            solve( PCR_Write( h(<'pcr0', ~n>) ) @ #j.1 )
              case Alice1
              by solve( !KU( ~sk ) @ #vk.3 )
            next
              case PCR_Extend
              by solve( !KU( ~sk ) @ #vk.3 )
            qed
          next
            case c_sign
            by solve( !KU( ~aik ) @ #vk.5 )
          qed
        next
          case PCR_Unbind
          solve( PCR_Write( h(<x.1, lock>) ) @ #j.1 )
            case Alice1
            solve( PCR_Write( x.1 ) @ #j.2 )
              case Alice1
              by solve( !KU( ~n.1 ) @ #vk.4 )
            next
              case PCR_Extend
              by solve( !KU( ~n.1 ) @ #vk.4 )
            next
              case PCR_Init
              by solve( !KU( ~n.1 ) @ #vk.4 )
            qed
          next
            case PCR_Extend
            solve( PCR_Write( x.1 ) @ #j.2 )
              case Alice1
              solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n>), 'obtain'>), pk>, ~aik)
                     ) @ #vk.1 )
                case PCR_CertKey
                solve( PCR_Write( h(<'pcr0', ~n>) ) @ #j.3 )
                  case Alice1
                  solve( !KU( sign(<'certpcr', h(<h(<'pcr0', ~n>), 'deny'>)>, ~aik)
                         ) @ #vk.2 )
                    case PCR_Quote
                    solve( PCR_Write( h(<h(<'pcr0', ~n>), 'deny'>) ) @ #j.3 )
                      case PCR_Extend
                      solve( !KU( aenc(~s, pk(~sk.1)) ) @ #vk.3 )
                        case Alice2
                        solve( PCR( 'pcr0' ) ▶₁ #vr )
                          case CreateLockedKey
                          solve( PCR_Write( 'pcr0' ) @ #j.3 )
                            case PCR_Init
                            solve( PCR_Write( 'pcr0' ) ▶₂ #vr )
                              case PCR_Init
                              solve( PCR( h(<h(<'pcr0', ~n>), 'obtain'>) ) ▶₀ #vr.2 )
                                case CreateLockedKey
                                solve( PCR( h(<'pcr0', ~n>) ) ▶₀ #vr.3 )
                                  case Alice1
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.4)) ) @ #vk.9 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.4)>,
                                                           ~aik)
                                                 ) @ #vk.10 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.12 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.3)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.9 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.8 )
                                  qed
                                next
                                  case CreateLockedKey
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.4)) ) @ #vk.9 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.4)>,
                                                           ~aik)
                                                 ) @ #vk.10 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.12 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.11 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.5)) ) @ #vk.10 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.5)>,
                                                           ~aik)
                                                 ) @ #vk.11 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.13 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.13 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.9 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.4)) ) @ #vk.9 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.4)>,
                                                           ~aik)
                                                 ) @ #vk.10 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.12 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.10 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.9 )
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.8 )
                                next
                                  case PCR_Quote
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.3)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.4)) ) @ #vk.9 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.3)>,
                                                           ~aik)
                                                 ) @ #vk.10 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.12 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.3)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.9 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.8 )
                                  qed
                                next
                                  case PCR_Unbind
                                  by solve( !KU( ~n ) @ #vk.9 )
                                qed
                              next
                                case PCR_Extend
                                solve( PCR( h(<'pcr0', ~n>) ) ▶₀ #vr.3 )
                                  case Alice1
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.7 )
                                  qed
                                next
                                  case CreateLockedKey
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.4)) ) @ #vk.9 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.3)>,
                                                           ~aik)
                                                 ) @ #vk.10 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.12 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.9 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.8 )
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.7 )
                                next
                                  case PCR_Quote
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.7 )
                                  qed
                                next
                                  case PCR_Unbind
                                  by solve( !KU( ~n ) @ #vk.8 )
                                qed
                              next
                                case PCR_Quote
                                solve( PCR( h(<'pcr0', ~n>) ) ▶₀ #vr.3 )
                                  case Alice1
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.7 )
                                  qed
                                next
                                  case CreateLockedKey
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.4)) ) @ #vk.9 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.3)>,
                                                           ~aik)
                                                 ) @ #vk.10 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.12 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.9 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.8 )
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.7 )
                                next
                                  case PCR_Quote
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.7 )
                                  qed
                                next
                                  case PCR_Unbind
                                  by solve( !KU( ~n ) @ #vk.8 )
                                qed
                              next
                                case PCR_Unbind
                                solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                  case Alice2
                                  solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.2)
                                                   >,
                                                   ~aik)
                                         ) @ #vk.8 )
                                    case PCR_CertKey
                                    solve( PCR_Write( h(<'pcr0', ~n>) ) @ #j.3 )
                                      case Alice1
                                      solve( PCR( h(<'pcr0', ~n>) ) ▶₀ #vr.3 )
                                        case Alice1
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                          case Alice1
                                          solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                            case CreateLockedKey
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.9 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.2)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.9 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.11 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.11 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.7 )
                                          next
                                            case PCR_Quote
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.2)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.8 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.10 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.10 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case PCR_Unbind
                                            by solve( !KU( ~n ) @ #vk.8 )
                                          qed
                                        next
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                          case Alice1
                                          solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                            case Alice1
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.9 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.2)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.9 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.11 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.11 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case CreateLockedKey
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.10 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.9 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.9 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.4)) ) @ #vk.9 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.3)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.10 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.12 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.12 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.8 )
                                          next
                                            case PCR_Quote
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.9 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.2)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.9 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.11 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.11 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case PCR_Unbind
                                            by solve( !KU( ~n ) @ #vk.9 )
                                          qed
                                        next
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                          case Alice1
                                          solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                            case Alice1
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.2)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.8 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.10 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.10 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case CreateLockedKey
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.9 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.2)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.9 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.11 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.11 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.7 )
                                          next
                                            case PCR_Quote
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.2)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.8 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.10 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.10 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case PCR_Unbind
                                            by solve( !KU( ~n ) @ #vk.8 )
                                          qed
                                        next
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    qed
                                  next
                                    case c_sign
                                    by solve( !KU( ~aik ) @ #vk.10 )
                                  qed
                                next
                                  case c_aenc
                                  solve( PCR( h(<'pcr0', ~n>) ) ▶₀ #vr.3 )
                                    case Alice1
                                    solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                        case CreateLockedKey
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.4)) ) @ #vk.11 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.4)>,
                                                             ~aik)
                                                   ) @ #vk.12 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.14 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.14 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.10 )
                                      next
                                        case PCR_Quote
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.3)) ) @ #vk.10 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.3)>,
                                                             ~aik)
                                                   ) @ #vk.11 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.13 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.13 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case PCR_Unbind
                                        by solve( !KU( ~n ) @ #vk.11 )
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.10 )
                                    qed
                                  next
                                    case CreateLockedKey
                                    solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                        case Alice1
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.4)) ) @ #vk.11 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.4)>,
                                                             ~aik)
                                                   ) @ #vk.12 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.14 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.14 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case CreateLockedKey
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.13 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.5)) ) @ #vk.12 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.5)>,
                                                             ~aik)
                                                   ) @ #vk.13 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.15 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.15 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.11 )
                                      next
                                        case PCR_Quote
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.4)) ) @ #vk.11 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.4)>,
                                                             ~aik)
                                                   ) @ #vk.12 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.14 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.14 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case PCR_Unbind
                                        by solve( !KU( ~n ) @ #vk.12 )
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.11 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.10 )
                                  next
                                    case PCR_Quote
                                    solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                        case Alice1
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.3)) ) @ #vk.10 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.3)>,
                                                             ~aik)
                                                   ) @ #vk.11 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.13 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.13 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case CreateLockedKey
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.4)) ) @ #vk.11 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.4)>,
                                                             ~aik)
                                                   ) @ #vk.12 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.14 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.14 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.10 )
                                      next
                                        case PCR_Quote
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.3)) ) @ #vk.10 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.3)>,
                                                             ~aik)
                                                   ) @ #vk.11 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.13 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.13 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case PCR_Unbind
                                        by solve( !KU( ~n ) @ #vk.11 )
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.10 )
                                    qed
                                  next
                                    case PCR_Unbind
                                    by solve( !KU( ~n ) @ #vk.11 )
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case PCR_Init
                          solve( PCR_Write( 'pcr0' ) ▶₂ #vr )
                            case PCR_Init
                            solve( PCR( h(<h(<'pcr0', ~n>), 'obtain'>) ) ▶₀ #vr.2 )
                              case CreateLockedKey
                              solve( PCR( h(<'pcr0', ~n>) ) ▶₀ #vr.3 )
                                case Alice1
                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                  case Alice1
                                  solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                    case CreateLockedKey
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.9 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.3)>,
                                                         ~aik)
                                               ) @ #vk.9 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.11 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.11 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.7 )
                                  next
                                    case PCR_Quote
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.2)>,
                                                         ~aik)
                                               ) @ #vk.8 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.10 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Unbind
                                    solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                      case PCR_Init
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    qed
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.7 )
                                qed
                              next
                                case CreateLockedKey
                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                  case Alice1
                                  solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.9 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.3)>,
                                                         ~aik)
                                               ) @ #vk.9 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.11 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.11 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case CreateLockedKey
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.10 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.9 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.9 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.4)) ) @ #vk.9 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.4)>,
                                                         ~aik)
                                               ) @ #vk.10 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.12 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.12 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.8 )
                                  next
                                    case PCR_Quote
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.9 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.3)>,
                                                         ~aik)
                                               ) @ #vk.9 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.11 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.11 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Unbind
                                    solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                      case PCR_Init
                                      by solve( !KU( ~n ) @ #vk.9 )
                                    qed
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.8 )
                                qed
                              next
                                case PCR_Extend
                                by solve( !KU( ~n ) @ #vk.7 )
                              next
                                case PCR_Quote
                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                  case Alice1
                                  solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.2)>,
                                                         ~aik)
                                               ) @ #vk.8 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.10 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case CreateLockedKey
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.9 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.2)>,
                                                         ~aik)
                                               ) @ #vk.9 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.11 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.11 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.7 )
                                  next
                                    case PCR_Quote
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.2)>,
                                                         ~aik)
                                               ) @ #vk.8 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.10 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Unbind
                                    solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                      case PCR_Init
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    qed
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.7 )
                                qed
                              next
                                case PCR_Unbind
                                solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                  case PCR_Init
                                  by solve( !KU( ~n ) @ #vk.8 )
                                qed
                              qed
                            next
                              case PCR_Extend
                              solve( PCR( h(<'pcr0', ~n>) ) ▶₀ #vr.3 )
                                case Alice1
                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                  case Alice1
                                  solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                    case CreateLockedKey
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.1)>,
                                                         ~aik)
                                               ) @ #vk.8 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.10 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.6 )
                                  next
                                    case PCR_Quote
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.6 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.6 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.1)>,
                                                         ~aik)
                                               ) @ #vk.7 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.9 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Unbind
                                    solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                      case PCR_Init
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    qed
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.6 )
                                qed
                              next
                                case CreateLockedKey
                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                  case Alice1
                                  solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.1)>,
                                                         ~aik)
                                               ) @ #vk.8 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.10 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case CreateLockedKey
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.9 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.2)>,
                                                         ~aik)
                                               ) @ #vk.9 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.11 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.11 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.7 )
                                  next
                                    case PCR_Quote
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.1)>,
                                                         ~aik)
                                               ) @ #vk.8 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.10 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Unbind
                                    solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                      case PCR_Init
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    qed
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.7 )
                                qed
                              next
                                case PCR_Extend
                                by solve( !KU( ~n ) @ #vk.6 )
                              next
                                case PCR_Quote
                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                  case Alice1
                                  solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.6 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.6 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.1)>,
                                                         ~aik)
                                               ) @ #vk.7 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.9 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case CreateLockedKey
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.1)>,
                                                         ~aik)
                                               ) @ #vk.8 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.10 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.6 )
                                  next
                                    case PCR_Quote
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.6 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.6 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.1)>,
                                                         ~aik)
                                               ) @ #vk.7 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.9 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Unbind
                                    solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                      case PCR_Init
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    qed
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.6 )
                                qed
                              next
                                case PCR_Unbind
                                solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                  case PCR_Init
                                  by solve( !KU( ~n ) @ #vk.7 )
                                qed
                              qed
                            next
                              case PCR_Quote
                              solve( PCR( h(<'pcr0', ~n>) ) ▶₀ #vr.3 )
                                case Alice1
                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                  case Alice1
                                  solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                    case CreateLockedKey
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.1)>,
                                                         ~aik)
                                               ) @ #vk.8 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.10 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.6 )
                                  next
                                    case PCR_Quote
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.6 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.6 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.1)>,
                                                         ~aik)
                                               ) @ #vk.7 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.9 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Unbind
                                    solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                      case PCR_Init
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    qed
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.6 )
                                qed
                              next
                                case CreateLockedKey
                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                  case Alice1
                                  solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.1)>,
                                                         ~aik)
                                               ) @ #vk.8 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.10 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case CreateLockedKey
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.9 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.2)>,
                                                         ~aik)
                                               ) @ #vk.9 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.11 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.11 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.7 )
                                  next
                                    case PCR_Quote
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.1)>,
                                                         ~aik)
                                               ) @ #vk.8 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.10 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Unbind
                                    solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                      case PCR_Init
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    qed
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.7 )
                                qed
                              next
                                case PCR_Extend
                                by solve( !KU( ~n ) @ #vk.6 )
                              next
                                case PCR_Quote
                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                  case Alice1
                                  solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.6 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.6 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.1)>,
                                                         ~aik)
                                               ) @ #vk.7 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.9 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case CreateLockedKey
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.8 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.1)>,
                                                         ~aik)
                                               ) @ #vk.8 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.10 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.6 )
                                  next
                                    case PCR_Quote
                                    solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Extend
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.6 )
                                      qed
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.6 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                        case Alice2
                                        solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                          pk(~sk.1)>,
                                                         ~aik)
                                               ) @ #vk.7 )
                                          case c_sign
                                          by solve( !KU( ~aik ) @ #vk.9 )
                                        qed
                                      next
                                        case c_aenc
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      qed
                                    qed
                                  next
                                    case PCR_Unbind
                                    solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                      case PCR_Init
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    qed
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.6 )
                                qed
                              next
                                case PCR_Unbind
                                solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                  case PCR_Init
                                  by solve( !KU( ~n ) @ #vk.7 )
                                qed
                              qed
                            next
                              case PCR_Unbind
                              solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                case Alice2
                                solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.1)
                                                 >,
                                                 ~aik)
                                       ) @ #vk.7 )
                                  case PCR_CertKey
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) @ #j.3 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₀ #vr.3 )
                                      case Alice1
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                        case Alice1
                                        solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                          case CreateLockedKey
                                          solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                            case CreateLockedKey
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.8 )
                                            qed
                                          next
                                            case PCR_Extend
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.7 )
                                            qed
                                          next
                                            case PCR_Quote
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.7 )
                                            qed
                                          next
                                            case PCR_Unbind
                                            solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                              case Alice2
                                              solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                                pk(~sk.1)>,
                                                               ~aik)
                                                     ) @ #vk.8 )
                                                case c_sign
                                                by solve( !KU( ~aik ) @ #vk.10 )
                                              qed
                                            next
                                              case c_aenc
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.10 )
                                              qed
                                            qed
                                          qed
                                        next
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        next
                                          case PCR_Quote
                                          solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                            case CreateLockedKey
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.7 )
                                            qed
                                          next
                                            case PCR_Extend
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.6 )
                                            qed
                                          next
                                            case PCR_Quote
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.6 )
                                            qed
                                          next
                                            case PCR_Unbind
                                            solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                              case Alice2
                                              solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                                pk(~sk.1)>,
                                                               ~aik)
                                                     ) @ #vk.7 )
                                                case c_sign
                                                by solve( !KU( ~aik ) @ #vk.9 )
                                              qed
                                            next
                                              case c_aenc
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.9 )
                                              qed
                                            qed
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                            case PCR_Init
                                            by solve( !KU( ~n ) @ #vk.7 )
                                          qed
                                        qed
                                      next
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.6 )
                                      qed
                                    next
                                      case CreateLockedKey
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                        case Alice1
                                        solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                          case Alice1
                                          solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                            case CreateLockedKey
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.8 )
                                            qed
                                          next
                                            case PCR_Extend
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.7 )
                                            qed
                                          next
                                            case PCR_Quote
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.7 )
                                            qed
                                          next
                                            case PCR_Unbind
                                            solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                              case Alice2
                                              solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                                pk(~sk.1)>,
                                                               ~aik)
                                                     ) @ #vk.8 )
                                                case c_sign
                                                by solve( !KU( ~aik ) @ #vk.10 )
                                              qed
                                            next
                                              case c_aenc
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.10 )
                                              qed
                                            qed
                                          qed
                                        next
                                          case CreateLockedKey
                                          solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                            case CreateLockedKey
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.9 )
                                            qed
                                          next
                                            case PCR_Extend
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.8 )
                                            qed
                                          next
                                            case PCR_Quote
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.8 )
                                            qed
                                          next
                                            case PCR_Unbind
                                            solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                              case Alice2
                                              solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                                pk(~sk.2)>,
                                                               ~aik)
                                                     ) @ #vk.9 )
                                                case c_sign
                                                by solve( !KU( ~aik ) @ #vk.11 )
                                              qed
                                            next
                                              case c_aenc
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.11 )
                                              qed
                                            qed
                                          qed
                                        next
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        next
                                          case PCR_Quote
                                          solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                            case CreateLockedKey
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.8 )
                                            qed
                                          next
                                            case PCR_Extend
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.7 )
                                            qed
                                          next
                                            case PCR_Quote
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.7 )
                                            qed
                                          next
                                            case PCR_Unbind
                                            solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                              case Alice2
                                              solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                                pk(~sk.1)>,
                                                               ~aik)
                                                     ) @ #vk.8 )
                                                case c_sign
                                                by solve( !KU( ~aik ) @ #vk.10 )
                                              qed
                                            next
                                              case c_aenc
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.10 )
                                              qed
                                            qed
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                            case PCR_Init
                                            by solve( !KU( ~n ) @ #vk.8 )
                                          qed
                                        qed
                                      next
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.6 )
                                    next
                                      case PCR_Quote
                                      solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                        case Alice1
                                        solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                          case Alice1
                                          solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                            case CreateLockedKey
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.7 )
                                            qed
                                          next
                                            case PCR_Extend
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.6 )
                                            qed
                                          next
                                            case PCR_Quote
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.6 )
                                            qed
                                          next
                                            case PCR_Unbind
                                            solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                              case Alice2
                                              solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                                pk(~sk.1)>,
                                                               ~aik)
                                                     ) @ #vk.7 )
                                                case c_sign
                                                by solve( !KU( ~aik ) @ #vk.9 )
                                              qed
                                            next
                                              case c_aenc
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.9 )
                                              qed
                                            qed
                                          qed
                                        next
                                          case CreateLockedKey
                                          solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                            case CreateLockedKey
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.8 )
                                            qed
                                          next
                                            case PCR_Extend
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.7 )
                                            qed
                                          next
                                            case PCR_Quote
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.7 )
                                            qed
                                          next
                                            case PCR_Unbind
                                            solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                              case Alice2
                                              solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                                pk(~sk.1)>,
                                                               ~aik)
                                                     ) @ #vk.8 )
                                                case c_sign
                                                by solve( !KU( ~aik ) @ #vk.10 )
                                              qed
                                            next
                                              case c_aenc
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.10 )
                                              qed
                                            qed
                                          qed
                                        next
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        next
                                          case PCR_Quote
                                          solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                            case CreateLockedKey
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.7 )
                                            qed
                                          next
                                            case PCR_Extend
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.6 )
                                            qed
                                          next
                                            case PCR_Quote
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.6 )
                                            qed
                                          next
                                            case PCR_Unbind
                                            solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                              case Alice2
                                              solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                                pk(~sk.1)>,
                                                               ~aik)
                                                     ) @ #vk.7 )
                                                case c_sign
                                                by solve( !KU( ~aik ) @ #vk.9 )
                                              qed
                                            next
                                              case c_aenc
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.9 )
                                              qed
                                            qed
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                            case PCR_Init
                                            by solve( !KU( ~n ) @ #vk.7 )
                                          qed
                                        qed
                                      next
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.6 )
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                        case PCR_Init
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.6 )
                                  qed
                                next
                                  case c_sign
                                  by solve( !KU( ~aik ) @ #vk.9 )
                                qed
                              next
                                case c_aenc
                                solve( PCR( h(<'pcr0', ~n>) ) ▶₀ #vr.3 )
                                  case Alice1
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.11 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m.1, pk(~sk.3)) ) @ #vk.10 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.3)>,
                                                           ~aik)
                                                 ) @ #vk.11 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.13 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.13 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.9 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m.1, pk(~sk.2)) ) @ #vk.9 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.10 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.12 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                        case PCR_Init
                                        by solve( !KU( ~n ) @ #vk.10 )
                                      qed
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.9 )
                                  qed
                                next
                                  case CreateLockedKey
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.11 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m.1, pk(~sk.3)) ) @ #vk.10 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.3)>,
                                                           ~aik)
                                                 ) @ #vk.11 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.13 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.13 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.12 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.11 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.11 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m.1, pk(~sk.4)) ) @ #vk.11 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.4)>,
                                                           ~aik)
                                                 ) @ #vk.12 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.14 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.14 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.10 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.11 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m.1, pk(~sk.3)) ) @ #vk.10 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.3)>,
                                                           ~aik)
                                                 ) @ #vk.11 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.13 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.13 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                        case PCR_Init
                                        by solve( !KU( ~n ) @ #vk.11 )
                                      qed
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.10 )
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.9 )
                                next
                                  case PCR_Quote
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m.1, pk(~sk.2)) ) @ #vk.9 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.10 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.12 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.11 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m.1, pk(~sk.3)) ) @ #vk.10 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.3)>,
                                                           ~aik)
                                                 ) @ #vk.11 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.13 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.13 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.9 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m.1, pk(~sk.2)) ) @ #vk.9 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.10 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.12 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                        case PCR_Init
                                        by solve( !KU( ~n ) @ #vk.10 )
                                      qed
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.9 )
                                  qed
                                next
                                  case PCR_Unbind
                                  solve( PCR_Write( 'pcr0' ) @ #j.3 )
                                    case PCR_Init
                                    by solve( !KU( ~n ) @ #vk.10 )
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case PCR_Quote
                          solve( PCR_Write( 'pcr0' ) @ #j.3 )
                            case PCR_Init
                            solve( PCR_Write( 'pcr0' ) ▶₂ #vr )
                              case PCR_Init
                              solve( PCR( h(<h(<'pcr0', ~n>), 'obtain'>) ) ▶₀ #vr.2 )
                                case CreateLockedKey
                                solve( PCR( h(<'pcr0', ~n>) ) ▶₀ #vr.3 )
                                  case Alice1
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.7 )
                                  qed
                                next
                                  case CreateLockedKey
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.10 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.4)) ) @ #vk.9 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.3)>,
                                                           ~aik)
                                                 ) @ #vk.10 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.12 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.9 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.8 )
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.7 )
                                next
                                  case PCR_Quote
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.2)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.7 )
                                  qed
                                next
                                  case PCR_Unbind
                                  by solve( !KU( ~n ) @ #vk.8 )
                                qed
                              next
                                case PCR_Extend
                                solve( PCR( h(<'pcr0', ~n>) ) ▶₀ #vr.3 )
                                  case Alice1
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.6 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.7 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.9 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.9 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.6 )
                                  qed
                                next
                                  case CreateLockedKey
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.7 )
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.6 )
                                next
                                  case PCR_Quote
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.7 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.9 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.9 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.6 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.7 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.9 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.9 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.6 )
                                  qed
                                next
                                  case PCR_Unbind
                                  by solve( !KU( ~n ) @ #vk.7 )
                                qed
                              next
                                case PCR_Quote
                                solve( PCR( h(<'pcr0', ~n>) ) ▶₀ #vr.3 )
                                  case Alice1
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.6 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.7 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.9 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.9 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.6 )
                                  qed
                                next
                                  case CreateLockedKey
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.9 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.9 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.11 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.8 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.7 )
                                  qed
                                next
                                  case PCR_Extend
                                  by solve( !KU( ~n ) @ #vk.6 )
                                next
                                  case PCR_Quote
                                  solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                    case Alice1
                                    solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.7 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.9 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.9 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case CreateLockedKey
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.8 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.8 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.10 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.6 )
                                    next
                                      case PCR_Quote
                                      solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Extend
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        qed
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                          case Alice2
                                          solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                            pk(~sk.1)>,
                                                           ~aik)
                                                 ) @ #vk.7 )
                                            case c_sign
                                            by solve( !KU( ~aik ) @ #vk.9 )
                                          qed
                                        next
                                          case c_aenc
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.9 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case PCR_Unbind
                                      by solve( !KU( ~n ) @ #vk.7 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.6 )
                                  qed
                                next
                                  case PCR_Unbind
                                  by solve( !KU( ~n ) @ #vk.7 )
                                qed
                              next
                                case PCR_Unbind
                                solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                  case Alice2
                                  solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.1)
                                                   >,
                                                   ~aik)
                                         ) @ #vk.7 )
                                    case PCR_CertKey
                                    solve( PCR_Write( h(<'pcr0', ~n>) ) @ #j.3 )
                                      case Alice1
                                      solve( PCR( h(<'pcr0', ~n>) ) ▶₀ #vr.3 )
                                        case Alice1
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                          case Alice1
                                          solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                            case CreateLockedKey
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.1)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.8 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.10 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.10 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.6 )
                                          next
                                            case PCR_Quote
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.6 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.6 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.1)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.7 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.9 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.9 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case PCR_Unbind
                                            by solve( !KU( ~n ) @ #vk.7 )
                                          qed
                                        next
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        qed
                                      next
                                        case CreateLockedKey
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                          case Alice1
                                          solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                            case Alice1
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.1)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.8 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.10 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.10 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case CreateLockedKey
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.9 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.3)) ) @ #vk.8 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.1)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.9 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.11 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.11 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.7 )
                                          next
                                            case PCR_Quote
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.1)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.8 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.10 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.10 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case PCR_Unbind
                                            by solve( !KU( ~n ) @ #vk.8 )
                                          qed
                                        next
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.7 )
                                        qed
                                      next
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.6 )
                                      next
                                        case PCR_Quote
                                        solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                          case Alice1
                                          solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                            case Alice1
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.6 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.6 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.1)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.7 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.9 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.9 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case CreateLockedKey
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.8 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.2)) ) @ #vk.7 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.1)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.8 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.10 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.10 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.6 )
                                          next
                                            case PCR_Quote
                                            solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                              case CreateLockedKey
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.7 )
                                              qed
                                            next
                                              case PCR_Extend
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.6 )
                                              qed
                                            next
                                              case PCR_Quote
                                              solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                case PCR_Extend
                                                by solve( !KU( ~n ) @ #vk.6 )
                                              qed
                                            next
                                              case PCR_Unbind
                                              solve( !KU( aenc(m, pk(~sk.1)) ) @ #vk.6 )
                                                case Alice2
                                                solve( !KU( sign(<'certkey', 
                                                                  h(<h(<'pcr0', ~n.1>), 'obtain'>), pk(~sk.1)
                                                                 >,
                                                                 ~aik)
                                                       ) @ #vk.7 )
                                                  case c_sign
                                                  by solve( !KU( ~aik ) @ #vk.9 )
                                                qed
                                              next
                                                case c_aenc
                                                solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                                  case PCR_Extend
                                                  by solve( !KU( ~n ) @ #vk.9 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case PCR_Unbind
                                            by solve( !KU( ~n ) @ #vk.7 )
                                          qed
                                        next
                                          case PCR_Extend
                                          by solve( !KU( ~n ) @ #vk.6 )
                                        qed
                                      next
                                        case PCR_Unbind
                                        by solve( !KU( ~n ) @ #vk.7 )
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.6 )
                                    qed
                                  next
                                    case c_sign
                                    by solve( !KU( ~aik ) @ #vk.9 )
                                  qed
                                next
                                  case c_aenc
                                  solve( PCR( h(<'pcr0', ~n>) ) ▶₀ #vr.3 )
                                    case Alice1
                                    solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                        case CreateLockedKey
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.3)) ) @ #vk.10 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.3)>,
                                                             ~aik)
                                                   ) @ #vk.11 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.13 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.13 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.9 )
                                      next
                                        case PCR_Quote
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.9 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.9 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.2)) ) @ #vk.9 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.2)>,
                                                             ~aik)
                                                   ) @ #vk.10 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.12 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.12 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case PCR_Unbind
                                        by solve( !KU( ~n ) @ #vk.10 )
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.9 )
                                    qed
                                  next
                                    case CreateLockedKey
                                    solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                        case Alice1
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.3)) ) @ #vk.10 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.3)>,
                                                             ~aik)
                                                   ) @ #vk.11 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.13 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.13 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case CreateLockedKey
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.12 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.4)) ) @ #vk.11 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.4)>,
                                                             ~aik)
                                                   ) @ #vk.12 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.14 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.14 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.10 )
                                      next
                                        case PCR_Quote
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.3)) ) @ #vk.10 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.3)>,
                                                             ~aik)
                                                   ) @ #vk.11 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.13 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.13 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case PCR_Unbind
                                        by solve( !KU( ~n ) @ #vk.11 )
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.10 )
                                    qed
                                  next
                                    case PCR_Extend
                                    by solve( !KU( ~n ) @ #vk.9 )
                                  next
                                    case PCR_Quote
                                    solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.1 )
                                      case Alice1
                                      solve( PCR( h(<'pcr0', ~n>) ) ▶₁ #j.1 )
                                        case Alice1
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.9 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.9 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.2)) ) @ #vk.9 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.2)>,
                                                             ~aik)
                                                   ) @ #vk.10 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.12 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.12 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case CreateLockedKey
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.11 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.3)) ) @ #vk.10 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.2)>,
                                                             ~aik)
                                                   ) @ #vk.11 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.13 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.13 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case PCR_Extend
                                        by solve( !KU( ~n ) @ #vk.9 )
                                      next
                                        case PCR_Quote
                                        solve( PCR( h(<h(<'pcr0', ~n>), 'deny'>) ) ▶₀ #vr.5 )
                                          case CreateLockedKey
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.10 )
                                          qed
                                        next
                                          case PCR_Extend
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.9 )
                                          qed
                                        next
                                          case PCR_Quote
                                          solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                            case PCR_Extend
                                            by solve( !KU( ~n ) @ #vk.9 )
                                          qed
                                        next
                                          case PCR_Unbind
                                          solve( !KU( aenc(m.1, pk(~sk.2)) ) @ #vk.9 )
                                            case Alice2
                                            solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n.1>), 'obtain'>), 
                                                              pk(~sk.2)>,
                                                             ~aik)
                                                   ) @ #vk.10 )
                                              case c_sign
                                              by solve( !KU( ~aik ) @ #vk.12 )
                                            qed
                                          next
                                            case c_aenc
                                            solve( PCR_Write( h(<'pcr0', ~n>) ) ▶₀ #j.2 )
                                              case PCR_Extend
                                              by solve( !KU( ~n ) @ #vk.12 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case PCR_Unbind
                                        by solve( !KU( ~n ) @ #vk.10 )
                                      qed
                                    next
                                      case PCR_Extend
                                      by solve( !KU( ~n ) @ #vk.9 )
                                    qed
                                  next
                                    case PCR_Unbind
                                    by solve( !KU( ~n ) @ #vk.10 )
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_aenc
                        by contradiction /* cyclic */
                      qed
                    qed
                  next
                    case c_sign
                    by solve( !KU( ~aik ) @ #vk.7 )
                  qed
                next
                  case PCR_Extend
                  by solve( !KU( ~n ) @ #vk.6 )
                qed
              next
                case c_sign
                by solve( !KU( ~aik ) @ #vk.6 )
              qed
            next
              case PCR_Extend
              solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n>), 'obtain'>), pk>, ~aik)
                     ) @ #vk.1 )
                case PCR_CertKey
                solve( PCR_Write( h(<'pcr0', ~n>) ) @ #j.3 )
                  case Alice1
                  solve( !KU( sign(<'certpcr', h(<h(<'pcr0', ~n>), 'deny'>)>, ~aik)
                         ) @ #vk.2 )
                    case PCR_Quote
                    solve( PCR_Write( h(<h(<'pcr0', ~n>), 'deny'>) ) @ #j.3 )
                      case PCR_Extend
                      solve( !KU( aenc(~s, pk(~sk.1)) ) @ #vk.3 )
                        case Alice2
                        by solve( !KU( ~n ) @ #vk.5 )
                      next
                        case c_aenc
                        by contradiction /* cyclic */
                      qed
                    qed
                  next
                    case c_sign
                    by solve( !KU( ~aik ) @ #vk.8 )
                  qed
                next
                  case PCR_Extend
                  by solve( !KU( ~n ) @ #vk.7 )
                qed
              next
                case c_sign
                by solve( !KU( ~aik ) @ #vk.7 )
              qed
            next
              case PCR_Init
              solve( !KU( sign(<'certkey', h(<h(<'pcr0', ~n>), 'obtain'>), pk>, ~aik)
                     ) @ #vk.1 )
                case PCR_CertKey
                solve( PCR_Write( h(<'pcr0', ~n>) ) @ #j.2 )
                  case Alice1
                  solve( !KU( sign(<'certpcr', h(<h(<'pcr0', ~n>), 'deny'>)>, ~aik)
                         ) @ #vk.2 )
                    case PCR_Quote
                    solve( PCR_Write( h(<h(<'pcr0', ~n>), 'deny'>) ) @ #j.2 )
                      case PCR_Extend
                      solve( !KU( aenc(~s, pk(~sk.1)) ) @ #vk.3 )
                        case c_aenc
                        by contradiction /* cyclic */
                      qed
                    qed
                  next
                    case c_sign
                    by solve( !KU( ~aik ) @ #vk.7 )
                  qed
                next
                  case PCR_Extend
                  by solve( !KU( ~n ) @ #vk.6 )
                qed
              next
                case c_sign
                by solve( !KU( ~aik ) @ #vk.6 )
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

/* All well-formedness checks were successful. */

end
/* Output
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.
SAPIC tool: 'sapic'
Checking availablity ... OK.


analyzing: examples/related_work/TPM_DKRS_CSF11/Envelope.spthy

------------------------------------------------------------------------------
analyzed: examples/related_work/TPM_DKRS_CSF11/Envelope.spthy

  output:          examples/related_work/TPM_DKRS_CSF11/Envelope.spthy.tmp
  processing time: 28.441925s
  types (all-traces): verified (13 steps)
  PCR_Write_charn (all-traces): verified (60 steps)
  Secret_and_Denied_exclusive (all-traces): verified (1799 steps)

------------------------------------------------------------------------------

==============================================================================
summary of summaries:

analyzed: examples/related_work/TPM_DKRS_CSF11/Envelope.spthy

  output:          examples/related_work/TPM_DKRS_CSF11/Envelope.spthy.tmp
  processing time: 28.441925s
  types (all-traces): verified (13 steps)
  PCR_Write_charn (all-traces): verified (60 steps)
  Secret_and_Denied_exclusive (all-traces): verified (1799 steps)

==============================================================================
*/
